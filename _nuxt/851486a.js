/*! For license information please see LICENSES */
(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{1138:function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));n(622),n(606),n(604),n(4),n(110),n(623),n(12),n(7),n(46),n(53),n(212),n(32),n(35),n(36),n(27),n(42),n(21);var r=n(870),o=n(639),l=n(650),c=n(605),h=n(630),d=n(670);n(59);function f(){var e,t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},body=document.body,text=document.createTextNode(""),span=document.createElement("SPAN"),n=function(element,e,t){element.addEventListener(e,t,!1)},r=function(element,e,t){element.removeEventListener(e,t,!1)},o=function(n){var r,o;n?/^[a-zA-Z \.,\\\/\|0-9]$/.test(n)||(n="."):n="",void 0!==text.textContent?text.textContent=e.value+n:text.data=e.value+n,span.style.fontSize=h(e).fontSize,span.style.fontFamily=h(e).fontFamily,span.style.whiteSpace="pre",body.appendChild(span),r=span.clientWidth+2,body.removeChild(span),e.style.height=t.minHeight+"px",t.minWidth>r?e.style.width=t.minWidth+"px":r>t.maxWidth?e.style.width=t.maxWidth+"px":e.style.width=r+"px",o=e.scrollHeight?e.scrollHeight-1:0,t.minHeight>o?e.style.height=t.minHeight+"px":t.maxHeight<o?(e.style.height=t.maxHeight+"px",e.style.overflowY="visible"):e.style.height=o+"px"},l=function(){window.setTimeout(o,0)},c=function(r,c,h){e=r,function(n){if(n&&n.minHeight)if("inherit"==n.minHeight)t.minHeight=e.clientHeight;else{var r=parseInt(n.minHeight);isNaN(r)||(t.minHeight=r)}if(n&&n.maxHeight)if("inherit"==n.maxHeight)t.maxHeight=e.clientHeight;else{var o=parseInt(n.maxHeight);isNaN(o)||(t.maxHeight=o)}if(n&&n.minWidth)if("inherit"==n.minWidth)t.minWidth=e.clientWidth;else{var l=parseInt(n.minWidth);isNaN(l)||(t.minWidth=l)}if(n&&n.maxWidth)if("inherit"==n.maxWidth)t.maxWidth=e.clientWidth;else{var c=parseInt(n.maxWidth);isNaN(c)||(t.maxWidth=c)}span.firstChild||(span.className="autoResize",span.style.display="inline-block",span.appendChild(text))}(c),"TEXTAREA"==e.nodeName&&(e.style.resize="none",e.style.overflowY="",e.style.height=t.minHeight+"px",e.style.minWidth=t.minWidth+"px",e.style.maxWidth=t.maxWidth+"px",e.style.overflowY="hidden"),h&&(n(e,"change",o),n(e,"cut",l),n(e,"paste",l),n(e,"drop",l),n(e,"keydown",l),n(e,"focus",o),n(e,"compositionstart",l),n(e,"compositionupdate",l),n(e,"compositionend",l)),o()};function h(element){return element.currentStyle||document.defaultView.getComputedStyle(element)}return{init:function(e,t,n){c(e,t,n)},unObserve:function(){r(e,"change",o),r(e,"cut",l),r(e,"paste",l),r(e,"drop",l),r(e,"keydown",l),r(e,"focus",o),r(e,"compositionstart",l),r(e,"compositionupdate",l),r(e,"compositionend",l)},resize:o}}var y=n(617),v=n(682);n(61);function m(e,t){for(var n=Object(c.h)(t),r=t.value.split("\n"),o=n,l=0,i=0;i<r.length;i++){var h=r[i];0!==i&&(l+=r[i-1].length+1);var d=l+h.length;if("home"===e?o=l:"end"===e&&(o=d),n<=d)break}Object(c.O)(t,o)}function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function O(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function S(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function E(){return E="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var base=R(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},E.apply(this,arguments)}function R(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=x(object)););return object}function T(e,p){return T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},T(e,p)}function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=x(e);if(t){var o=x(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return j(this,n)}}function j(e,t){if(t&&("object"===w(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return A(e)}function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x(e){return x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},x(e)}var M="ht_editor_hidden",I="textEditor",_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T(e,t)}(R,e);var t,n,w,C=k(R);function R(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,R),(t=C.call(this,e)).eventManager=new o.a(A(t)),t.autoResize=f(),t.TEXTAREA=void 0,t.textareaStyle=void 0,t.TEXTAREA_PARENT=void 0,t.textareaParentStyle=void 0,t.layerClass=void 0,t.createElements(),t.bindEvents(),t.hot.addHookOnce("afterDestroy",(function(){return t.destroy()})),t}return t=R,n=[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(e){this.TEXTAREA.value=e}},{key:"open",value:function(){var e=this;this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",(function(t){return e.onAfterDocumentKeyDown(t)})),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(e,col,t,td,n,o){var c=this.state;if(E(x(R.prototype),"prepare",this).call(this,e,col,t,td,n,o),!o.readOnly){this.refreshDimensions(!0);var h=o.allowInvalid,d=o.fragmentSelection;h&&(this.TEXTAREA.value=""),c!==r.b.FINISHED&&this.hideEditableElement(),!d&&!Object(l.k)()&&this.focus()}}},{key:"beginEditing",value:function(e,t){this.state===r.b.VIRGIN&&(this.TEXTAREA.value="",E(x(R.prototype),"beginEditing",this).call(this,e,t))}},{key:"focus",value:function(){this.TEXTAREA.select(),Object(c.O)(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var e=this.hot.rootDocument;this.TEXTAREA=e.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,Object(c.a)(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),Object(c.a)(this.TEXTAREA_PARENT,"handsontableInputHolder"),Object(c.v)(this.TEXTAREA_PARENT,this.layerClass)&&Object(c.K)(this.TEXTAREA_PARENT,this.layerClass),Object(c.a)(this.TEXTAREA_PARENT,M),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(Object(l.f)()||Object(l.c)())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Object(c.K)(this.TEXTAREA_PARENT,this.layerClass),Object(c.a)(this.TEXTAREA_PARENT,M)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var e=this.TEXTAREA_PARENT.childNodes,t=!1;Object(h.c)(e.length-1,(function(n){var r=e[n];if(Object(c.v)(r,"handsontableEditor"))return t=!0,!1})),Object(c.v)(this.TEXTAREA_PARENT,M)&&Object(c.K)(this.TEXTAREA_PARENT,M),t?(this.layerClass="ht_editor_visible",Object(c.a)(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Object(c.a)(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state===r.b.EDITING||e)if(this.TD=this.getEditedCell(),this.TD){var t=this.getEditedCellRect(),n=t.top,o=t.start,l=t.width,h=t.maxWidth,d=t.height,f=t.maxHeight;this.textareaParentStyle.top="".concat(n,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(o,"px"),this.showEditableElement();var y=Object(c.i)(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=y.fontSize,this.TEXTAREA.style.fontFamily=y.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var v=Object(c.i)(this.TEXTAREA),m=parseInt(v.paddingLeft,10)+parseInt(v.paddingRight,10),w=parseInt(v.paddingTop,10)+parseInt(v.paddingBottom,10),O=l-m,C=d-w,S=h-m,E=f-w;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(O,S),minHeight:Math.min(C,E),maxWidth:S,maxHeight:E},!0)}else e||this.close()}},{key:"bindEvents",value:function(){var e=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",(function(e){return e.stopPropagation()})),this.eventManager.addEventListener(this.TEXTAREA,"paste",(function(e){return e.stopPropagation()})),Object(l.h)()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",(function(){return e.finishEditing(!1)})),this.addHook("afterScrollHorizontally",(function(){return e.refreshDimensions()})),this.addHook("afterScrollVertically",(function(){return e.refreshDimensions()})),this.addHook("afterColumnResize",(function(){e.refreshDimensions(),e.focus()})),this.addHook("afterRowResize",(function(){e.refreshDimensions(),e.focus()}))}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var e=this,t=this.hot.getShortcutManager().getContext("editor"),n={runOnlyIf:function(){return Object(y.b)(e.hot.getSelected())},group:I},r=function(){e.hot.rootDocument.execCommand("insertText",!1,"\n")};t.addShortcuts([{keys:[["Tab"]],callback:function(t){var n=e.hot.getSettings(),r="function"==typeof n.tabMoves?n.tabMoves(t):n.tabMoves;e.hot.selection.transformStart(r.row,r.col,!0)}},{keys:[["Shift","Tab"]],callback:function(t){var n=e.hot.getSettings(),r="function"==typeof n.tabMoves?n.tabMoves(t):n.tabMoves;e.hot.selection.transformStart(-r.row,-r.col)}},{keys:[["Control","Enter"]],callback:function(){return r(),!1},runOnlyIf:function(t){return!e.hot.selection.isMultiple()&&!t.altKey},relativeToGroup:v.a,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return r(),!1},runOnlyIf:function(){return!e.hot.selection.isMultiple()},relativeToGroup:v.a,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return r(),!1},relativeToGroup:v.a,position:"before"},{keys:[["PageUp"]],callback:function(){e.hot.selection.transformStart(-e.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){e.hot.selection.transformStart(e.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(t,n){m(O(n,1)[0],e.TEXTAREA)}},{keys:[["End"]],callback:function(t,n){m(O(n,1)[0],e.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){e.hot._registerTimeout((function(){e.autoResize.resize()}),10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){e.hot._registerTimeout((function(){e.autoResize.resize()}),10)}}],n)}},{key:"unregisterShortcuts",value:function(){var e=this.hot.getShortcutManager().getContext("editor");e.removeShortcutsByGroup(v.b),e.removeShortcutsByGroup(I),e.removeShortcutsByGroup(r.c)}},{key:"onAfterDocumentKeyDown",value:function(e){-1===[d.a.ARROW_UP,d.a.ARROW_RIGHT,d.a.ARROW_DOWN,d.a.ARROW_LEFT].indexOf(e.keyCode)&&this.autoResize.resize(String.fromCharCode(e.keyCode))}}],w=[{key:"EDITOR_TYPE",get:function(){return"text"}}],n&&S(t.prototype,n),w&&S(t,w),Object.defineProperty(t,"prototype",{writable:!1}),R}(r.a)},1140:function(e,t,n){"use strict";n.d(t,"a",(function(){return B}));n(28),n(36),n(60),n(42),n(32),n(212),n(4),n(631),n(35),n(377),n(22),n(622),n(21),n(61),n(214),n(101),n(626),n(606),n(604),n(110),n(623),n(12),n(7),n(46),n(53);var base=n(895),r=n(605),o=n(630),l=n(607),object=n(601),c=n(617),h=n(684),d=n(638),f=(n(27),n(609));function y(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}n(9),n(33),n(52);function m(e){return function(e){if(Array.isArray(e))return w(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var O=n(743);function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function R(){return R="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var base=T(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},R.apply(this,arguments)}function T(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=M(object)););return object}function k(e,p){return k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},k(e,p)}function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M(e);if(t){var o=M(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return A(this,n)}}function A(e,t){if(t&&("object"===C(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return x(e)}function x(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function M(e){return M=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},M(e)}function I(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function _(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,H(e,t,"get"))}function N(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,H(e,t,"set"),n),n}function H(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}d.a.getSingleton().register("beforeHideColumns"),d.a.getSingleton().register("afterHideColumns"),d.a.getSingleton().register("beforeUnhideColumns"),d.a.getSingleton().register("afterUnhideColumns");var P="hiddenColumns",D=new WeakMap,L=new WeakMap,B=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k(e,t)}(w,e);var t,n,d,v=j(w);function w(){var e;S(this,w);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return I(x(e=v.call.apply(v,[this].concat(n))),D,{writable:!0,value:{}}),I(x(e),L,{writable:!0,value:null}),e}return t=w,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[P]}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings()[P];Object(object.l)(t)&&(N(this,D,t),Object(c.e)(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),N(this,L,new O.a),_(this,L).addLocalHook("init",(function(){return e.onMapInit()})),this.hot.columnIndexMapper.registerMap(this.pluginName,_(this,L)),this.addHook("afterContextMenuDefaultOptions",(function(){return e.onAfterContextMenuDefaultOptions.apply(e,arguments)})),this.addHook("afterGetCellMeta",(function(t,col,n){return e.onAfterGetCellMeta(t,col,n)})),this.addHook("modifyColWidth",(function(t,col){return e.onModifyColWidth(t,col)})),this.addHook("afterGetColHeader",(function(){return e.onAfterGetColHeader.apply(e,arguments)})),this.addHook("modifyCopyableRange",(function(t){return e.onModifyCopyableRange(t)})),R(M(w.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),R(M(w.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),N(this,D,{}),R(M(w.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(e){var t=this,n=this.getHiddenColumns(),r=this.isValidConfig(e),o=n,c=_(this,L).getValues().slice(),h=e.length>0;if(r&&h){var d=e.map((function(e){return t.hot.toPhysicalColumn(e)}));Object(l.a)(d,(function(e){c[e]=!1})),o=Object(l.d)(c,(function(e,n,r){return n&&e.push(t.hot.toVisualColumn(r)),e}),[])}!1!==this.hot.runHooks("beforeUnhideColumns",n,o,r&&h)&&(r&&h&&_(this,L).setValues(c),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,o,r&&h,r&&o.length<n.length))}},{key:"showColumn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.showColumns(t)}},{key:"hideColumns",value:function(e){var t=this,n=this.getHiddenColumns(),r=this.isValidConfig(e),o=n;r&&(o=Array.from(new Set(n.concat(e)))),!1!==this.hot.runHooks("beforeHideColumns",n,o,r)&&(r&&this.hot.batchExecution((function(){Object(l.a)(e,(function(e){_(t,L).setValueAtIndex(t.hot.toPhysicalColumn(e),!0)}))}),!0),this.hot.runHooks("afterHideColumns",n,o,r,r&&o.length>n.length))}},{key:"hideColumn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.hideColumns(t)}},{key:"getHiddenColumns",value:function(){var e=this;return Object(l.c)(_(this,L).getHiddenIndexes(),(function(t){return e.hot.toVisualColumn(t)}))}},{key:"isHidden",value:function(e){return _(this,L).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}},{key:"isValidConfig",value:function(e){var t=this.hot.countCols();return!!(Array.isArray(e)&&e.length>0)&&e.every((function(e){return Number.isInteger(e)&&e>=0&&e<t}))}},{key:"resetCellsMeta",value:function(){Object(l.a)(this.hot.getCellsMeta(),(function(meta){meta&&(meta.skipColumnOnPaste=!1)}))}},{key:"onModifyColWidth",value:function(e,t){return this.isHidden(t)?0:_(this,D).indicators&&(this.isHidden(t+1)||this.isHidden(t-1))&&"number"==typeof e&&this.hot.hasColHeaders()?e+15:void 0}},{key:"onAfterGetCellMeta",value:function(e,t,n){if(!1===_(this,D).copyPasteEnabled&&this.isHidden(t)&&(n.skipColumnOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenColumn")&&(n.className+=" afterHiddenColumn");else if(n.className){var r=n.className.split(" ");if(r.length>0){var o=r.indexOf("afterHiddenColumn");o>-1&&r.splice(o,1),n.className=r.join(" ")}}}},{key:"onModifyCopyableRange",value:function(e){var t=this;if(_(this,D).copyPasteEnabled)return e;var n=[],r=function(e,t,r,o){n.push({startRow:e,endRow:t,startCol:r,endCol:o})};return Object(l.a)(e,(function(e){var n=!0,l=0;Object(o.c)(e.startCol,e.endCol,(function(o){t.isHidden(o)?(n||r(e.startRow,e.endRow,l,o-1),n=!0):(n&&(l=o),o===e.endCol&&r(e.startRow,e.endRow,l,o),n=!1)}))})),n}},{key:"onAfterGetColHeader",value:function(e,t){if(_(this,D).indicators&&!(e<0)){var n=[];e>=1&&this.isHidden(e-1)&&n.push("afterHiddenColumn"),e<this.hot.countCols()-1&&this.isHidden(e+1)&&n.push("beforeHiddenColumn"),Object(r.a)(t,n)}}},{key:"onAfterContextMenuDefaultOptions",value:function(e){var t;e.items.push({name:h.a},(t=this,{key:"hidden_columns_hide",name:function(){var e=this.getSelectedLast(),t=0;if(Array.isArray(e)){var n=y(e,4);n[1]-n[3]!=0&&(t=1)}return this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_HIDE_COLUMN,t)},callback:function(){for(var e=this.getSelectedRangeLast(),n=e.from,r=e.to,o=Math.max(Math.min(n.col,r.col),0),l=Math.max(n.col,r.col),c=[],h=o;h<=l;h+=1)c.push(h);t.hideColumns(c);var d=c[c.length-1],f=this.columnIndexMapper.getNearestNotHiddenIndex(d,1,!0);Number.isInteger(f)&&f>=0?this.selectColumns(f):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}),function(e){var t=[];return{key:"hidden_columns_show",name:function(){var e=t.length>1?1:0;return this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_SHOW_COLUMN,e)},callback:function(){var n,r;if(0!==t.length){var o=t[0],l=t[t.length-1];o=null!==(n=this.columnIndexMapper.getNearestNotHiddenIndex(o-1,-1))&&void 0!==n?n:0,l=null!==(r=this.columnIndexMapper.getNearestNotHiddenIndex(l+1,1))&&void 0!==r?r:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(!0),l-o+1===this.countCols()||this.selectColumns(o,l)}},disabled:!1,hidden:function(){var n=this,r=Object(l.c)(e.getHiddenColumns(),(function(e){return n.toPhysicalColumn(e)}));if(!this.selection.isSelectedByColumnHeader()&&!this.selection.isSelectedByCorner()||r.length<1)return!0;t.length=0;var o=this.getSelectedRangeLast(),c=o.getTopStartCorner().col,h=o.getBottomEndCorner().col,d=this.columnIndexMapper,f=d.getRenderableFromVisualIndex(c),y=d.getRenderableFromVisualIndex(h),v=d.getNotTrimmedIndexes(),w=[];if(c!==h){if(h-c+1>y-f+1){var O=v.slice(c,h+1);w.push.apply(w,m(O.filter((function(e){return r.includes(e)}))))}}else if(0===f&&f<c)w.push.apply(w,m(v.slice(0,c)));else if(null===f)w.push.apply(w,m(v.slice(0,this.countCols())));else{var C=this.countCols()-1;y===d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(C,-1))&&C>h&&w.push.apply(w,m(v.slice(h+1)))}return Object(l.a)(w,(function(e){t.push(n.toVisualColumn(e))})),0===t.length}}}(this))}},{key:"onMapInit",value:function(){Array.isArray(_(this,D).columns)&&this.hideColumns(_(this,D).columns)}},{key:"destroy",value:function(){N(this,D,null),N(this,L,null),R(M(w.prototype),"destroy",this).call(this)}}],d=[{key:"PLUGIN_KEY",get:function(){return P}},{key:"PLUGIN_PRIORITY",get:function(){return 310}}],n&&E(t.prototype,n),d&&E(t,d),Object.defineProperty(t,"prototype",{writable:!1}),w}(base.a)},1142:function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));n(9),n(4),n(606),n(604),n(110),n(623),n(12),n(7),n(46),n(53),n(212),n(32),n(35);var r=n(890),o=n(638);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(){return d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var base=f(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},d.apply(this,arguments)}function f(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=w(object)););return object}function y(e,p){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},y(e,p)}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=w(e);if(t){var o=w(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return m(this,n)}}function m(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}var O=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(l,e);var t,n,r,o=v(l);function l(){return c(this,l),o.apply(this,arguments)}return t=l,r=[{key:"EDITOR_TYPE",get:function(){return"dropdown"}}],(n=[{key:"prepare",value:function(e,col,t,td,n,r){d(w(l.prototype),"prepare",this).call(this,e,col,t,td,n,r),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}])&&h(t.prototype,n),r&&h(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(r.a);o.a.getSingleton().add("beforeValidate",(function(e,t,col){var n=this.getCellMeta(t,this.propToCol(col));n.editor===O&&void 0===n.strict&&(n.filter=!1,n.strict=!0)}));var C=n(1143),S=n(892),E={CELL_TYPE:"dropdown",editor:O,renderer:C.a,validator:S.a}},1143:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(887),o=n(605);function l(e,t,n,col,l,c,h){r.a.apply(this,[e,t,n,col,l,c,h]),Object(o.f)(t,null==c?"":c,!1)}l.RENDERER_TYPE="html";var c=n(886),h=n(639);function d(e,t,n,col,r,d,f){var y=e.rootDocument,v=f.allowHtml?l:c.a,m=y.createElement("DIV");if(m.className="htAutocompleteArrow",m.appendChild(y.createTextNode(String.fromCharCode(9660))),v.apply(this,[e,t,n,col,r,d,f]),t.firstChild||t.appendChild(y.createTextNode(String.fromCharCode(160))),t.insertBefore(m,t.firstChild),Object(o.a)(t,"htAutocomplete"),!e.acArrowListener){var w=new h.a(e);e.acArrowListener=function(r){Object(o.v)(r.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(n,col),t)},w.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",(function(){w.destroy()}))}}d.RENDERER_TYPE="autocomplete"},601:function(e,t,n){"use strict";n.d(t,"g",(function(){return c})),n.d(t,"k",(function(){return h})),n.d(t,"h",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"c",(function(){return y})),n.d(t,"a",(function(){return v})),n.d(t,"n",(function(){return m})),n.d(t,"m",(function(){return w})),n.d(t,"l",(function(){return O})),n.d(t,"f",(function(){return C})),n.d(t,"o",(function(){return S})),n.d(t,"i",(function(){return E})),n.d(t,"p",(function(){return R})),n.d(t,"e",(function(){return T})),n.d(t,"b",(function(){return k})),n.d(t,"j",(function(){return j}));n(33),n(52),n(4),n(21),n(61),n(10),n(7),n(46),n(53),n(212),n(32),n(35);var r=n(607);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function c(object){var e;return Array.isArray(object)?e=[]:(e={},S(object,(function(t,n){"__children"!==n&&(t&&"object"===l(t)&&!Array.isArray(t)?e[n]=c(t):Array.isArray(t)?t.length&&"object"===l(t[0])&&!Array.isArray(t[0])?e[n]=[c(t[0])]:e[n]=[]:e[n]=null)}))),e}function h(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function d(e,t,n){var r=Array.isArray(n);return S(t,(function(t,o){(!1===r||n.includes(o))&&(e[o]=t)})),e}function f(e,t){S(t,(function(n,r){t[r]&&"object"===l(t[r])?(e[r]||(Array.isArray(t[r])?e[r]=[]:"[object Date]"===Object.prototype.toString.call(t[r])?e[r]=t[r]:e[r]={}),f(e[r],t[r])):e[r]=t[r]}))}function y(e){return"object"===l(e)?JSON.parse(JSON.stringify(e)):e}function v(object){var e={};return S(object,(function(t,n){e[n]=t})),e}function m(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return Object(r.a)(n,(function(t){e.MIXINS.push(t.MIXIN_NAME),S(t,(function(t,n){if(void 0!==e.prototype[n])throw new Error("Mixin conflict. Property '".concat(n,"' already exist and cannot be overwritten."));if("function"==typeof t)e.prototype[n]=t;else{Object.defineProperty(e.prototype,n,{get:(r=n,o=t,l="_".concat(r),function(){var e;return void 0===this[l]&&(this[l]=(e=o,(Array.isArray(e)||O(e))&&(e=y(e)),e)),this[l]}),set:function(e){var t="_".concat(e);return function(e){this[t]=e}}(n),configurable:!0})}var r,o,l}))})),e}function w(e,t){return JSON.stringify(e)===JSON.stringify(t)}function O(object){return"[object Object]"===Object.prototype.toString.call(object)}function C(object,e,t,n){n.value=t,n.writable=!1!==n.writable,n.enumerable=!1!==n.enumerable,n.configurable=!1!==n.configurable,Object.defineProperty(object,e,n)}function S(object,e){for(var t in object)if((!object.hasOwnProperty||object.hasOwnProperty&&Object.prototype.hasOwnProperty.call(object,t))&&!1===e(object[t],t,object))break;return object}function E(object,e){var t=e.split("."),n=object;return S(t,(function(e){if(void 0===(n=n[e]))return n=void 0,!1})),n}function R(object,e,t){var n=e.split("."),r=object;n.forEach((function(e,o){o!==n.length-1?(j(r,e)||(r[e]={}),r=r[e]):r[e]=t}))}function T(object){if(!O(object))return 0;return function e(t){var n=0;return O(t)?S(t,(function(t,r){"__children"!==r&&(n+=e(t))})):n+=1,n}(object)}function k(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value",r="_".concat(n),l=(o(t={_touched:!1},r,e),o(t,"isTouched",(function(){return this._touched})),t);return Object.defineProperty(l,n,{get:function(){return this[r]},set:function(e){this._touched=!0,this[r]=e},enumerable:!0,configurable:!0}),l}function j(object,e){return Object.prototype.hasOwnProperty.call(object,e)}},604:function(e,t,n){var r=n(6),o=n(18),l=n(71),c=n(295),h=n(387);r({target:"Object",stat:!0,forced:o((function(){c(1)})),sham:!h},{getPrototypeOf:function(e){return c(l(e))}})},605:function(e,t,n){"use strict";n.d(t,"j",(function(){return v})),n.d(t,"k",(function(){return m})),n.d(t,"c",(function(){return w})),n.d(t,"d",(function(){return O})),n.d(t,"B",(function(){return C})),n.d(t,"y",(function(){return S})),n.d(t,"J",(function(){return E})),n.d(t,"v",(function(){return j})),n.d(t,"a",(function(){return A})),n.d(t,"K",(function(){return x})),n.d(t,"L",(function(){return M})),n.d(t,"e",(function(){return I})),n.d(t,"f",(function(){return H})),n.d(t,"g",(function(){return P})),n.d(t,"F",(function(){return D})),n.d(t,"G",(function(){return L})),n.d(t,"u",(function(){return B})),n.d(t,"t",(function(){return V})),n.d(t,"m",(function(){return F})),n.d(t,"l",(function(){return W})),n.d(t,"n",(function(){return z})),n.d(t,"s",(function(){return U})),n.d(t,"r",(function(){return G})),n.d(t,"i",(function(){return X})),n.d(t,"I",(function(){return K})),n.d(t,"H",(function(){return Y})),n.d(t,"z",(function(){return $})),n.d(t,"A",(function(){return Q})),n.d(t,"h",(function(){return J})),n.d(t,"p",(function(){return Z})),n.d(t,"q",(function(){return ee})),n.d(t,"b",(function(){return te})),n.d(t,"O",(function(){return ne})),n.d(t,"o",(function(){return oe})),n.d(t,"x",(function(){return ie})),n.d(t,"w",(function(){return ae})),n.d(t,"P",(function(){return le})),n.d(t,"M",(function(){return se})),n.d(t,"D",(function(){return ce})),n.d(t,"E",(function(){return ue})),n.d(t,"N",(function(){return he})),n.d(t,"C",(function(){return de}));n(604),n(33),n(52),n(36),n(622),n(9),n(4),n(21),n(61),n(217),n(70),n(101),n(80),n(65),n(28),n(7),n(46),n(53),n(212),n(32),n(35),n(42),n(27);var r,o,l,c=n(662),h=n(650),d=n(643);function f(e){return function(e){if(Array.isArray(e))return y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function v(element){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=-1,n=null,r=element;null!==r;){if(t===e){n=r;break}r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r=r.host:(t+=1,r=r.parentNode)}return n}function m(e){return function(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}(e)&&e.parent}function w(element){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0,n=Node,r=n.ELEMENT_NODE,o=n.DOCUMENT_FRAGMENT_NODE,l=element;null!=l&&l!==t;){var c=l,h=c.nodeType,d=c.nodeName;if(h===r&&(e.includes(d)||e.includes(l)))return l;var f=l,y=f.host;l=y&&h===o?y:l.parentNode}return null}function O(element,e,t){for(var n=[],r=element;r&&(r=w(r,e,t))&&(!t||t.contains(r));)n.push(r),r=r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r.host:r.parentNode;var o=n.length;return o?n[o-1]:null}function C(e,t){var n=e.parentNode,r=[];for("string"==typeof t?r=e.defaultView?Array.prototype.slice.call(e.querySelectorAll(t),0):Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):r.push(t);null!==n;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function S(element){var i=0,e=element;if(e.previousSibling)for(;e=e.previousSibling;)i+=1;return i}function E(e,element,t){var n=t.parentElement.querySelector(".ht_clone_".concat(e));return n?n.contains(element):null}function R(e){return e&&e.length?e.filter((function(e){return!!e})):[]}if(Object(c.d)()){var T=function(e){var element=e.createElement("div");return element.classList.add("test","test2"),element.classList.contains("test2")};r=function(element,e){return void 0!==element.classList&&"string"==typeof e&&""!==e&&element.classList.contains(e)},o=function(element,e){var t,n=element.ownerDocument,r=e;if("string"==typeof r&&(r=r.split(" ")),(r=R(r)).length>0)if(T(n))(t=element.classList).add.apply(t,f(r));else for(var o=0;r[o];)element.classList.add(r[o]),o+=1},l=function(element,e){var t,n=element.ownerDocument,r=e;if("string"==typeof r&&(r=r.split(" ")),(r=R(r)).length>0)if(T(n))(t=element.classList).remove.apply(t,f(r));else for(var o=0;r[o];)element.classList.remove(r[o]),o+=1}}else{var k=function(e){return new RegExp("(\\s|^)".concat(e,"(\\s|$)"))};r=function(element,e){return void 0!==element.className&&k(e).test(element.className)},o=function(element,e){var t=element.className,n=e;if("string"==typeof n&&(n=n.split(" ")),n=R(n),""===t)t=n.join(" ");else for(var r=0;r<n.length;r++)n[r]&&!k(n[r]).test(t)&&(t+=" ".concat(n[r]));element.className=t},l=function(element,e){var t=0,n=element.className,r=e;for("string"==typeof r&&(r=r.split(" ")),r=R(r);r[t];)n=n.replace(k(r[t])," ").trim(),t+=1;element.className!==n&&(element.className=n)}}function j(element,e){return r(element,e)}function A(element,e){o(element,e)}function x(element,e){l(element,e)}function M(element){if(3===element.nodeType)element.parentNode.removeChild(element);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(element.nodeName)>-1)for(var e=element.childNodes,i=e.length-1;i>=0;i--)M(e[i])}function I(element){for(var e;e=element.lastChild;)element.removeChild(e)}var _,N=/(<(.*)>|&(.*);)/;function H(element,content){var e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];N.test(content)?element.innerHTML=e?Object(d.c)(content):content:P(element,content)}function P(element,content){var e=element.firstChild;e&&3===e.nodeType&&null===e.nextSibling?c.g?e.textContent=content:e.data=content:(I(element),element.appendChild(element.ownerDocument.createTextNode(content)))}function D(element){for(var e=element.ownerDocument.documentElement,t=element;t!==e;){if(null===t)return!1;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(t.host){if(t.host.impl)return D(t.host.impl);if(t.host)return D(t.host);throw new Error("Lost in Web Components world")}return!1}if(t.style&&"none"===t.style.display)return!1;t=t.parentNode}return!0}function L(element){var e,t,n,r,o=element.ownerDocument,l=o.defaultView,h=o.documentElement,d=element;if(Object(c.c)()&&d.firstChild&&"CAPTION"===d.firstChild.nodeName)return{top:(r=d.getBoundingClientRect()).top+(l.pageYOffset||h.scrollTop)-(h.clientTop||0),left:r.left+(l.pageXOffset||h.scrollLeft)-(h.clientLeft||0)};for(e=d.offsetLeft,t=d.offsetTop,n=d;(d=d.offsetParent)&&d!==o.body;)e+=d.offsetLeft,t+=d.offsetTop,n=d;return n&&"fixed"===n.style.position&&(e+=l.pageXOffset||h.scrollLeft,t+=l.pageYOffset||h.scrollTop),{left:e,top:t}}function B(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.scrollY;return void 0===t&&(t=e.document.documentElement.scrollTop),t}function V(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.scrollX;return void 0===t&&(t=e.document.documentElement.scrollLeft),t}function F(element){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return element===e?B(e):element.scrollTop}function W(element){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return element===e?V(e):element.scrollLeft}function z(element){var e=element.ownerDocument,t=e?e.defaultView:void 0;e||(t=(e=element.document?element.document:element).defaultView);for(var n=["auto","scroll"],r=Object(c.e)(),o=element.parentNode;o&&o.style&&e.body!==o;){var l=o.style,h=l.overflow,d=l.overflowX,f=l.overflowY;if([h,d,f].includes("scroll"))return o;if(r){var y=t.getComputedStyle(o);if(h=y.overflow,d=y.overflowX,f=y.overflowY,n.includes(h)||n.includes(d)||n.includes(f))return o}if(o.clientHeight<=o.scrollHeight+1&&(n.includes(f)||n.includes(h)))return o;if(o.clientWidth<=o.scrollWidth+1&&(n.includes(d)||n.includes(h)))return o;o=o.parentNode}return t}function U(base){for(var e=base.ownerDocument,t=e.defaultView,n=base.parentNode;n&&n.style&&e.body!==n;){if("visible"!==n.style.overflow&&""!==n.style.overflow)return n;var r=X(n,t),o=["scroll","hidden","auto"],l=r.getPropertyValue("overflow"),c=r.getPropertyValue("overflow-y"),h=r.getPropertyValue("overflow-x");if(o.includes(l)||o.includes(c)||o.includes(h))return n;n=n.parentNode}return t}function G(element,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(element){if(element===t)return"width"===e?"".concat(t.innerWidth,"px"):"height"===e?"".concat(t.innerHeight,"px"):void 0;var n=element.style[e];if(""!==n&&void 0!==n)return n;var r=X(element,t);return""!==r[e]&&void 0!==r[e]?r[e]:void 0}}function X(element){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return element.currentStyle||e.getComputedStyle(element)}function K(element){return element.offsetWidth}function Y(element){return Object(c.c)()&&element.firstChild&&"CAPTION"===element.firstChild.nodeName?element.offsetHeight+element.firstChild.offsetHeight:element.offsetHeight}function $(element){return element.clientHeight||element.innerHeight}function Q(element){return element.clientWidth||element.innerWidth}function J(e){var t=e.ownerDocument;if(e.selectionStart)return e.selectionStart;if(t.selection){e.focus();var n=t.selection.createRange();if(null===n)return 0;var r=e.createTextRange(),o=r.duplicate();return r.moveToBookmark(n.getBookmark()),o.setEndPoint("EndToStart",r),o.text.length}return 0}function Z(e){var t=e.ownerDocument;if(e.selectionEnd)return e.selectionEnd;if(t.selection){var n=t.selection.createRange();return null===n?0:e.createTextRange().text.indexOf(n.text)+n.text.length}return 0}function ee(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.document,text="";return e.getSelection?text=e.getSelection().toString():t.selection&&"Control"!==t.selection.type&&(text=t.selection.createRange().text),text}function te(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.document;e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():t.selection&&t.selection.empty()}function ne(element,e,t){if(void 0===t&&(t=e),element.setSelectionRange){element.focus();try{element.setSelectionRange(e,t)}catch(o){var n=element.parentNode,r=n.style.display;n.style.display="block",element.setSelectionRange(e,t),n.style.display=r}}}function re(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";var n=e.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(t),(e.body||e.documentElement).appendChild(n);var r=t.offsetWidth;n.style.overflow="scroll";var o=t.offsetWidth;return r===o&&(o=n.clientWidth),(e.body||e.documentElement).removeChild(n),r-o}function oe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===_&&(_=re(e)),_}function ie(element){return element.offsetWidth!==element.clientWidth}function ae(element){return element.offsetHeight!==element.clientHeight}function le(e,t,n){Object(h.g)()?(e.style.top=n,e.style.left=t):Object(h.l)()?e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(n,",0)"):e.style.transform="translate3d(".concat(t,",").concat(n,",0)")}function se(element){element.style.transform&&""!==element.style.transform?element.style.transform="":element.style["-webkit-transform"]&&""!==element.style["-webkit-transform"]&&(element.style["-webkit-transform"]="")}function ce(element){return element&&(["INPUT","SELECT","TEXTAREA"].indexOf(element.nodeName)>-1||"true"===element.contentEditable)}function ue(element){return ce(element)&&!1===element.hasAttribute("data-hot-input")}function he(element){ue(element.ownerDocument.activeElement)||element.select()}function de(element){return!element.parentNode}},606:function(e,t,n){n(6)({target:"Object",stat:!0},{setPrototypeOf:n(224)})},607:function(e,t,n){"use strict";n.d(t,"j",(function(){return r})),n.d(t,"f",(function(){return o})),n.d(t,"h",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return f})),n.d(t,"e",(function(){return y})),n.d(t,"g",(function(){return v})),n.d(t,"i",(function(){return m}));n(42),n(32),n(28),n(622),n(36),n(9),n(4),n(33),n(52),n(212),n(631),n(35),n(21),n(61);function r(e){for(var t=e.length,i=0;i<t;)e[i]=[e[i]],i+=1}function o(e,t){for(var n=t.length,i=0;i<n;)e.push(t[i]),i+=1}function l(e){var t=[];if(!e||0===e.length||!e[0]||0===e[0].length)return t;for(var n=e.length,r=e[0].length,i=0;i<n;i++)for(var o=0;o<r;o++)t[o]||(t[o]=[]),t[o][i]=e[i][o];return t}function c(e,t,n,r){var o=-1,l=e,c=n;Array.isArray(e)||(l=Array.from(e));var h=l.length;for(r&&h&&(c=l[o+=1]),o+=1;o<h;)c=t(c,l[o],o,l),o+=1;return c}function h(e,t){var n=0,r=e;Array.isArray(e)||(r=Array.from(e));for(var o=r.length,l=[],c=-1;n<o;){var h=r[n];t(h,n,r)&&(l[c+=1]=h),n+=1}return l}function d(e,t){var n=0,r=e;Array.isArray(e)||(r=Array.from(e));for(var o=r.length,l=[],c=-1;n<o;){var h=r[n];l[c+=1]=t(h,n,r),n+=1}return l}function f(e,t){var n=0,r=e;Array.isArray(e)||(r=Array.from(e));for(var o=r.length;n<o&&!1!==t(r[n],n,r);)n+=1;return e}function y(e){var t=[];return f(e,(function(e){-1===t.indexOf(e)&&t.push(e)})),t}function v(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=[].concat(t),o=r[0],l=r.slice(1),c=o;return f(l,(function(e){c=c.filter((function(t){return!e.includes(t)}))})),c}function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return e.split(t)}},609:function(e,t,n){"use strict";n.r(t),n.d(t,"CONTEXT_MENU_ITEMS_NAMESPACE",(function(){return r})),n.d(t,"CONTEXTMENU_ITEMS_NO_ITEMS",(function(){return o})),n.d(t,"CONTEXTMENU_ITEMS_ROW_ABOVE",(function(){return l})),n.d(t,"CONTEXTMENU_ITEMS_ROW_BELOW",(function(){return c})),n.d(t,"CONTEXTMENU_ITEMS_INSERT_LEFT",(function(){return h})),n.d(t,"CONTEXTMENU_ITEMS_INSERT_RIGHT",(function(){return d})),n.d(t,"CONTEXTMENU_ITEMS_REMOVE_ROW",(function(){return f})),n.d(t,"CONTEXTMENU_ITEMS_REMOVE_COLUMN",(function(){return y})),n.d(t,"CONTEXTMENU_ITEMS_UNDO",(function(){return v})),n.d(t,"CONTEXTMENU_ITEMS_REDO",(function(){return m})),n.d(t,"CONTEXTMENU_ITEMS_READ_ONLY",(function(){return w})),n.d(t,"CONTEXTMENU_ITEMS_CLEAR_COLUMN",(function(){return O})),n.d(t,"CONTEXTMENU_ITEMS_COPY",(function(){return C})),n.d(t,"CONTEXTMENU_ITEMS_CUT",(function(){return S})),n.d(t,"CONTEXTMENU_ITEMS_FREEZE_COLUMN",(function(){return E})),n.d(t,"CONTEXTMENU_ITEMS_UNFREEZE_COLUMN",(function(){return R})),n.d(t,"CONTEXTMENU_ITEMS_MERGE_CELLS",(function(){return T})),n.d(t,"CONTEXTMENU_ITEMS_UNMERGE_CELLS",(function(){return k})),n.d(t,"CONTEXTMENU_ITEMS_ADD_COMMENT",(function(){return j})),n.d(t,"CONTEXTMENU_ITEMS_EDIT_COMMENT",(function(){return A})),n.d(t,"CONTEXTMENU_ITEMS_REMOVE_COMMENT",(function(){return x})),n.d(t,"CONTEXTMENU_ITEMS_READ_ONLY_COMMENT",(function(){return M})),n.d(t,"CONTEXTMENU_ITEMS_ALIGNMENT",(function(){return I})),n.d(t,"CONTEXTMENU_ITEMS_ALIGNMENT_LEFT",(function(){return _})),n.d(t,"CONTEXTMENU_ITEMS_ALIGNMENT_CENTER",(function(){return N})),n.d(t,"CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT",(function(){return H})),n.d(t,"CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY",(function(){return P})),n.d(t,"CONTEXTMENU_ITEMS_ALIGNMENT_TOP",(function(){return D})),n.d(t,"CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE",(function(){return L})),n.d(t,"CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM",(function(){return B})),n.d(t,"CONTEXTMENU_ITEMS_BORDERS",(function(){return V})),n.d(t,"CONTEXTMENU_ITEMS_BORDERS_TOP",(function(){return F})),n.d(t,"CONTEXTMENU_ITEMS_BORDERS_RIGHT",(function(){return W})),n.d(t,"CONTEXTMENU_ITEMS_BORDERS_BOTTOM",(function(){return z})),n.d(t,"CONTEXTMENU_ITEMS_BORDERS_LEFT",(function(){return U})),n.d(t,"CONTEXTMENU_ITEMS_REMOVE_BORDERS",(function(){return G})),n.d(t,"CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD",(function(){return X})),n.d(t,"CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD",(function(){return K})),n.d(t,"CONTEXTMENU_ITEMS_HIDE_COLUMN",(function(){return Y})),n.d(t,"CONTEXTMENU_ITEMS_SHOW_COLUMN",(function(){return $})),n.d(t,"CONTEXTMENU_ITEMS_HIDE_ROW",(function(){return Q})),n.d(t,"CONTEXTMENU_ITEMS_SHOW_ROW",(function(){return J})),n.d(t,"FILTERS_NAMESPACE",(function(){return Z})),n.d(t,"FILTERS_CONDITIONS_NAMESPACE",(function(){return ee})),n.d(t,"FILTERS_CONDITIONS_NONE",(function(){return te})),n.d(t,"FILTERS_CONDITIONS_EMPTY",(function(){return ne})),n.d(t,"FILTERS_CONDITIONS_NOT_EMPTY",(function(){return re})),n.d(t,"FILTERS_CONDITIONS_EQUAL",(function(){return oe})),n.d(t,"FILTERS_CONDITIONS_NOT_EQUAL",(function(){return ie})),n.d(t,"FILTERS_CONDITIONS_BEGINS_WITH",(function(){return ae})),n.d(t,"FILTERS_CONDITIONS_ENDS_WITH",(function(){return le})),n.d(t,"FILTERS_CONDITIONS_CONTAINS",(function(){return se})),n.d(t,"FILTERS_CONDITIONS_NOT_CONTAIN",(function(){return ce})),n.d(t,"FILTERS_CONDITIONS_BY_VALUE",(function(){return ue})),n.d(t,"FILTERS_CONDITIONS_GREATER_THAN",(function(){return he})),n.d(t,"FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL",(function(){return de})),n.d(t,"FILTERS_CONDITIONS_LESS_THAN",(function(){return fe})),n.d(t,"FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL",(function(){return pe})),n.d(t,"FILTERS_CONDITIONS_BETWEEN",(function(){return be})),n.d(t,"FILTERS_CONDITIONS_NOT_BETWEEN",(function(){return ye})),n.d(t,"FILTERS_CONDITIONS_AFTER",(function(){return ge})),n.d(t,"FILTERS_CONDITIONS_BEFORE",(function(){return ve})),n.d(t,"FILTERS_CONDITIONS_TODAY",(function(){return me})),n.d(t,"FILTERS_CONDITIONS_TOMORROW",(function(){return we})),n.d(t,"FILTERS_CONDITIONS_YESTERDAY",(function(){return Oe})),n.d(t,"FILTERS_DIVS_FILTER_BY_CONDITION",(function(){return Ce})),n.d(t,"FILTERS_DIVS_FILTER_BY_VALUE",(function(){return Se})),n.d(t,"FILTERS_LABELS_CONJUNCTION",(function(){return Ee})),n.d(t,"FILTERS_LABELS_DISJUNCTION",(function(){return Re})),n.d(t,"FILTERS_VALUES_BLANK_CELLS",(function(){return Te})),n.d(t,"FILTERS_BUTTONS_SELECT_ALL",(function(){return ke})),n.d(t,"FILTERS_BUTTONS_CLEAR",(function(){return je})),n.d(t,"FILTERS_BUTTONS_OK",(function(){return Ae})),n.d(t,"FILTERS_BUTTONS_CANCEL",(function(){return xe})),n.d(t,"FILTERS_BUTTONS_PLACEHOLDER_SEARCH",(function(){return Me})),n.d(t,"FILTERS_BUTTONS_PLACEHOLDER_VALUE",(function(){return Ie})),n.d(t,"FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE",(function(){return _e}));var r="ContextMenu:items",o="".concat(r,".noItems"),l="".concat(r,".insertRowAbove"),c="".concat(r,".insertRowBelow"),h="".concat(r,".insertColumnOnTheLeft"),d="".concat(r,".insertColumnOnTheRight"),f="".concat(r,".removeRow"),y="".concat(r,".removeColumn"),v="".concat(r,".undo"),m="".concat(r,".redo"),w="".concat(r,".readOnly"),O="".concat(r,".clearColumn"),C="".concat(r,".copy"),S="".concat(r,".cut"),E="".concat(r,".freezeColumn"),R="".concat(r,".unfreezeColumn"),T="".concat(r,".mergeCells"),k="".concat(r,".unmergeCells"),j="".concat(r,".addComment"),A="".concat(r,".editComment"),x="".concat(r,".removeComment"),M="".concat(r,".readOnlyComment"),I="".concat(r,".align"),_="".concat(r,".align.left"),N="".concat(r,".align.center"),H="".concat(r,".align.right"),P="".concat(r,".align.justify"),D="".concat(r,".align.top"),L="".concat(r,".align.middle"),B="".concat(r,".align.bottom"),V="".concat(r,".borders"),F="".concat(r,".borders.top"),W="".concat(r,".borders.right"),z="".concat(r,".borders.bottom"),U="".concat(r,".borders.left"),G="".concat(r,".borders.remove"),X="".concat(r,".nestedHeaders.insertChildRow"),K="".concat(r,".nestedHeaders.detachFromParent"),Y="".concat(r,".hideColumn"),$="".concat(r,".showColumn"),Q="".concat(r,".hideRow"),J="".concat(r,".showRow"),Z="Filters:",ee="".concat(Z,"conditions"),te="".concat(ee,".none"),ne="".concat(ee,".isEmpty"),re="".concat(ee,".isNotEmpty"),oe="".concat(ee,".isEqualTo"),ie="".concat(ee,".isNotEqualTo"),ae="".concat(ee,".beginsWith"),le="".concat(ee,".endsWith"),se="".concat(ee,".contains"),ce="".concat(ee,".doesNotContain"),ue="".concat(ee,".byValue"),he="".concat(ee,".greaterThan"),de="".concat(ee,".greaterThanOrEqualTo"),fe="".concat(ee,".lessThan"),pe="".concat(ee,".lessThanOrEqualTo"),be="".concat(ee,".isBetween"),ye="".concat(ee,".isNotBetween"),ge="".concat(ee,".after"),ve="".concat(ee,".before"),me="".concat(ee,".today"),we="".concat(ee,".tomorrow"),Oe="".concat(ee,".yesterday"),Ce="".concat(Z,"labels.filterByCondition"),Se="".concat(Z,"labels.filterByValue"),Ee="".concat(Z,"labels.conjunction"),Re="".concat(Z,"labels.disjunction"),Te="".concat(Z,"values.blankCells"),ke="".concat(Z,"buttons.selectAll"),je="".concat(Z,"buttons.clear"),Ae="".concat(Z,"buttons.ok"),xe="".concat(Z,"buttons.cancel"),Me="".concat(Z,"buttons.placeholder.search"),Ie="".concat(Z,"buttons.placeholder.value"),_e="".concat(Z,"buttons.placeholder.secondValue")},617:function(e,t,n){"use strict";n.d(t,"f",(function(){return w})),n.d(t,"b",(function(){return O})),n.d(t,"e",(function(){return C})),n.d(t,"c",(function(){return S})),n.d(t,"d",(function(){return E})),n.d(t,"a",(function(){return N}));n(36),n(290),n(4),n(70),n(808),n(21),n(65),n(61),n(384),n(7),n(46),n(53),n(212),n(32),n(35);var r,o,l,c,h,d,f=n(218),y=n(649);function v(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function w(e){var t;switch(m(e)){case"string":case"number":t="".concat(e);break;case"object":t=null===e?"":e.toString();break;case"undefined":t="";break;default:t=e.toString()}return t}function O(e){return void 0!==e}function C(e){return void 0===e}function S(e){return null===e||""===e||C(e)}function E(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var R="length",T=function(e){return parseInt(e,16)},k=function(e){return parseInt(e,10)},j=function(e,s,t){return e.substr(s,t)},A=function(e){return e.codePointAt(0)-65},x=function(e){return"".concat(e).replace(/\-/g,"")},M=!1,I={invalid:function(){return Object(y.a)(r||(r=v(["\n    The license key for Handsontable is invalid. \n    If you need any help, contact us at support@handsontable.com."],["\n    The license key for Handsontable is invalid.\\x20\n    If you need any help, contact us at support@handsontable.com."])))},expired:function(e){var t=e.keyValidityDate,n=e.hotVersion;return Object(y.a)(o||(o=v(["\n    The license key for Handsontable expired on ",", and is not valid for the installed \n    version ",". Renew your license key at handsontable.com or downgrade to a version released prior \n    to ",". If you need any help, contact us at sales@handsontable.com."],["\n    The license key for Handsontable expired on ",", and is not valid for the installed\\x20\n    version ",". Renew your license key at handsontable.com or downgrade to a version released prior\\x20\n    to ",". If you need any help, contact us at sales@handsontable.com."])),t,n,t)},missing:function(){return Object(y.a)(l||(l=v(["\n    The license key for Handsontable is missing. Use your purchased key to activate the product. \n    Alternatively, you can activate Handsontable to use for non-commercial purposes by \n    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact \n    us at support@handsontable.com."],["\n    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20\n    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20\n    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20\n    us at support@handsontable.com."])))},non_commercial:function(){return""}},_={invalid:function(){return Object(y.a)(c||(c=v(['\n    The license key for Handsontable is invalid. \n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to \n    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'],['\n    The license key for Handsontable is invalid.\\x20\n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20\n    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'])))},expired:function(e){var t=e.keyValidityDate,n=e.hotVersion;return Object(y.a)(h||(h=v(["\n    The license key for Handsontable expired on ",", and is not valid for the installed \n    version ",'. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your \n    license key or downgrade to a version released prior to ','. If you need any \n    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.'],["\n    The license key for Handsontable expired on ",", and is not valid for the installed\\x20\n    version ",'. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20\n    license key or downgrade to a version released prior to ','. If you need any\\x20\n    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.'])),t,n,t)},missing:function(){return Object(y.a)(d||(d=v(['\n    The license key for Handsontable is missing. Use your purchased key to activate the product. \n    Alternatively, you can activate Handsontable to use for non-commercial purposes by \n    passing the key: \'non-commercial-and-evaluation\'. \n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in \n    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'],['\n    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20\n    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20\n    passing the key: \'non-commercial-and-evaluation\'.\\x20\n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20\n    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'])))},non_commercial:function(){return""}};function N(e,element){var t,n,r=!S(e),o="string"==typeof e&&"non-commercial-and-evaluation"===e.toLowerCase(),l="12.1.2",c="invalid",h="invalid",d=function(e){var t=[][R],p=t;if(e[R]!==A("Z"))return!1;for(var n="",i="B<H4P+".split(""),r=A(i.shift());r;r=A(i.shift()||"A"))--r<""[R]?p|=(k("".concat(k(T(n)+(T(j(e,Math.abs(r),2))+[]).padStart(2,"0"))))%97||2)>>1:n=j(e,r,r?1===i[R]?9:8:6);return p===t}(e=x(e||""));if(r||o||d)if(d){var y=f("08/07/2022","DD/MM/YYYY"),v=Math.floor(y.toDate().getTime()/864e5),m=T(j(x(n=e),T("12"),A("F")))/(T(j(x(n),A("B"),~~![][R]))||9);if(t=f(864e5*(m+1),"x").format("MMMM DD, YYYY"),v>m){var w=f().diff(y,"days");c=w<=1?"valid":"expired",h=w<=15?"valid":"expired"}else c="valid",h="valid"}else o?(c="non_commercial",h="valid"):(c="invalid",h="invalid");else c="missing",h="missing";("undefined"!=typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)&&(c="valid",h="valid"),M||"valid"===c)||(I[c]({keyValidityDate:t,hotVersion:l})&&console["non_commercial"===c?"info":"warn"](I[c]({keyValidityDate:t,hotVersion:l})),M=!0);if("valid"!==h&&element.parentNode&&_[h]({keyValidityDate:t,hotVersion:l})){var O=document.createElement("div");O.id="hot-display-license-info",O.innerHTML=_[h]({keyValidityDate:t,hotVersion:l}),element.parentNode.insertBefore(O,element.nextSibling)}}},622:function(e,t,n){"use strict";var r=n(6),o=n(19),l=n(300).indexOf,c=n(220),h=o([].indexOf),d=!!h&&1/h([1],1,-0)<0,f=c("indexOf");r({target:"Array",proto:!0,forced:d||!f},{indexOf:function(e){var t=arguments.length>1?arguments[1]:void 0;return d?h(this,e,t)||0:l(this,e,t)}})},623:function(e,t,n){var r=n(6),o=n(29),l=n(37),c=n(23),h=n(810),d=n(93),f=n(295);r({target:"Reflect",stat:!0},{get:function e(t,n){var r,y,v=arguments.length<3?t:arguments[2];return c(t)===v?t[n]:(r=d.f(t,n))?h(r)?r.value:void 0===r.get?void 0:o(r.get,v):l(y=f(t))?e(y,n,v):void 0}})},626:function(e,t,n){n(807)},630:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"e",(function(){return y}));n(21),n(101),n(60),n(42),n(32),n(212),n(4),n(631),n(35),n(28),n(217),n(70),n(80),n(65),n(7),n(46),n(53),n(36),n(27);function r(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=l(e);if("number"===n)return!isNaN(e)&&isFinite(e);if("string"===n){if(0===e.length)return!1;if(1===e.length)return/\d/.test(e);var o=Array.from(new Set(["."].concat(r(t)))).map((function(e){return"\\".concat(e)})).join("|");return new RegExp("^[+-]?\\s*(((".concat(o,")?\\d+((").concat(o,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(e.trim())}return"object"===n&&!(!e||"number"!=typeof e.valueOf()||e instanceof Date)}function h(e){return c(e,[","])}function d(e,t,n){var r=-1;for("function"==typeof t?(n=t,t=e):r=e-1;++r<=t&&!1!==n(r););}function f(e,t,n){var r=e+1;for("function"==typeof t&&(n=t,t=0);--r>=t&&!1!==n(r););}function y(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}},631:function(e,t,n){n(710)},636:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"a",(function(){return h})),n.d(t,"c",(function(){return d}));n(59),n(36),n(28),n(690),n(607);var r=n(617);function o(e){return"function"==typeof e}function l(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=null;function o(){for(var o=this,l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];return r&&clearTimeout(r),r=setTimeout((function(){t=e.apply(o,c)}),n),t}return o}function c(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return e.apply(this,n.concat(r))}}function h(e){var t=e.length;return function n(r){return function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];var h=r.concat(l);return h.length>=t?e.apply(this,h):n(h)}}([])}function d(e,t,n,o,l,c,h,d){return Object(r.b)(d)?e.call(t,n,o,l,c,h,d):Object(r.b)(h)?e.call(t,n,o,l,c,h):Object(r.b)(c)?e.call(t,n,o,l,c):Object(r.b)(l)?e.call(t,n,o,l):Object(r.b)(o)?e.call(t,n,o):Object(r.b)(n)?e.call(t,n):e.call(t)}},638:function(e,t,n){"use strict";n(36),n(290),n(212),n(269),n(4),n(32),n(35),n(622),n(214);var r,o=n(607),l=n(601),c=n(643),h=n(678),d=n(649),f=n(636);function y(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var v,m,w=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],O=Object(d.a)(r||(v=['The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. \n  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to \n  learn about the migration path.'],(m=['The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20\n  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20\n  learn about the migration path.'])||(m=v.slice(0)),r=Object.freeze(Object.defineProperties(v,{raw:{value:Object.freeze(m)}})))),C=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),S=new Map([["beforeAutofillInsidePopulate",'The plugin hook "beforeAutofillInsidePopulate" is deprecated and will be removed in the next major release.']]),E=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.globalBucket=this.createEmptyBucket()}var t,n,r;return t=e,n=[{key:"createEmptyBucket",value:function(){var e=Object.create(null);return Object(o.a)(w,(function(t){return e[t]=[]})),e}},{key:"getBucket",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}},{key:"add",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(t))Object(o.a)(t,(function(t){return n.add(e,t,r)}));else{C.has(e)&&Object(h.b)(Object(c.e)(O,{hookName:e,removedInVersion:C.get(e)})),S.has(e)&&Object(h.b)(S.get(e));var l=this.getBucket(r);if(void 0===l[e]&&(this.register(e),l[e]=[]),t.skip=!1,-1===l[e].indexOf(t)){var d=!1;t.initialHook&&Object(o.a)(l[e],(function(n,i){if(n.initialHook)return l[e][i]=t,d=!0,!1})),d||l[e].push(t)}}return this}},{key:"once",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(t)?Object(o.a)(t,(function(t){return n.once(e,t,r)})):(t.runOnce=!0,this.add(e,t,r))}},{key:"remove",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.getBucket(n);return void 0!==r[e]&&r[e].indexOf(t)>=0&&(t.skip=!0,!0)}},{key:"has",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getBucket(t);return!(void 0===n[e]||!n[e].length)}},{key:"run",value:function(e,t,n,r,o,l,c,h){var d=this.globalBucket[t],y=d?d.length:0,v=0;if(y)for(;v<y;)if(d[v]&&!d[v].skip){var m=Object(f.c)(d[v],e,n,r,o,l,c,h);void 0!==m&&(n=m),d[v]&&d[v].runOnce&&this.remove(t,d[v]),v+=1}else v+=1;var w=this.getBucket(e)[t],O=w?w.length:0,C=0;if(O)for(;C<O;)if(w[C]&&!w[C].skip){var S=Object(f.c)(w[C],e,n,r,o,l,c,h);void 0!==S&&(n=S),w[C]&&w[C].runOnce&&this.remove(t,w[C],e),C+=1}else C+=1;return n}},{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Object(l.o)(this.getBucket(e),(function(e,t,n){return n[t].length=0}))}},{key:"register",value:function(e){this.isRegistered(e)||w.push(e)}},{key:"deregister",value:function(e){this.isRegistered(e)&&w.splice(w.indexOf(e),1)}},{key:"isDeprecated",value:function(e){return S.has(e)||C.has(e)}},{key:"isRegistered",value:function(e){return w.indexOf(e)>=0}},{key:"getRegistered",value:function(){return w}}],r=[{key:"getSingleton",value:function(){return R}}],n&&y(t.prototype,n),r&&y(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),R=new E;t.a=E},639:function(e,t,n){"use strict";n(214);var r=n(662),o=n(645);function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;l(this,e),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}var t,n,o;return t=e,n=[{key:"addEventListener",value:function(element,e,t){var n=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function l(e){t.call(this,d(e))}return"boolean"==typeof o||Object(r.f)()||(o=!1),this.context.eventListeners.push({element:element,event:e,callback:t,callbackProxy:l,options:o,eventManager:this}),element.addEventListener(e,l,o),1,function(){n.removeEventListener(element,e,t)}}},{key:"removeEventListener",value:function(element,e,t){for(var n,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.context.eventListeners.length;o;)if(o-=1,(n=this.context.eventListeners[o]).event===e&&n.element===element){if(t&&t!==n.callback)continue;if(r&&n.eventManager!==this)continue;this.context.eventListeners.splice(o,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),1}}},{key:"clearEvents",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.context)for(var t=this.context.eventListeners.length;t;){t-=1;var n=this.context.eventListeners[t];e&&n.eventManager!==this||(this.context.eventListeners.splice(t,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),1)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(element,e){var t=element.document,n=element;t||(n=(t=element.ownerDocument?element.ownerDocument:element).defaultView);var r,o={bubbles:!0,cancelable:"mousemove"!==e,view:n,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};t.createEvent?(r=t.createEvent("MouseEvents")).initMouseEvent(e,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,o.relatedTarget||t.body.parentNode):r=t.createEventObject(),element.dispatchEvent?element.dispatchEvent(r):element.fireEvent("on".concat(e),r)}}],n&&c(t.prototype,n),o&&c(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function d(e){var t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),Object(o.d)(this)},e}t.a=h},642:function(e,t,n){"use strict";var r=n(601),o=n(636),l={_localHooks:Object.create(null),addLocalHook:function(e,t){return this._localHooks[e]||(this._localHooks[e]=[]),this._localHooks[e].push(t),this},runLocalHooks:function(e,t,n,r,l,c,h){if(this._localHooks[e])for(var d=this._localHooks[e].length,i=0;i<d;i++)Object(o.c)(this._localHooks[e][i],this,t,n,r,l,c,h)},clearLocalHooks:function(){return this._localHooks={},this}};Object(r.f)(l,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1}),t.a=l},643:function(e,t,n){"use strict";n.d(t,"f",(function(){return o})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return c})),n.d(t,"e",(function(){return h})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return f}));n(622),n(4),n(70),n(21),n(65);var r=n(809);n(617);function o(e){return e[0].toUpperCase()+e.substr(1)}function l(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}function c(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function h(template){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"".concat(template).replace(/(?:\\)?\[([^[\]]+)]/g,(function(t,n){return"\\"===t.charAt(0)?t.substr(1,t.length-1):void 0===e[n]?"":e[n]}))}function d(e){return f("".concat(e),{ALLOWED_TAGS:[]})}function f(e,t){return r.sanitize(e,t)}},645:function(e,t,n){"use strict";function r(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function o(e){return!1===e.isImmediatePropagationEnabled}function l(e){return 2===e.button}function c(e){return 0===e.button}n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return c}))},649:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n(21),n(65),n(80);var r=n(607);function o(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];var l=Object(r.d)(e,(function(e,t,r){return e+t.replace(/\r?\n\s*/g,"")+(n[r]?n[r]:"")}),"");return l.trim()}},650:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"e",(function(){return y})),n.d(t,"l",(function(){return v})),n.d(t,"c",(function(){return m})),n.d(t,"f",(function(){return w})),n.d(t,"g",(function(){return O})),n.d(t,"k",(function(){return C})),n.d(t,"h",(function(){return S})),n.d(t,"i",(function(){return E})),n.d(t,"m",(function(){return R})),n.d(t,"j",(function(){return T}));n(21);var r=n(601),o=function(e){var t={value:!1,test:function(n,r){t.value=e(n,r)}};return t},l={chrome:o((function(e,t){return/Chrome/.test(e)&&/Google/.test(t)})),chromeWebKit:o((function(e){return/CriOS/.test(e)})),edge:o((function(e){return/Edge/.test(e)})),edgeWebKit:o((function(e){return/EdgiOS/.test(e)})),firefox:o((function(e){return/Firefox/.test(e)})),firefoxWebKit:o((function(e){return/FxiOS/.test(e)})),ie:o((function(e){return/Trident/.test(e)})),ie9:o((function(){return!!document.documentMode})),mobile:o((function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)})),safari:o((function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)}))},c={mac:o((function(e){return/^Mac/.test(e)})),win:o((function(e){return/^Win/.test(e)})),linux:o((function(e){return/^Linux/.test(e)})),ios:o((function(e){return/iPhone|iPad|iPod/i.test(e)}))};function h(){return l.chrome.value}function d(){return l.chromeWebKit.value}function f(){return l.firefox.value}function y(){return l.firefoxWebKit.value}function v(){return l.safari.value}function m(){return l.edge.value}function w(){return l.ie.value}function O(){return l.ie9.value}function C(){return l.mobile.value}function S(){return c.ios.value}function E(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator,t=e.maxTouchPoints;return t>2&&c.mac.value}function R(){return c.win.value}function T(){return c.mac.value}!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.userAgent,n=void 0===t?navigator.userAgent:t,o=e.vendor,c=void 0===o?navigator.vendor:o;Object(r.o)(l,(function(e){(0,e.test)(n,c)}))}(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.platform,n=void 0===t?navigator.platform:t;Object(r.o)(c,(function(e){(0,e.test)(n)}))}()},651:function(e,t,n){"use strict";n.d(t,"l",(function(){return c})),n.d(t,"j",(function(){return h})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return f})),n.d(t,"i",(function(){return y})),n.d(t,"e",(function(){return v})),n.d(t,"d",(function(){return m})),n.d(t,"a",(function(){return w})),n.d(t,"b",(function(){return O})),n.d(t,"k",(function(){return C})),n.d(t,"h",(function(){return S})),n.d(t,"c",(function(){return k}));n(622),n(21),n(65),n(28),n(36),n(27),n(690);var r=n(607),o=n(605),l=n(684);function c(e){return Object(r.c)(e,(function(e){return{start:e.getTopStartCorner(),end:e.getBottomEndCorner()}}))}function h(e){return Object(o.v)(e,"htSeparator")}function d(e){return Object(o.v)(e,"htSubmenu")}function f(e){return Object(o.v)(e,"htDisabled")}function y(e){return Object(o.v)(e,"htSelectionDisabled")}function v(e){var t=e.getSelected();return t?t[0]<0?null:t:null}function m(e,t){var n={};return Object(r.a)(e,(function(e){e.forAll((function(e,col){e>=0&&col>=0&&(n[e]||(n[e]=[]),n[e][col]=t(e,col))}))})),n}function w(e,t,n,o,l){Object(r.a)(e,(function(e){e.forAll((function(e,col){e>=0&&col>=0&&function(e,col,t,n,r,o){var l=r(e,col),c=n;l.className&&(c="vertical"===t?function(e,t){if(-1!==e.indexOf(t))return e;var n=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(n," ").concat(t)}(l.className,n):function(e,t){if(-1!==e.indexOf(t))return e;var n=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(n," ").concat(t)}(l.className,n));o(e,col,"className",c)}(e,col,t,n,o,l)}))}))}function O(e,t){var n=!1;return Array.isArray(e)&&Object(r.a)(e,(function(e){return e.forAll((function(e,col){if(e>=0&&col>=0&&t(e,col))return n=!0,!1})),n})),n}function C(label){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(label)}function S(e,t){return!e.hidden||!("function"==typeof e.hidden&&e.hidden.call(t))}function E(e,t){for(var n=e.slice(0);0<n.length&&n[0].name===t;)n.shift();return n}function R(e,t){var n=e.slice(0);return n.reverse(),(n=E(n,t)).reverse(),n}function T(e){var t=[];return Object(r.a)(e,(function(e,n){n>0?t[t.length-1].name!==e.name&&t.push(e):t.push(e)})),t}function k(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.a,n=e.slice(0);return n=T(n=R(n=E(n,t),t))}},654:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return P}));var r=n(869),o=n(3);function l(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function c(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(t){v(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y(e,t,n){return t&&f(e.prototype,t),n&&f(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O(e,t)}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}function O(e,p){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},O(e,p)}function C(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return C(e)}function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=w(e);if(t){var o=w(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return S(this,n)}}var R=Symbol("unassigned"),T=null;function k(source){var e=r.a.hooks.getRegistered(),t={};for(var n in Object.assign(t,r.a.DefaultSettings),t)t[n]={default:R};for(var i=0;i<e.length;i++)t[e[i]]={default:R};return t.settings={default:R},"HotTable"===source&&(t.id={type:String,default:"hot-"+Math.random().toString(36).substring(5)},t.wrapperRendererCacheSize={type:Number,default:3e3}),t}function j(e){var t={},n=e.settings;if(n!==R)for(var r in n)n.hasOwnProperty(r)&&n[r]!==R&&(t[r]=n[r]);for(var o in e)e.hasOwnProperty(o)&&"settings"!==o&&e[o]!==R&&(t[o]=e[o]);return t}function A(e,t){var n=j(e),r=e.settings?e.settings:n,o=e.settings?n:null,l={};for(var c in r)!r.hasOwnProperty(c)||void 0===r[c]||t&&"data"!==c&&I(t[c],r[c])||(l[c]=r[c]);for(var h in o)!o.hasOwnProperty(h)||"id"===h||"settings"===h||"wrapperRendererCacheSize"===h||void 0===o[h]||t&&"data"!==h&&I(t[h],o[h])||(l[h]=o[h]);return l}function x(e,t){var n=null;return e.every((function(slot,e){return!slot.data||!slot.data.attrs||void 0===slot.data.attrs[t]||(n=slot,!1)})),n}function M(e,t,n,data){var r=t.$el?t.$el.ownerDocument:document,o={propsData:n,parent:t,data:data};T||((T=r.createElement("DIV")).id="vueHotComponents",r.body.appendChild(T));var l=r.createElement("DIV");return T.appendChild(l),new e.componentOptions.Ctor(o).$mount(l)}function I(e,t){return JSON.stringify(e)===JSON.stringify(t)}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e||"undefined"!=typeof self&&self;var _=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e,t){!function(e){var t=Symbol("newer"),n=Symbol("older");function r(e,t){"number"!=typeof e&&(t=e,e=0),this.size=0,this.limit=e,this.oldest=this.newest=void 0,this._keymap=new Map,t&&(this.assign(t),e<1&&(this.limit=this.size))}function o(e,r){this.key=e,this.value=r,this[t]=void 0,this[n]=void 0}e.LRUMap=r,r.prototype._markEntryAsUsed=function(e){e!==this.newest&&(e[t]&&(e===this.oldest&&(this.oldest=e[t]),e[t][n]=e[n]),e[n]&&(e[n][t]=e[t]),e[t]=void 0,e[n]=this.newest,this.newest&&(this.newest[t]=e),this.newest=e)},r.prototype.assign=function(e){var r,l=this.limit||Number.MAX_VALUE;this._keymap.clear();for(var c=e[Symbol.iterator](),h=c.next();!h.done;h=c.next()){var d=new o(h.value[0],h.value[1]);if(this._keymap.set(d.key,d),r?(r[t]=d,d[n]=r):this.oldest=d,r=d,0==l--)throw new Error("overflow")}this.newest=r,this.size=this._keymap.size},r.prototype.get=function(e){var t=this._keymap.get(e);if(t)return this._markEntryAsUsed(t),t.value},r.prototype.set=function(e,r){var l=this._keymap.get(e);return l?(l.value=r,this._markEntryAsUsed(l),this):(this._keymap.set(e,l=new o(e,r)),this.newest?(this.newest[t]=l,l[n]=this.newest):this.oldest=l,this.newest=l,++this.size,this.size>this.limit&&this.shift(),this)},r.prototype.shift=function(){var e=this.oldest;if(e)return this.oldest[t]?(this.oldest=this.oldest[t],this.oldest[n]=void 0):(this.oldest=void 0,this.newest=void 0),e[t]=e[n]=void 0,this._keymap.delete(e.key),--this.size,[e.key,e.value]},r.prototype.has=function(e){return this._keymap.has(e)}}(t)})),N=_.LRUMap;function H(template,style,script,e,t,n,r,o,l,c){"boolean"!=typeof r&&(l=o,o=r,r=!1);const h="function"==typeof script?script.options:script;let d;if(template&&template.render&&(h.render=template.render,h.staticRenderFns=template.staticRenderFns,h._compiled=!0,t&&(h.functional=!0)),e&&(h._scopeId=e),n?(d=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),style&&style.call(this,l(e)),e&&e._registeredComponents&&e._registeredComponents.add(n)},h._ssrRegister=d):style&&(d=r?function(e){style.call(this,c(e,this.$root.$options.shadowRoot))}:function(e){style.call(this,o(e))}),d)if(h.functional){const e=h.render;h.render=function(t,n){return d.call(n),e(t,n)}}else{const e=h.beforeCreate;h.beforeCreate=e?[].concat(e,d):[d]}return script}var P=H({render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{attrs:{id:e.id}},[e._t("default")],2)},staticRenderFns:[]},undefined,{name:"HotTable",props:k("HotTable"),watch:{mergedHotSettings:function(e){this.hotInstance&&void 0!==e&&(e.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete e.data),Object.keys(e).length?this.hotInstance.updateSettings(e):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())}},data:function(){var e=this,t=new N(this.wrapperRendererCacheSize);return t.shift=function(){var e=N.prototype.shift.call(this);return e[1].component.$destroy(),e},{__internalEdit:!1,miscCache:{currentSourceColumns:null},__hotInstance:null,columnSettings:null,rendererCache:t,editorCache:new Map,get hotInstance(){return!e.__hotInstance||e.__hotInstance&&!e.__hotInstance.isDestroyed?e.__hotInstance:(console.warn("The Handsontable instance bound to this component was destroyed and cannot be used properly."),null)},set hotInstance(t){e.__hotInstance=t}}},computed:{mergedHotSettings:function(){return A(this.$props,this.hotInstance?this.hotInstance.getSettings():void 0)}},methods:{hotInit:function(){var component,e=this.getGlobalRendererVNode(),t=this.getGlobalEditorVNode(),n=A(this.$props);n.columns=this.columnSettings?this.columnSettings:n.columns,t&&(n.editor=this.getEditorClass(t,this),t.child.$destroy()),e&&(n.renderer=this.getRendererWrapper(e,this),e.child.$destroy()),this.hotInstance=new r.a.Core(this.$el,n),this.hotInstance.init(),(component=this).hotInstance&&(component.hotInstance.addHook("beforeChange",(function(){component.__internalEdit=!0})),component.hotInstance.addHook("beforeCreateRow",(function(){component.__internalEdit=!0})),component.hotInstance.addHook("beforeCreateCol",(function(){component.__internalEdit=!0})),component.hotInstance.addHook("beforeRemoveRow",(function(){component.__internalEdit=!0})),component.hotInstance.addHook("beforeRemoveCol",(function(){component.__internalEdit=!0}))),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var e=this;if(this.hotInstance){var t,data=this.hotInstance.getSourceData(),n=[],r=[],o=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),l=this.hotInstance.isColumnModificationAllowed(),c=0;if(data&&data.length!==o&&data.length<o)for(var h=data.length;h<o;h++)n.push(h);if(l)if(c=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),data&&data[0]&&(null===(t=data[0])||void 0===t?void 0:t.length)!==c&&data[0].length<c)for(var d=data[0].length;d<c;d++)r.push(d);this.hotInstance.batch((function(){n.length>0?e.hotInstance.rowIndexMapper.removeIndexes(n):e.hotInstance.rowIndexMapper.insertIndexes(o-1,data.length-o),l&&0!==data.length&&(r.length>0?e.hotInstance.columnIndexMapper.removeIndexes(r):e.hotInstance.columnIndexMapper.insertIndexes(c-1,data[0].length-c))}))}},getGlobalRendererVNode:function(){return x(this.$slots.default||[],"hot-renderer")},getGlobalEditorVNode:function(){return x(this.$slots.default||[],"hot-editor")},getColumnSettings:function(){var e=this.$children.filter((function(e){return"HotColumn"===e.$options.name})),t=!1,n=e.map((function(e){return e.usesRendererComponent&&(t=!0),c({},e.columnSettings)}));return t&&this.settings&&(!1!==this.settings.autoColumnSize||this.settings.autoRowSize)&&(!1!==this.autoColumnSize||this.autoRowSize)&&console.warn("Your `hot-table` configuration includes both `hot-column` and `autoRowSize`/`autoColumnSize`, which are not compatible with each other in this version of `@handsontable/vue`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment."),n.length?n:void 0},getRendererWrapper:function(e,t){var n=this;return function(r,o,l,col,c,h,d){if(o&&!o.getAttribute("ghost-table")){var f=n.rendererCache,y={hotInstance:r,TD:o,row:l,col:col,prop:c,value:h,cellProperties:d,isRenderer:!0};if(f&&!f.has("".concat(l,"-").concat(col))){var v=M(e,t,e.componentOptions.propsData,y);f.set("".concat(l,"-").concat(col),{component:v,lastUsedTD:null})}var m=f.get("".concat(l,"-").concat(col)),w=m.component,O=m.lastUsedTD;if(Object.assign(w.$data,y),!w.$el.parentElement||O!==o){for(;o.firstChild;)o.removeChild(o.firstChild);o.appendChild(w.$el),m.lastUsedTD=o}}return o}},getEditorClass:function(e,t){var n=e.key?e.key.toString():null,r=e.componentOptions.Ctor.options.name,o=n?"".concat(r,":").concat(n):r,l=this.editorCache,c=null;return l.has(o)?c=l.get(o):(c=M(e,t,e.componentOptions.propsData,{isEditor:!0}),l.set(o,c)),c.$data.hotCustomEditorClass}},mounted:function(){return this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeDestroy:function(){this.hotInstance&&this.hotInstance.destroy()},version:"12.1.0"},undefined,false,undefined,!1,void 0,void 0,void 0);k("HotColumn");function D(e){return D="function"==typeof Symbol&&"symbol"===h(Symbol.iterator)?function(e){return h(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":h(e)},D(e)}function L(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function B(e){return function(e){if(Array.isArray(e)){for(var i=0,t=new Array(e.length);i<e.length;i++)t[i]=e[i];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function V(){return"undefined"!=typeof Reflect&&Reflect.defineMetadata&&Reflect.getOwnMetadataKeys}function F(e,t){W(e,t),Object.getOwnPropertyNames(t.prototype).forEach((function(n){W(e.prototype,t.prototype,n)})),Object.getOwnPropertyNames(t).forEach((function(n){W(e,t,n)}))}function W(e,t,n){(n?Reflect.getOwnMetadataKeys(t,n):Reflect.getOwnMetadataKeys(t)).forEach((function(r){var o=n?Reflect.getOwnMetadata(r,t,n):Reflect.getOwnMetadata(r,t);n?Reflect.defineMetadata(r,o,e,n):Reflect.defineMetadata(r,o,e)}))}var z={__proto__:[]}instanceof Array;function U(e,t){var n=t.prototype._init;t.prototype._init=function(){var t=this,n=Object.getOwnPropertyNames(e);if(e.$options.props)for(var r in e.$options.props)e.hasOwnProperty(r)||n.push(r);n.forEach((function(n){Object.defineProperty(t,n,{get:function(){return e[n]},set:function(t){e[n]=t},configurable:!0})}))};var data=new t;t.prototype._init=n;var r={};return Object.keys(data).forEach((function(e){void 0!==data[e]&&(r[e]=data[e])})),r}var G=["data","beforeCreate","created","beforeMount","mounted","beforeDestroy","destroyed","beforeUpdate","updated","activated","deactivated","render","errorCaptured","serverPrefetch"];function X(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.name=t.name||e._componentTag||e.name;var n=e.prototype;Object.getOwnPropertyNames(n).forEach((function(e){if("constructor"!==e)if(G.indexOf(e)>-1)t[e]=n[e];else{var r=Object.getOwnPropertyDescriptor(n,e);void 0!==r.value?"function"==typeof r.value?(t.methods||(t.methods={}))[e]=r.value:(t.mixins||(t.mixins=[])).push({data:function(){return L({},e,r.value)}}):(r.get||r.set)&&((t.computed||(t.computed={}))[e]={get:r.get,set:r.set})}})),(t.mixins||(t.mixins=[])).push({data:function(){return U(this,e)}});var r=e.__decorators__;r&&(r.forEach((function(e){return e(t)})),delete e.__decorators__);var l=Object.getPrototypeOf(e.prototype),c=l instanceof o.default?l.constructor:o.default,h=c.extend(t);return Y(h,e,c),V()&&F(h,e),h}var K={prototype:!0,arguments:!0,callee:!0,caller:!0};function Y(e,t,n){Object.getOwnPropertyNames(t).forEach((function(r){if(!K[r]){var o=Object.getOwnPropertyDescriptor(e,r);if(!o||o.configurable){var l,c,h=Object.getOwnPropertyDescriptor(t,r);if(!z){if("cid"===r)return;var d=Object.getOwnPropertyDescriptor(n,r);if(l=h.value,c=D(l),null!=l&&("object"===c||"function"===c)&&d&&d.value===h.value)return}Object.defineProperty(e,r,h)}}}))}function $(e){return"function"==typeof e?X(e):function(t){return X(t,e)}}$.registerHooks=function(e){G.push.apply(G,B(e))};var Q=function(e){m(n,e);var t=E(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).name="BaseEditorComponent",e.instance=null,e.row=null,e.col=null,e.prop=null,e.TD=null,e.originalValue=null,e.cellProperties=null,e.state=null,e.hot=null,e}return y(n,[{key:"mounted",value:function(){var e,t=this;this.$data.hotCustomEditorClass=(e=function(e){m(r,e);var n=E(r);function r(e){var o;return d(this,r),o=n.call(this,e),t.$data.hotCustomEditorInstance=C(o),o}return y(r,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),r}(r.a.editors.BaseEditor),Object.getOwnPropertyNames(r.a.editors.BaseEditor.prototype).forEach((function(n){"constructor"!==n&&(e.prototype[n]=function(){for(var e,r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return(e=t[n]).call.apply(e,[this].concat(o))})})),e)}},{key:"_fireCallbacks",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];(e=r.a.editors.BaseEditor.prototype._fireCallbacks).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"beginEditing",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.beginEditing).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"cancelChanges",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.cancelChanges).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"checkEditorSection",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.checkEditorSection).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"close",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.close).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"discardEditor",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.discardEditor).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"enableFullEditMode",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.enableFullEditMode).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"extend",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.extend).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"finishEditing",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.finishEditing).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"focus",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.focus).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getValue",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.getValue).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"init",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.init).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isInFullEditMode",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.isInFullEditMode).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isOpened",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.isOpened).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isWaiting",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.isWaiting).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"open",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.open).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"prepare",value:function(e,col,t,n,o,l){return this.$data.hotInstance=l.instance,this.$data.row=e,this.$data.col=col,this.$data.prop=t,this.$data.TD=n,this.$data.originalValue=o,this.$data.cellProperties=l,r.a.editors.BaseEditor.prototype.prepare.call(this.$data.hotCustomEditorInstance,e,col,t,n,o,l)}},{key:"saveValue",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.saveValue).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"setValue",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.setValue).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"addHook",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.addHook).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"removeHooksByKey",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.removeHooksByKey).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"clearHooks",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.clearHooks).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCell",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.getEditedCell).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellRect",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.getEditedCellRect).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellsZIndex",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.getEditedCellsZIndex).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellsLayerClass",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.getEditedCellsLayerClass).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}}]),n}(o.default);Q=function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l}([$({})],Q)}).call(this,n(92))},655:function(e,t,n){var content=n(821);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(15).default)("6f0e746e",content,!0,{sourceMap:!1})},656:function(e,t,n){"use strict";n.d(t,"a",(function(){return T})),n.d(t,"b",(function(){return j}));n(622);var r,o=n(601),l=n(725),c=n(719),h=n(717),d=n(718),f=n(724),y=n(723),v=n(721),m=n(720),w=n(715),O=n(716),C=n(684),S=n(726),E=n(722);function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var T=[w.a,O.a,h.a,d.a,c.a,m.a,v.a,E.a,y.a,f.a,l.a,C.a,S.a],k=(R(r={},C.a,C.b),R(r,S.a,S.b),R(r,w.a,w.b),R(r,O.a,O.b),R(r,h.a,h.b),R(r,d.a,d.b),R(r,c.a,c.b),R(r,m.a,m.b),R(r,v.a,v.b),R(r,E.a,E.b),R(r,y.a,y.b),R(r,f.a,f.b),R(r,l.a,l.b),r);function j(){var e={};return Object(o.o)(k,(function(t,n){e[n]=t()})),e}},662:function(e,t,n){"use strict";n.d(t,"i",(function(){return m})),n.d(t,"d",(function(){return w})),n.d(t,"g",(function(){return O})),n.d(t,"e",(function(){return C})),n.d(t,"a",(function(){return S})),n.d(t,"h",(function(){return E})),n.d(t,"c",(function(){return R})),n.d(t,"b",(function(){return T})),n.d(t,"f",(function(){return k}));n(59),n(7),n(46),n(4),n(53),n(212),n(32),n(35);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}for(var o,l,c,h=0,d=["ms","moz","webkit","o"],f=window.requestAnimationFrame,y=window.cancelAnimationFrame,v=0;v<d.length&&!f;++v)f=window["".concat(d[v],"RequestAnimationFrame")],y=window["".concat(d[v],"CancelAnimationFrame")]||window["".concat(d[v],"CancelRequestAnimationFrame")];function m(e){return f.call(window,e)}function w(){return!!document.documentElement.classList}function O(){return!!document.createTextNode("test").textContent}function C(){return!!window.getComputedStyle}function S(e){y.call(window,e)}function E(){return"ontouchstart"in window}function R(){return void 0===o&&function(){var e=document.createElement("TABLE");e.style.borderSpacing="0",e.style.borderWidth="0",e.style.padding="0";var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var n=document.createElement("CAPTION");n.innerHTML="c<br>c<br>c<br>c",n.style.padding="0",n.style.margin="0",e.insertBefore(n,t),document.body.appendChild(e),o=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}(),o}function T(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l||(l="object"===("undefined"==typeof Intl?"undefined":r(Intl))?new Intl.Collator(e,t).compare:"function"==typeof String.prototype.localeCompare?function(a,b){return"".concat(a).localeCompare(b)}:function(a,b){return a===b?0:a>b?-1:1})}function k(){if(void 0!==c)return c;try{var e={get passive(){c=!0}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch(e){c=!1}return c}f||(f=function(e){var t=(new Date).getTime(),n=Math.max(0,16-(t-h)),r=window.setTimeout((function(){e(t+n)}),n);return h=t+n,r}),y||(y=function(e){clearTimeout(e)})},669:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));n(212),n(269),n(4),n(32),n(35),n(7),n(46),n(53),n(42),n(36),n(27),n(21);function r(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var l=new Map;function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";l.has(e)||l.set(e,new Map);var t=l.get(e);function n(e,n){t.set(e,n)}function o(e){return t.get(e)}function c(e){return t.has(e)}function h(){return r(t.keys())}function d(){return r(t.values())}return{register:n,getItem:o,hasItem:c,getNames:h,getValues:d}}},670:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"e",(function(){return h})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return f})),n.d(t,"d",(function(){return y}));n(33),n(52),n(21),n(61);var r=n(607),o=n(650),l={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Object(o.d)()?182:174,AUDIO_MUTE:Object(o.d)()?181:173,AUDIO_UP:Object(o.d)()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},c=[l.ALT,l.ARROW_DOWN,l.ARROW_LEFT,l.ARROW_RIGHT,l.ARROW_UP,l.AUDIO_DOWN,l.AUDIO_MUTE,l.AUDIO_UP,l.BACKSPACE,l.CAPS_LOCK,l.DELETE,l.END,l.ENTER,l.ESCAPE,l.F1,l.F2,l.F3,l.F4,l.F5,l.F6,l.F7,l.F8,l.F9,l.F10,l.F11,l.F12,l.F13,l.F14,l.F15,l.F16,l.F17,l.F18,l.F19,l.HOME,l.INSERT,l.MEDIA_NEXT,l.MEDIA_PLAY_PAUSE,l.MEDIA_PREV,l.MEDIA_STOP,l.NULL,l.NUM_LOCK,l.PAGE_DOWN,l.PAGE_UP,l.PAUSE,l.SCROLL_LOCK,l.SHIFT,l.TAB];function h(e){return 32===e||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function d(e){return c.includes(e)}function f(e){return[l.CONTROL,l.COMMAND_LEFT,l.COMMAND_RIGHT,l.COMMAND_FIREFOX].includes(e)}function y(e,t){var n=t.split("|"),o=!1;return Object(r.a)(n,(function(t){if(e===l[t])return o=!0,!1})),o}},678:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return l}));var r=n(617);function o(){var e;Object(r.b)(console)&&(e=console).warn.apply(e,arguments)}function l(){var e;Object(r.b)(console)&&(e=console).error.apply(e,arguments)}},682:function(e,t,n){"use strict";n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return m}));n(33),n(52),n(212),n(4),n(32),n(626),n(35),n(7),n(46),n(53),n(36),n(27),n(42),n(21);var r=n(670),o=n(645),l=n(709),c=n(639),h=n(617);function d(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function y(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var v="editorManager.navigation",m="editorManager.handlingEditor",w=function(){function e(t,n,r){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.instance=t,this.tableMeta=n,this.selection=r,this.eventManager=new c.a(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0,this.instance.getShortcutManager().addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",(function(e){return o.onAfterDocumentKeyDown(e)})),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",(function(e){!o.destroyed&&o.activeEditor&&!o.activeEditor.isOpened()&&o.instance.isListening()&&o.openEditor("",e)})),this.instance.view._wt.update("onCellDblClick",(function(e,t,n){return o.onCellDblClick(e,t,n)}))}var t,n,f;return t=e,(n=[{key:"registerShortcuts",value:function(){var e=this,t=this.instance.getShortcutManager(),n=t.getContext("grid"),r=t.getContext("editor"),l={group:m};r.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(n,r){e.closeEditorAndSaveChanges(t.isCtrlPressed()),e.moveSelectionAfterEnter(r.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){e.closeEditorAndRestoreOriginalValue(t.isCtrlPressed()),e.activeEditor.focus()}}],l),n.addShortcuts([{keys:[["F2"]],callback:function(t){e.activeEditor&&e.activeEditor.enableFullEditMode(),e.openEditor(null,t)}},{keys:[["Backspace"],["Delete"]],callback:function(){e.instance.emptySelectedCells(),e.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(t,n){e.instance.getSettings().enterBeginsEditing?e.cellProperties.readOnly?e.moveSelectionAfterEnter():e.activeEditor&&(e.activeEditor.enableFullEditMode(),e.openEditor(null,t)):e.moveSelectionAfterEnter(n.includes("shift")),Object(o.d)(t)}}],l)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(e){this.lock||this.closeEditor(e)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var e=this;if(!this.lock)if(this.activeEditor&&this.activeEditor.isWaiting())this.closeEditor(!1,!1,(function(t){t&&e.prepareEditor()}));else{var t=this.instance.selection.selectedRange.current().highlight,n=t.row,col=t.col,r=this.instance.runHooks("modifyGetCellCoords",n,col),o=n,c=col;if(Array.isArray(r)){var h=d(r,2);o=h[0],c=h[1]}this.cellProperties=this.instance.getCellMeta(o,c);var f=this.instance.rootDocument.activeElement;if(f&&f.blur(),this.cellProperties.readOnly)this.clearActiveEditor();else{var y=this.instance.getCellEditor(this.cellProperties),td=this.instance.getCell(n,col,!0);if(y&&td){var v=this.instance.colToProp(c),m=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(o),c);this.activeEditor=Object(l.a)(y,this.instance),this.activeEditor.prepare(n,col,v,td,m,this.cellProperties)}else this.clearActiveEditor()}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(e,t){this.activeEditor&&this.activeEditor.beginEditing(e,t)}},{key:"closeEditor",value:function(e,t,n){this.activeEditor?this.activeEditor.finishEditing(e,t,n):n&&n(!1)}},{key:"closeEditorAndSaveChanges",value:function(e){this.closeEditor(!1,e)}},{key:"closeEditorAndRestoreOriginalValue",value:function(e){this.closeEditor(!0,e)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"moveSelectionAfterEnter",value:function(e){var t="function"==typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-t.row,-t.col):this.selection.transformStart(t.row,t.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(e){var t=this;if(this.instance.isListening()){var n=e.keyCode;if(229!==n&&this.selection.isSelected()){var o=(e.ctrlKey||e.metaKey)&&!e.altKey;if(this.activeEditor&&!this.activeEditor.isWaiting()&&!(Object(r.c)(n)||Object(r.b)(n)||o||this.isEditorOpened())){var l=this.instance.getShortcutManager().getContext("editor"),c={runOnlyIf:function(){return Object(h.b)(t.instance.getSelected())},group:v};l.addShortcuts([{keys:[["ArrowUp"]],callback:function(){t.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){t.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){t.instance.selection.transformStart(0,-1*t.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){t.instance.selection.transformStart(0,t.instance.getDirectionFactor())}}],c),this.openEditor("",e)}}}}},{key:"onCellDblClick",value:function(e,t,n){"TD"===n.nodeName&&(this.activeEditor&&this.activeEditor.enableFullEditMode(),this.openEditor(null,e))}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}])&&y(t.prototype,n),f&&y(t,f),Object.defineProperty(t,"prototype",{writable:!1}),e}(),O=new WeakMap;w.getInstance=function(e,t,n){var r=O.get(e);return r||(r=new w(e,t,n),O.set(e,r)),r},t.c=w},683:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));n(36);var r=n(630),o=n(601),l=n(636),c=n(642);function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var f=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;h(this,e),this.indexedValues=[],this.initValueOrFn=t}var t,n,o;return t=e,n=[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(e){var t=this.indexedValues;if(e<t.length)return t[e]}},{key:"setValues",value:function(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(e,t){return e<this.indexedValues.length&&(this.indexedValues[e]=t,this.runLocalHooks("change"),!0)}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Object(l.d)(this.initValueOrFn)?Object(r.c)(t-1,(function(t){return e.indexedValues.push(e.initValueOrFn(t))})):Object(r.c)(t-1,(function(){return e.indexedValues.push(e.initValueOrFn)})),this.runLocalHooks("change")}},{key:"init",value:function(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}],n&&d(t.prototype,n),o&&d(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();Object(o.n)(f,c.a)},684:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r="---------";function o(){return{name:r}}},689:function(e,t,n){"use strict";n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return y}));var r=n(669),o=n(709),l=n(711),c=n(712),h=Object(r.a)("cellTypes"),d=h.register,f=h.getItem,y=h.hasItem;h.getNames,h.getValues;function v(e){if(!y(e))throw Error('You declared cell type "'.concat(e,'" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method'));return f(e)}function m(e,t){"string"!=typeof e&&(e=(t=e).CELL_TYPE);var n=t,r=n.editor,h=n.renderer,f=n.validator;r&&Object(o.c)(e,r),h&&Object(l.c)(e,h),f&&Object(c.c)(e,f),d(e,t)}},690:function(e,t,n){"use strict";var r=n(6),o=n(19),l=n(148),c=o([].reverse),h=[1,2];r({target:"Array",proto:!0,forced:String(h)===String(h.reverse())},{reverse:function(){return l(this)&&(this.length=this.length),c(this)}})},691:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));n(212),n(269),n(4),n(32),n(35),n(79),n(7),n(46),n(53),n(36),n(27),n(42),n(21);var r=n(636);function o(e){return function(e){if(Array.isArray(e))return h(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||c(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||c(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var d=function(e){return"The id '".concat(e,"' is already declared in a map.")};function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.errorIdExists,n=new Map;function c(e,r){if(w(e))throw new Error(t(e));n.set(e,r)}function h(e){return n.delete(e)}function f(){n.clear()}function y(e){var t=m().find((function(t){var n=l(t,2),r=n[0],element=n[1];return e===element&&r}))||[null];return l(t,1)[0]}function v(e){return n.get(e)}function m(){return o(n)}function w(e){return n.has(e)}return t=Object(r.d)(t)?t:d,{addItem:c,clear:f,getId:y,getItem:v,getItems:m,hasItem:w,removeItem:h}}},692:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return h}));n(28),n(36),n(33),n(52),n(7),n(46),n(4),n(53),n(212),n(32),n(35),n(42),n(27),n(21);var r=n(607);function o(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function c(e,t,n){return[].concat(o(e.slice(0,t)),o(n),o(e.slice(t)))}function h(e,t){return Object(r.b)(e,(function(e){return!1===t.includes(e)}))}},693:function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));n(606),n(604),n(4),n(110),n(623),n(12),n(7),n(46),n(53),n(212),n(32),n(35);var r=n(683),o=n(744);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(){return d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var base=f(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},d.apply(this,arguments)}function f(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=w(object)););return object}function y(e,p){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},y(e,p)}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=w(e);if(t){var o=w(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return m(this,n)}}function m(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}var O=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(f,e);var t,n,r,l=v(f);function f(){return c(this,f),l.apply(this,arguments)}return t=f,(n=[{key:"insert",value:function(e,t){this.indexedValues=Object(o.a)(this.indexedValues,e,t,this.initValueOrFn),d(w(f.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){this.indexedValues=Object(o.b)(this.indexedValues,e),d(w(f.prototype),"remove",this).call(this,e)}}])&&h(t.prototype,n),r&&h(t,r),Object.defineProperty(t,"prototype",{writable:!1}),f}(r.a)},694:function(e,t,n){"use strict";n.d(t,"d",(function(){return h})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return y}));n(604),n(4),n(10),n(8),n(7),n(46),n(53),n(212),n(32),n(35);var r=n(689),o=n(601);var l="ABCDEFGHIJKLMNOPQRSTUVWXYZ",c=l.length;function h(e){for(var t,n=e+1,r="";n>0;)t=(n-1)%c,r=String.fromCharCode(65+t)+r,n=parseInt((n-t)/c,10);return r}function d(e,t){var n=void 0===t||t;return function(t,col){return function t(l){if(l){if(Object(o.j)(l,e)&&void 0!==l[e])return l[e];if(Object(o.j)(l,"type")&&l.type){if("string"!=typeof l.type)throw new Error('Cell "type" must be a string');var c=Object(r.a)(l.type);if(Object(o.j)(c,e))return c[e];if(n)return}return t(Object.getPrototypeOf(l))}}("number"==typeof t?this.getCellMeta(t,col):t)}}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e,r=[];return Array.isArray(e)&&Array.isArray(e[0])||(n=[e]),n.forEach((function(e,n){Array.isArray(e)?e.forEach((function(e,o){r.push([n+t,o,e])})):Object.keys(e).forEach((function(o){r.push([n+t,o,e[o]])}))})),r}function y(data){var e=0;return Array.isArray(data)&&(data[0]&&Array.isArray(data[0])?e=data[0].length:data[0]&&Object(o.l)(data[0])&&(e=Object(o.e)(data[0]))),e}},709:function(e,t,n){"use strict";n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return f}));n(212),n(4),n(32),n(626),n(35);var r=n(638),o=n(669),l=new WeakMap,c=Object(o.a)("editors"),h=c.register,d=c.getItem,f=c.hasItem;c.getNames,c.getValues;function y(e){var t={},n=e;this.getConstructor=function(){return e},this.getInstance=function(e){return e.guid in t||(t[e.guid]=new n(e)),t[e.guid]},r.a.getSingleton().add("afterDestroy",(function(){t[this.guid]=null}))}function v(e,t){var n;if("function"==typeof e)l.get(e)||m(null,e),n=l.get(e);else{if("string"!=typeof e)throw Error('Only strings and functions can be passed as "editor" parameter');n=d(e)}if(!n)throw Error('No editor registered under name "'.concat(e,'"'));return n.getInstance(t)}function m(e,t){e&&"string"!=typeof e&&(e=(t=e).EDITOR_TYPE);var n=new y(t);"string"==typeof e&&h(e,n),l.set(t,n)}},710:function(e,t,n){"use strict";n(379)("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),n(382))},711:function(e,t,n){"use strict";n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return h}));var r=n(669),o=Object(r.a)("renderers"),l=o.register,c=o.getItem,h=o.hasItem;o.getNames,o.getValues;function d(e){if("function"==typeof e)return e;if(!h(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return c(e)}function f(e,t){"string"!=typeof e&&(e=(t=e).RENDERER_TYPE),l(e,t)}},712:function(e,t,n){"use strict";n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return h}));var r=n(669),o=Object(r.a)("validators"),l=o.register,c=o.getItem,h=o.hasItem;o.getNames,o.getValues;function d(e){if("function"==typeof e)return e;if(!h(e))throw Error('No registered validator found under "'.concat(e,'" name'));return c(e)}function f(e,t){"string"!=typeof e&&(e=(t=e).VALIDATOR_TYPE),l(e,t)}},713:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return h}));n(212),n(4),n(32),n(626),n(35),n(7),n(46);var r=new WeakMap,o=Symbol("rootInstance");function l(object){r.set(object,!0)}function c(e){return e===o}function h(object){return r.has(object)}},714:function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return y})),n.d(t,"c",(function(){return C})),n.d(t,"e",(function(){return S})),n.d(t,"f",(function(){return E})),n.d(t,"g",(function(){return R})),n.d(t,"d",(function(){return T}));n(7),n(46),n(4),n(33),n(52),n(212),n(631),n(32),n(35),n(42),n(292),n(53),n(36),n(27),n(21);var r=n(816),o=n(607),l=n(617);function c(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}var f=0,y=1,v=[3,2],m=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],w=Symbol("root"),O=Symbol("child");function C(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w;if(t!==w&&t!==O)throw new Error("The second argument is used internally only and cannot be overwritten.");var n=Array.isArray(e),o=t===w,l=f;if(n){var c=e[0];if(0===e.length)l=y;else if(o&&c instanceof r.a)l=3;else if(o&&Array.isArray(c))l=C(c,O);else if(e.length>=2&&e.length<=4){var h=!e.some((function(e,t){return!m[t].includes(d(e))}));h&&(l=2)}}return l}function S(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.keepDirection,r=void 0!==n&&n,o=t.propToCol;if(!v.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(t){var n=3===e,c=n?t.from.row:t[0],h=n?t.from.col:t[1],d=n?t.to.row:t[2],f=n?t.to.col:t[3];if("function"==typeof o&&("string"==typeof h&&(h=o(h)),"string"==typeof f&&(f=o(f))),Object(l.e)(d)&&(d=c),Object(l.e)(f)&&(f=h),!r){var y=c,v=h,m=d,w=f;c=Math.min(y,m),h=Math.min(v,w),d=Math.max(y,m),f=Math.max(v,w)}return[c,h,d,f]}}function E(e){var t=C(e);if(t===f||t===y)return[];var n=S(t),r=new Set;Object(o.a)(e,(function(e){var t=c(n(e),4),l=t[1],h=t[3],d=Math.max(l,0),f=h-d+1;Object(o.a)(Array.from(new Array(f),(function(e,i){return d+i})),(function(e){r.has(e)||r.add(e)}))}));var l=Array.from(r).sort((function(a,b){return a-b}));return Object(o.d)(l,(function(e,t,n,r){return 0!==n&&t===r[n-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e}),[])}function R(e){var t=C(e);if(t===f||t===y)return[];var n=S(t),r=new Set;Object(o.a)(e,(function(e){var t=c(n(e),3),l=t[0],h=t[2],d=Math.max(l,0),f=h-d+1;Object(o.a)(Array.from(new Array(f),(function(e,i){return d+i})),(function(e){r.has(e)||r.add(e)}))}));var l=Array.from(r).sort((function(a,b){return a-b}));return Object(o.d)(l,(function(e,t,n,r){return 0!==n&&t===r[n-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e}),[])}function T(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;return"number"==typeof e&&e>=0&&e<t}},715:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c}));var r=n(651),o=n(609),l="row_above";function c(){return{key:l,name:function(){return this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ROW_ABOVE)},callback:function(e,t){var n=this.selection.isSelectedByCorner(),r=0;n||(r=t[Math.max(t.length-1,0)].start.row);this.alter("insert_row",r,1,"ContextMenu.rowAbove"),n&&this.selectAll()},disabled:function(){return!Object(r.e)(this)||(this.selection.isSelectedByCorner()?0===this.countRows():this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden:function(){return!this.getSettings().allowInsertRow}}}},716:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return h}));var r=n(651),o=n(617),l=n(609),c="row_below";function h(){return{key:c,name:function(){return this.getTranslatedPhrase(l.CONTEXTMENU_ITEMS_ROW_BELOW)},callback:function(e,t){var n=this.selection.isSelectedByCorner(),r=0;if(n)r=this.countRows();else{var l,c=t[Math.max(t.length-1,0)],h=null==c||null===(l=c.end)||void 0===l?void 0:l.row;r=Object(o.b)(h)?h+1:0}this.alter("insert_row",r,1,"ContextMenu.rowBelow"),n&&this.selectAll()},disabled:function(){return!Object(r.e)(this)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden:function(){return!this.getSettings().allowInsertRow}}}},717:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return h}));var r=n(651),o=n(617),l=n(609),c="col_left";function h(){return{key:c,name:function(){return this.getTranslatedPhrase(l.CONTEXTMENU_ITEMS_INSERT_LEFT)},callback:function(){var e=this.selection.isSelectedByCorner(),t=this.isRtl()?this.countCols():0;if(!e){var n=this.getSelectedRangeLast();if(Object(o.b)(n)){var col=n.getTopLeftCorner().col;t=this.isRtl()?col+1:col}}this.alter("insert_col",t,1,"ContextMenu.columnLeft"),e&&this.selectAll()},disabled:function(){return!this.isColumnModificationAllowed()||(!Object(r.e)(this)||(this.selection.isSelectedByCorner()?0===this.countCols():this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols))},hidden:function(){return!this.getSettings().allowInsertColumn}}}},718:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return h}));var r=n(651),o=n(609),l=n(617),c="col_right";function h(){return{key:c,name:function(){return this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_INSERT_RIGHT)},callback:function(){var e=this.selection.isSelectedByCorner(),t=this.isRtl()?0:this.countCols();if(!e){var n=this.getSelectedRangeLast();if(Object(l.b)(n)){var col=n.getTopRightCorner().col;t=this.isRtl()?col:col+1}}this.alter("insert_col",t,1,"ContextMenu.columnRight"),e&&this.selectAll()},disabled:function(){return!this.isColumnModificationAllowed()||(!Object(r.e)(this)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols))},hidden:function(){return!this.getSettings().allowInsertColumn}}}},719:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c}));var r=n(651),o=n(609),l="clear_column";function c(){return{key:l,name:function(){return this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_CLEAR_COLUMN)},callback:function(e,t){var n=t[0].start.col,r=t[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(t[0].start.row,t[0].end.row),r,"ContextMenu.clearColumn")},disabled:function(){return!Object(r.e)(this)||!this.selection.isSelectedByColumnHeader()}}}},720:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return f}));n(7),n(46),n(4),n(53),n(212),n(32),n(35),n(36),n(27),n(42),n(21);var r=n(651),o=n(714),l=n(609);function c(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var d="remove_row";function f(){return{key:d,name:function(){var e=this.getSelected(),t=0;if(e)if(e.length>1)t=1;else{var n=c(e[0],3);n[0]-n[2]!=0&&(t=1)}return this.getTranslatedPhrase(l.CONTEXTMENU_ITEMS_REMOVE_ROW,t)},callback:function(){this.alter("remove_row",Object(o.g)(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){if(!Object(r.e)(this))return!0;var e=this.countRows();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByColumnHeader()||0===e},hidden:function(){return!this.getSettings().allowRemoveRow}}}},721:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return f}));n(7),n(46),n(4),n(53),n(212),n(32),n(35),n(36),n(27),n(42),n(21);var r=n(651),o=n(714),l=n(609);function c(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var d="remove_col";function f(){return{key:d,name:function(){var e=this.getSelected(),t=0;if(e)if(e.length>1)t=1;else{var n=c(e[0],4);n[1]-n[3]!=0&&(t=1)}return this.getTranslatedPhrase(l.CONTEXTMENU_ITEMS_REMOVE_COLUMN,t)},callback:function(){this.alter("remove_col",Object(o.f)(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;if(!Object(r.e)(this))return!0;var e=this.countCols();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByRowHeader()||0===e},hidden:function(){return!this.getSettings().allowRemoveColumn}}}},722:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return l}));var r=n(609),o="undo";function l(){return{key:o,name:function(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_UNDO)},callback:function(){this.undo()},hidden:function(){var e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}},723:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return l}));var r=n(609),o="redo";function l(){return{key:o,name:function(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_REDO)},callback:function(){this.redo()},hidden:function(){var e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}},724:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return h}));var r=n(651),o=n(607),l=n(609),c="make_read_only";function h(){return{key:c,name:function(){var e=this,label=this.getTranslatedPhrase(l.CONTEXTMENU_ITEMS_READ_ONLY);return Object(r.b)(this.getSelectedRange(),(function(t,col){return e.getCellMeta(t,col).readOnly}))&&(label=Object(r.k)(label)),label},callback:function(){var e=this,t=this.getSelectedRange(),n=Object(r.b)(t,(function(t,col){return e.getCellMeta(t,col).readOnly}));Object(o.a)(t,(function(t){t.forAll((function(t,col){t>=0&&col>=0&&e.setCellMeta(t,col,"readOnly",!n)}))})),this.render()},disabled:function(){return!!this.selection.isSelectedByCorner()||(0===this.countRows()||0===this.countCols()||(!this.getSelectedRange()||0===this.getSelectedRange().length))}}}},725:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return h}));n(622);var r=n(651),o=n(684),l=n(609),c="alignment";function h(){return{key:c,name:function(){return this.getTranslatedPhrase(l.CONTEXTMENU_ITEMS_ALIGNMENT)},disabled:function(){return 0===this.countRows()||0===this.countCols()||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(c,":left"),name:function(){var e=this,label=this.getTranslatedPhrase(l.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT);return Object(r.b)(this.getSelectedRange(),(function(t,col){var n=e.getCellMeta(t,col).className;if(n&&-1!==n.indexOf("htLeft"))return!0}))&&(label=Object(r.k)(label)),label},callback:function(){var e=this,t=this.getSelectedRange(),n=Object(r.d)(t,(function(t,col){return e.getCellMeta(t,col).className})),o="horizontal",l="htLeft";this.runHooks("beforeCellAlignment",n,t,o,l),Object(r.a)(t,o,l,(function(t,col){return e.getCellMeta(t,col)}),(function(t,col,n,r){return e.setCellMeta(t,col,n,r)})),this.render()},disabled:!1},{key:"".concat(c,":center"),name:function(){var e=this,label=this.getTranslatedPhrase(l.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER);return Object(r.b)(this.getSelectedRange(),(function(t,col){var n=e.getCellMeta(t,col).className;if(n&&-1!==n.indexOf("htCenter"))return!0}))&&(label=Object(r.k)(label)),label},callback:function(){var e=this,t=this.getSelectedRange(),n=Object(r.d)(t,(function(t,col){return e.getCellMeta(t,col).className})),o="horizontal",l="htCenter";this.runHooks("beforeCellAlignment",n,t,o,l),Object(r.a)(t,o,l,(function(t,col){return e.getCellMeta(t,col)}),(function(t,col,n,r){return e.setCellMeta(t,col,n,r)})),this.render()},disabled:!1},{key:"".concat(c,":right"),name:function(){var e=this,label=this.getTranslatedPhrase(l.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT);return Object(r.b)(this.getSelectedRange(),(function(t,col){var n=e.getCellMeta(t,col).className;if(n&&-1!==n.indexOf("htRight"))return!0}))&&(label=Object(r.k)(label)),label},callback:function(){var e=this,t=this.getSelectedRange(),n=Object(r.d)(t,(function(t,col){return e.getCellMeta(t,col).className})),o="horizontal",l="htRight";this.runHooks("beforeCellAlignment",n,t,o,l),Object(r.a)(t,o,l,(function(t,col){return e.getCellMeta(t,col)}),(function(t,col,n,r){return e.setCellMeta(t,col,n,r)})),this.render()},disabled:!1},{key:"".concat(c,":justify"),name:function(){var e=this,label=this.getTranslatedPhrase(l.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY);return Object(r.b)(this.getSelectedRange(),(function(t,col){var n=e.getCellMeta(t,col).className;if(n&&-1!==n.indexOf("htJustify"))return!0}))&&(label=Object(r.k)(label)),label},callback:function(){var e=this,t=this.getSelectedRange(),n=Object(r.d)(t,(function(t,col){return e.getCellMeta(t,col).className})),o="horizontal",l="htJustify";this.runHooks("beforeCellAlignment",n,t,o,l),Object(r.a)(t,o,l,(function(t,col){return e.getCellMeta(t,col)}),(function(t,col,n,r){return e.setCellMeta(t,col,n,r)})),this.render()},disabled:!1},{name:o.a},{key:"".concat(c,":top"),name:function(){var e=this,label=this.getTranslatedPhrase(l.CONTEXTMENU_ITEMS_ALIGNMENT_TOP);return Object(r.b)(this.getSelectedRange(),(function(t,col){var n=e.getCellMeta(t,col).className;if(n&&-1!==n.indexOf("htTop"))return!0}))&&(label=Object(r.k)(label)),label},callback:function(){var e=this,t=this.getSelectedRange(),n=Object(r.d)(t,(function(t,col){return e.getCellMeta(t,col).className})),o="vertical",l="htTop";this.runHooks("beforeCellAlignment",n,t,o,l),Object(r.a)(t,o,l,(function(t,col){return e.getCellMeta(t,col)}),(function(t,col,n,r){return e.setCellMeta(t,col,n,r)})),this.render()},disabled:!1},{key:"".concat(c,":middle"),name:function(){var e=this,label=this.getTranslatedPhrase(l.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE);return Object(r.b)(this.getSelectedRange(),(function(t,col){var n=e.getCellMeta(t,col).className;if(n&&-1!==n.indexOf("htMiddle"))return!0}))&&(label=Object(r.k)(label)),label},callback:function(){var e=this,t=this.getSelectedRange(),n=Object(r.d)(t,(function(t,col){return e.getCellMeta(t,col).className})),o="vertical",l="htMiddle";this.runHooks("beforeCellAlignment",n,t,o,l),Object(r.a)(t,o,l,(function(t,col){return e.getCellMeta(t,col)}),(function(t,col,n,r){return e.setCellMeta(t,col,n,r)})),this.render()},disabled:!1},{key:"".concat(c,":bottom"),name:function(){var e=this,label=this.getTranslatedPhrase(l.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM);return Object(r.b)(this.getSelectedRange(),(function(t,col){var n=e.getCellMeta(t,col).className;if(n&&-1!==n.indexOf("htBottom"))return!0}))&&(label=Object(r.k)(label)),label},callback:function(){var e=this,t=this.getSelectedRange(),n=Object(r.d)(t,(function(t,col){return e.getCellMeta(t,col).className})),o="vertical",l="htBottom";this.runHooks("beforeCellAlignment",n,t,o,l),Object(r.a)(t,o,l,(function(t,col){return e.getCellMeta(t,col)}),(function(t,col,n,r){return e.setCellMeta(t,col,n,r)})),this.render()},disabled:!1}]}}}},726:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return l}));var r=n(609),o="no_items";function l(){return{key:o,name:function(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_NO_ITEMS)},disabled:!0,isCommand:!1}}},733:function(e,t,n){"use strict";n(27),n(59),n(8),n(21),n(217),n(70),n(4),n(65),n(28),n(7),n(9),n(12),n(10),n(13);var r=n(605);function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l=function(){function e(object,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n,o,l,c,h,d,f=Object(r.u)(t),y=Object(r.t)(t);this.rootWindow=t,this.type=this.getSourceType(object),"literal"===this.type?(n=parseInt(object.top,10),l=parseInt(object.left,10),h=object.height||0,d=object.width||0,o=n,c=l,n+=f,l+=y):"event"===this.type&&(n=parseInt(object.pageY,10),l=parseInt(object.pageX,10),h=object.target.clientHeight,d=object.target.clientWidth,o=n-f,c=l-y),this.top=n,this.topRelative=o,this.left=l,this.leftRelative=c,this.scrollTop=f,this.scrollLeft=y,this.cellHeight=h,this.cellWidth=d}var t,n,l;return t=e,n=[{key:"getSourceType",value:function(object){var e="literal";return object instanceof Event&&(e="event"),e}},{key:"fitsAbove",value:function(element){return this.topRelative>=element.offsetHeight}},{key:"fitsBelow",value:function(element){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+element.offsetHeight<=e}},{key:"fitsOnRight",value:function(element){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+element.offsetWidth<=e}},{key:"fitsOnLeft",value:function(element){return this.leftRelative>=element.offsetWidth}}],n&&o(t.prototype,n),l&&o(t,l),Object.defineProperty(t,"prototype",{writable:!1}),e}(),c=l,h=n(726),d=n(656),f=n(684),y=n(651),v=n(756),m=n(639),w=n(607),O=n(650),C=n(645),S=n(636),E=n(617),R=n(601),T=n(642);function k(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function j(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?k(Object(source),!0).forEach((function(t){A(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):k(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function x(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var M="menu",I=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=t,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:215,container:this.hot.rootDocument.documentElement},this.eventManager=new m.a(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}var t,n,o;return t=e,n=[{key:"registerEvents",value:function(){for(var e=this,t=this.hot.rootWindow;t;)this.eventManager.addEventListener(t.document,"mousedown",(function(t){return e.onDocumentMouseDown(t)})),this.eventManager.addEventListener(t.document,"contextmenu",(function(t){return e.onDocumentContextMenu(t)})),t=Object(r.k)(t)}},{key:"setMenuItems",value:function(e){this.menuItems=e}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(area){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.offset[area]=e}},{key:"isSubMenu",value:function(){return null!==this.parentMenu}},{key:"open",value:function(){var e=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var t=Object(S.b)((function(t){return e.openSubMenu(t)}),300),n=this.options.minWidth||215,o=!1,l=Object(w.b)(this.menuItems,(function(t){return t.key===h.a&&(o=!0),Object(y.h)(t,e.hot)}));if(l.length<1&&!o)l.push(Object(d.b)()[h.a]);else if(0===l.length)return;l=Object(y.c)(l,f.a);var c=!1,m={data:l,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(e){return Object(E.b)(e)&&e<n?n:e},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(t,n,r,col,o,l){return e.menuItemRenderer(t,n,r,col,o,l)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:function(n,r){e.isAllSubMenusClosed()?t(r.row):e.openSubMenu(r.row)},rowHeights:function(e){return l[e].name===f.a?1:23},afterOnCellContextMenu:function(t){t.preventDefault(),Object(O.m)()&&c&&e.hasSelectedItem()&&e.close(!0)},beforeOnCellMouseUp:function(t){e.hasSelectedItem()&&(c=!e.isCommandPassive(e.getSelectedItem()),e.executeCommand(t))},afterOnCellMouseUp:function(t){Object(O.m)()&&Object(C.c)(t)||!c||!e.hasSelectedItem()||(Object(O.k)()||Object(O.i)()?setTimeout((function(){return e.close(!0)}),325):e.close(!0))},afterUnlisten:function(){!e.hasSelectedItem()&&e.isOpened()&&e.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new v.a(this.container,m),this.hotMenu.addHook("afterInit",(function(){return e.onAfterInit()})),this.hotMenu.addHook("afterSelection",(function(){return e.onAfterSelection.apply(e,arguments)})),this.hotMenu.init(),this.hotMenu.listen();var R=this.hotMenu.getShortcutManager(),T=R.addContext("menu"),k=j(j({},{group:M}),{},{runOnlyIf:function(t){return!1===Object(r.D)(t.target)||!1===e.container.contains(t.target)}});R.setActiveContextName("menu"),T.addShortcuts([{keys:[["Escape"]],callback:function(){e.keyEvent=!0,e.close(),e.keyEvent=!1}},{keys:[["ArrowDown"]],callback:function(){var t=e.hotMenu.getSelectedLast();e.keyEvent=!0,t?e.selectNextCell(t[0],t[1]):e.selectFirstCell(),e.keyEvent=!1}},{keys:[["ArrowUp"]],callback:function(){var t=e.hotMenu.getSelectedLast();e.keyEvent=!0,t?e.selectPrevCell(t[0],t[1]):e.selectLastCell(),e.keyEvent=!1}},{keys:[["ArrowRight"]],callback:function(){var t=e.hotMenu.getSelectedLast();if(e.keyEvent=!0,t){var menu=e.openSubMenu(t[0]);menu&&menu.selectFirstCell()}e.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:function(){var t=e.hotMenu.getSelectedLast();e.keyEvent=!0,t&&e.isSubMenu()&&(e.close(),e.parentMenu&&e.parentMenu.hotMenu.listen()),e.keyEvent=!1}},{keys:[["Enter"]],callback:function(t){var n=e.hotMenu.getSelectedLast();e.keyEvent=!0,e.hotMenu.getSourceDataAtRow(n[0]).submenu||(e.executeCommand(t),e.close(!0)),e.keyEvent=!1}},{keys:[["PageUp"]],callback:function(){var t=e.hotMenu.getSelectedLast();e.keyEvent=!0,t?e.hotMenu.selection.transformStart(-e.hotMenu.countVisibleRows(),0):e.selectFirstCell(),e.keyEvent=!1}},{keys:[["PageDown"]],callback:function(){var t=e.hotMenu.getSelectedLast();e.keyEvent=!0,t?e.hotMenu.selection.transformStart(e.hotMenu.countVisibleRows(),0):e.selectLastCell(),e.keyEvent=!1}}],k),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isOpened()&&(e&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(t){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(t,0);if(this.closeAllSubMenus(),!n||!Object(y.f)(n))return!1;var r=this.hotMenu.getSourceDataAtRow(t),o=new e(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return o.setMenuItems(r.submenu.items),o.open(),o.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=o,o}},{key:"closeSubMenu",value:function(e){var t=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[t.key];n&&(n.destroy(),delete this.hotSubMenus[t.key])}},{key:"closeAllSubMenus",value:function(){var e=this;Object(w.a)(this.hotMenu.getData(),(function(t,n){return e.closeSubMenu(n)}))}},{key:"isAllSubMenusClosed",value:function(){return 0===Object.keys(this.hotSubMenus).length}},{key:"destroy",value:function(){var e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}},{key:"isOpened",value:function(){return null!==this.hotMenu}},{key:"executeCommand",value:function(e){if(this.isOpened()&&this.hasSelectedItem()){var t=this.getSelectedItem();if(this.runLocalHooks("select",t,e),!this.isCommandPassive(t)){var n=this.hot.getSelectedRange(),r=n?Object(y.l)(n):[];this.runLocalHooks("executeCommand",t.key,r,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,r,e)}}}},{key:"isCommandPassive",value:function(e){var t=e.isCommand,n=e.name,r=e.disabled,o=e.submenu,l=!0===r||"function"==typeof r&&!0===r.call(this.hot);return!1===t||n===f.a||!0===l||o}},{key:"setPosition",value:function(e){var cursor=new c(e,this.container.ownerDocument.defaultView);this.options.keepInViewport?(cursor.fitsBelow(this.container)?this.setPositionBelowCursor(cursor):cursor.fitsAbove(this.container)?this.setPositionAboveCursor(cursor):this.setPositionBelowCursor(cursor),this.hot.isLtr()?this.setHorizontalPositionForLtr(cursor):this.setHorizontalPositionForRtl(cursor)):(this.setPositionBelowCursor(cursor),this.setPositionOnRightOfCursor(cursor))}},{key:"setHorizontalPositionForRtl",value:function(cursor){cursor.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(cursor):this.setPositionOnRightOfCursor(cursor)}},{key:"setHorizontalPositionForLtr",value:function(cursor){cursor.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(cursor):this.setPositionOnLeftOfCursor(cursor)}},{key:"setPositionAboveCursor",value:function(cursor){var e=this.offset.above+cursor.top-this.container.offsetHeight;this.isSubMenu()&&(e=cursor.top+cursor.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(e,"px")}},{key:"setPositionBelowCursor",value:function(cursor){var e=this.offset.below+cursor.top+1;this.isSubMenu()&&(e=cursor.top-1),this.container.style.top="".concat(e,"px")}},{key:"setPositionOnRightOfCursor",value:function(cursor){var e=cursor.left;if(this.isSubMenu()){var t=this.parentMenu.container.getBoundingClientRect().right;e+=cursor.cellWidth+t-(cursor.left+cursor.cellWidth)}else e+=this.offset.right;this.container.style.left="".concat(e,"px")}},{key:"setPositionOnLeftOfCursor",value:function(cursor){var e=this.offset.left+cursor.left-this.container.offsetWidth;if(this.isSubMenu()){var t=this.parentMenu.container.getBoundingClientRect().left;e-=cursor.left-t}this.container.style.left="".concat(e,"px")}},{key:"selectFirstCell",value:function(){var e=this.hotMenu.getCell(0,0);Object(y.j)(e)||Object(y.g)(e)||Object(y.i)(e)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var e=this.hotMenu.countRows()-1,t=this.hotMenu.getCell(e,0);Object(y.j)(t)||Object(y.g)(t)||Object(y.i)(t)?this.selectPrevCell(e,0):(this.hotMenu.selectCell(e,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(e,0,!0,!1))}},{key:"selectNextCell",value:function(e,col){var t=e+1,n=t<this.hotMenu.countRows()?this.hotMenu.getCell(t,col):null;n&&(Object(y.j)(n)||Object(y.g)(n)||Object(y.i)(n)?this.selectNextCell(t,col):this.hotMenu.selectCell(t,col))}},{key:"selectPrevCell",value:function(e,col){var t=e-1,n=t>=0?this.hotMenu.getCell(t,col):null;n&&(Object(y.j)(n)||Object(y.g)(n)||Object(y.i)(n)?this.selectPrevCell(t,col):this.hotMenu.selectCell(t,col))}},{key:"menuItemRenderer",value:function(e,t,n,col,o,l){var c,h=this,d=e.getSourceDataAtRow(n),y=this.hot.rootDocument.createElement("div"),v=function(e){return e.disableSelection},m=l;"function"==typeof m&&(m=m.call(this.hot)),Object(r.e)(t),Object(r.a)(y,"htItemWrapper"),t.appendChild(y),c=d,new RegExp(f.a,"i").test(c.name)?Object(r.a)(t,"htSeparator"):"function"==typeof d.renderer?(Object(r.a)(t,"htCustomMenuRenderer"),t.appendChild(d.renderer(e,y,n,col,o,m))):Object(r.f)(y,m),function(e){return!0===e.disabled||"function"==typeof e.disabled&&!0===e.disabled.call(h.hot)}(d)?(Object(r.a)(t,"htDisabled"),this.eventManager.addEventListener(t,"mouseenter",(function(){return e.deselectCell()}))):v(d)?(Object(r.a)(t,"htSelectionDisabled"),this.eventManager.addEventListener(t,"mouseenter",(function(){return e.deselectCell()}))):function(e){return Object(R.j)(e,"submenu")}(d)?(Object(r.a)(t,"htSubmenu"),v(d)?this.eventManager.addEventListener(t,"mouseenter",(function(){return e.deselectCell()})):this.eventManager.addEventListener(t,"mouseenter",(function(){return e.selectCell(n,col,void 0,void 0,!1,!1)}))):(Object(r.K)(t,["htSubmenu","htDisabled"]),v(d)?this.eventManager.addEventListener(t,"mouseenter",(function(){return e.deselectCell()})):this.eventManager.addEventListener(t,"mouseenter",(function(){return e.selectCell(n,col,void 0,void 0,!1,!1)})))}},{key:"createContainer",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=this.options.container.ownerDocument,o=t;return o&&(Object(S.d)(o)&&(o=null===(o=o.call(this.hot))||Object(E.e)(o)?"":o.toString()),o=o.replace(/[^A-z0-9]/g,"_"),o="".concat(this.options.className,"Sub_").concat(o),e=n.querySelector(".".concat(this.options.className,".").concat(o))),e||(e=n.createElement("div"),Object(r.a)(e,"htMenu ".concat(this.options.className)),o&&Object(r.a)(e,o),this.options.container.appendChild(e)),e}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onAfterInit",value:function(){var e=this.hotMenu.view._wt.wtTable,data=this.hotMenu.getSettings().data,t=e.hider.style,n=e.holder.style,r=parseInt(t.width,10),o=Object(w.d)(data,(function(e,t){return e+(t.name===f.a?1:26)}),0);n.width="".concat(r+3,"px"),n.height="".concat(o+3,"px"),t.height=n.height}},{key:"onAfterSelection",value:function(e,t,n,r,o){!1===this.keyEvent&&(o.value=!0)}},{key:"onDocumentMouseDown",value:function(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Object(r.B)(e.target,this.hotMenu.rootElement)?this.close(!0):!this.isAllSubMenusClosed()&&!this.isSubMenu()||Object(r.B)(e.target,".htMenu")||this.close(!0))}},{key:"onDocumentContextMenu",value:function(e){this.isOpened()&&Object(r.v)(e.target,"htCore")&&Object(r.B)(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}],n&&x(t.prototype,n),o&&x(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();Object(R.n)(I,T.a);t.a=I},741:function(e,t,n){"use strict";var r=n(19),o=n(298),l=n(221).getWeakData,c=n(23),h=n(37),d=n(180),f=n(62),y=n(123),v=n(38),m=n(91),w=m.set,O=m.getterFor,C=y.find,S=y.findIndex,E=r([].splice),R=0,T=function(e){return e.frozen||(e.frozen=new k)},k=function(){this.entries=[]},j=function(e,t){return C(e.entries,(function(e){return e[0]===t}))};k.prototype={get:function(e){var t=j(this,e);if(t)return t[1]},has:function(e){return!!j(this,e)},set:function(e,t){var n=j(this,e);n?n[1]=t:this.entries.push([e,t])},delete:function(e){var t=S(this.entries,(function(t){return t[0]===e}));return~t&&E(this.entries,t,1),!!~t}},e.exports={getConstructor:function(e,t,n,r){var y=e((function(e,o){d(e,m),w(e,{type:t,id:R++,frozen:void 0}),null!=o&&f(o,e[r],{that:e,AS_ENTRIES:n})})),m=y.prototype,C=O(t),S=function(e,t,n){var r=C(e),data=l(c(t),!0);return!0===data?T(r).set(t,n):data[r.id]=n,e};return o(m,{delete:function(e){var t=C(this);if(!h(e))return!1;var data=l(e);return!0===data?T(t).delete(e):data&&v(data,t.id)&&delete data[t.id]},has:function(e){var t=C(this);if(!h(e))return!1;var data=l(e);return!0===data?T(t).has(e):data&&v(data,t.id)}}),o(m,n?{get:function(e){var t=C(this);if(h(e)){var data=l(e);return!0===data?T(t).get(e):data?data[t.id]:void 0}},set:function(e,t){return S(this,e,t)}}:{add:function(e){return S(this,e,!0)}}),y}}},742:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return y}));n(28),n(21),n(36),n(290);var r,o=n(617),l=n(601),c=n(678),h=n(649);function d(e,t){return Object(l.o)(t,(function(t,n){Object(o.e)(e[n])&&(e[n]=t)})),e}function f(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(e);return t?"".concat(t[1].toLowerCase(),"-").concat(t[2].toUpperCase()):e}function y(e){var t,n;Object(o.b)(e)&&Object(c.a)(Object(h.a)(r||(t=['Language with code "','" was not found. You should register particular language \n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'],(n=['Language with code "','" was not found. You should register particular language\\x20\n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'])||(n=t.slice(0)),r=Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(n)}}))),e))}},743:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));n(606),n(604),n(4),n(110),n(7),n(46),n(53),n(212),n(32),n(35);var r=n(693),o=n(607);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e,p){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},d(e,p)}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v(e);if(t){var o=v(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return y(this,n)}}function y(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(y,e);var t,n,r,l=f(y);function y(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return c(this,y),l.call(this,e)}return t=y,(n=[{key:"getHiddenIndexes",value:function(){return Object(o.d)(this.getValues(),(function(e,t,n){return t&&e.push(n),e}),[])}}])&&h(t.prototype,n),r&&h(t,r),Object.defineProperty(t,"prototype",{writable:!1}),y}(r.a)},744:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return d}));n(28),n(36),n(60),n(33),n(52),n(7),n(46),n(4),n(53),n(212),n(32),n(35),n(42),n(27),n(21);var r=n(636),o=n(607);function l(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function h(e,t,n,o){var c=n.length?n[0]:void 0;return[].concat(l(e.slice(0,c)),l(n.map((function(e,t){return Object(r.d)(o)?o(e,t):o}))),l(void 0===c?[]:e.slice(c)))}function d(e,t){return Object(o.b)(e,(function(e,n){return!1===t.includes(n)}))}},745:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));n(28),n(60),n(212),n(4),n(35),n(33),n(52),n(214),n(606),n(604),n(110),n(623),n(12),n(7),n(46),n(53),n(32),n(42),n(36),n(27),n(21);var r=n(683),o=n(744),l=n(692),c=n(815),h=n(636);function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function f(e){return function(e){if(Array.isArray(e))return y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function w(){return w="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var base=O(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},w.apply(this,arguments)}function O(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=T(object)););return object}function C(e,p){return C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},C(e,p)}function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T(e);if(t){var o=T(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return E(this,n)}}function E(e,t){if(t&&("object"===d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return R(e)}function R(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function T(e){return T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},T(e)}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var j=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&C(e,t)}(y,e);var t,n,r,d=S(y);function y(){var e;v(this,y);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return k(R(e=d.call.apply(d,[this].concat(n))),"orderOfIndexes",[]),e}return t=y,n=[{key:"getValues",value:function(){var e=this;return this.orderOfIndexes.map((function(t){return e.indexedValues[t]}))}},{key:"setValues",value:function(e){this.orderOfIndexes=f(Array(e.length).keys()),w(T(y.prototype),"setValues",this).call(this,e)}},{key:"setValueAtIndex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length&&(this.indexedValues[e]=t,!1===this.orderOfIndexes.includes(e)&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0)}},{key:"clearValue",value:function(e){this.orderOfIndexes=Object(l.b)(this.orderOfIndexes,[e]),Object(h.d)(this.initValueOrFn)?w(T(y.prototype),"setValueAtIndex",this).call(this,e,this.initValueOrFn(e)):w(T(y.prototype),"setValueAtIndex",this).call(this,e,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,w(T(y.prototype),"setDefaultValues",this).call(this,e)}},{key:"insert",value:function(e,t){this.indexedValues=Object(o.a)(this.indexedValues,e,t,this.initValueOrFn),this.orderOfIndexes=Object(c.b)(this.orderOfIndexes,t),w(T(y.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){this.indexedValues=Object(o.b)(this.indexedValues,e),this.orderOfIndexes=Object(l.b)(this.orderOfIndexes,e),this.orderOfIndexes=Object(c.a)(this.orderOfIndexes,e),w(T(y.prototype),"remove",this).call(this,e)}},{key:"getEntries",value:function(){var e=this;return this.orderOfIndexes.map((function(t){return[t,e.getValueAtIndex(t)]}))}}],n&&m(t.prototype,n),r&&m(t,r),Object.defineProperty(t,"prototype",{writable:!1}),y}(r.a)},746:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));n(606),n(604),n(4),n(110),n(7),n(46),n(53),n(212),n(32),n(35);var r=n(693),o=n(607);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e,p){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},d(e,p)}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v(e);if(t){var o=v(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return y(this,n)}}function y(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(y,e);var t,n,r,l=f(y);function y(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return c(this,y),l.call(this,e)}return t=y,(n=[{key:"getTrimmedIndexes",value:function(){return Object(o.d)(this.getValues(),(function(e,t,n){return t&&e.push(n),e}),[])}}])&&h(t.prototype,n),r&&h(t,r),Object.defineProperty(t,"prototype",{writable:!1}),y}(r.a)},747:function(e,t,n){"use strict";n(212),n(4),n(32),n(626),n(35);function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,f(e,t,"get"))}function d(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,f(e,t,"set"),n),n}function f(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var y=new WeakMap,v=function(){function e(t,n){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r(this,e),c(this,"row",null),c(this,"col",null),l(this,y,{writable:!0,value:!1}),d(this,y,o),void 0!==t&&void 0!==n&&(this.row=t,this.col=n)}var t,n,f;return t=e,(n=[{key:"isValid",value:function(e){return!(this.row<0||this.col<0||this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns"))}},{key:"isEqual",value:function(e){return e===this||this.row===e.row&&this.col===e.col}},{key:"isSouthEastOf",value:function(e){return this.row>=e.row&&(h(this,y)?this.col<=e.col:this.col>=e.col)}},{key:"isNorthWestOf",value:function(e){return this.row<=e.row&&(h(this,y)?this.col>=e.col:this.col<=e.col)}},{key:"isSouthWestOf",value:function(e){return this.row>=e.row&&(h(this,y)?this.col>=e.col:this.col<=e.col)}},{key:"isNorthEastOf",value:function(e){return this.row<=e.row&&(h(this,y)?this.col<=e.col:this.col>=e.col)}},{key:"normalize",value:function(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new e(this.row,this.col,h(this,y))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}])&&o(t.prototype,n),f&&o(t,f),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.a=v},748:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var r=1,o=2},749:function(e,t,n){"use strict";n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return y})),n.d(t,"b",(function(){return v}));n(217),n(21),n(70),n(101),n(60),n(8),n(65),n(4),n(28),n(214),n(111),n(817),n(819),n(42),n(32),n(9),n(213),n(33),n(52),n(7),n(46),n(53),n(212),n(35),n(36),n(27);var r=n(617);function o(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var c={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},h=new RegExp(Object.keys(c).map((function(e){return"(".concat(e,")")})).join("|"),"gi");function d(element){return"TABLE"===(element&&element.nodeName||"")}function f(e){for(var t=e.hasColHeaders(),n=e.hasRowHeaders(),o=[t?-1:0,n?-1:0,e.countRows()-1,e.countCols()-1],data=e.getData.apply(e,o),l=data.length,c=l>0?data[0].length:0,h=["<table>","</table>"],d=t?["<thead>","</thead>"]:[],f=["<tbody>","</tbody>"],y=n?1:0,v=t?1:0,m=0;m<l;m+=1){for(var w=t&&0===m,O=[],C=0;C<c;C+=1){var S=!w&&n&&0===C,E="";if(w)E="<th>".concat(e.getColHeader(C-y),"</th>");else if(S)E="<th>".concat(e.getRowHeader(m-v),"</th>");else{var R=data[m][C],T=e.getCellMeta(m-v,C-y),k=T.hidden,j=T.rowspan,A=T.colspan;if(!k){var x=[];if(j&&x.push('rowspan="'.concat(j,'"')),A&&x.push('colspan="'.concat(A,'"')),Object(r.c)(R))E="<td ".concat(x.join(" "),"></td>");else{var M=R.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");E="<td ".concat(x.join(" "),">").concat(M,"</td>")}}}O.push(E)}var I=["<tr>"].concat(O,["</tr>"]).join("");w?d.splice(1,0,I):f.splice(-1,0,I)}return h.splice(1,0,d.join(""),f.join("")),h.join("")}function y(input){for(var e=input.length,t=["<table>"],n=0;n<e;n+=1){var o=input[n],l=o.length,c=[];0===n&&t.push("<tbody>");for(var h=0;h<l;h+=1){var d=o[h],f=Object(r.c)(d)?"":d.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");c.push("<td>".concat(f,"</td>"))}t.push.apply(t,["<tr>"].concat(c,["</tr>"])),n+1===e&&t.push("</tbody>")}return t.push("</table>"),t.join("")}function v(element){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,t={},n=e.createDocumentFragment(),r=e.createElement("div");n.appendChild(r);var l=element;if("string"==typeof l){var f=l.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,(function(e){var t=e.match(/<td\b[^>]*?>/g)[0],n=e.substring(t.length,e.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return"".concat(t).concat(n).concat("</td>")}));r.insertAdjacentHTML("afterbegin","".concat(f)),l=r.querySelector("table")}if(l&&d(l)){var y=r.querySelector('meta[name$="enerator"]'),v=null!==l.querySelector("tbody th"),m=l.querySelector("tr"),w=m?Array.from(m.cells).reduce((function(e,t){return e+t.colSpan}),0)-(v?1:0):0,O=l.tFoot&&Array.from(l.tFoot.rows)||[],C=[],S=!1,E=0,R=0;if(l.tHead){var T=Array.from(l.tHead.rows).filter((function(tr){var e=null!==tr.querySelector("td");return e&&C.push(tr),!e}));S=(E=T.length)>0,E>1?t.nestedHeaders=Array.from(T).reduce((function(e,t){var n=Array.from(t.cells).reduce((function(e,header,t){if(v&&0===t)return e;var n=header.colSpan,r=header.innerHTML,o=n>1?{label:r,colspan:n}:r;return e.push(o),e}),[]);return e.push(n),e}),[]):S&&(t.colHeaders=Array.from(T[0].children).reduce((function(e,header,t){return v&&0===t||e.push(header.innerHTML),e}),[]))}C.length&&(t.fixedRowsTop=C.length),O.length&&(t.fixedRowsBottom=O.length);var k=[].concat(C,o(Array.from(l.tBodies).reduce((function(e,section){return e.push.apply(e,o(Array.from(section.rows))),e}),[])),o(O));R=k.length;for(var j=new Array(R),A=0;A<R;A++)j[A]=new Array(w);for(var x=[],M=[],I=0;I<R;I++)for(var tr=k[I],_=Array.from(tr.cells),N=_.length,H=0;H<N;H++){var P=_[H],D=P.nodeName,L=P.innerHTML,B=P.rowSpan,V=P.colSpan,col=j[I].findIndex((function(e){return void 0===e}));if("TD"===D){if(B>1||V>1){for(var F=I;F<I+B;F++)if(F<R)for(var W=col;W<col+V;W++)j[F][W]=null;var z=P.getAttribute("style"),U=z&&z.includes("mso-ignore:colspan");U||x.push({col:col,row:I,rowspan:B,colspan:V})}var G="";G=y&&/excel/gi.test(y.content)?L.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):L.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),j[I][col]=G.replace(h,(function(e){return c[e]}))}else M.push(L)}return x.length&&(t.mergeCells=x),M.length&&(t.rowHeaders=M),j.length&&(t.data=j),t}}},750:function(e,t,n){n(823)},751:function(e,t,n){"use strict";n(21),n(61),n(101);var r=n(607),o=n(601);function l(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=t,this.commands={},this.commonCallback=null}var t,n,c;return t=e,n=[{key:"registerCommand",value:function(e,t){this.commands[e]=t}},{key:"setCommonCallback",value:function(e){this.commonCallback=e}},{key:"execute",value:function(e){for(var t=this,n=arguments.length,l=new Array(n>1?n-1:0),c=1;c<n;c++)l[c-1]=arguments[c];var d=e.split(":"),f=d[0],y=2===d.length?d[1]:null,v=this.commands[f];if(!v)throw new Error("Menu command '".concat(f,"' not exists."));if(y&&v.submenu&&(v=h(y,v.submenu.items)),!0!==v.disabled&&("function"!=typeof v.disabled||!0!==v.disabled.call(this.hot))&&!Object(o.j)(v,"submenu")){var m=[];"function"==typeof v.callback&&m.push(v.callback),"function"==typeof this.commonCallback&&m.push(this.commonCallback),l.unshift(d.join(":")),Object(r.a)(m,(function(e){return e.apply(t.hot,l)}))}}}],n&&l(t.prototype,n),c&&l(t,c),Object.defineProperty(t,"prototype",{writable:!1}),e}();function h(e,t){var n;return Object(r.a)(t,(function(t){var r=t.key?t.key.split(":"):null;if(Array.isArray(r)&&r[1]===e)return n=t,!1})),n}t.a=c},752:function(e,t,n){"use strict";n(27),n(622);var r=n(601),o=n(607),l=n(656),c=n(684);function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var f=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;h(this,e),this.hot=t,this.predefinedItems=Object(l.b)(),this.defaultOrderPattern=n}var t,n,o;return t=e,n=[{key:"setPredefinedItems",value:function(e){var t=this,n={};this.defaultOrderPattern.length=0,Object(r.o)(e,(function(e,r){var o="";e.name===c.a?(n[c.a]=e,o=c.a):isNaN(parseInt(r,10))?(e.key=void 0===e.key?r:e.key,n[r]=e,o=e.key):(n[e.key]=e,o=e.key),t.defaultOrderPattern.push(o)})),this.predefinedItems=n}},{key:"getItems",value:function(){var pattern=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return y(pattern,this.defaultOrderPattern,this.predefinedItems)}}],n&&d(t.prototype,n),o&&d(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=[],pattern=e;return pattern&&pattern.items?pattern=pattern.items:Array.isArray(pattern)||(pattern=t),Object(r.l)(pattern)?Object(r.o)(pattern,(function(e,t){var o=n["string"==typeof e?e:t];o||(o=e),Object(r.l)(e)?Object(r.h)(o,e):"string"==typeof o&&(o={name:o}),void 0===o.key&&(o.key=t),c.push(o)})):Object(o.a)(pattern,(function(e,t){var o=n[e];!o&&l.a.indexOf(e)>=0||(o||(o={name:e,key:"".concat(t)}),Object(r.l)(e)&&Object(r.h)(o,e),void 0===o.key&&(o.key=t),c.push(o))})),c}t.a=f},756:function(e,t,n){"use strict";n.d(t,"a",(function(){return fs}));n(33),n(292),n(214),n(377),n(22),n(36),n(28),n(378),n(60),n(21),n(65),n(42),n(32),n(622),n(690),n(4),n(10),n(59),n(811),n(212),n(269),n(35),n(7),n(46),n(53),n(27);var r=n(605),o=n(636),l=n(617),c=n(650),h=n(682),d=n(639),object=n(601),f=n(607),y=n(749),v=n(775),m=n(711),w=n(712),O=n(643),C=n(630),S=(n(626),n(645)),E=(n(606),n(604),n(110),n(662));function R(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var k=new WeakMap,j=function(){function e(t,n,r,o,l,c){var h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;R(this,e),this.wtSettings=r,this.domBindings=n,this.wtTable=l,this.selections=c,this.parent=h,this.eventManager=o,this.facadeGetter=t,k.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}var t,n,h;return t=e,(n=[{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",(function(t){return e.onContextMenu(t)})),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",(function(t){return e.onMouseOver(t)})),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",(function(t){return e.onMouseOut(t)}));var t=function(){e.eventManager.addEventListener(e.wtTable.holder,"touchstart",(function(t){return e.onTouchStart(t)})),e.eventManager.addEventListener(e.wtTable.holder,"touchend",(function(t){return e.onTouchEnd(t)})),e.momentumScrolling||(e.momentumScrolling={}),e.eventManager.addEventListener(e.wtTable.holder,"scroll",(function(){clearTimeout(e.momentumScrolling._timeout),e.momentumScrolling.ongoing||e.wtSettings.getSetting("onBeforeTouchScroll"),e.momentumScrolling.ongoing=!0,e.momentumScrolling._timeout=setTimeout((function(){e.touchApplied||(e.momentumScrolling.ongoing=!1,e.wtSettings.getSetting("onAfterMomentumScroll"))}),200)}))};Object(c.k)()?t():(Object(E.h)()&&t(),e.eventManager.addEventListener(e.wtTable.holder,"mouseup",(function(t){return e.onMouseUp(t)})),e.eventManager.addEventListener(e.wtTable.holder,"mousedown",(function(t){return e.onMouseDown(t)})))}},{key:"selectedCellWasTouched",value:function(e){var t=k.get(this),n=this.parentCell(e).coords;if(t.selectedCellBeforeTouchEnd&&n){var r=[n.row,t.selectedCellBeforeTouchEnd.from.row],o=r[0],l=r[1],c=[n.col,t.selectedCellBeforeTouchEnd.from.col];return o===l&&c[0]===c[1]}return!1}},{key:"parentCell",value:function(e){var t={},n=this.wtTable.TABLE,o=Object(r.d)(e,["TD","TH"],n);return o?(t.coords=this.wtTable.getCoords(o),t.TD=o):Object(r.v)(e,"wtBorder")&&Object(r.v)(e,"current")?(t.coords=this.selections.getCell().cellRange.highlight,t.TD=this.wtTable.getCell(t.coords)):Object(r.v)(e,"wtBorder")&&Object(r.v)(e,"area")&&this.selections.createOrGetArea().cellRange&&(t.coords=this.selections.createOrGetArea().cellRange.to,t.TD=this.wtTable.getCell(t.coords)),t}},{key:"onMouseDown",value:function(e){var t=k.get(this),n=this.domBindings.rootDocument.activeElement,l=Object(o.e)(r.j,e.target),c=e.target;if(c!==n&&l(0)!==n&&l(1)!==n){var h=this.parentCell(c);Object(r.v)(c,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",e,c):h.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,h.coords,h.TD),(0===e.button||this.touchApplied)&&h.TD&&(t.dblClickOrigin[0]=h.TD,clearTimeout(t.dblClickTimeout[0]),t.dblClickTimeout[0]=setTimeout((function(){t.dblClickOrigin[0]=null}),1e3))}}},{key:"onContextMenu",value:function(e){if(this.wtSettings.has("onCellContextMenu")){var t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}},{key:"onMouseOver",value:function(e){if(this.wtSettings.has("onCellMouseOver")){var table=this.wtTable.TABLE,td=Object(r.d)(e.target,["TD","TH"],table),t=this.parent||this;td&&td!==t.lastMouseOver&&Object(r.B)(td,table)&&(t.lastMouseOver=td,this.callListener("onCellMouseOver",e,this.wtTable.getCoords(td),td))}}},{key:"onMouseOut",value:function(e){if(this.wtSettings.has("onCellMouseOut")){var table=this.wtTable.TABLE,t=Object(r.d)(e.target,["TD","TH"],table),n=Object(r.d)(e.relatedTarget,["TD","TH"],table);t&&t!==n&&Object(r.B)(t,table)&&this.callListener("onCellMouseOut",e,this.wtTable.getCoords(t),t)}}},{key:"onMouseUp",value:function(e){var t=k.get(this),n=this.parentCell(e.target);n.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),(0===e.button||this.touchApplied)&&(n.TD===t.dblClickOrigin[0]&&n.TD===t.dblClickOrigin[1]?(Object(r.v)(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),t.dblClickOrigin[0]=null,t.dblClickOrigin[1]=null):n.TD===t.dblClickOrigin[0]&&(t.dblClickOrigin[1]=n.TD,clearTimeout(t.dblClickTimeout[1]),t.dblClickTimeout[1]=setTimeout((function(){t.dblClickOrigin[1]=null}),500)))}},{key:"onTouchStart",value:function(e){k.get(this).selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(e)}},{key:"onTouchEnd",value:function(e){var t,n=e.target,r=null===(t=this.parentCell(n))||void 0===t?void 0:t.coords,o=Object(l.b)(r)&&r.row>=0&&r.col>=0;e.cancelable&&o&&this.wtSettings.getSetting("isDataViewInstance")&&(Object(c.h)()&&(Object(c.b)()||Object(c.e)())&&this.selectedCellWasTouched(n)&&!["A","BUTTON","INPUT"].includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()),this.onMouseUp(e),this.touchApplied=!1}},{key:"callListener",value:function(e,t,n,r){var o=this.wtSettings.getSettingPure(e);o&&o(t,n,r,this.facadeGetter())}},{key:"destroy",value:function(){var e=k.get(this);clearTimeout(e.dblClickTimeout[0]),clearTimeout(e.dblClickTimeout[1]),this.eventManager.destroy()}}])&&T(t.prototype,n),h&&T(t,h),Object.defineProperty(t,"prototype",{writable:!1}),e}(),A=j,x=n(670);function M(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var I=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.offset=t,this.total=n,this.countTH=r}var t,n,r;return t=e,(n=[{key:"offsetted",value:function(e){return e+this.offset}},{key:"unOffsetted",value:function(e){return e-this.offset}},{key:"renderedToSource",value:function(e){return this.offsetted(e)}},{key:"sourceToRendered",value:function(e){return this.unOffsetted(e)}},{key:"offsettedTH",value:function(e){return e-this.countTH}},{key:"unOffsettedTH",value:function(e){return e+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(e){return this.renderedToSource(this.offsettedTH(e))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}}])&&M(t.prototype,n),r&&M(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function _(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var N=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.offset=t,this.total=n,this.countTH=r}var t,n,r;return t=e,(n=[{key:"offsetted",value:function(e){return e+this.offset}},{key:"unOffsetted",value:function(e){return e-this.offset}},{key:"renderedToSource",value:function(e){return this.offsetted(e)}},{key:"sourceToRendered",value:function(e){return this.unOffsetted(e)}},{key:"offsettedTH",value:function(e){return e-this.countTH}},{key:"unOffsettedTH",value:function(e){return e+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(e){return this.renderedToSource(this.offsettedTH(e))}},{key:"sourceRowToVisibleColHeadedRow",value:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}}])&&_(t.prototype,n),r&&_(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function H(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var P=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}var t,n,r;return t=e,(n=[{key:"setSize",value:function(e){this.currentSize=this.nextSize,this.nextSize=e}},{key:"setOffset",value:function(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}])&&H(t.prototype,n),r&&H(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function D(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var L=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.size=new P,this.workingSpace=0,this.sharedSize=null}var t,n,r;return t=e,(n=[{key:"setSize",value:function(e){this.size.setSize(e)}},{key:"setOffset",value:function(e){this.size.setOffset(e)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof P}},{key:"isPlaceOn",value:function(e){return this.workingSpace===e}},{key:"append",value:function(e){this.workingSpace=1,e.workingSpace=2,this.sharedSize=e.getViewSize()}},{key:"prepend",value:function(e){this.workingSpace=2,e.workingSpace=1,this.sharedSize=e.getViewSize()}}])&&D(t.prototype,n),r&&D(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function B(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var V=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootNode=t,this.nodesPool=n,this.sizeSet=new L,this.childNodeType=r.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}var t,n,r;return t=e,(n=[{key:"setSize",value:function(e){return this.sizeSet.setSize(e),this}},{key:"setOffset",value:function(e){return this.sizeSet.setOffset(e),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}},{key:"getCurrentNode",value:function(){var e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}},{key:"getRenderedChildCount",value:function(){var e=this.rootNode,t=this.sizeSet,n=0;if(this.isSharedViewSet())for(var element=e.firstElementChild;element;){if(element.tagName===this.childNodeType)n+=1;else if(t.isPlaceOn(1))break;element=element.nextElementSibling}else n=e.childElementCount;return n}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var e=this.rootNode,t=this.sizeSet,n=this.isSharedViewSet(),r=t.getViewSize().nextSize,o=this.getRenderedChildCount();o<r;){var l=this.nodesPool();!n||n&&t.isPlaceOn(2)?e.appendChild(l):e.insertBefore(l,e.firstChild),o+=1}for(var c=n&&t.isPlaceOn(1);o>r;)e.removeChild(c?e.firstChild:e.lastChild),o-=1}},{key:"render",value:function(){var e=this.rootNode,t=this.sizeSet,n=this.visualIndex;this.isSharedViewSet()&&t.isPlaceOn(2)&&(n+=t.sharedSize.nextSize);var r=e.childNodes[n];if(r.tagName!==this.childNodeType){var o=this.nodesPool();e.replaceChild(o,r),r=o}this.collectedNodes.push(r),this.visualIndex+=1}},{key:"end",value:function(){}}])&&B(t.prototype,n),r&&B(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function F(e){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F(e)}function W(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function z(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function U(e,p){return U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},U(e,p)}function G(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=K(e);if(t){var o=K(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return X(this,n)}}function X(e,t){if(t&&("object"===F(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function K(e){return K=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},K(e)}var Y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&U(e,t)}(l,e);var t,n,r,o=G(l);function l(){return W(this,l),o.apply(this,arguments)}return t=l,(n=[{key:"prependView",value:function(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}])&&z(t.prototype,n),r&&z(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(V);function $(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Q=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.nodeType=t.toUpperCase()}var t,n,r;return t=e,(n=[{key:"setRootDocument",value:function(e){this.rootDocument=e}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}])&&$(t.prototype,n),r&&$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function J(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Z=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.nodesPool="string"==typeof t?new Q(t):null,this.nodeType=t,this.rootNode=n,this.table=null,this.renderedNodes=0}var t,n,r;return t=e,(n=[{key:"setTable",value:function(table){this.nodesPool&&this.nodesPool.setRootDocument(table.rootDocument),this.table=table}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}])&&J(t.prototype,n),r&&J(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ee(e){return ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ee(e)}function te(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ne(e,p){return ne=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},ne(e,p)}function re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ie(e);if(t){var o=ie(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return oe(this,n)}}function oe(e,t){if(t&&("object"===ee(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ie(e){return ie=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ie(e)}var ae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ne(e,t)}(l,e);var t,n,r,o=re(l);function l(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(e=o.call(this,"TH")).orderViews=new WeakMap,e.sourceRowIndex=0,e}return t=l,(n=[{key:"obtainOrderView",value:function(e){var t,n=this;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new Y(e,(function(e){return n.nodesPool.obtain(n.sourceRowIndex,e)}),this.nodeType),this.orderViews.set(e,t)),t}},{key:"render",value:function(){for(var e=this.table,t=e.rowsToRender,n=e.rowHeaderFunctions,r=e.rowHeadersCount,o=e.rows,l=e.cells,c=0;c<t;c++){var h=this.table.renderedRowToSource(c),d=o.getRenderedNode(c);this.sourceRowIndex=h;var f=this.obtainOrderView(d),y=l.obtainOrderView(d);f.appendView(y).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(var v=0;v<r;v++){f.render();var m=f.getCurrentNode();m.className="",m.removeAttribute("style"),n[v](h,m,v)}f.end()}}}])&&te(t.prototype,n),r&&te(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(Z);function le(e){return le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},le(e)}function se(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ce(e,p){return ce=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},ce(e,p)}function ue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=de(e);if(t){var o=de(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return he(this,n)}}function he(e,t){if(t&&("object"===le(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function de(e){return de=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},de(e)}var fe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ce(e,t)}(c,e);var t,n,o,l=ue(c);function c(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),l.call(this,null,e)}return t=c,(n=[{key:"adjust",value:function(){var e=this.table,t=e.columnHeadersCount,n=e.rowHeadersCount,o=this.rootNode.firstChild;if(t){for(var l=this.table.columnsToRender+n,i=0,c=t;i<c;i++){for((o=this.rootNode.childNodes[i])||(o=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(o)),this.renderedNodes=o.childNodes.length;this.renderedNodes<l;)o.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>l;)o.removeChild(o.lastChild),this.renderedNodes-=1}var h=this.rootNode.childNodes.length;if(h>t)for(var d=t;d<h;d++)this.rootNode.removeChild(this.rootNode.lastChild)}else o&&Object(r.e)(o)}},{key:"render",value:function(){for(var e=this.table.columnHeadersCount,t=0;t<e;t+=1)for(var n=this.table,r=n.columnHeaderFunctions,o=n.columnsToRender,l=n.rowHeadersCount,c=this.rootNode.childNodes[t],h=-1*l;h<o;h+=1){var d=this.table.renderedColumnToSource(h),f=c.childNodes[h+l];f.className="",f.removeAttribute("style"),r[t](d,f,t)}}}])&&se(t.prototype,n),o&&se(t,o),Object.defineProperty(t,"prototype",{writable:!1}),c}(Z);function pe(e){return pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pe(e)}function be(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ye(e,p){return ye=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},ye(e,p)}function ge(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=me(e);if(t){var o=me(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ve(this,n)}}function ve(e,t){if(t&&("object"===pe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function me(e){return me=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},me(e)}var we,Oe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ye(e,t)}(c,e);var t,n,o,l=ge(c);function c(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),l.call(this,null,e)}return t=c,(n=[{key:"adjust",value:function(){for(var e=this.table,t=e.columnsToRender+e.rowHeadersCount;this.renderedNodes<t;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>t;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var e=this.table,t=e.columnsToRender,n=e.rowHeadersCount,o=0;o<n;o++){var l=this.table.renderedColumnToSource(o),c=this.table.columnUtils.getHeaderWidth(l);this.rootNode.childNodes[o].style.width="".concat(c,"px")}for(var h=0;h<t;h++){var d=this.table.renderedColumnToSource(h),f=this.table.columnUtils.getStretchedColumnWidth(d);this.rootNode.childNodes[h+n].style.width="".concat(f,"px")}var y=this.rootNode.firstChild;y&&Object(r.a)(y,"rowHeader")}}])&&be(t.prototype,n),o&&be(t,o),Object.defineProperty(t,"prototype",{writable:!1}),c}(Z),Ce=(n(290),n(678)),Se=n(649);function Ee(e){return Ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ee(e)}function Re(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Te(e,p){return Te=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},Te(e,p)}function ke(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ae(e);if(t){var o=Ae(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return je(this,n)}}function je(e,t){if(t&&("object"===Ee(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ae(e){return Ae=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ae(e)}var xe=!1,Me=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Te(e,t)}(l,e);var t,n,r,o=ke(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=o.call(this,"TR",e)).orderView=new V(e,(function(e){return t.nodesPool.obtain(e)}),t.nodeType),t}return t=l,(n=[{key:"getRenderedNode",value:function(e){return this.orderView.getNode(e)}},{key:"render",value:function(){var e,t,n=this.table.rowsToRender;!xe&&n>1e3&&(xe=!0,Object(Ce.b)(Object(Se.a)(we||(e=['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting \n        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.'],(t=['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20\n        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.'])||(t=e.slice(0)),we=Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}})))))),this.orderView.setSize(n).setOffset(this.table.renderedRowToSource(0)).start();for(var r=0;r<n;r++)this.orderView.render();this.orderView.end()}}])&&Re(t.prototype,n),r&&Re(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(Z);function Ie(e){return Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ie(e)}function _e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ne(e,p){return Ne=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},Ne(e,p)}function He(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=De(e);if(t){var o=De(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Pe(this,n)}}function Pe(e,t){if(t&&("object"===Ie(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function De(e){return De=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},De(e)}var Le=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ne(e,t)}(c,e);var t,n,o,l=He(c);function c(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(e=l.call(this,"TD")).orderViews=new WeakMap,e.sourceRowIndex=0,e}return t=c,(n=[{key:"obtainOrderView",value:function(e){var t,n=this;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new Y(e,(function(e){return n.nodesPool.obtain(n.sourceRowIndex,e)}),this.nodeType),this.orderViews.set(e,t)),t}},{key:"render",value:function(){for(var e=this.table,t=e.rowsToRender,n=e.columnsToRender,o=e.rows,l=e.rowHeaders,c=0;c<t;c++){var h=this.table.renderedRowToSource(c),d=o.getRenderedNode(c);this.sourceRowIndex=h;var f=this.obtainOrderView(d),y=l.obtainOrderView(d);f.prependView(y).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(var v=0;v<n;v++){f.render();var m=f.getCurrentNode(),w=this.table.renderedColumnToSource(v);Object(r.v)(m,"hide")||(m.className=""),m.removeAttribute("style"),m.removeAttribute("dir"),this.table.cellRenderer(h,w,m)}f.end()}}}])&&_e(t.prototype,n),o&&_e(t,o),Object.defineProperty(t,"prototype",{writable:!1}),c}(Z);function Be(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ve(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Fe=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.cellRenderer;Be(this,e),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=r}var t,n,r;return t=e,n=[{key:"setAxisUtils",value:function(e,t){this.rowUtils=e,this.columnUtils=t}},{key:"setViewportSize",value:function(e,t){this.rowsToRender=e,this.columnsToRender=t}},{key:"setFilters",value:function(e,t){this.rowFilter=e,this.columnFilter=t}},{key:"setHeaderContentRenderers",value:function(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}},{key:"setRenderers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.rowHeaders,n=e.columnHeaders,r=e.colGroup,o=e.rows,l=e.cells;t.setTable(this),n.setTable(this),r.setTable(this),o.setTable(this),l.setTable(this),this.rowHeaders=t,this.columnHeaders=n,this.colGroup=r,this.rows=o,this.cells=l}},{key:"renderedRowToSource",value:function(e){return this.rowFilter.renderedToSource(e)}},{key:"renderedColumnToSource",value:function(e){return this.columnFilter.renderedToSource(e)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var e=this.rowsToRender,t=this.rows,n=0;n<e;n++){var r=t.getRenderedNode(n);if(r.firstChild){var o=this.renderedRowToSource(n),l=this.rowUtils.getHeight(o);r.firstChild.style.height=l?"".concat(l-1,"px"):""}}}}],n&&Ve(t.prototype,n),r&&Ve(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function We(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ze(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ue=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.TABLE,r=t.THEAD,o=t.COLGROUP,l=t.TBODY,c=t.rowUtils,h=t.columnUtils,d=t.cellRenderer;We(this,e),this.renderer=new Fe(n,{cellRenderer:d}),this.renderer.setRenderers({rowHeaders:new ae,columnHeaders:new fe(r),colGroup:new Oe(o),rows:new Me(l),cells:new Le}),this.renderer.setAxisUtils(c,h)}var t,n,r;return t=e,(n=[{key:"setFilters",value:function(e,t){return this.renderer.setFilters(e,t),this}},{key:"setViewportSize",value:function(e,t){return this.renderer.setViewportSize(e,t),this}},{key:"setHeaderContentRenderers",value:function(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}])&&ze(t.prototype,n),r&&ze(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ge(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Xe=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dataAccessObject=t,this.wtSettings=n,this.headerWidths=new Map}var t,n,o;return t=e,(n=[{key:"getWidth",value:function(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(e){var t=this.dataAccessObject.wtViewport.columnsRenderCalculator,n=this.getWidth(e);if(t){var r=t.getStretchedColumnWidth(e,n);r&&(n=r)}return n}},{key:"getHeaderHeight",value:function(e){var t=this.wtSettings.getSetting("defaultRowHeight"),n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return void 0!==n&&(t=t?Math.max(t,n):n),t}},{key:"getHeaderWidth",value:function(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}},{key:"calculateWidths",value:function(){var e=this.wtSettings,t=this.dataAccessObject,n=t.wtTable,o=t.wtViewport,l=t.cloneSource,c=l?l.wtTable.holder:n.holder,h=c.offsetHeight<c.scrollHeight?Object(r.o)():0,d=e.getSetting("rowHeaderWidth");if(o.columnsRenderCalculator.refreshStretching(o.getViewportWidth()-h),null!=(d=e.getSetting("onModifyRowHeaderWidth",d)))for(var f=e.getSetting("rowHeaders").length,y=e.getSetting("defaultColumnWidth"),v=0;v<f;v++){var m=Array.isArray(d)?d[v]:d;m=null==m?y:m,this.headerWidths.set(v,m)}}}])&&Ge(t.prototype,n),o&&Ge(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ke(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ye=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dataAccessObject=t,this.wtSettings=n}var t,n,r;return t=e,(n=[{key:"getHeight",value:function(e){var t=this.wtSettings.getSetting("rowHeight",e),n=this.dataAccessObject.wtViewport.oversizedRows[e];return void 0!==n&&(t=void 0===t?n:Math.max(t,n)),t}}])&&Ke(t.prototype,n),r&&Ke(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),qe="top",$e="bottom",Qe="inline_start",Je="top_inline_start_corner",Ze="bottom_inline_start_corner",et=[qe,$e,Qe,Je,Ze],tt=new Map([[qe,"ht_clone_".concat(qe)],[$e,"ht_clone_".concat($e)],[Qe,"ht_clone_".concat(Qe," ht_clone_left")],[Je,"ht_clone_".concat(Je," ht_clone_top_left_corner")],[Ze,"ht_clone_".concat(Ze," ht_clone_bottom_left_corner")]]);function nt(e){return function(e){if(Array.isArray(e))return at(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||it(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ot(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||it(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function it(e,t){if(e){if("string"==typeof e)return at(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?at(e,t):void 0}}function at(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function lt(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function st(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ct=function(){function e(t,n,o,l,c){var h=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),st(this,"wtSettings",null),st(this,"domBindings",void 0),st(this,"TBODY",null),st(this,"THEAD",null),st(this,"COLGROUP",null),st(this,"hasTableHeight",!0),st(this,"hasTableWidth",!0),st(this,"isTableVisible",!1),st(this,"tableOffset",0),st(this,"holderOffset",0),this.domBindings=o,this.isMaster="master"===c,this.name=c,this.dataAccessObject=t,this.facadeGetter=n,this.wtSettings=l,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=o.rootTable,Object(r.L)(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var d=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",(function(){return h._modifyRowHeaderWidth(d)})),this.rowUtils=new Ye(this.dataAccessObject,this.wtSettings),this.columnUtils=new Xe(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Ue({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}var t,n,l;return t=e,n=[{key:"is",value:function(e){return this.name===e}},{key:"fixTableDomTree",value:function(){var e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(table){var e,t=table.parentNode;return t&&t.nodeType===Node.ELEMENT_NODE&&Object(r.v)(t,"wtHolder")||((e=this.domBindings.rootDocument.createElement("div")).className="wtSpreader",t&&t.insertBefore(e,table),e.appendChild(table)),e.style.position="relative",e}},{key:"createHider",value:function(e){var t,n=e.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&Object(r.v)(n,"wtHolder")||((t=this.domBindings.rootDocument.createElement("div")).className="wtHider",n&&n.insertBefore(t,e),t.appendChild(e)),t}},{key:"createHolder",value:function(e){var t,n=e.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&Object(r.v)(n,"wtHolder")||((t=this.domBindings.rootDocument.createElement("div")).style.position="relative",t.className="wtHolder",n&&n.insertBefore(t,e),this.isMaster&&(t.parentNode.className+="ht_master handsontable",t.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),t.appendChild(e)),t}},{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.wtSettings,n=this.dataAccessObject,o=n.wtOverlays,l=n.wtViewport,c=t.getSetting("totalRows"),h=t.getSetting("totalColumns"),d=t.getSetting("rowHeaders"),f=d.length,y=t.getSetting("columnHeaders"),v=y.length,m=!1,w=e;if(this.isMaster&&(this.holderOffset=Object(r.G)(this.holder),w=l.createRenderCalculators(w),f&&!t.getSetting("fixedColumnsStart"))){var O=o.inlineStartOverlay.getScrollPosition(),C=this.correctHeaderWidth;this.correctHeaderWidth=0!==O,C!==this.correctHeaderWidth&&(w=!1)}if(this.isMaster&&(m=o.updateStateOfRendering()),w)this.isMaster&&l.createVisibleCalculators(),o&&o.refresh(!0);else{this.isMaster?this.tableOffset=Object(r.G)(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var S=c>0?this.getFirstRenderedRow():0,E=h>0?this.getFirstRenderedColumn():0;this.rowFilter=new N(S,c,v),this.columnFilter=new I(E,h,f);var R,T=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var k={};this.wtSettings.getSetting("beforeDraw",!0,k),T=!0!==k.skipRender}if(T)if(this.tableRenderer.setHeaderContentRenderers(d,y),(this.is($e)||this.is(Ze))&&this.tableRenderer.setHeaderContentRenderers(d,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&(R=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is($e))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var j=Object(r.I)(this.hider),A=Object(r.I)(this.TABLE);0!==j&&A!==j&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),R!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is($e)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}if(this.isMaster){var x=o.topOverlay.resetFixedPosition();o.bottomOverlay.clone&&(x=o.bottomOverlay.resetFixedPosition()||x),x=o.inlineStartOverlay.resetFixedPosition()||x,o.topInlineStartCornerOverlay&&o.topInlineStartCornerOverlay.resetFixedPosition(),o.bottomInlineStartCornerOverlay&&o.bottomInlineStartCornerOverlay.clone&&o.bottomInlineStartCornerOverlay.resetFixedPosition(),x&&(o.refreshAll(),o.adjustElementsSize())}return this.refreshSelections(w),m&&o.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(col){for(var e,t,n,o=this.columnFilter.renderedToSource(col),l=this.wtSettings.getSetting("columnHeaders").length,c=this.wtSettings.getSetting("defaultRowHeight"),h=this.wtSettings.getSetting("columnHeaderHeight")||[];l;)l-=1,e=this.getColumnHeaderHeight(l),(t=this.getColumnHeader(o,l))&&(n=Object(r.z)(t),(!e&&c<n||e<n)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[l]=n),Array.isArray(h)?null!==h[l]&&void 0!==h[l]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[l]=h[l]):isNaN(h)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[l]=h),this.dataAccessObject.wtViewport.oversizedColumnHeaders[l]<(h[l]||h)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[l]=h[l]||h))}},{key:"adjustColumnHeaderHeights",value:function(){for(var e=this.wtSettings,t=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=0,r=e.getSetting("columnHeaders").length;i<r;i++)if(n[i]){if(!t[i]||0===t[i].childNodes.length)return;t[i].childNodes[0].style.height="".concat(n[i],"px")}}},{key:"resetOversizedRows",value:function(){var e=this.wtSettings,t=this.dataAccessObject.wtViewport;if((this.isMaster||this.is($e))&&!e.getSetting("externalRowCalculator"))for(var n=this.getRenderedRowsCount(),r=0;r<n;r++){var o=this.rowFilter.renderedToSource(r);t.oversizedRows&&t.oversizedRows[o]&&(t.oversizedRows[o]=void 0)}}},{key:"removeClassFromCells",value:function(e){for(var t=this.TABLE.querySelectorAll(".".concat(e)),i=0,n=t.length;i<n;i++)Object(r.K)(t[i],e)}},{key:"refreshSelections",value:function(e){var t=this.wtSettings,n=this.dataAccessObject.selections;if(n){var r=Array.from(n),o=r.length;if(e){for(var l=[],i=0;i<o;i++){for(var c=r[i].settings,h=c.highlightHeaderClassName,d=c.highlightRowClassName,f=c.highlightColumnClassName,y=r[i].classNames,v=y.length,m=0;m<v;m++)l.includes(y[m])||l.push(y[m]);h&&!l.includes(h)&&l.push(h),d&&!l.includes(d)&&l.push(d),f&&!l.includes(f)&&l.push(f)}var w=t.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(w))for(var O=0;O<w.length;O++)l.push(w[O]);for(var C=l.length,S=0;S<C;S++)this.removeClassFromCells(l[S])}for(var E=0;E<o;E++)r[E].draw(this.facadeGetter(),e)}}},{key:"getCell",value:function(e){var t,n=e.row,r=e.col,o=this.wtSettings.getSetting("onModifyGetCellCoords",n,r);if(o&&Array.isArray(o)){var l=ot(o,2);n=l[0],r=l[1]}if(this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;if(!(t=n<0?this.THEAD.childNodes[this.rowFilter.sourceRowToVisibleColHeadedRow(n)]:this.TBODY.childNodes[this.rowFilter.sourceToRendered(n)])&&n>=0)throw new Error("TR was expected to be rendered but is not");var c=t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!c&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return c}},{key:"getColumnHeader",value:function(col){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=this.THEAD.childNodes[e];return null==t?void 0:t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(col)]}},{key:"getColumnHeaders",value:function(e){var t=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach((function(e){var r=e.childNodes[n];r&&t.push(r)})),t}},{key:"getRowHeader",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0!==this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)){var n=this.wtSettings.getSetting("rowHeaders").length;if(!(t>=n)){var r=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];return null==r?void 0:r.childNodes[t]}}}},{key:"getRowHeaders",value:function(e){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return[];for(var t=[],n=this.wtSettings.getSetting("rowHeaders").length,r=0;r<n;r++){var o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],l=null==o?void 0:o.childNodes[r];l&&t.push(l)}return t}},{key:"getCoords",value:function(e){var t=e;if("TD"!==t.nodeName&&"TH"!==t.nodeName&&(t=Object(r.c)(t,["TD","TH"])),null===t)return null;var n=t.parentNode,o=n.parentNode,l=Object(r.y)(n),col=t.cellIndex;return Object(r.J)(Je,t,this.wtRootElement)||Object(r.J)(qe,t,this.wtRootElement)?"THEAD"===o.nodeName&&(l-=o.childNodes.length):l=Object(r.J)(Ze,t,this.wtRootElement)||Object(r.J)($e,t,this.wtRootElement)?this.wtSettings.getSetting("totalRows")-o.childNodes.length+l:o===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(l):this.rowFilter.renderedToSource(l),col=Object(r.J)(Je,t,this.wtRootElement)||Object(r.J)(Qe,t,this.wtRootElement)||Object(r.J)(Ze,t,this.wtRootElement)?this.columnFilter.offsettedTH(col):this.columnFilter.visibleRowHeadedColumnToSourceColumn(col),this.wot.createCellCoords(l,col)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var e,t,n,o,l,c=this.TBODY.childNodes.length;if(c*this.wtSettings.getSetting("defaultRowHeight")!=Object(r.z)(this.TBODY)-1||this.wtSettings.getSetting("fixedRowsBottom"))for(;c;)c-=1,n=this.rowFilter.renderedToSource(c),e=this.getRowHeight(n),t=(l=(o=this.getTrForRow(n)).querySelector("th"))?Object(r.z)(l):Object(r.z)(o)-1,(!e&&this.wtSettings.getSetting("defaultRowHeight")<t||e<t)&&(t+=1,this.dataAccessObject.wtViewport.oversizedRows[n]=t)}}},{key:"getTrForRow",value:function(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}},{key:"isColumnHeaderRendered",value:function(e){if(e>=0)return!1;var t=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=t}},{key:"isRowHeaderRendered",value:function(e){if(e>=0)return!1;var t=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=t}},{key:"isRowBeforeRenderedRows",value:function(e){var t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}},{key:"isRowAfterRenderedRows",value:function(e){return e>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(e){var t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}},{key:"isColumnAfterRenderedColumns",value:function(e){return this.columnFilter&&e>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(e){return this.columnFilter&&e>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(e){return this.rowFilter&&e>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(e){return this.rowUtils.getHeight(e)}},{key:"getColumnHeaderHeight",value:function(e){return this.columnUtils.getHeaderHeight(e)}},{key:"getColumnWidth",value:function(e){return this.columnUtils.getWidth(e)}},{key:"getStretchedColumnWidth",value:function(e){return this.columnUtils.getStretchedColumnWidth(e)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return Object(r.I)(this.TABLE)}},{key:"getHeight",value:function(){return Object(r.H)(this.TABLE)}},{key:"getTotalWidth",value:function(){var e=Object(r.I)(this.hider);return 0!==e?e:this.getWidth()}},{key:"getTotalHeight",value:function(){var e=Object(r.H)(this.hider);return 0!==e?e:this.getHeight()}},{key:"isVisible",value:function(){return Object(r.F)(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(e){var t=Object(o.d)(e)?e():null;return Array.isArray(t)?(t=nt(t))[t.length-1]=this._correctRowHeaderWidth(t[t.length-1]):t=this._correctRowHeaderWidth(t),t}},{key:"_correctRowHeaderWidth",value:function(e){var t=e;return"number"!=typeof e&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}}],n&&lt(t.prototype,n),l&&lt(t,l),Object.defineProperty(t,"prototype",{writable:!1}),e}(),ut=ct,ht={getFirstRenderedRow:function(){return 0===this.wtSettings.getSetting("totalRows")?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),e)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Object(object.f)(ht,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});var ft=ht,pt={getFirstRenderedColumn:function(){var e=this.dataAccessObject.startColumnRendered;return null===e?-1:e},getFirstVisibleColumn:function(){var e=this.dataAccessObject.startColumnVisible;return null===e?-1:e},getLastRenderedColumn:function(){var e=this.dataAccessObject.endColumnRendered;return null===e?-1:e},getLastVisibleColumn:function(){var e=this.dataAccessObject.endColumnVisible;return null===e?-1:e},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};Object(object.f)(pt,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});var bt=pt;function yt(e){return yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yt(e)}function gt(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function vt(e,p){return vt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},vt(e,p)}function mt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ot(e);if(t){var o=Ot(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return wt(this,n)}}function wt(e,t){if(t&&("object"===yt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ot(e){return Ot=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ot(e)}var Ct=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vt(e,t)}(l,e);var t,n,r,o=mt(l);function l(e,t,n,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),o.call(this,e,t,n,r,qe)}return t=l,n&&gt(t.prototype,n),r&&gt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(ut);Object(object.n)(Ct,ft),Object(object.n)(Ct,bt);var St=Ct;function Et(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Rt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Tt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Rt(this,"dataAccessObject",void 0),Rt(this,"lastScrolledColumnPos",-1),Rt(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}var t,n,o;return t=e,(n=[{key:"scrollViewport",value:function(e,t,n,r,o){var l=this.scrollViewportHorizontally(e.col,n,o),c=this.scrollViewportVertically(e.row,t,r);return l||c}},{key:"scrollViewportHorizontally",value:function(e,t,n){var r=this.dataAccessObject,o=r.drawn,l=r.totalColumns;if(!o||!Number.isInteger(e)||e<0||e>l)return!1;var c=this.getFirstVisibleColumn(),h=this.getLastVisibleColumn(),d=void 0===t&&void 0===n,f=this.dataAccessObject,y=f.fixedColumnsStart,v=f.inlineStartOverlay;if(d&&e<y)return!1;var m=!1;return-1===c?m=v.scrollTo(e,d?e>this.lastScrolledColumnPos:t):(d&&(e<c||e>h)||!d)&&(m=v.scrollTo(e,d?e>h:t)),m&&(this.lastScrolledColumnPos=e),m}},{key:"scrollViewportVertically",value:function(e,t,n){var r=this.dataAccessObject,o=r.drawn,l=r.totalRows;if(!o||!Number.isInteger(e)||e<0||e>l)return!1;var c=this.getFirstVisibleRow(),h=this.getLastVisibleRow(),d=void 0===t&&void 0===n,f=this.dataAccessObject,y=f.fixedRowsBottom,v=f.fixedRowsTop,m=f.topOverlay;if(d&&(e<v||e>l-y-1))return!1;var w=!1;return-1===c?w=m.scrollTo(e,d?e>this.lastScrolledRowPos:n):(d&&(e<c||e>h)||!d)&&(w=m.scrollTo(e,d?e>h:n)),w&&(this.lastScrolledRowPos=e),w}},{key:"getFirstVisibleRow",value:function(){var e=this.dataAccessObject,t=e.topOverlay,n=e.wtTable,o=e.wtViewport,l=e.totalRows,c=e.fixedRowsTop,h=e.rootWindow,d=n.getFirstVisibleRow();if(t.mainTableScrollableElement===h){var f=Object(r.G)(n.wtRootElement),y=Object(r.z)(n.hider),v=Object(r.z)(h),m=Object(r.m)(h,h);if(f.top+y-v<=m){var w=o.getColumnHeaderHeight();w+=t.sumCellSizes(0,c);for(var O=l;O>0;O--)if(w+=t.sumCellSizes(O-1,O),f.top+y-w<=m){d=O;break}}}return d}},{key:"getLastVisibleRow",value:function(){var e=this.dataAccessObject,t=e.topOverlay,n=e.wtTable,o=e.wtViewport,l=e.totalRows,c=e.rootWindow,h=n.getLastVisibleRow();if(t.mainTableScrollableElement===c){var d=Object(r.G)(n.wtRootElement),f=Object(r.m)(c,c);if(d.top>f)for(var y=Object(r.z)(c),v=o.getColumnHeaderHeight(),m=1;m<=l;m++)if(v+=t.sumCellSizes(m-1,m),d.top+v-f>=y){h=m-2;break}}return h}},{key:"getFirstVisibleColumn",value:function(){var e=this.dataAccessObject,t=e.inlineStartOverlay,n=e.wtTable,o=e.wtViewport,l=e.totalColumns,c=e.rootWindow,h=n.getFirstVisibleColumn();if(t.mainTableScrollableElement===c){var d=Object(r.G)(n.wtRootElement),f=Object(r.A)(n.hider),y=Object(r.A)(c),v=Math.abs(Object(r.l)(c,c));if(d.left+f-y<=v)for(var m=o.getRowHeaderWidth(),w=l;w>0;w--)if(m+=t.sumCellSizes(w-1,w),d.left+f-m<=v){h=w;break}}return h}},{key:"getLastVisibleColumn",value:function(){var e=this.dataAccessObject,t=e.inlineStartOverlay,n=e.wtTable,o=e.wtViewport,l=e.totalColumns,c=e.rootWindow,h=n.getLastVisibleColumn();if(t.mainTableScrollableElement===c){var d=Object(r.G)(n.wtRootElement),f=Math.abs(Object(r.l)(c,c));if(d.left>f)for(var y=Object(r.A)(c),v=o.getRowHeaderWidth(),m=1;m<=l;m++)if(v+=t.sumCellSizes(m-1,m),d.left+v-f>=y){h=m-2;break}}return h}}])&&Et(t.prototype,n),o&&Et(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}(),kt=n(747),jt=n(816);function At(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function xt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Mt=function(){function e(table,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),xt(this,"wtTable",void 0),xt(this,"wtScroll",void 0),xt(this,"wtViewport",void 0),xt(this,"wtOverlays",void 0),xt(this,"selections",void 0),xt(this,"wtEvent",void 0),xt(this,"guid","wt_".concat(Object(O.b)())),xt(this,"drawInterrupted",!1),xt(this,"drawn",!1),xt(this,"domBindings",void 0),xt(this,"wtSettings",void 0),this.domBindings={rootTable:table,rootDocument:table.ownerDocument,rootWindow:table.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new Tt(this.createScrollDao())}var t,n,o;return t=e,n=[{key:"eventManager",get:function(){return new d.a(this)}},{key:"findOriginalHeaders",value:function(){var e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var t=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;t<n;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,n){Object(r.g)(n,e[t])}])}}},{key:"createCellCoords",value:function(e,t){return new kt.a(e,t,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(e,t,n){return new jt.a(e,t,n,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,e||this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}},{key:"getCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)return this.wtTable.getCell(e);var n=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),l=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<r&&e.col<l)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<l&&e.row>=n-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<l)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}},{key:"scrollViewport",value:function(e,t,n,r,o){return!(e.col<0||e.row<0)&&this.wtScroll.scrollViewport(e,t,n,r,o)}},{key:"scrollViewportHorizontally",value:function(e,t,n){return!(e<0)&&this.wtScroll.scrollViewportHorizontally(e,t,n)}},{key:"scrollViewportVertically",value:function(e,t,n){return!(e<0)&&this.wtScroll.scrollViewportVertically(e,t,n)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selections(){return e.selections},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count}}}}],n&&At(t.prototype,n),o&&At(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function It(e){return It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},It(e)}function _t(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Nt(e,p){return Nt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},Nt(e,p)}function Ht(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Lt(e);if(t){var o=Lt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Pt(this,n)}}function Pt(e,t){if(t&&("object"===It(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Dt(e)}function Dt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lt(e){return Lt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Lt(e)}function Bt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Vt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Nt(e,t)}(l,e);var t,n,r,o=Ht(l);function l(table,e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),Bt(Dt(n=o.call(this,table,e)),"cloneSource",void 0),Bt(Dt(n),"cloneOverlay",void 0);var r=n.wtSettings.getSetting("facade",Dt(n));return n.cloneSource=t.source,n.cloneOverlay=t.overlay,n.wtTable=n.cloneOverlay.createTable(n.getTableDao(),r,n.domBindings,n.wtSettings),n.wtViewport=t.viewport,n.selections=t.selections,n.wtEvent=new A(r,n.domBindings,n.wtSettings,n.eventManager,n.wtTable,n.selections,t.event),n.findOriginalHeaders(),n}return t=l,n&&_t(t.prototype,n),r&&_t(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(Mt);function Ft(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Wt=function(){function e(t,n,o,l,c){var h,d,f;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),f=null,(d="wtSettings")in(h=this)?Object.defineProperty(h,d,{value:f,enumerable:!0,configurable:!0,writable:!0}):h[d]=f,Object(object.f)(this,"wot",t,{writable:!1}),this.domBindings=c,this.facadeGetter=n,this.wtSettings=l;var y=this.wot.wtTable,v=y.TABLE,m=y.hider,w=y.spreader,O=y.holder,C=y.wtRootElement;this.instance=this.wot,this.type=o,this.mainTableScrollableElement=null,this.TABLE=v,this.hider=m,this.spreader=w,this.holder=O,this.wtRootElement=C,this.trimmingContainer=Object(r.s)(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}var t,n,o;return t=e,n=[{key:"updateStateOfRendering",value:function(){var e=this.needFullRender;this.needFullRender=this.shouldBeRendered();var t=e!==this.needFullRender;return t&&!this.needFullRender&&this.reset(),t}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=Object(r.s)(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var e=this.wot.wtTable;"hidden"===this.domBindings.rootWindow.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Object(r.n)(e.TABLE)}},{key:"getRelativeCellPosition",value:function(element,e,t){if(!1!==this.clone.wtTable.holder.contains(element)){var n=this.mainTableScrollableElement===this.domBindings.rootWindow,r=t<this.wtSettings.getSetting("fixedColumnsStart"),o=e<this.wtSettings.getSetting("fixedRowsTop"),l=e>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),c=this.clone.wtTable.spreader,h={start:this.getRelativeStartPosition(c),top:c.offsetTop},d={start:this.getRelativeStartPosition(element),top:element.offsetTop};return n?this.getRelativeCellPositionWithinWindow(o,r,d,h):this.getRelativeCellPositionWithinHolder(o,l,r,d,h)}Object(Ce.b)("The provided element is not a child of the ".concat(this.type," overlay"))}},{key:"getRelativeStartPosition",value:function(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(e,t,n,o){var l=this.wot.wtTable.wtRootElement.getBoundingClientRect(),c=0,h=0;if(t){var d=l.left;this.isRtl()&&(d=this.domBindings.rootWindow.innerWidth-(l.left+l.width+Object(r.o)())),c=d<=0?-1*d:0}else c=o.start;return h=e?this.clone.wtTable.TABLE.getBoundingClientRect().top-l.top:o.top,{start:n.start+c,top:n.top+h}}},{key:"getRelativeCellPositionWithinHolder",value:function(e,t,n,r,o){var l=this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),c=this.wot.wtOverlays.topOverlay.getScrollPosition(),h=0,d=0;if(n||(h=l-o.start),t){var f=this.wot.wtTable.wtRootElement.getBoundingClientRect();d=-1*this.clone.wtTable.TABLE.getBoundingClientRect().top+f.top}else e||(d=c-o.top);return{start:r.start-h,top:r.top-d}}},{key:"makeClone",value:function(){if(-1===et.indexOf(this.type))throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var e=this.wot.wtTable,t=this.domBindings,n=t.rootDocument,o=t.rootWindow,l=n.createElement("DIV"),c=n.createElement("TABLE"),h=e.wtRootElement.parentNode;l.className="".concat(tt.get(this.type)," handsontable"),l.setAttribute("dir",this.isRtl()?"rtl":"ltr"),l.style.position="absolute",l.style.top=0,l.style.overflow="visible",this.isRtl()?l.style.right=0:l.style.left=0,c.className=e.TABLE.className,l.appendChild(c),h.appendChild(l);var d=this.wtSettings.getSetting("preventOverflow");return!0===d||"horizontal"===d&&this.type===qe||"vertical"===d&&this.type===Qe?this.mainTableScrollableElement=o:"hidden"===o.getComputedStyle(h).getPropertyValue("overflow")?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Object(r.n)(e.TABLE),new Vt(c,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.shouldBeRendered();this.clone&&(this.needFullRender||t)&&this.clone.draw(e),this.needFullRender=t}},{key:"reset",value:function(){if(this.clone){var e=this.clone.wtTable.holder,t=this.clone.wtTable.hider,n=e.style,r=t.style,o=e.parentNode.style;Object(f.a)([n,r,o],(function(style){style.width="",style.height=""}))}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}],n&&Ft(t.prototype,n),o&&Ft(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function zt(e){return zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zt(e)}function Ut(e,t,n){return Ut=qt()?Reflect.construct.bind():function(e,t,n){var a=[null];a.push.apply(a,t);var r=new(Function.bind.apply(e,a));return n&&Xt(r,n.prototype),r},Ut.apply(null,arguments)}function Gt(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Xt(e,p){return Xt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},Xt(e,p)}function Kt(e,t){if(t&&("object"===zt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Yt(e)}function Yt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function $t(e){return $t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},$t(e)}var Qt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xt(e,t)}(d,e);var t,n,o,l,c,h=(t=d,n=qt(),function(){var e,r=$t(t);if(n){var o=$t(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return Kt(this,e)});function d(e,t,n,r){var o,l,c,f;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),o=h.call(this,e,t,qe,n,r),l=Yt(o),f=-1,(c="cachedFixedRowsTop")in l?Object.defineProperty(l,c,{value:f,enumerable:!0,configurable:!0,writable:!0}):l[c]=f,o.cachedFixedRowsTop=o.wtSettings.getSetting("fixedRowsTop"),o}return o=d,l=[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Ut(St,t)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var e=this.clone.wtTable.holder.parentNode,t=this.domBindings.rootWindow,n=this.wtSettings.getSetting("preventOverflow"),o=0,l=!1;if(this.trimmingContainer!==t||n&&"vertical"===n)o=this.getScrollPosition(),Object(r.M)(e);else{var c=this.wot.wtTable.hider.getBoundingClientRect();l=Math.ceil(c.bottom)===e.offsetHeight,o=this.getOverlayOffset(),Object(r.P)(e,"0px","".concat(o,"px"))}var h=this.adjustHeaderBordersPosition(o,l);return this.adjustElementsSize(),h}},{key:"setScrollPosition",value:function(e){var t=this.domBindings.rootWindow,n=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo(Object(r.t)(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(e,t){for(var n=this.wtSettings.getSetting("defaultRowHeight"),r=e,o=0;r<t;){var l=this.wot.wtTable.getRowHeight(r);o+=void 0===l?n:l,r+=1}return o}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var e=this.wot.wtTable,t=this.domBindings,n=t.rootDocument,o=t.rootWindow,l=Object(r.o)(n),c=this.clone.wtTable.holder.parentNode.style,h=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||"horizontal"===h){var d=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(d-=l),d=Math.min(d,e.wtRootElement.scrollWidth),c.width="".concat(d,"px")}else c.width="";this.clone.wtTable.holder.style.width=c.width;var f=Object(r.H)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(f=0),c.height="".concat(f,"px")}},{key:"adjustRootChildrenSize",value:function(){var e,t=this.clone.wtTable.holder,n=this.wot.selections,r=this.facadeGetter(),o=Math.abs(null!==(e=null==n?void 0:n.getCell().getBorder(r).cornerCenterPointOffset)&&void 0!==e?e:0);this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height="".concat(parseInt(t.parentNode.style.height,10)+o,"px")}},{key:"applyToDOM",value:function(){var e=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var e=this.isRtl()?"right":"left",t=this.clone.wtTable.spreader;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):t.style[e]=""}},{key:"scrollTo",value:function(e,t){var n=this.wot,o=this.wtSettings,l=(n.cloneSource?n.cloneSource:n).wtTable.holder,c=this.getTableParentOffset(),h=0;if(t&&this.wot.wtTable.getRowHeight(e)>this.wot.wtViewport.getViewportHeight()&&(t=!1),t&&l.offsetHeight!==l.clientHeight&&(h=Object(r.o)(this.domBindings.rootDocument)),t){var d=o.getSetting("fixedRowsBottom"),f=o.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=n.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),c+=1}else c+=this.sumCellSizes(o.getSetting("fixedRowsTop"),e);return c+=h,this.setScrollPosition(c)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Object(r.m)(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var e=this.domBindings.rootWindow,t=this.wtSettings.getSetting("preventOverflow"),n=0;if(this.trimmingContainer===e&&(!t||"vertical"!==t)){var r=this.wot.wtTable.getTotalHeight()-this.clone.wtTable.getTotalHeight();(n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0))>r&&(n=0)}return n}},{key:"adjustHeaderBordersPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.wot.wtTable.holder.parentNode,o=this.wtSettings.getSetting("totalColumns");o?Object(r.K)(n,"emptyColumns"):Object(r.a)(n,"emptyColumns");var l=!1;if(!t){var c=this.wtSettings.getSetting("fixedRowsTop"),h=this.cachedFixedRowsTop!==c,d=this.wtSettings.getSetting("columnHeaders");if((h||0===c)&&d.length>0){var f=Object(r.v)(n,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||0===this.wtSettings.getSetting("totalRows")?(Object(r.a)(n,"innerBorderTop"),l=!f):(Object(r.K)(n,"innerBorderTop"),l=f)}}return l}}],l&&Gt(o.prototype,l),c&&Gt(o,c),Object.defineProperty(o,"prototype",{writable:!1}),d}(Wt),Jt={getFirstRenderedRow:function(){var e=this.wtSettings.getSetting("totalRows"),t=this.wtSettings.getSetting("fixedRowsBottom"),n=e-t;return 0===e||0===t?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),e)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Object(object.f)(Jt,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});var Zt=Jt;function en(e){return en="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},en(e)}function tn(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function nn(e,p){return nn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},nn(e,p)}function rn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=an(e);if(t){var o=an(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return on(this,n)}}function on(e,t){if(t&&("object"===en(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function an(e){return an=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},an(e)}var ln=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nn(e,t)}(l,e);var t,n,r,o=rn(l);function l(e,t,n,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),o.call(this,e,t,n,r,$e)}return t=l,n&&tn(t.prototype,n),r&&tn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(ut);Object(object.n)(ln,Zt),Object(object.n)(ln,bt);var sn=ln;function cn(e){return cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cn(e)}function un(e,t,n){return un=bn()?Reflect.construct.bind():function(e,t,n){var a=[null];a.push.apply(a,t);var r=new(Function.bind.apply(e,a));return n&&dn(r,n.prototype),r},un.apply(null,arguments)}function hn(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function dn(e,p){return dn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},dn(e,p)}function fn(e,t){if(t&&("object"===cn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return pn(e)}function pn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function yn(e){return yn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},yn(e)}var gn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dn(e,t)}(d,e);var t,n,o,l,c,h=(t=d,n=bn(),function(){var e,r=yn(t);if(n){var o=yn(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return fn(this,e)});function d(e,t,n,r){var o,l,c,f;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),o=h.call(this,e,t,$e,n,r),l=pn(o),f=-1,(c="cachedFixedRowsBottom")in l?Object.defineProperty(l,c,{value:f,enumerable:!0,configurable:!0,writable:!0}):l[c]=f,o.cachedFixedRowsBottom=o.wtSettings.getSetting("fixedRowsBottom"),o}return o=d,l=[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return un(sn,t)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var e=this.domBindings.rootWindow,t=this.clone.wtTable.holder.parentNode;t.style.top="";var n=0,r=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==e||r&&"vertical"===r?(n=this.getScrollPosition(),this.repositionOverlay()):(n=this.getOverlayOffset(),t.style.bottom="".concat(n,"px"));var o=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),o}},{key:"repositionOverlay",value:function(){var e=this.wot,t=e.wtTable,n=e.wtViewport,o=this.domBindings.rootDocument,l=this.clone.wtTable.holder.parentNode,c=0;n.hasVerticalScroll()||(c+=n.getWorkspaceHeight()-t.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(c+=Object(r.o)(o)),l.style.bottom="".concat(c,"px")}},{key:"setScrollPosition",value:function(e){var t=this.domBindings.rootWindow,n=!1;return this.mainTableScrollableElement===t?(t.scrollTo(Object(r.t)(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(e,t){for(var n=this.wot,r=n.wtTable,o=n.wtSettings.getSetting("defaultRowHeight"),l=e,c=0;l<t;){var h=r.getRowHeight(l);c+=void 0===h?o:h,l+=1}return c}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var e=this.wot,t=e.wtTable,n=e.wtViewport,o=this.domBindings,l=o.rootDocument,c=o.rootWindow,h=Object(r.o)(l),d=this.clone.wtTable.holder.parentNode.style,f=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==c||"horizontal"===f){var y=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(y-=h),y=Math.min(y,t.wtRootElement.scrollWidth),d.width="".concat(y,"px")}else d.width="";this.clone.wtTable.holder.style.width=d.width;var v=Object(r.H)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(v=0),d.height="".concat(v,"px")}},{key:"adjustRootChildrenSize",value:function(){var e=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}},{key:"applyToDOM",value:function(){var e=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var e=this.isRtl()?"right":"left",t=this.clone.wtTable.spreader;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):t.style[e]=""}},{key:"scrollTo",value:function(e,t){var n=this.getTableParentOffset(),o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=0;t&&o.offsetHeight!==o.clientHeight&&(l=Object(r.o)(this.domBindings.rootDocument)),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=l,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Object(r.m)(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var e=this.domBindings.rootWindow,t=this.wtSettings.getSetting("preventOverflow"),n=0;if(this.trimmingContainer===e&&(!t||"vertical"!==t)){var r=this.wot.wtTable.getTotalHeight(),o=r-this.clone.wtTable.getTotalHeight(),l=this.domBindings.rootDocument.documentElement.clientHeight;(n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-l+r,0))>o&&(n=0)}return n}},{key:"adjustHeaderBordersPosition",value:function(e){var t=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==t,o=this.wtSettings.getSetting("columnHeaders"),l=!1;if((n||0===t)&&o.length>0){var c=this.wot.wtTable.holder.parentNode,h=Object(r.v)(c,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||0===this.wtSettings.getSetting("totalRows")?(Object(r.a)(c,"innerBorderBottom"),l=!h):(Object(r.K)(c,"innerBorderBottom"),l=h)}return l}}],l&&hn(o.prototype,l),c&&hn(o,c),Object.defineProperty(o,"prototype",{writable:!1}),d}(Wt),vn={getFirstRenderedRow:function(){var e=this.dataAccessObject.startRowRendered;return null===e?-1:e},getFirstVisibleRow:function(){var e=this.dataAccessObject.startRowVisible;return null===e?-1:e},getLastRenderedRow:function(){var e=this.dataAccessObject.endRowRendered;return null===e?-1:e},getLastVisibleRow:function(){var e=this.dataAccessObject.endRowVisible;return null===e?-1:e},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};Object(object.f)(vn,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});var mn=vn,wn={getFirstRenderedColumn:function(){return 0===this.wtSettings.getSetting("totalColumns")?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var e=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),e)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};Object(object.f)(wn,"MIXIN_NAME","stickyColumnsStart",{writable:!1,enumerable:!1});var On=wn;function Cn(e){return Cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cn(e)}function Sn(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function En(e,p){return En=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},En(e,p)}function Rn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=kn(e);if(t){var o=kn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Tn(this,n)}}function Tn(e,t){if(t&&("object"===Cn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function kn(e){return kn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},kn(e)}var jn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&En(e,t)}(l,e);var t,n,r,o=Rn(l);function l(e,t,n,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),o.call(this,e,t,n,r,Qe)}return t=l,n&&Sn(t.prototype,n),r&&Sn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(ut);Object(object.n)(jn,mn),Object(object.n)(jn,On);var An=jn;function xn(e){return xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xn(e)}function Mn(e,t,n){return Mn=Hn()?Reflect.construct.bind():function(e,t,n){var a=[null];a.push.apply(a,t);var r=new(Function.bind.apply(e,a));return n&&_n(r,n.prototype),r},Mn.apply(null,arguments)}function In(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _n(e,p){return _n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},_n(e,p)}function Nn(e,t){if(t&&("object"===xn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Hn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Pn(e){return Pn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Pn(e)}var Dn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_n(e,t)}(d,e);var t,n,o,l,c,h=(t=d,n=Hn(),function(){var e,r=Pn(t);if(n){var o=Pn(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return Nn(this,e)});function d(e,t,n,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),h.call(this,e,t,Qe,n,r)}return o=d,l=[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Mn(An,t)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var e=this.wot.wtTable;if(!this.needFullRender||!e.holder.parentNode)return!1;var t=this.domBindings.rootWindow,n=this.clone.wtTable.holder.parentNode,o=this.wtSettings.getSetting("preventOverflow"),l=0;this.trimmingContainer!==t||o&&"horizontal"===o?(l=this.getScrollPosition(),Object(r.M)(n)):(l=this.getOverlayOffset()*(this.isRtl()?-1:1),Object(r.P)(n,"".concat(l,"px"),"0px"));var c=this.adjustHeaderBordersPosition(l);return this.adjustElementsSize(),c}},{key:"setScrollPosition",value:function(e){var t=this.domBindings.rootWindow,n=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,Object(r.u)(t)),n=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,n=!0),n}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(e,t){for(var n=this.wtSettings.getSetting("defaultColumnWidth"),r=e,o=0;r<t;)o+=this.wot.wtTable.getStretchedColumnWidth(r)||n,r+=1;return o}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var e=this.wot.wtTable,t=this.domBindings,n=t.rootDocument,o=t.rootWindow,l=Object(r.o)(n),c=this.clone.wtTable.holder.parentNode.style,h=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||"vertical"===h){var d=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(d-=l),d=Math.min(d,e.wtRootElement.scrollHeight),c.height="".concat(d,"px")}else c.height="";this.clone.wtTable.holder.style.height=c.height;var f=Object(r.I)(this.clone.wtTable.TABLE);c.width="".concat(f,"px")}},{key:"adjustRootChildrenSize",value:function(){var e,t=this.clone.wtTable.holder,n=this.wot.selections,r=this.facadeGetter(),o=Math.abs(null!==(e=null==n?void 0:n.getCell().getBorder(r).cornerCenterPointOffset)&&void 0!==e?e:0);this.clone.wtTable.hider.style.height=this.hider.style.height,t.style.height=t.parentNode.style.height,t.style.width="".concat(parseInt(t.parentNode.style.width,10)+o,"px")}},{key:"applyToDOM",value:function(){var e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if("number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[t]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else{if(0!==e)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style[t]="0"}this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(e,t){var n=this.getTableParentOffset(),o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=0;return t&&this.wot.wtTable.getColumnWidth(e)>this.wot.wtViewport.getViewportWidth()&&(t=!1),t&&o.offsetWidth!==o.clientWidth&&(l=Object(r.o)(this.domBindings.rootDocument)),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportWidth()):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),n+=l,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){var e=0;return this.wtSettings.getSetting("preventOverflow")||this.trimmingContainer!==this.domBindings.rootWindow||(e=this.wot.wtTable.holderOffset.left),e}},{key:"getScrollPosition",value:function(){return Math.abs(Object(r.l)(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var e=this.domBindings.rootWindow,t=this.wtSettings.getSetting("preventOverflow"),n=0;return this.trimmingContainer!==e||t&&"horizontal"===t||(n=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0))>this.wot.wtTable.getTotalWidth()-this.clone.wtTable.getTotalWidth()&&(n=0),n}},{key:"adjustHeaderBordersPosition",value:function(e){var t=this.wot.wtTable.holder.parentNode,n=this.wtSettings.getSetting("rowHeaders"),o=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?Object(r.K)(t,"emptyRows"):Object(r.a)(t,"emptyRows");var l=!1;if(o&&!n.length)Object(r.a)(t,"innerBorderLeft innerBorderInlineStart");else if(!o&&n.length){var c=Object(r.v)(t,"innerBorderInlineStart");e?(Object(r.a)(t,"innerBorderLeft innerBorderInlineStart"),l=!c):(Object(r.K)(t,"innerBorderLeft innerBorderInlineStart"),l=c)}return l}}],l&&In(o.prototype,l),c&&In(o,c),Object.defineProperty(o,"prototype",{writable:!1}),d}(Wt);function Ln(e){return Ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ln(e)}function Bn(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Vn(e,p){return Vn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},Vn(e,p)}function Fn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=zn(e);if(t){var o=zn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Wn(this,n)}}function Wn(e,t){if(t&&("object"===Ln(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function zn(e){return zn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},zn(e)}var Un=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Vn(e,t)}(l,e);var t,n,r,o=Fn(l);function l(e,t,n,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),o.call(this,e,t,n,r,Je)}return t=l,n&&Bn(t.prototype,n),r&&Bn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(ut);Object(object.n)(Un,ft),Object(object.n)(Un,On);var Gn=Un;function Xn(e){return Xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xn(e)}function Kn(e,t,n){return Kn=Jn()?Reflect.construct.bind():function(e,t,n){var a=[null];a.push.apply(a,t);var r=new(Function.bind.apply(e,a));return n&&qn(r,n.prototype),r},Kn.apply(null,arguments)}function Yn(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function qn(e,p){return qn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},qn(e,p)}function $n(e,t){if(t&&("object"===Xn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Qn(e)}function Qn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Zn(e){return Zn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Zn(e)}function er(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var nr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qn(e,t)}(d,e);var t,n,o,l,c,h=(t=d,n=Jn(),function(){var e,r=Zn(t);if(n){var o=Zn(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return $n(this,e)});function d(e,t,n,r,o,l){var c;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),er(Qn(c=h.call(this,e,t,Je,n,r)),"topOverlay",void 0),er(Qn(c),"inlineStartOverlay",void 0),c.topOverlay=o,c.inlineStartOverlay=l,c}return o=d,l=[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Kn(Gn,t)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var t=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),n=this.topOverlay.getOverlayOffset();Object(r.P)(e,"".concat(t,"px"),"".concat(n,"px"))}else Object(r.M)(e);var o=Object(r.H)(this.clone.wtTable.TABLE),l=Object(r.I)(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(o=0),e.style.height="".concat(o,"px"),e.style.width="".concat(l,"px"),!1}}],l&&Yn(o.prototype,l),c&&Yn(o,c),Object.defineProperty(o,"prototype",{writable:!1}),d}(Wt);function rr(e){return rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rr(e)}function or(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ir(e,p){return ir=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},ir(e,p)}function ar(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=sr(e);if(t){var o=sr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return lr(this,n)}}function lr(e,t){if(t&&("object"===rr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function sr(e){return sr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},sr(e)}var cr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ir(e,t)}(l,e);var t,n,r,o=ar(l);function l(e,t,n,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),o.call(this,e,t,n,r,Ze)}return t=l,n&&or(t.prototype,n),r&&or(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(ut);Object(object.n)(cr,Zt),Object(object.n)(cr,On);var ur=cr;function dr(e){return dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dr(e)}function fr(e,t,n){return fr=vr()?Reflect.construct.bind():function(e,t,n){var a=[null];a.push.apply(a,t);var r=new(Function.bind.apply(e,a));return n&&yr(r,n.prototype),r},fr.apply(null,arguments)}function pr(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function yr(e,p){return yr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},yr(e,p)}function gr(e,t){if(t&&("object"===dr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function vr(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function mr(e){return mr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},mr(e)}var wr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yr(e,t)}(d,e);var t,n,o,l,c,h=(t=d,n=vr(),function(){var e,r=mr(t);if(n){var o=mr(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return gr(this,e)});function d(e,t,n,r,o,l){var c;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(c=h.call(this,e,t,Ze,n,r)).bottomOverlay=o,c.inlineStartOverlay=l,c}return o=d,l=[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return fr(ur,t)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var e=this.wot;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;var t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var n=this.inlineStartOverlay.getOverlayOffset(),o=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]="".concat(n,"px"),t.style.bottom="".concat(o,"px")}else Object(r.M)(t),this.repositionOverlay();var l=Object(r.H)(this.clone.wtTable.TABLE),c=Object(r.I)(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(l=0),t.style.height="".concat(l,"px"),t.style.width="".concat(c,"px"),!1}},{key:"repositionOverlay",value:function(){var e=this.wot,t=e.wtTable,n=e.wtViewport,o=this.domBindings.rootDocument,l=this.clone.wtTable.holder.parentNode,c=0;n.hasVerticalScroll()||(c+=n.getWorkspaceHeight()-t.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(c+=Object(r.o)(o)),l.style.bottom="".concat(c,"px")}}],l&&pr(o.prototype,l),c&&pr(o,c),Object.defineProperty(o,"prototype",{writable:!1}),d}(Wt);function Or(e,t,n){return Or=Cr()?Reflect.construct.bind():function(e,t,n){var a=[null];a.push.apply(a,t);var r=new(Function.bind.apply(e,a));return n&&Sr(r,n.prototype),r},Or.apply(null,arguments)}function Cr(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Sr(e,p){return Sr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},Sr(e,p)}function Er(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Rr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Tr=function(){function e(t,n,o,l,c,h){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Rr(this,"wot",null),Rr(this,"topOverlay",null),Rr(this,"bottomOverlay",null),Rr(this,"inlineStartOverlay",null),Rr(this,"topInlineStartCornerOverlay",null),Rr(this,"bottomInlineStartCornerOverlay",null),Rr(this,"browserLineHeight",void 0),Rr(this,"wtSettings",null),this.wot=t,this.wtSettings=l,this.domBindings=o,this.facadeGetter=n,this.wtTable=h;var d=this.domBindings,f=d.rootDocument,y=d.rootWindow;this.instance=this.wot,this.eventManager=c,this.scrollbarSize=Object(r.o)(f);var v="hidden"===y.getComputedStyle(h.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=v?h.holder:Object(r.n)(h.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=y.scrollX,this.lastScrollY=y.scrollY}var t,n,o;return t=e,n=[{key:"initBrowserLineHeight",value:function(){var e=this.domBindings,t=e.rootWindow,n=e.rootDocument,r=t.getComputedStyle(n.body),o=parseInt(r.lineHeight,10),l=1.2*parseInt(r.fontSize,10);this.browserLineHeight=o||l}},{key:"initOverlays",value:function(){var e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=Or(Qt,e),this.bottomOverlay=Or(gn,e),this.inlineStartOverlay=Or(Dn,e),this.topInlineStartCornerOverlay=Or(nr,e.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=Or(wr,e.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}},{key:"refreshAll",value:function(){this.wot.drawn&&(this.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}},{key:"registerListeners",value:function(){var e=this,t=this.domBindings,n=t.rootDocument,r=t.rootWindow,o=this.topOverlay.mainTableScrollableElement,l=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(n.documentElement,"keydown",(function(t){return e.onKeyDown(t)})),this.eventManager.addEventListener(n.documentElement,"keyup",(function(){return e.onKeyUp()})),this.eventManager.addEventListener(n,"visibilitychange",(function(){return e.onKeyUp()})),this.eventManager.addEventListener(o,"scroll",(function(t){return e.onTableScroll(t)}),{passive:!0}),o!==l&&this.eventManager.addEventListener(l,"scroll",(function(t){return e.onTableScroll(t)}),{passive:!0});var h,d=r.devicePixelRatio&&r.devicePixelRatio>1,f=this.scrollableElement===r,y=this.wtSettings.getSetting("preventWheel"),v={passive:f};(y||d||!Object(c.a)())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",(function(t){return e.onCloneWheel(t,y)}),v),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach((function(t){if(t&&t.needFullRender){var n=t.clone.wtTable.holder;e.eventManager.addEventListener(n,"wheel",(function(t){return e.onCloneWheel(t,y)}),v)}})),this.eventManager.addEventListener(r,"resize",(function(){clearTimeout(h),h=setTimeout((function(){e.wtSettings.getSetting("onWindowResize")}),200)}))}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(e){var t=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(r!==t&&o!==t&&!e.target.contains(r)||n!==t&&o!==t&&!e.target.contains(n))||this.syncScrollPositions(e)}},{key:"onCloneWheel",value:function(e,t){var n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,l=e.target,c=o!==n&&l!==n&&!l.contains(o),h=r!==n&&l!==n&&!l.contains(r);if(!this.keyPressed||!c&&!h){var d=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==n&&d)&&e.preventDefault()}}},{key:"onKeyDown",value:function(e){this.keyPressed=Object(x.d)(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(e){var t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;1===e.deltaMode&&(n+=n*this.browserLineHeight,t+=t*this.browserLineHeight);var r=this.scrollVertically(t),o=this.scrollHorizontally(n);return r||o}},{key:"scrollVertically",value:function(e){var t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(e){var t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var e=this.domBindings.rootWindow,t=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder,r=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],o=r[0],l=r[1];if(this.horizontalScrolling=t.scrollLeft!==o||this.lastScrollX!==e.scrollX,this.verticalScrolling=n.scrollTop!==l||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=o;var c=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;c&&(c.scrollLeft=o)}this.verticalScrolling&&(n.scrollTop=l),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var e=this.topOverlay.mainTableScrollableElement,t=e.scrollLeft,n=e.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var e=this.wtTable;"hidden"===this.domBindings.rootWindow.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=e.holder:this.scrollableElement=Object(r.n)(e.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.wtTable.spreader,n=t.clientWidth,r=t.clientHeight;n===this.spreaderLastSize.width&&r===this.spreaderLastSize.height||(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r,this.adjustElementsSize()),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.wot.wtViewport,n=this.wtTable,r=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),l=t.getRowHeaderWidth(),c=t.getColumnHeaderHeight(),h=n.hider.style;if(h.width="".concat(l+this.inlineStartOverlay.sumCellSizes(0,r),"px"),h.height="".concat(c+this.topOverlay.sumCellSizes(0,o)+1,"px"),this.scrollbarSize>0){var d=n.wtRootElement,f=d.scrollHeight,y=d.scrollWidth,v=n.holder,m=v.scrollHeight,w=v.scrollWidth;this.hasScrollbarRight=f<m,this.hasScrollbarBottom=y<w,this.hasScrollbarRight&&n.hider.scrollWidth+this.scrollbarSize>y?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&n.hider.scrollHeight+this.scrollbarSize>f&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(element){if(!element)return null;var e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],t=null;return Object(f.a)(e,(function(e){e&&e.clone&&e.clone.wtTable.TABLE.contains(element)&&(t=e.clone)})),t}},{key:"syncOverlayTableClassNames",value:function(){var e=this.wtTable.TABLE,t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];Object(f.a)(t,(function(t){t&&(t.clone.wtTable.TABLE.className=e.className)}))}}],n&&Er(t.prototype,n),o&&Er(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}(),kr=Tr;function jr(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ar(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var xr=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Ar(this,"settings",{}),Ar(this,"defaults",Object.freeze(this.getDefaults())),Object(object.o)(this.defaults,(function(e,r){if(void 0!==t[r])n.settings[r]=t[r];else{if(void 0===e)throw new Error('A required setting "'.concat(r,'" was not provided'));n.settings[r]=e}}))}var t,n,o;return t=e,(n=[{key:"getDefaults",value:function(){var e=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return e.getSetting("fixedColumnsStart")>0||e.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return e.getSetting("fixedRowsTop")>0||e.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return e.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(t,n,o){var l=e.getSetting("data",t,n);Object(r.g)(o,null==l?"":l)},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(e){return e},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(e){return e},onBeforeHighlightingColumnHeader:function(e){return e},onWindowResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(e,t){var n=this;return void 0===t?Object(object.o)(e,(function(e,t){n.settings[t]=e})):this.settings[e]=t,this}},{key:"getSetting",value:function(e,t,n,r,o){return"function"==typeof this.settings[e]?this.settings[e](t,n,r,o):void 0!==t&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}},{key:"getSettingPure",value:function(e){return this.settings[e]}},{key:"has",value:function(e){return!!this.settings[e]}}])&&jr(t.prototype,n),o&&jr(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Mr(e){return Mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mr(e)}function Ir(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _r(e,p){return _r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},_r(e,p)}function Nr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Pr(e);if(t){var o=Pr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Hr(this,n)}}function Hr(e,t){if(t&&("object"===Mr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Pr(e){return Pr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Pr(e)}var Dr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_r(e,t)}(c,e);var t,n,o,l=Nr(c);function c(e,t,n,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),l.call(this,e,t,n,r,"master")}return t=c,(n=[{key:"alignOverlaysWithTrimmingContainer",value:function(){var e=Object(r.s)(this.wtRootElement),t=this.domBindings.rootWindow;if(e===t)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{var n=e.parentElement,o=Object(r.r)(e,"height",t),l=Object(r.r)(e,"overflow",t),c=this.holder.style,h=e.scrollWidth,d=e.scrollHeight,f=e.getBoundingClientRect(),y=f.width,v=f.height;if(n&&["auto","hidden","scroll"].includes(l)){var m=e.cloneNode(!1);m.style.overflow="auto",e.nextElementSibling?n.insertBefore(m,e.nextElementSibling):n.appendChild(m);var w=parseInt(Object(r.i)(m,t).height,10);n.removeChild(m),0===w&&(v=0)}v=Math.min(v,d),c.height="auto"===o?"auto":"".concat(v,"px"),y=Math.min(y,h),c.width="".concat(y,"px"),c.overflow="",this.hasTableHeight="auto"===c.height||v>0,this.hasTableWidth=y>0}this.isTableVisible=Object(r.F)(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var e=this.wtSettings,t=this.dataAccessObject.wtViewport,n=e.getSetting("columnHeaders").length;if(n&&!t.hasOversizedColumnHeadersMarked.master){for(var r=e.getSetting("rowHeaders").length,o=this.getRenderedColumnsCount(),i=0;i<n;i++)for(var l=-1*r;l<o;l++)this.markIfOversizedColumnHeader(l);t.hasOversizedColumnHeadersMarked.master=!0}}}])&&Ir(t.prototype,n),o&&Ir(t,o),Object.defineProperty(t,"prototype",{writable:!1}),c}(ut);Object(object.n)(Dr,mn),Object(object.n)(Dr,bt);var Lr=Dr,Br=n(748);function Vr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Fr(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Wr=new WeakMap,zr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.viewportSize,r=t.scrollOffset,o=t.totalItems,l=t.itemSizeFn,c=t.overrideFn,h=t.calculationType,d=t.scrollbarHeight;Vr(this,e),Wr.set(this,{viewportHeight:n,scrollOffset:r,totalRows:o,rowHeightFn:l,overrideFn:c,calculationType:h,horizontalScrollbarHeight:d}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.calculate()}var t,n,r;return t=e,r=[{key:"DEFAULT_HEIGHT",get:function(){return 23}}],(n=[{key:"calculate",value:function(){for(var t,n=0,r=!0,o=[],l=Wr.get(this),c=l.calculationType,h=l.overrideFn,d=l.rowHeightFn,f=l.scrollOffset,y=l.totalRows,v=l.viewportHeight,m=l.horizontalScrollbarHeight||0,i=0;i<y;i++)if(t=d(i),isNaN(t)&&(t=e.DEFAULT_HEIGHT),n<=f&&c!==Br.a&&(this.startRow=i),n>=f&&n+(c===Br.a?t:0)<=f+v-m&&(null===this.startRow&&(this.startRow=i),this.endRow=i),o.push(n),n+=t,c!==Br.a&&(this.endRow=i),n>=f+v-m){r=!1;break}if(this.endRow===y-1&&r)for(this.startRow=this.endRow;this.startRow>0;){var w=o[this.endRow]+t-o[this.startRow-1];if((w<=v-m||c!==Br.a)&&(this.startRow-=1),w>=v-m)break}c===Br.b&&null!==this.startRow&&h&&h(this),this.startPosition=o[this.startRow],void 0===this.startPosition&&(this.startPosition=null),y<this.endRow&&(this.endRow=y-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}])&&Fr(t.prototype,n),r&&Fr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Ur=zr,Gr=n(888);function Xr(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Kr=function(){function e(t,n,r,o,l){var c=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=l,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",(function(){c.clientHeight=c.getWorkspaceHeight()}))}var t,n,o;return t=e,n=[{key:"getWorkspaceHeight",value:function(){var e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer;return t===this.domBindings.rootWindow?e.documentElement.clientHeight:Object(r.H)(t)>0&&t.clientHeight>0?t.clientHeight:1/0}},{key:"getWorkspaceWidth",value:function(){var e,t,n=this.wtSettings,o=this.domBindings,l=o.rootDocument,c=o.rootWindow,h=this.dataAccessObject.inlineStartOverlayTrimmingContainer,d=l.documentElement.offsetWidth,f=n.getSetting("totalColumns"),y=n.getSetting("preventOverflow"),v=n.getSetting("rtlMode"),m=this.wtTable.TABLE.getBoundingClientRect(),w=d-(v?m.right-d:m.left);if(y)return Object(r.I)(this.wtTable.wtRootElement);if(e=n.getSetting("freezeOverlays")?Math.min(w,d):Math.min(this.getContainerFillWidth(),w,d),h===c&&f>0&&this.sumColumnWidths(0,f-1)>e)return l.documentElement.clientWidth;if(h!==c&&("scroll"===(t=Object(r.r)(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",c))||"hidden"===t||"auto"===t))return Math.max(e,h.clientWidth);var O=n.getSetting("stretchH");return"none"!==O&&O?e:Math.max(e,Object(r.I)(this.wtTable.TABLE))}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(e,t){for(var n=0,r=e;r<t;)n+=this.wtTable.getColumnWidth(r),r+=1;return n}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var e=this.wtTable.holder,t=this.domBindings.rootDocument.createElement("div");t.style.width="100%",t.style.height="1px",e.appendChild(t);var n=t.offsetWidth;return this.containerWidth=n,e.removeChild(t),n}},{key:"getWorkspaceOffset",value:function(){return Object(r.G)(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Object(r.H)(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var e=this.getWorkspaceHeight();if(e===1/0)return e;var t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}},{key:"getRowHeaderWidth",value:function(){var e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(var i=0,n=t.length;i<n;i++)this.rowHeaderWidth+=e[i]||e}if(isNaN(this.rowHeaderWidth))if(t.length){var o=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var l=0,c=t.length;l<c;l++)o?(this.rowHeaderWidth+=Object(r.I)(o),o=o.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var e=this.getWorkspaceWidth();if(e===1/0)return e;var t=this.getRowHeaderWidth();return t>0?e-t:e}},{key:"createRowsCalculator",value:function(){var e,t,n,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Br.b,l=this.wtSettings,c=this.wtTable;this.rowHeaderWidth=NaN,e=l.getSetting("renderAllRows")&&o===Br.b?1/0:this.getViewportHeight();var h=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;h<0&&(h=0);var d=l.getSetting("fixedRowsTop"),f=l.getSetting("fixedRowsBottom"),y=l.getSetting("totalRows");return d&&(h+=n=this.dataAccessObject.topOverlay.sumCellSizes(0,d),e-=n),f&&this.dataAccessObject.bottomOverlay.clone&&(e-=n=this.dataAccessObject.bottomOverlay.sumCellSizes(y-f,y)),t=c.holder.clientHeight===c.holder.offsetHeight?0:Object(r.o)(this.domBindings.rootDocument),new Ur({viewportSize:e,scrollOffset:h,totalItems:l.getSetting("totalRows"),itemSizeFn:function(e){return c.getRowHeight(e)},overrideFn:l.getSettingPure("viewportRowCalculatorOverride"),calculationType:o,scrollbarHeight:t})}},{key:"createColumnsCalculator",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Br.b,t=this.wtSettings,n=this.wtTable,o=this.getViewportWidth(),l=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN,l<0&&(l=0);var c=t.getSetting("fixedColumnsStart");if(c){var h=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,c);l+=h,o-=h}return n.holder.clientWidth!==n.holder.offsetWidth&&(o-=Object(r.o)(this.domBindings.rootDocument)),new Gr.a({viewportSize:o,scrollOffset:Math.abs(l),totalItems:t.getSetting("totalColumns"),itemSizeFn:function(e){return n.getColumnWidth(e)},overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,stretchMode:t.getSetting("stretchH"),stretchingItemWidthFn:function(e,n){return t.getSetting("onBeforeStretchingColumnWidth",e,n)}})}},{key:"createRenderCalculators",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=e;if(t){var n=this.createRowsCalculator(Br.a),r=this.createColumnsCalculator(Br.a);this.areAllProposedVisibleRowsAlreadyRendered(n)&&this.areAllProposedVisibleColumnsAlreadyRendered(r)||(t=!1)}return t||(this.rowsRenderCalculator=this.createRowsCalculator(Br.b),this.columnsRenderCalculator=this.createColumnsCalculator(Br.b)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,t}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(Br.a),this.columnsVisibleCalculator=this.createColumnsCalculator(Br.a)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(e){if(!this.rowsVisibleCalculator)return!1;var t=e.startRow,n=e.endRow;if(null===t&&null===n)return!1;var r=this.rowsRenderCalculator,o=r.startRow,l=r.endRow;return!(t<o||t===o&&t>0||n>l||n===l&&n<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(e){if(!this.columnsVisibleCalculator)return!1;var t=e.startColumn,n=e.endColumn;if(null===t&&null===n)return!1;var r=this.columnsRenderCalculator,o=r.startColumn,l=r.endColumn;return!(t<o||t===o&&t>0||n>l||n===l&&n<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){Object(object.o)(this.hasOversizedColumnHeadersMarked,(function(e,t,object){object[t]=void 0}))}}],n&&Xr(t.prototype,n),o&&Xr(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Yr=Kr;function qr(e){return qr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qr(e)}function $r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Qr(e,p){return Qr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},Qr(e,p)}function Jr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=to(e);if(t){var o=to(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Zr(this,n)}}function Zr(e,t){if(t&&("object"===qr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return eo(e)}function eo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function to(e){return to=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},to(e)}var no=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qr(e,t)}(c,e);var t,n,o,l=Jr(c);function c(table,e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c);var n=(t=l.call(this,table,new xr(e))).wtSettings.getSetting("facade",eo(t));return t.wtTable=new Lr(t.getTableDao(),n,t.domBindings,t.wtSettings),t.wtViewport=new Yr(t.getViewportDao(),t.domBindings,t.wtSettings,t.eventManager,t.wtTable),t.selections=t.wtSettings.getSetting("selections"),t.wtEvent=new A(n,t.domBindings,t.wtSettings,t.eventManager,t.wtTable,t.selections),t.wtOverlays=new kr(eo(t),n,t.domBindings,t.wtSettings,t.eventManager,t.wtTable),t.exportSettingsAsClassNames(),t.findOriginalHeaders(),t}return t=c,(n=[{key:"exportSettingsAsClassNames",value:function(){var e=this,t=[],n=[];Object(object.o)({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},(function(r,o){e.wtSettings.getSetting(o).length&&n.push(r),t.push(r)})),Object(r.K)(this.wtTable.wtRootElement.parentNode,t),Object(r.a)(this.wtTable.wtRootElement.parentNode,n)}},{key:"getViewportDao",value:function(){var e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}])&&$r(t.prototype,n),o&&$r(t,o),Object.defineProperty(t,"prototype",{writable:!1}),c}(Mt);function ro(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var oo=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t instanceof Mt?this._wot=t:this._initFromSettings(t)}var t,n,r;return t=e,n=[{key:"_initFromSettings",value:function(t){t.facade=function(t){var n=new e(t);return function(){return n}},this._wot=new no(t.table,t)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(e){this._wot.drawn=e}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(e){this._wot.drawInterrupted=e}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(e){this._wot.lastMouseOver=e}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(e){this._wot.momentumScrolling=e}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(e){this._wot.touchApplied=e}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(e){this._wot.eventListeners=e}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(e,t){return this._wot.createCellCoords(e,t)}},{key:"createCellRange",value:function(e,t,n){return this._wot.createCellRange(e,t,n)}},{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(e),this}},{key:"getCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(e,t)}},{key:"scrollViewport",value:function(e,t,n,r,o){return this._wot.scrollViewport(e,t,n,r,o)}},{key:"scrollViewportHorizontally",value:function(e,t,n){return this._wot.scrollViewportHorizontally(e,t,n)}},{key:"scrollViewportVertically",value:function(e,t,n){return this._wot.scrollViewportVertically(e,t,n)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(e,t){return this._wot.wtSettings.update(e,t),this}},{key:"getSetting",value:function(e,t,n,r,o){return this._wot.wtSettings.getSetting(e,t,n,r,o)}},{key:"hasSetting",value:function(e){return this._wot.wtSettings.hasSetting(e)}},{key:"destroy",value:function(){this._wot.destroy()}}],n&&ro(t.prototype,n),r&&ro(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function io(e){var t=e.isShiftKey,n=e.isLeftClick,r=e.isRightClick,o=e.coords,l=e.selection,c=e.controller,h=e.cellCoordsFactory,d=l.isSelected()?l.getSelectedRange().current():null,f=l.isSelectedByCorner(),y=l.isSelectedByRowHeader();if(t&&d)o.row>=0&&o.col>=0&&!c.cell?l.setRangeEnd(o):(f||y)&&o.row>=0&&o.col>=0&&!c.cell?l.setRangeEnd(h(o.row,o.col)):f&&o.row<0&&!c.column?l.setRangeEnd(h(d.to.row,o.col)):y&&o.col<0&&!c.row?l.setRangeEnd(h(o.row,d.to.col)):(!f&&!y&&o.col<0||f&&o.col<0)&&!c.row?l.selectRows(Math.max(d.from.row,0),o.row,o.col):(!f&&!y&&o.row<0||y&&o.row<0)&&!c.column&&l.selectColumns(Math.max(d.from.col,0),o.col,o.row);else{var v=!l.inInSelection(o),m=n||r&&v;o.row<0&&o.col>=0&&!c.column?m&&l.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!c.row?m&&l.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!c.cell?m&&l.setRangeStart(o):o.col<0&&o.row<0&&l.selectAll(!0,!0)}}var ao=new Map([["mousedown",io],["mouseover",function(e){var t=e.isLeftClick,n=e.coords,r=e.selection,o=e.controller,l=e.cellCoordsFactory;if(t){var c=r.isSelectedByRowHeader(),h=r.isSelectedByColumnHeader(),d=r.tableProps.countCols(),f=r.tableProps.countRows();h&&!o.column?r.setRangeEnd(l(f-1,n.col)):c&&!o.row?r.setRangeEnd(l(n.row,d-1)):o.cell||r.setRangeEnd(n)}}],["touchstart",io]]);function lo(e,t){var n=t.coords,r=t.selection,o=t.controller,l=t.cellCoordsFactory;ao.get(e.type)({coords:n,selection:r,controller:o,cellCoordsFactory:l,isShiftKey:e.shiftKey,isLeftClick:Object(S.b)(e)||"touchstart"===e.type,isRightClick:Object(S.c)(e)})}var so=n(713);function co(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||ho(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function uo(e){return function(e){if(Array.isArray(e))return fo(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ho(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ho(e,t){if(e){if("string"==typeof e)return fo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fo(e,t):void 0}}function fo(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function po(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var bo=new WeakMap,yo=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.instance=t,this.eventManager=new d.a(t),this.settings=t.getSettings(),this.THEAD=void 0,this.TBODY=void 0,this._wt=void 0,this.activeWt=void 0,this.postponedAdjustElementsSize=!1,bo.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}var t,n,o;return t=e,n=[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}},{key:"getCellAtCoords",value:function(e,t){var td=this._wt.getCell(e,t);return td<0?null:td}},{key:"scrollViewport",value:function(e,t,n,r,o){return this._wt.scrollViewport(e,t,n,r,o)}},{key:"scrollViewportHorizontally",value:function(e,t,n){return this._wt.scrollViewportHorizontally(e,t,n)}},{key:"scrollViewportVertically",value:function(e,t,n){return this._wt.scrollViewportVertically(e,t,n)}},{key:"createElements",value:function(){var e=bo.get(this),t=this.instance,n=t.rootElement,o=t.rootDocument,l=n.getAttribute("style");l&&n.setAttribute("data-originalstyle",l),Object(r.a)(n,"handsontable"),e.table=o.createElement("TABLE"),Object(r.a)(e.table,"htCore"),this.instance.getSettings().tableClassName&&Object(r.a)(e.table,this.instance.getSettings().tableClassName),this.THEAD=o.createElement("THEAD"),e.table.appendChild(this.THEAD),this.TBODY=o.createElement("TBODY"),e.table.appendChild(this.TBODY),this.instance.table=e.table,this.instance.container.insertBefore(e.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var e=this,t=bo.get(this),n=this.instance,o=n.rootElement,l=n.rootDocument,c=n.selection,h=l.documentElement;this.eventManager.addEventListener(o,"mousedown",(function(n){if(t.selectionMouseDown=!0,!e.isTextSelectionAllowed(n.target)){var o=e.instance.rootWindow;Object(r.b)(o),n.preventDefault(),o.focus()}})),this.eventManager.addEventListener(o,"mouseup",(function(){t.selectionMouseDown=!1})),this.eventManager.addEventListener(o,"mousemove",(function(n){t.selectionMouseDown&&!e.isTextSelectionAllowed(n.target)&&(e.settings.fragmentSelection&&Object(r.b)(e.instance.rootWindow),n.preventDefault())})),this.eventManager.addEventListener(h,"keyup",(function(e){c.isInProgress()&&!e.shiftKey&&c.finish()})),this.eventManager.addEventListener(h,"mouseup",(function(n){c.isInProgress()&&Object(S.b)(n)&&c.finish(),t.mouseDown=!1,!Object(r.E)(l.activeElement)&&(c.isSelected()||c.isSelectedByAnyHeader()||o.contains(n.target)||Object(S.c)(n))||e.instance.unlisten()})),this.eventManager.addEventListener(h,"contextmenu",(function(e){c.isInProgress()&&Object(S.c)(e)&&(c.finish(),t.mouseDown=!1)})),this.eventManager.addEventListener(h,"touchend",(function(){c.isInProgress()&&c.finish(),t.mouseDown=!1})),this.eventManager.addEventListener(h,"mousedown",(function(n){var c=n.target,d=n.x||n.clientX,f=n.y||n.clientY,y=n.target;if(!t.mouseDown&&o&&e.instance.view){var v=e.instance.view._wt.wtTable.holder;if(y===v){var m=Object(r.o)(l);if(l.elementFromPoint(d+m,f)!==v||l.elementFromPoint(d,f+m)!==v)return}else for(;y!==h;){if(null===y){if(n.isTargetWebComponent)break;return}if(y===o)return;y=y.parentNode}("function"==typeof e.settings.outsideClickDeselects?e.settings.outsideClickDeselects(c):e.settings.outsideClickDeselects)?e.instance.deselectCell():e.instance.destroyEditor(!1,!1)}})),this.eventManager.addEventListener(t.table,"selectstart",(function(t){e.settings.fragmentSelection||Object(r.D)(t.target)||t.preventDefault()}))}},{key:"translateFromRenderableToVisualCoords",value:function(e){var t,n=e.row,col=e.col;return(t=this.instance)._createCellCoords.apply(t,uo(this.translateFromRenderableToVisualIndex(n,col)))}},{key:"translateFromRenderableToVisualIndex",value:function(e,t){var n=e>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(e):e,r=t>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(t):t;return null===n&&(n=e),null===r&&(r=t),[n,r]}},{key:"countRenderableIndexes",value:function(e,t){var n=Math.min(e.getNotTrimmedIndexesLength(),t),r=e.getNearestNotHiddenIndex(n-1,-1);return null===r?0:e.getRenderableFromVisualIndex(r)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(e,t){return this.countNotHiddenIndexes(e,t,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(e,t){return this.countNotHiddenIndexes(e,t,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(e,t,n,r){if(isNaN(e)||e<0)return 0;var o=n.getNearestNotHiddenIndex(e,t),l=n.getRenderableFromVisualIndex(o);if(!Number.isInteger(l))return 0;var c=0;return t<0?c=l+1:t>0&&(c=r-l),c}},{key:"countNotHiddenFixedColumnsStart",value:function(){var e=this.instance.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var e=this.instance.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var e=this.instance.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>e&&this.instance.countRenderedCols()>t}},{key:"initializeWalkontable",value:function(){var e=this,t=bo.get(this),n={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:t.table,isDataViewInstance:function(){return Object(so.b)(e.instance)},preventOverflow:function(){return e.settings.preventOverflow},preventWheel:function(){return e.settings.preventWheel},stretchH:function(){return e.settings.stretchH},data:function(t,n){var r;return(r=e.instance).getDataAtCell.apply(r,uo(e.translateFromRenderableToVisualIndex(t,n)))},totalRows:function(){return e.countRenderableRows()},totalColumns:function(){return e.countRenderableColumns()},fixedColumnsStart:function(){return e.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return e.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return e.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return e.settings.fixedColumnsStart>0||n.rowHeaders().length>0},shouldRenderTopOverlay:function(){return e.settings.fixedRowsTop>0||n.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return e.settings.fixedRowsBottom>0},minSpareRows:function(){return e.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var t=[];return e.instance.hasRowHeaders()&&t.push((function(t,n){var r=t>=0?e.instance.rowIndexMapper.getVisualFromRenderableIndex(t):t;e.appendRowHeader(r,n)})),e.instance.runHooks("afterGetRowHeaderRenderers",t),t},columnHeaders:function(){var t=[];return e.instance.hasColHeaders()&&t.push((function(t,n){var r=t>=0?e.instance.columnIndexMapper.getVisualFromRenderableIndex(t):t;e.appendColHeader(r,n)})),e.instance.runHooks("afterGetColumnHeaderRenderers",t),t},columnWidth:function(t){var n=e.instance.columnIndexMapper.getVisualFromRenderableIndex(t);return e.instance.getColWidth(null===n?t:n)},rowHeight:function(t){var n=e.instance.rowIndexMapper.getVisualFromRenderableIndex(t);return e.instance.getRowHeight(null===n?t:n)},cellRenderer:function(t,n,r){var o=co(e.translateFromRenderableToVisualIndex(t,n),2),l=o[0],c=o[1],h=e.instance.runHooks("modifyGetCellCoords",l,c),d=l,f=c;if(Array.isArray(h)){var y=co(h,2);d=y[0],f=y[1]}var v=e.instance.getCellMeta(d,f),m=e.instance.colToProp(f),w=e.instance.getDataAtRowProp(d,m);e.instance.hasHook("beforeValueRender")&&(w=e.instance.runHooks("beforeValueRender",w,v)),e.instance.runHooks("beforeRenderer",r,l,c,m,w,v),e.instance.getCellRenderer(v)(e.instance,r,l,c,m,w,v),e.instance.runHooks("afterRenderer",r,l,c,m,w,v)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return e.settings.fragmentSelection},onWindowResize:function(){e.instance&&!e.instance.isDestroyed&&e.instance.refreshDimensions()},onCellMouseDown:function(n,r,o,l){var c=e.translateFromRenderableToVisualCoords(r),h={row:!1,column:!1,cell:!1};e.instance.listen(),e.activeWt=l,t.mouseDown=!0,e.instance.runHooks("beforeOnCellMouseDown",n,c,o,h),Object(S.a)(n)||(lo(n,{coords:c,selection:e.instance.selection,controller:h,cellCoordsFactory:function(t,n){return e.instance._createCellCoords(t,n)}}),e.instance.runHooks("afterOnCellMouseDown",n,c,o),e.activeWt=e._wt)},onCellContextMenu:function(n,r,o,l){var c=e.translateFromRenderableToVisualCoords(r);e.activeWt=l,t.mouseDown=!1,e.instance.selection.isInProgress()&&e.instance.selection.finish(),e.instance.runHooks("beforeOnCellContextMenu",n,c,o),Object(S.a)(n)||(e.instance.runHooks("afterOnCellContextMenu",n,c,o),e.activeWt=e._wt)},onCellMouseOut:function(t,n,r,o){var l=e.translateFromRenderableToVisualCoords(n);e.activeWt=o,e.instance.runHooks("beforeOnCellMouseOut",t,l,r),Object(S.a)(t)||(e.instance.runHooks("afterOnCellMouseOut",t,l,r),e.activeWt=e._wt)},onCellMouseOver:function(n,r,o,l){var c=e.translateFromRenderableToVisualCoords(r),h={row:!1,column:!1,cell:!1};e.activeWt=l,e.instance.runHooks("beforeOnCellMouseOver",n,c,o,h),Object(S.a)(n)||(t.mouseDown&&lo(n,{coords:c,selection:e.instance.selection,controller:h,cellCoordsFactory:function(t,n){return e.instance._createCellCoords(t,n)}}),e.instance.runHooks("afterOnCellMouseOver",n,c,o),e.activeWt=e._wt)},onCellMouseUp:function(t,n,r,o){var l=e.translateFromRenderableToVisualCoords(n);e.activeWt=o,e.instance.runHooks("beforeOnCellMouseUp",t,l,r),Object(S.a)(t)||e.instance.isDestroyed||(e.instance.runHooks("afterOnCellMouseUp",t,l,r),e.activeWt=e._wt)},onCellCornerMouseDown:function(t){t.preventDefault(),e.instance.runHooks("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:function(t){t.preventDefault(),e.instance.runHooks("afterOnCellCornerDblClick",t)},beforeDraw:function(t,n){return e.beforeRender(t,n)},onDraw:function(t){return e.afterRender(t)},onScrollVertically:function(){return e.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return e.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return e.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(t,n,r){var o=e.instance.rowIndexMapper,l=o.getVisualFromRenderableIndex(t),c=e.instance.runHooks("beforeHighlightingRowHeader",l,n,r);return o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(c,1))},onBeforeHighlightingColumnHeader:function(t,n,r){var o=e.instance.columnIndexMapper,l=o.getVisualFromRenderableIndex(t),c=e.instance.runHooks("beforeHighlightingColumnHeader",l,n,r);return o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(c,1))},onAfterDrawSelection:function(t,n,r){var o,l=co(e.translateFromRenderableToVisualIndex(t,n),2),c=l[0],h=l[1],d=e.instance.selection.getSelectedRange(),f=d.size();if(f>0){var y=(null!=r?r:0)+1-f,v=d.peekByIndex(y);o=[v.from.row,v.from.col,v.to.row,v.to.col]}return e.instance.runHooks("afterDrawSelection",c,h,o,r)},onBeforeDrawBorders:function(t,n){var r=co(t,4),o=r[0],l=r[1],c=r[2],h=r[3],d=[e.instance.rowIndexMapper.getVisualFromRenderableIndex(o),e.instance.columnIndexMapper.getVisualFromRenderableIndex(l),e.instance.rowIndexMapper.getVisualFromRenderableIndex(c),e.instance.columnIndexMapper.getVisualFromRenderableIndex(h)];return e.instance.runHooks("beforeDrawBorders",d,n)},onBeforeTouchScroll:function(){return e.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return e.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(t,n){var r=e.instance.columnIndexMapper.getVisualFromRenderableIndex(n);return e.instance.runHooks("beforeStretchingColumnWidth",t,r)},onModifyRowHeaderWidth:function(t){return e.instance.runHooks("modifyRowHeaderWidth",t)},onModifyGetCellCoords:function(t,n,r){var o=e.instance.rowIndexMapper,l=e.instance.columnIndexMapper,c=n>=0?l.getVisualFromRenderableIndex(n):n,h=t>=0?o.getVisualFromRenderableIndex(t):t,d=e.instance.runHooks("modifyGetCellCoords",h,c,r);if(Array.isArray(d)){var f=co(d,4),y=f[0],v=f[1],m=f[2],w=f[3];return[y>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(y,1)):y,v>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(v,1)):v,m>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(m,-1)):m,w>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(w,-1)):w]}},viewportRowCalculatorOverride:function(t){var n=e.settings.viewportRowRenderingOffset;if("auto"===n&&e.settings.fixedRowsTop&&(n=10),n>0||"auto"===n){var r=e.countRenderableRows(),o=t.startRow,l=t.endRow;if("number"==typeof n)t.startRow=Math.max(o-n,0),t.endRow=Math.min(l+n,r-1);else if("auto"===n){var c=Math.ceil(l/r*12);t.startRow=Math.max(o-c,0),t.endRow=Math.min(l+c,r-1)}}e.instance.runHooks("afterViewportRowCalculatorOverride",t)},viewportColumnCalculatorOverride:function(t){var n=e.settings.viewportColumnRenderingOffset;if("auto"===n&&e.settings.fixedColumnsStart&&(n=10),n>0||"auto"===n){var r=e.countRenderableColumns(),o=t.startColumn,l=t.endColumn;if("number"==typeof n&&(t.startColumn=Math.max(o-n,0),t.endColumn=Math.min(l+n,r-1)),"auto"===n){var c=Math.ceil(l/r*6);t.startColumn=Math.max(o-c,0),t.endColumn=Math.min(l+c,r-1)}}e.instance.runHooks("afterViewportColumnCalculatorOverride",t)},rowHeaderWidth:function(){return e.settings.rowHeaderWidth},columnHeaderHeight:function(){var t=e.instance.runHooks("modifyColumnHeaderHeight");return e.settings.columnHeaderHeight||t}};this.instance.runHooks("beforeInitWalkontable",n),this._wt=new oo(n),this.activeWt=this._wt;var r=this._wt.wtTable.spreader,o=this.instance.rootElement.getBoundingClientRect(),l=o.width,c=o.height;this.setLastSize(l,c),this.eventManager.addEventListener(r,"mousedown",(function(e){e.target===r&&3===e.which&&e.stopPropagation()})),this.eventManager.addEventListener(r,"contextmenu",(function(e){e.target===r&&3===e.which&&e.stopPropagation()})),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",(function(){e.settings.observeDOMVisibility&&e._wt.drawInterrupted&&(e.instance.forceFullRender=!0,e.render())}))}},{key:"isTextSelectionAllowed",value:function(e){if(Object(r.D)(e))return!0;var t=Object(r.B)(e,this.instance.view._wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!t)||!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!t)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return bo.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var e,t;return null!==(e=null===(t=this.instance.getSelectedRangeLast())||void 0===t?void 0:t.isSingle())&&void 0!==e&&e}},{key:"isCellEdited",value:function(){var e=this.instance.getActiveEditor();return e&&e.isOpened()}},{key:"beforeRender",value:function(e,t){e&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,t)}},{key:"afterRender",value:function(e){e&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(e,t){if(t.firstChild){var n=t.firstChild;if(!Object(r.v)(n,"relative"))return Object(r.e)(t),void this.appendRowHeader(e,t);this.updateCellHeader(n.querySelector(".rowHeader"),e,this.instance.getRowHeader)}else{var o=this.instance,l=o.rootDocument,c=o.getRowHeader,div=l.createElement("div"),span=l.createElement("span");div.className="relative",span.className="rowHeader",this.updateCellHeader(span,e,c),div.appendChild(span),t.appendChild(div)}this.instance.runHooks("afterGetRowHeader",e,t)}},{key:"appendColHeader",value:function(e,t){if(t.firstChild){var n=t.firstChild;Object(r.v)(n,"relative")?this.updateCellHeader(n.querySelector(".colHeader"),e,this.instance.getColHeader):(Object(r.e)(t),this.appendColHeader(e,t))}else{var o=this.instance.rootDocument,div=o.createElement("div"),span=o.createElement("span");div.className="relative",span.className="colHeader",this.updateCellHeader(span,e,this.instance.getColHeader),div.appendChild(span),t.appendChild(div)}this.instance.runHooks("afterGetColHeader",e,t)}},{key:"updateCellHeader",value:function(element,e,content){var t=e,n=this._wt.wtOverlays.getParentOverlay(element)||this._wt;element.parentNode&&(Object(r.v)(element,"colHeader")?t=n.wtTable.columnFilter.sourceToRendered(e):Object(r.v)(element,"rowHeader")&&(t=n.wtTable.rowFilter.sourceToRendered(e))),t>-1?Object(r.f)(element,content(e)):(Object(r.g)(element,String.fromCharCode(160)),Object(r.a)(element,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(e){var t=this._wt.wtViewport.getWorkspaceWidth()-e;return t>0?t:0}},{key:"maximumVisibleElementHeight",value:function(e){var t=this._wt.wtViewport.getWorkspaceHeight()-e;return t>0?t:0}},{key:"setLastSize",value:function(e,t){var n=bo.get(this),r=[e,t];n.lastWidth=r[0],n.lastHeight=r[1]}},{key:"getLastSize",value:function(){var e=bo.get(this);return{width:e.lastWidth,height:e.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}],n&&po(t.prototype,n),o&&po(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}(),go=yo,vo=n(694);function mo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wo(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Oo=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];mo(this,e),this.hot=t,this.data=n,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}var t,n,r;return t=e,n=[{key:"modifyRowData",value:function(e){var t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),void 0===t||Number.isInteger(t)?this.data[e]:t}},{key:"getData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,e):this.data}},{key:"setData",value:function(data){this.data=data}},{key:"getAtColumn",value:function(e){var t=this,n=[];return Object(f.a)(this.data,(function(r,o){var l=t.getAtCell(o,e);n.push(l)})),n}},{key:"getAtRow",value:function(e,t,n){var r=this,l=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=void 0===t&&void 0===n,h=null,d=null;if(h=this.modifyRowData(e),Array.isArray(h))d=[],c?h.forEach((function(t,n){d[n]=r.getAtPhysicalCell(e,n,h)})):Object(C.c)(t,n,(function(n){d[n-t]=r.getAtPhysicalCell(e,n,h)}));else if(Object(object.l)(h)||Object(o.d)(h))if(d=l?[]:{},!c||l){var f=0,y=this.countFirstRowKeys()-1;Object(C.c)(f,y,(function(o){var c=r.colToProp(o);if(o>=(t||f)&&o<=(n||y)&&!Number.isInteger(c)){var v=r.getAtPhysicalCell(e,c,h);l?d.push(v):Object(object.p)(d,c,v)}}))}else Object(object.o)(h,(function(t,n){Object(object.p)(d,n,r.getAtPhysicalCell(e,n,h))}));return d}},{key:"setAtCell",value:function(e,t,n){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var r=Object(object.b)(n);this.hot.runHooks("modifySourceData",e,this.propToCol(t),r,"set"),r.isTouched()&&(n=r.value)}Number.isInteger(t)?this.data[e][t]=n:Object(object.p)(this.data[e],t,n)}}},{key:"getAtPhysicalCell",value:function(e,t,n){var r=null;if(n&&(r="string"==typeof t?Object(object.i)(n,t):"function"==typeof t?t(n):n[t]),this.hot.hasHook("modifySourceData")){var o=Object(object.b)(r);this.hot.runHooks("modifySourceData",e,this.colToProp(t),o,"get"),o.isTouched()&&(r=o.value)}return r}},{key:"getAtCell",value:function(e,t){var n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),n)}},{key:"getByRange",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=!1,l=null,c=null,h=null,d=null;null===t||null===n?(o=!0,l=0,h=this.countRows()-1):(l=Math.min(t.row,n.row),c=Math.min(t.col,n.col),h=Math.max(t.row,n.row),d=Math.max(t.col,n.col));var f=[];return Object(C.c)(l,h,(function(t){f.push(o?e.getAtRow(t,void 0,void 0,r):e.getAtRow(t,c,d,r))})),f}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}},{key:"countFirstRowKeys",value:function(){return Object(vo.b)(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}],n&&wo(t.prototype,n),r&&wo(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Co=Oo,So=(n(631),n(213),n(9),n(52),n(623),n(12),n(683)),Eo=n(692),Ro=n(815);function To(e){return To="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},To(e)}function ko(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function jo(){return jo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var base=Ao(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},jo.apply(this,arguments)}function Ao(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=_o(object)););return object}function xo(e,p){return xo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},xo(e,p)}function Mo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=_o(e);if(t){var o=_o(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Io(this,n)}}function Io(e,t){if(t&&("object"===To(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function _o(e){return _o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_o(e)}var No=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xo(e,t)}(l,e);var t,n,r,o=Mo(l);function l(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),o.call(this,(function(e){return e}))}return t=l,(n=[{key:"insert",value:function(e,t){var n=Object(Ro.b)(this.indexedValues,t);this.indexedValues=Object(Eo.a)(n,e,t),jo(_o(l.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){var t=Object(Eo.b)(this.indexedValues,e);this.indexedValues=Object(Ro.a)(t,e),jo(_o(l.prototype),"remove",this).call(this,e)}}])&&ko(t.prototype,n),r&&ko(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(So.a),Ho=n(743),Po=n(745),Do=n(693),Lo=n(746),Bo=new Map([["hiding",Ho.a],["index",So.a],["linkedPhysicalIndexToValue",Po.a],["physicalIndexToValue",Do.a],["trimming",Lo.a]]);var Vo=n(642);function Fo(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Wo=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.collection=new Map}var t,n,r;return t=e,(n=[{key:"register",value:function(e,t){var n=this;!1===this.collection.has(e)&&(this.collection.set(e,t),t.addLocalHook("change",(function(){return n.runLocalHooks("change",t)})),1)}},{key:"unregister",value:function(e){var t=this.collection.get(e);Object(l.b)(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t),1)}},{key:"unregisterAll",value:function(){var e=this;this.collection.forEach((function(t,n){return e.unregister(n)})),this.collection.clear()}},{key:"get",value:function(e){return Object(l.e)(e)?Array.from(this.collection.values()):this.collection.get(e)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(e){this.collection.forEach((function(t){t.remove(e)}))}},{key:"insertToEvery",value:function(e,t){this.collection.forEach((function(n){n.insert(e,t)}))}},{key:"initEvery",value:function(e){this.collection.forEach((function(t){t.init(e)}))}}])&&Fo(t.prototype,n),r&&Fo(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function zo(e){return zo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zo(e)}function Uo(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Go(e,p){return Go=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},Go(e,p)}function Xo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Yo(e);if(t){var o=Yo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ko(this,n)}}function Ko(e,t){if(t&&("object"===zo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Yo(e){return Yo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Yo(e)}Object(object.n)(Wo,Vo.a);var qo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Go(e,t)}(c,e);var t,n,r,o=Xo(c);function c(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(n=o.call(this)).mergedValuesCache=[],n.aggregationFunction=e,n.fallbackValue=t,n}return t=c,n=[{key:"getMergedValues",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===e)return this.mergedValuesCache;if(0===this.getLength())return[];for(var t=Object(f.c)(this.get(),(function(map){return map.getValues()})),n=[],r=Object(l.b)(t[0])&&t[0].length||0,o=0;o<r;o+=1){for(var c=[],h=0;h<this.getLength();h+=1)c.push(t[h][o]);n.push(c)}return Object(f.c)(n,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(e,t){var n=this.getMergedValues(t)[e];return Object(l.b)(n)?n:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}],n&&Uo(t.prototype,n),r&&Uo(t,r),Object.defineProperty(t,"prototype",{writable:!1}),c}(Wo);function $o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Qo(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function Jo(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,Zo(e,t,"set"),n),n}function Zo(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var ei=new WeakMap,ti=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Qo(this,ei,{writable:!0,value:[]})}var t,n,r;return t=e,(n=[{key:"subscribe",value:function(e){var t;return this.addLocalHook("change",e),this._write(function(e,t){return t.get?t.get.call(e):t.value}(t=this,Zo(t,ei,"get"))),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(e){return e.length>0&&this.runLocalHooks("change",e),this}},{key:"_writeInitialChanges",value:function(e){Jo(this,ei,e)}}])&&$o(t.prototype,n),r&&$o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ni(e,t){for(var n=[],i=0,r=0;i<e.length&&r<t.length;i++,r++)e[i]!==t[r]&&n.push({op:"replace",index:r,oldValue:e[i],newValue:t[r]});for(;i<t.length;i++)n.push({op:"insert",index:i,oldValue:void 0,newValue:t[i]});for(;r<e.length;r++)n.push({op:"remove",index:r,oldValue:e[r],newValue:void 0});return n}function ri(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oi(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ii(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function ai(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,ci(e,t,"get"))}function si(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,ci(e,t,"set"),n),n}function ci(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}Object(object.n)(ti,Vo.a);var ui,hi=new WeakMap,di=new WeakMap,fi=new WeakMap,pi=new WeakMap,bi=new WeakMap,yi=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.initialIndexValue;ri(this,e),ii(this,hi,{writable:!0,value:new Set}),ii(this,di,{writable:!0,value:[]}),ii(this,fi,{writable:!0,value:[]}),ii(this,pi,{writable:!0,value:!1}),ii(this,bi,{writable:!0,value:!1}),si(this,bi,null!=n&&n)}var t,n,r;return t=e,(n=[{key:"createObserver",value:function(){var e=this,t=new ti;return ai(this,hi).add(t),t.addLocalHook("unsubscribe",(function(){ai(e,hi).delete(t)})),t._writeInitialChanges(ni(ai(this,di),ai(this,fi))),t}},{key:"emit",value:function(e){var t=ai(this,fi);ai(this,pi)&&ai(this,di).length===e.length||(0===e.length?e=new Array(t.length).fill(ai(this,bi)):si(this,di,new Array(e.length).fill(ai(this,bi))),ai(this,pi)||(si(this,pi,!0),t=ai(this,di)));var n=ni(t,e);ai(this,hi).forEach((function(e){return e._write(n)})),si(this,fi,e)}}])&&oi(t.prototype,n),r&&oi(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function gi(e){return function(e){if(Array.isArray(e))return vi(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return vi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vi(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vi(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function mi(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function wi(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Oi=new Set(["getFirstNotHiddenIndex"]),Ci=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.indexesSequence=new No,this.trimmingMapsCollection=new qo((function(e){return e.some((function(e){return!0===e}))}),!1),this.hidingMapsCollection=new qo((function(e){return e.some((function(e){return!0===e}))}),!1),this.variousMapsCollection=new Wo,this.hidingChangesObservable=new yi({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",(function(){t.indexesSequenceChanged=!0,t.updateCache(),t.runLocalHooks("change",t.indexesSequence,null)})),this.trimmingMapsCollection.addLocalHook("change",(function(e){t.trimmedIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",e,t.trimmingMapsCollection)})),this.hidingMapsCollection.addLocalHook("change",(function(e){t.hiddenIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",e,t.hidingMapsCollection)})),this.variousMapsCollection.addLocalHook("change",(function(e){t.runLocalHooks("change",e,t.variousMapsCollection)}))}var t,n,r;return t=e,n=[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(e){if("hiding"!==e)throw new Error('Unsupported index map type "'.concat(e,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(e,t,n){return this.registerMap(e,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!Bo.has(e))throw new Error('The provided map type ("'.concat(e,'") does not exist.'));return new(Bo.get(e))(t)}(t,n))}},{key:"registerMap",value:function(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error('Map with name "'.concat(e,'" has been already registered.'));t instanceof Lo.a?this.trimmingMapsCollection.register(e,t):t instanceof Ho.a?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);var n=this.getNumberOfIndexes();return n>0&&t.init(n),t}},{key:"unregisterMap",value:function(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(e){var t=this.notTrimmedIndexesCache[e];return Object(l.b)(t)?t:null}},{key:"getPhysicalFromRenderableIndex",value:function(e){var t=this.renderablePhysicalIndexesCache[e];return Object(l.b)(t)?t:null}},{key:"getVisualFromPhysicalIndex",value:function(e){var t=this.fromPhysicalToVisualIndexesCache.get(e);return Object(l.b)(t)?t:null}},{key:"getVisualFromRenderableIndex",value:function(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}},{key:"getRenderableFromVisualIndex",value:function(e){var t=this.fromVisualToRenderableIndexesCache.get(e);return Object(l.b)(t)?t:null}},{key:"getFirstNotHiddenIndex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e-t;Oi.has("getFirstNotHiddenIndex")&&(Oi.delete("getFirstNotHiddenIndex"),Object(Ce.b)(Object(Se.a)(ui||(ui=mi(['The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next \n                        major release. Please use "getNearestNotHiddenIndex" instead.'],['The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next\\x20\n                        major release. Please use "getNearestNotHiddenIndex" instead.'])))));var o=this.getPhysicalFromVisualIndex(e);return null===o?!0===n&&r!==e-t?this.getFirstNotHiddenIndex(r,-t,!1,r):null:!1===this.isHidden(o)?e:this.getFirstNotHiddenIndex(e+t,t,n,r)}},{key:"getNearestNotHiddenIndex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.getPhysicalFromVisualIndex(e);if(null===r)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;var o=Array.from(this.fromVisualToRenderableIndexesCache.keys()),l=-1;return-1===(l=t>0?o.findIndex((function(t){return t>e})):o.reverse().findIndex((function(t){return t<e})))?n?this.getNearestNotHiddenIndex(e,-t,!1):null:o[l]}},{key:"initToLength",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=gi(new Array(e).keys()),this.notHiddenIndexesCache=gi(new Array(e).keys()),this.suspendOperations(),this.indexesSequence.init(e),this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(e){var t=this.getNumberOfIndexes();if(e<t){var n=gi(Array(this.getNumberOfIndexes()-e).keys()).map((function(i){return i+e}));this.removeIndexes(n)}else this.insertIndexes(t,e-t)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(e){this.indexesSequence.setValues(e)}},{key:"getNotTrimmedIndexes",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.notTrimmedIndexesCache;var n=this.getIndexesSequence();return n.filter((function(t){return!1===e.isTrimmed(t)}))}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.notHiddenIndexesCache;var n=this.getIndexesSequence();return n.filter((function(t){return!1===e.isHidden(t)}))}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.renderablePhysicalIndexesCache;var n=this.getNotTrimmedIndexes();return n.filter((function(t){return!1===e.isHidden(t)}))}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(e,t){var n=this;"number"==typeof e&&(e=[e]);var r=Object(f.c)(e,(function(e){return n.getPhysicalFromVisualIndex(e)})),o=this.getNotTrimmedIndexesLength(),l=e.length,c=Object(Eo.b)(this.getIndexesSequence(),r),h=o-l;if(t+l<o){var d=c.filter((function(e){return!1===n.isTrimmed(e)}))[t];h=c.indexOf(d)}this.setIndexesSequence(Object(Eo.a)(c,h,r))}},{key:"isTrimmed",value:function(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}},{key:"isHidden",value:function(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}},{key:"insertIndexes",value:function(e,t){var n=this.getNotTrimmedIndexes()[e],r=Object(l.b)(n)?n:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),c=Object(f.c)(new Array(t).fill(r),(function(e,t){return e+t}));this.suspendOperations(),this.indexesSequence.insert(o,c),this.trimmingMapsCollection.insertToEvery(o,c),this.hidingMapsCollection.insertToEvery(o,c),this.variousMapsCollection.insertToEvery(o,c),this.resumeOperations()}},{key:"removeIndexes",value:function(e){this.suspendOperations(),this.indexesSequence.remove(e),this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}},{key:"updateCache",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===e||!1===this.isBatched&&!0===t)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var t=0;t<e;t+=1){var n=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(n,t)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var t=0;t<e;t+=1){var n=this.getPhysicalFromRenderableIndex(t),r=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(r,t)}}}],n&&wi(t.prototype,n),r&&wi(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();Object(object.n)(Ci,Vo.a);var Si=n(638),Ei=n(774),Ri=n(742),Ti=(n(8),n(13),n(669)),ki="active-header",ji="area",Ai="cell",xi="fill",Mi="header",Ii="custom-selection";n(288),n(101);function _i(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return Ni(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ni(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ni(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Hi(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Pi=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-parseInt(this.cornerDefaultStyle.width,10)/2,this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}var t,n,o;return t=e,n=[{key:"registerListeners",value:function(){var e=this,t=this.wot.rootDocument.body;this.eventManager.addEventListener(t,"mousedown",(function(){return e.onMouseDown()})),this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()}));for(var n=function(t,n){var element=e.main.childNodes[t];e.eventManager.addEventListener(element,"mouseenter",(function(n){return e.onMouseEnter(n,e.main.childNodes[t])}))},r=0,o=this.main.childNodes.length;r<o;r++)n(r)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(e,t){if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){e.preventDefault(),Object(S.d)(e);var n=this,r=this.wot.rootDocument.body,o=t.getBoundingClientRect();t.style.display="none",this.eventManager.addEventListener(r,"mousemove",(function e(l){var c;((c=l).clientY<Math.floor(o.top)||c.clientY>Math.ceil(o.top+o.height)||c.clientX<Math.floor(o.left)||c.clientX>Math.ceil(o.left+o.width))&&(n.eventManager.removeEventListener(r,"mousemove",e),t.style.display="block")}))}}},{key:"createBorders",value:function(e){var t=this.wot.rootDocument;this.main=t.createElement("div");var n=["top","start","bottom","end","corner"],style=this.main.style;style.position="absolute",style.top=0,style.left=0;for(var i=0;i<5;i++){var r=n[i],div=t.createElement("div");div.className="wtBorder ".concat(this.settings.className||""),this.settings[r]&&this.settings[r].hide&&(div.className+=" hidden"),(style=div.style).backgroundColor=this.settings[r]&&this.settings[r].color?this.settings[r].color:e.border.color,style.height=this.settings[r]&&this.settings[r].width?"".concat(this.settings[r].width,"px"):"".concat(e.border.width,"px"),style.width=this.settings[r]&&this.settings[r].width?"".concat(this.settings[r].width,"px"):"".concat(e.border.width,"px"),this.main.appendChild(div)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Object(c.k)()&&this.createMultipleSelectorHandles(),this.disappear();var o=this.wot.wtTable,l=o.bordersHolder;l||((l=t.createElement("div")).className="htBorders",o.bordersHolder=l,o.spreader.appendChild(l)),l.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var e=this,t=this.wot.rootDocument;this.selectionHandles={top:t.createElement("DIV"),topHitArea:t.createElement("DIV"),bottom:t.createElement("DIV"),bottomHitArea:t.createElement("DIV")},this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var n={position:"absolute",height:"".concat(40,"px"),width:"".concat(40,"px"),"border-radius":"".concat(parseInt(40/1.5,10),"px")};Object(object.o)(n,(function(t,n){e.selectionHandles.styles.bottomHitArea[n]=t,e.selectionHandles.styles.topHitArea[n]=t}));var r={position:"absolute",height:"".concat(10,"px"),width:"".concat(10,"px"),"border-radius":"".concat(parseInt(10/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};Object(object.o)(r,(function(t,n){e.selectionHandles.styles.bottom[n]=t,e.selectionHandles.styles.top[n]=t})),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(e,col){var t=this.wot.selections.createOrGetArea();return!(!t.cellRange||e===t.cellRange.to.row&&col===t.cellRange.to.col)}},{key:"updateMultipleSelectionHandlesPosition",value:function(e,col,t,n,r,o){var l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",c=parseInt(this.selectionHandles.styles.top.width,10),h=parseInt(this.selectionHandles.styles.topHitArea.width,10);this.selectionHandles.styles.top.top="".concat(parseInt(t-c-1,10),"px"),this.selectionHandles.styles.top[l]="".concat(parseInt(n-c-1,10),"px"),this.selectionHandles.styles.topHitArea.top="".concat(parseInt(t-h/4*3,10),"px"),this.selectionHandles.styles.topHitArea[l]="".concat(parseInt(n-h/4*3,10),"px"),this.selectionHandles.styles.bottom.top="".concat(parseInt(t+o,10),"px"),this.selectionHandles.styles.bottom[l]="".concat(parseInt(n+r,10),"px"),this.selectionHandles.styles.bottomHitArea.top="".concat(parseInt(t+o-h/4,10),"px"),this.selectionHandles.styles.bottomHitArea[l]="".concat(parseInt(n+r-h/4,10),"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(this.selectionHandles.styles.top.display="block",this.selectionHandles.styles.topHitArea.display="block",this.isPartRange(e,col)?(this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none"):(this.selectionHandles.styles.bottom.display="block",this.selectionHandles.styles.bottomHitArea.display="block")):(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottomHitArea.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||col===this.wot.wtSettings.getSetting("fixedColumnsStart")?(this.selectionHandles.styles.top.zIndex="9999",this.selectionHandles.styles.topHitArea.zIndex="9999"):(this.selectionHandles.styles.top.zIndex="",this.selectionHandles.styles.topHitArea.zIndex="")}},{key:"appear",value:function(e){if(!this.disabled){for(var t,n,o,l,h,d,f=this.wot,y=f.wtTable,v=f.rootDocument,m=f.rootWindow,w=y.getRenderedRowsCount(),i=0;i<w;i+=1){var s=y.rowFilter.renderedToSource(i);if(s>=e[0]&&s<=e[2]){t=s,h=e[0];break}}for(var O=w-1;O>=0;O-=1){var C=y.rowFilter.renderedToSource(O);if(C>=e[0]&&C<=e[2]){n=C;break}}for(var S=y.getRenderedColumnsCount(),E=0;E<S;E+=1){var R=y.columnFilter.renderedToSource(E);if(R>=e[1]&&R<=e[3]){o=R,d=e[1];break}}for(var T=S-1;T>=0;T-=1){var k=y.columnFilter.renderedToSource(T);if(k>=e[1]&&k<=e[3]){l=k;break}}if(void 0!==t&&void 0!==o){var j=y.getCell(this.wot.createCellCoords(t,o)),A=t!==n||o!==l,x=A?y.getCell(this.wot.createCellCoords(n,l)):j,M=Object(r.G)(j),I=A?Object(r.G)(x):M,_=Object(r.G)(y.TABLE),N=Object(r.I)(y.TABLE),H=M.top,P=M.left,D=this.wot.wtSettings.getSetting("rtlMode"),L=0,B=0;if(D){var V=Object(r.I)(j),F=m.innerWidth-_.left-N;B=P+V-I.left,L=m.innerWidth-P-V-F-1}else B=I.left+Object(r.I)(x)-P,L=P-_.left-1;if(this.isEntireColumnSelected(t,n)){var W=this.getDimensionsFromHeader("columns",o,l,h,_),z=null;if(W){var U=_i(W,3);z=U[0],L=U[1],B=U[2]}z&&(j=z)}var G=H-_.top-1,X=I.top+Object(r.H)(x)-H;if(this.isEntireRowSelected(o,l)){var K=this.getDimensionsFromHeader("rows",t,n,d,_),Y=null;if(K){var $=_i(K,3);Y=$[0],G=$[1],X=$[2]}Y&&(j=Y)}var style=Object(r.i)(j,m);parseInt(style.borderTopWidth,10)>0&&(G+=1,X=X>0?X-1:0),parseInt(style[D?"borderRightWidth":"borderLeftWidth"],10)>0&&(L+=1,B=B>0?B-1:0);var Q=D?"right":"left";this.topStyle.top="".concat(G,"px"),this.topStyle[Q]="".concat(L,"px"),this.topStyle.width="".concat(B,"px"),this.topStyle.display="block",this.startStyle.top="".concat(G,"px"),this.startStyle[Q]="".concat(L,"px"),this.startStyle.height="".concat(X,"px"),this.startStyle.display="block";var J=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(G+X-J,"px"),this.bottomStyle[Q]="".concat(L,"px"),this.bottomStyle.width="".concat(B,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(G,"px"),this.endStyle[Q]="".concat(L+B-J,"px"),this.endStyle.height="".concat(X+1,"px"),this.endStyle.display="block";var Z=this.settings.border.cornerVisible;Z="function"==typeof Z?Z(this.settings.layerLevel):Z;var ee=this.wot.getSetting("onModifyGetCellCoords",n,l),te=n,ne=l;if(ee&&Array.isArray(ee)){var re=_i(ee,4);te=re[2],ne=re[3]}if(Object(c.k)()||!Z||this.isPartRange(te,ne))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(G+X+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[Q]="".concat(L+B+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var oe=Object(r.s)(y.TABLE),ie=oe===m;if(ie&&(oe=v.documentElement),l===this.wot.getSetting("totalColumns")-1){var ae=ie?x.getBoundingClientRect().left:x.offsetLeft;(D?ae-parseInt(this.cornerDefaultStyle.width,10)/2<0:ae+Object(r.I)(x)+parseInt(this.cornerDefaultStyle.width,10)/2>=Object(r.A)(oe))&&(this.cornerStyle[Q]="".concat(Math.floor(L+B+this.cornerCenterPointOffset-parseInt(this.cornerDefaultStyle.width,10)/2),"px"),this.cornerStyle[D?"borderLeftWidth":"borderRightWidth"]=0)}n===this.wot.getSetting("totalRows")-1&&(ie?x.getBoundingClientRect().top:x.offsetTop)+Object(r.H)(x)+parseInt(this.cornerDefaultStyle.height,10)/2>=Object(r.z)(oe)&&(this.cornerStyle.top="".concat(Math.floor(G+X+this.cornerCenterPointOffset-parseInt(this.cornerDefaultStyle.height,10)/2),"px"),this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}Object(c.k)()&&this.updateMultipleSelectionHandlesPosition(n,l,G,L,B,X)}else this.disappear()}}},{key:"isEntireColumnSelected",value:function(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(e,t,n,o,l){var c=this.wot.wtTable,h=c.wtRootElement.parentNode,d=null,f=null,y=null,v=null,m=null,w=null,O=null,C=null;switch(e){case"rows":d=function(){return c.getRowHeader.apply(c,arguments)},f=function(){return r.H.apply(void 0,arguments)},y="ht__selection--rows",w="top";break;case"columns":d=function(){return c.getColumnHeader.apply(c,arguments)},f=function(){return r.I.apply(void 0,arguments)},y="ht__selection--columns",w="left"}if(h.classList.contains(y)){var S=this.wot.getSetting("columnHeaders").length;if(O=d(t,S-o),C=d(n,S-o),!O||!C)return!1;var E=Object(r.G)(O),R=Object(r.G)(C);return O&&C&&(v=E[w]-l[w]-1,m=R[w]+f(C)-E[w]),[O,v,m]}return!1}},{key:"changeBorderStyle",value:function(e,t){var style=this[e].style,n=t[e];!n||n.hide?Object(r.a)(this[e],"hidden"):(Object(r.v)(this[e],"hidden")&&Object(r.K)(this[e],"hidden"),style.backgroundColor=n.color,"top"!==e&&"bottom"!==e||(style.height="".concat(n.width,"px")),"start"!==e&&"end"!==e||(style.width="".concat(n.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(e){var t=1,n="#000",style=this[e].style;style.backgroundColor=n,style.width="".concat(t,"px"),style.height="".concat(t,"px")}},{key:"toggleHiddenClass",value:function(e,t){this.changeBorderToDefaultStyle(e),t?Object(r.a)(this[e],"hidden"):Object(r.K)(this[e],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Object(c.k)()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.bottom.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}],n&&Hi(t.prototype,n),o&&Hi(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Di=Pi;function Li(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return Bi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Bi(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Bi(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Vi(e){return Vi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vi(e)}function Fi(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Wi=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.settings=t,this.cellRange=n||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}var t,n,o;return t=e,n=[{key:"getBorder",value:function(e){return this.instanceBorders[e.guid]||(this.instanceBorders[e.guid]=new Di(e,this.settings)),this.instanceBorders[e.guid]}},{key:"isEmpty",value:function(){return null===this.cellRange}},{key:"add",value:function(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}},{key:"replace",value:function(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}},{key:"addClassAtCoords",value:function(e,t,n,o){var l=arguments.length>4&&void 0!==arguments[4]&&arguments[4],c=e.wtTable.getCell(this.settings.createCellCoords(t,n));if("object"===Vi(c)){var h=o;l&&(h=this.classNameGenerator(c),this.classNames.includes(h)||this.classNames.push(h)),Object(r.a)(c,h)}return this}},{key:"linearClassNameGenerator",value:function(e,t){return function n(element){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(0===t||0===o)return e;var l=o>=0?o:t,c=e,h=0==(l-=1)?e:"".concat(e,"-").concat(l);if(Object(r.v)(element,h)){var d=l+1;c="".concat(e,"-").concat(d)}else c=n(element,l);return c}}},{key:"draw",value:function(e){if(this.isEmpty())this.settings.border&&this.getBorder(e).disappear();else{var t=e.wtTable.getRenderedRowsCount(),n=e.wtTable.getRenderedColumnsCount(),o=this.getCorners(),l=Li(o,4),c=l[0],h=l[1],d=l[2],f=l[3],y=this.settings,v=y.highlightHeaderClassName,m=y.highlightColumnClassName,w=y.highlightRowClassName,O=y.highlightOnlyClosestHeader,C=y.selectionType,S=void 0===C||["active-header","header"].includes(C);if(S&&null!==h&&null!==f)for(var E=0,R=0;R<n;R+=1){var T=e.wtTable.columnFilter.renderedToSource(R);if(T>=h&&T<=f){var k=e.wtTable.getColumnHeaders(T),j=k.length-1;O&&k.length>1&&(k=[k[j]]);for(var A=0;A<k.length;A+=1){var x=[],M=k[A];v&&x.push(v),m&&x.push(m),A=O?j:A;var I=e.getSetting("onBeforeHighlightingColumnHeader",T,A,{selectionType:C,columnCursor:E,selectionWidth:f-h+1,classNames:x});I!==T&&(M=e.wtTable.getColumnHeader(I,A)),Object(r.a)(M,x)}E+=1}}if(null!==c&&null!==d)for(var _=0,N=0;N<t;N+=1){var H=e.wtTable.rowFilter.renderedToSource(N);if(S&&H>=c&&H<=d){var P=e.wtTable.getRowHeaders(H),D=P.length-1;O&&P.length>1&&(P=[P[D]]);for(var L=0;L<P.length;L+=1){var B=[],V=P[L];v&&B.push(v),w&&B.push(w),L=O?D:L;var F=e.getSetting("onBeforeHighlightingRowHeader",H,L,{selectionType:C,rowCursor:_,selectionHeight:d-c+1,classNames:B});F!==H&&(V=e.wtTable.getRowHeader(F,L)),Object(r.a)(V,B)}_+=1}if(null!==h&&null!==f)for(var W=0;W<n;W+=1){var z=e.wtTable.columnFilter.renderedToSource(W);H>=c&&H<=d&&z>=h&&z<=f?this.settings.className&&this.addClassAtCoords(e,H,z,this.settings.className,this.settings.markIntersections):H>=c&&H<=d?w&&this.addClassAtCoords(e,H,z,w):z>=h&&z<=f&&m&&this.addClassAtCoords(e,H,z,m);var U=e.getSetting("onAfterDrawSelection",H,z,this.settings.layerLevel);"string"==typeof U&&this.addClassAtCoords(e,H,z,U)}}e.getSetting("onBeforeDrawBorders",o,this.settings.className),this.settings.border&&this.getBorder(e).appear(o)}}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach((function(e){return e.destroy()}))}}],n&&Fi(t.prototype,n),o&&Fi(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function zi(e){return zi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zi(e)}function Ui(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Gi(){return Gi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var base=Xi(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},Gi.apply(this,arguments)}function Xi(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=Qi(object)););return object}function Ki(e,p){return Ki=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},Ki(e,p)}function Yi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Qi(e);if(t){var o=Qi(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return qi(this,n)}}function qi(e,t){if(t&&("object"===zi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return $i(e)}function $i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qi(e){return Qi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Qi(e)}var Ji=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ki(e,t)}(l,e);var t,n,r,o=Yi(l);function l(e,t){var n,r,c,h;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),n=o.call(this,e,null),r=$i(n),h=null,(c="visualCellRange")in r?Object.defineProperty(r,c,{value:h,enumerable:!0,configurable:!0,writable:!0}):r[c]=h,n.visualCellRange=t||null,n.commit(),n}return t=l,n=[{key:"add",value:function(e){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}},{key:"clear",value:function(){return this.visualCellRange=null,Gi(Qi(l.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(e){var t=e.from,n=e.to,r=this.getNearestNotHiddenCoords(t,1),o=this.getNearestNotHiddenCoords(n,-1);if(null===r||null===o)return null;if(r.row>o.row||r.col>o.col){if("header"!==this.settings.type&&"active-header"!==this.settings.type)return null;r=t,o=n}return this.settings.createCellRange(r,r,o)}},{key:"getNearestNotHiddenCoords",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,r=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),e.row,t);if(null===r)return null;var o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),e.col,n);return null===o?null:this.settings.createCellCoords(r,o)}},{key:"getNearestNotHiddenIndex",value:function(e,t,n){if(t<0)return t;var r=e.getNearestNotHiddenIndex(t,n);return"header"!==this.settings.type&&"active-header"!==this.settings.type||null!==r?r:-1}},{key:"commit",value:function(){if(null===this.visualCellRange)return this;var e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return this.cellRange=null===e?null:this.createRenderableCellRange(e.from,e.to),this}},{key:"syncWith",value:function(e){var t="N-S"===e.getVerticalDirection()?1:-1,n="W-E"===e.getHorizontalDirection()?1:-1,r=this.getNearestNotHiddenCoords(e.from.clone().normalize(),t,n);if(null!==r&&e.overlaps(r)){if(null===this.cellRange){var o=this.settings.visualToRenderableCoords(r);this.cellRange=this.settings.createCellRange(o)}return e.setHighlight(r),this}return e.setHighlight(e.from),this}},{key:"getCorners",value:function(){var e=this.cellRange,t=e.from,n=e.to,r=null===t.row||null===n.row,o=null===t.col||null===n.col,l=this.settings.createCellCoords(r?null:Math.min(t.row,n.row),o?null:Math.min(t.col,n.col)),c=this.settings.createCellCoords(r?null:Math.max(t.row,n.row),o?null:Math.max(t.col,n.col));return[l.row,l.col,c.row,c.col]}},{key:"getVisualCorners",value:function(){var e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}},{key:"createRenderableCellRange",value:function(e,t){var n=this.settings.visualToRenderableCoords(e),r=this.settings.visualToRenderableCoords(t);return this.settings.createCellRange(n,n,r)}}],n&&Ui(t.prototype,n),r&&Ui(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(Wi),Zi=Ji,ea=["activeHeaderClassName"];function ta(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function na(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ta(Object(source),!0).forEach((function(t){ra(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):ta(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function ra(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oa(source,e){if(null==source)return{};var t,i,n=function(source,e){if(null==source)return{};var t,i,n={},r=Object.keys(source);for(i=0;i<r.length;i++)t=r[i],e.indexOf(t)>=0||(n[t]=source[t]);return n}(source,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(source);for(i=0;i<r.length;i++)t=r[i],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(source,t)&&(n[t]=source[t])}return n}var ia=function(e){var t=e.activeHeaderClassName,n=oa(e,ea);return new Zi(na(na({highlightHeaderClassName:t},n),{},{selectionType:ki}))},aa=["layerLevel","areaCornerVisible"];function la(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function sa(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?la(Object(source),!0).forEach((function(t){ca(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):la(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function ca(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ua(source,e){if(null==source)return{};var t,i,n=function(source,e){if(null==source)return{};var t,i,n={},r=Object.keys(source);for(i=0;i<r.length;i++)t=r[i],e.indexOf(t)>=0||(n[t]=source[t]);return n}(source,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(source);for(i=0;i<r.length;i++)t=r[i],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(source,t)&&(n[t]=source[t])}return n}var ha=function(e){var t=e.layerLevel,n=e.areaCornerVisible,r=ua(e,aa);return new Zi(sa(sa({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:n}},r),{},{selectionType:ji}))},da=["cellCornerVisible"];function fa(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function pa(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?fa(Object(source),!0).forEach((function(t){ba(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):fa(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function ba(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ya(source,e){if(null==source)return{};var t,i,n=function(source,e){if(null==source)return{};var t,i,n={},r=Object.keys(source);for(i=0;i<r.length;i++)t=r[i],e.indexOf(t)>=0||(n[t]=source[t]);return n}(source,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(source);for(i=0;i<r.length;i++)t=r[i],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(source,t)&&(n[t]=source[t])}return n}var ga=function(e){var t=e.cellCornerVisible,n=ya(e,da);return new Zi(pa(pa({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t}},n),{},{selectionType:Ai}))},va=["border","visualCellRange"];function ma(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function wa(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ma(Object(source),!0).forEach((function(t){Oa(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):ma(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function Oa(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ca(source,e){if(null==source)return{};var t,i,n=function(source,e){if(null==source)return{};var t,i,n={},r=Object.keys(source);for(i=0;i<r.length;i++)t=r[i],e.indexOf(t)>=0||(n[t]=source[t]);return n}(source,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(source);for(i=0;i<r.length;i++)t=r[i],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(source,t)&&(n[t]=source[t])}return n}var Sa=function(e){var t=e.border,n=e.visualCellRange,r=Ca(e,va);return new Zi(wa(wa(wa({},t),r),{},{selectionType:Ii}),n)};n(388);function Ea(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function Ra(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?Ea(Object(source),!0).forEach((function(t){Ta(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):Ea(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function Ta(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ka=function(e){var t=Object.assign({},e);return new Zi(Ra(Ra({className:"fill",border:{width:1,color:"#ff0000"}},t),{},{selectionType:xi}))},ja=["headerClassName","rowClassName","columnClassName"];function Aa(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function xa(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?Aa(Object(source),!0).forEach((function(t){Ma(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):Aa(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function Ma(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ia(source,e){if(null==source)return{};var t,i,n=function(source,e){if(null==source)return{};var t,i,n={},r=Object.keys(source);for(i=0;i<r.length;i++)t=r[i],e.indexOf(t)>=0||(n[t]=source[t]);return n}(source,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(source);for(i=0;i<r.length;i++)t=r[i],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(source,t)&&(n[t]=source[t])}return n}var _a=function(e){var t=e.headerClassName,n=e.rowClassName,r=e.columnClassName,o=Ia(e,ja);return new Zi(xa(xa({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:n,highlightColumnClassName:r},o),{},{highlightOnlyClosestHeader:!0,selectionType:Mi}))};function Na(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function Ha(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Pa=Object(Ti.a)("highlight/types"),Da=Pa.register,La=Pa.getItem;function Ba(e,t){return La(e)(function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?Na(Object(source),!0).forEach((function(t){Ha(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):Na(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({type:e},t))}function Va(e){return function(e){if(Array.isArray(e))return Fa(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Fa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Fa(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fa(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Wa(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function za(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?Wa(Object(source),!0).forEach((function(t){Ua(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):Wa(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function Ua(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ga(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Da(ki,ia),Da(ji,ha),Da(Ai,ga),Da(Ii,Sa),Da(xi,ka),Da(Mi,_a);var Xa=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=e,this.layerLevel=0,this.cell=Ba(Ai,e),this.fill=Ba(xi,e),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}var n,r,o;return n=t,r=[{key:"isEnabledFor",value:function(e,t){var n=e;e===Ai&&(n="current");var r=this.options.disabledCellSelection(t.row,t.col);return"string"==typeof r&&(r=[r]),!1===r||Array.isArray(r)&&!r.includes(n)}},{key:"useLayerLevel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=e,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var area,e=this.layerLevel;return this.areas.has(e)?area=this.areas.get(e):(area=Ba(ji,za({layerLevel:e},this.options)),this.areas.set(e,area)),area}},{key:"getAreas",value:function(){return Va(this.areas.values())}},{key:"createOrGetHeader",value:function(){var header,e=this.layerLevel;return this.headers.has(e)?header=this.headers.get(e):(header=Ba(Mi,za({},this.options)),this.headers.set(e,header)),header}},{key:"getHeaders",value:function(){return Va(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var header,e=this.layerLevel;return this.activeHeaders.has(e)?header=this.activeHeaders.get(e):(header=Ba(ki,za({},this.options)),this.activeHeaders.set(e,header)),header}},{key:"getActiveHeaders",value:function(){return Va(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return Va(this.customSelections.values())}},{key:"addCustomSelection",value:function(e){this.customSelections.push(Ba(Ii,za(za({},this.options),e)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),Object(f.a)(this.areas.values(),(function(e){e.clear()})),Object(f.a)(this.headers.values(),(function(e){e.clear()})),Object(f.a)(this.activeHeaders.values(),(function(e){e.clear()}))}},{key:e,value:function(){return[this.cell,this.fill].concat(Va(this.areas.values()),Va(this.headers.values()),Va(this.activeHeaders.values()),Va(this.customSelections))[Symbol.iterator]()}}],r&&Ga(n.prototype,r),o&&Ga(n,o),Object.defineProperty(n,"prototype",{writable:!1}),t}(Symbol.iterator),Ka=Xa;function Ya(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var qa=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.ranges=[],this.createCellRange=e}var n,r,o;return n=t,r=[{key:"isEmpty",value:function(){return 0===this.size()}},{key:"set",value:function(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}},{key:"add",value:function(e){return this.ranges.push(this.createCellRange(e)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(e){return this.ranges.some((function(t){return t.includes(e)}))}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=this.size()+t-1;return n>=0&&(e=this.ranges[n]),e}},{key:e,value:function(){return this.ranges[Symbol.iterator]()}}],r&&Ya(n.prototype,r),o&&Ya(n,o),Object.defineProperty(n,"prototype",{writable:!1}),t}(Symbol.iterator),$a=qa;function Qa(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ja=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.range=t,this.options=n}var t,n,r;return t=e,n=[{key:"transformStart",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.options.createCellCoords(e,t),o=this.range.current().highlight,l=this.options.visualToRenderableCoords(o),c=l.row,h=l.col,d=o,f=0,y=0;if(this.runLocalHooks("beforeTransformStart",r),null!==c&&null!==h){var v=this.options.countRows(),m=this.options.countCols(),w=this.options.fixedRowsBottom(),O=this.options.minSpareRows(),C=this.options.minSpareCols(),S=this.options.autoWrapRow(),E=this.options.autoWrapCol();c+e>v-1?n&&O>0&&!(w&&c>=v-w-1)?(this.runLocalHooks("insertRowRequire",v),v=this.options.countRows()):E&&(r.row=1-v,r.col=h+r.col===m-1?1-m:1):E&&c+r.row<0&&h+r.col>=0&&(r.row=v-1,r.col=h+r.col===0?m-1:-1),h+r.col>m-1?n&&C>0?(this.runLocalHooks("insertColRequire",m),m=this.options.countCols()):S&&(r.row=c+r.row===v-1?1-v:1,r.col=1-m):S&&h+r.col<0&&c+r.row>=0&&(r.row=c+r.row===0?v-1:-1,r.col=m-1);var R=this.options.createCellCoords(c+r.row,h+r.col);f=0,y=0,R.row<0?(f=-1,R.row=0):R.row>0&&R.row>=v&&(f=1,R.row=v-1),R.col<0?(y=-1,R.col=0):R.col>0&&R.col>=m&&(y=1,R.col=m-1),d=this.options.renderableToVisualCoords(R)}return this.runLocalHooks("afterTransformStart",d,f,y),d}},{key:"transformEnd",value:function(e,t){var n=this.options.createCellCoords(e,t),r=this.range.current(),o=r.to,l=0,c=0;this.runLocalHooks("beforeTransformEnd",n);var h=this.options.visualToRenderableCoords(r.highlight),d=h.row,f=h.col;if(null!==d&&null!==f){var y=this.options.countRows(),v=this.options.countCols(),m=this.options.visualToRenderableCoords(r.to),w=m.row,O=m.col,C=this.options.createCellCoords(w+n.row,O+n.col);l=0,c=0,C.row<0?(l=-1,C.row=0):C.row>0&&C.row>=y&&(l=1,C.row=y-1),C.col<0?(c=-1,C.col=0):C.col>0&&C.col>=v&&(c=1,C.col=v-1),o=this.options.renderableToVisualCoords(C)}return this.runLocalHooks("afterTransformEnd",o,l,c),o}}],n&&Qa(t.prototype,n),r&&Qa(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();Object(object.n)(Ja,Vo.a);var Za,el=Ja,tl=n(714);function nl(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return rl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rl(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rl(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function il(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var al=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.settings=t,this.tableProps=n,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new $a((function(e,t,n){return r.tableProps.createCellRange(e,t,n)})),this.highlight=new Ka({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disabledCellSelection:function(e,t){return r.tableProps.isDisabledCellSelection(e,t)},cellCornerVisible:function(){return r.isCellCornerVisible.apply(r,arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible.apply(r,arguments)},visualToRenderableCoords:function(e){return r.tableProps.visualToRenderableCoords(e)},renderableToVisualCoords:function(e){return r.tableProps.renderableToVisualCoords(e)},createCellCoords:function(e,t){return r.tableProps.createCellCoords(e,t)},createCellRange:function(e,t,n){return r.tableProps.createCellRange(e,t,n)},rowIndexMapper:function(){return r.tableProps.rowIndexMapper()},columnIndexMapper:function(){return r.tableProps.columnIndexMapper()}}),this.transformation=new el(this.selectedRange,{countRows:function(){return r.tableProps.countRowsTranslated()},countCols:function(){return r.tableProps.countColsTranslated()},visualToRenderableCoords:function(e){return r.tableProps.visualToRenderableCoords(e)},renderableToVisualCoords:function(e){return r.tableProps.renderableToVisualCoords(e)},createCellCoords:function(e,t){return r.tableProps.createCellCoords(e,t)},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["beforeModifyTransformStart"].concat(t))})),this.transformation.addLocalHook("afterTransformStart",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["afterModifyTransformStart"].concat(t))})),this.transformation.addLocalHook("beforeTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["beforeModifyTransformEnd"].concat(t))})),this.transformation.addLocalHook("afterTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["afterModifyTransformEnd"].concat(t))})),this.transformation.addLocalHook("insertRowRequire",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["insertRowRequire"].concat(t))})),this.transformation.addLocalHook("insertColRequire",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["insertColRequire"].concat(t))}))}var t,n,r;return t=e,n=[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="multiple"===this.settings.selectionMode,o=Object(l.e)(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,c=e.row<0,h=e.col<0,d=c&&h,f=e.clone();this.selectedByCorner=d,this.runLocalHooks("beforeSetRangeStart".concat(n?"Only":""),f),(!r||r&&!o&&Object(l.e)(t))&&this.selectedRange.clear(),this.selectedRange.add(f),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!d&&h&&this.selectedByRowHeader.add(this.getLayerLevel()),!d&&c&&this.selectedByColumnHeader.add(this.getLayerLevel()),n||this.setRangeEnd(e)}},{key:"setRangeStartOnly",value:function(e,t){this.setRangeStart(e,t,!0)}},{key:"setRangeEnd",value:function(e){if(!this.selectedRange.isEmpty()){var t=e.clone();this.runLocalHooks("beforeSetRangeEnd",t),this.begin();var n=this.selectedRange.current();"single"!==this.settings.selectionMode&&n.setTo(this.tableProps.createCellCoords(t.row,t.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(Ai,n.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(n);var r=this.getLayerLevel();r<this.highlight.layerLevel&&(Object(f.a)(this.highlight.getAreas(),(function(e){e.clear()})),Object(f.a)(this.highlight.getHeaders(),(function(e){e.clear()})),Object(f.a)(this.highlight.getActiveHeaders(),(function(e){e.clear()}))),this.highlight.useLayerLevel(r);var o=this.highlight.createOrGetArea(),l=this.highlight.createOrGetHeader(),c=this.highlight.createOrGetActiveHeader();if(o.clear(),l.clear(),c.clear(),this.highlight.isEnabledFor(ji,n.highlight)&&(this.isMultiple()||r>=1)&&(o.add(n.from).add(n.to).commit(),1===r)){var h=this.selectedRange.previous();this.highlight.useLayerLevel(r-1).createOrGetArea().add(h.from).commit().syncWith(h),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(Mi,n.highlight)){var d=0===this.tableProps.countRowsTranslated(),y=0===this.tableProps.countColsTranslated(),v=n;(d||y)&&(v=n.clone()),d&&(v.from.row=-1),y&&(v.from.col=-1),"single"===this.settings.selectionMode?(this.isSelectedByAnyHeader()&&v.from.normalize(),l.add(v.from).commit()):l.add(v.from).add(v.to).commit(),this.isEntireRowSelected()&&this.tableProps.countCols()===n.getWidth()&&c.add(this.tableProps.createCellCoords(n.from.row,-1)).add(this.tableProps.createCellCoords(n.to.row,-1)).commit(),this.isEntireColumnSelected()&&this.tableProps.countRows()===n.getHeight()&&c.add(this.tableProps.createCellCoords(-1,n.from.col)).add(this.tableProps.createCellCoords(-1,n.to.col)).commit()}this.runLocalHooks("afterSetRangeEnd",e)}}},{key:"isMultiple",value:function(){var e=Object(object.b)(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}},{key:"transformStart",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.setRangeStart(this.transformation.transformStart(e,t,n))}},{key:"transformEnd",value:function(e,t){this.setRangeEnd(this.transformation.transformEnd(e,t))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&this.isEntireRowSelected(e)}},{key:"isEntireRowSelected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===e?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e)}},{key:"isSelectedByColumnHeader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(e)}},{key:"isEntireColumnSelected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===e?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(e){return this.selectedRange.includes(e)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(e){return(!Number.isInteger(e)||e===this.getLayerLevel())&&this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.tableProps.countRows(),r=this.tableProps.countCols();if(e||t||0!==n&&0!==r){var o=this.tableProps.createCellCoords(t?-1:0,e?-1:0);this.clear(),this.setRangeStartOnly(o),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(this.tableProps.createCellCoords(n-1,r-1)),this.finish()}}},{key:"selectCells",value:function(e){var t,n,r=this,o=Object(tl.c)(e);if(o===tl.a)return!1;if(o===tl.b)throw new Error(Object(Se.a)(Za||(t=["Unsupported format of the selection ranges was passed. To select cells pass \n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, \n        columnEnd/columnPropEnd]]) or as an array of CellRange objects."],(n=["Unsupported format of the selection ranges was passed. To select cells pass\\x20\n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20\n        columnEnd/columnPropEnd]]) or as an array of CellRange objects."])||(n=t.slice(0)),Za=Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(n)}})))));var l=Object(tl.e)(o,{propToCol:function(e){return r.tableProps.propToCol(e)},keepDirection:!0}),c=this.tableProps.countRows(),h=this.tableProps.countCols(),d=!e.some((function(e){var t=nl(l(e),4),n=t[0],r=t[1],o=t[2],d=t[3];return!(Object(tl.d)(n,c)&&Object(tl.d)(r,h)&&Object(tl.d)(o,c)&&Object(tl.d)(d,h))}));return d&&(this.clear(),Object(f.a)(e,(function(e){var t=nl(l(e),4),n=t[0],o=t[1],c=t[2],h=t[3];r.setRangeStartOnly(r.tableProps.createCellCoords(n,o),!1),r.setRangeEnd(r.tableProps.createCellCoords(c,h)),r.finish()}))),d}},{key:"selectColumns",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r="string"==typeof e?this.tableProps.propToCol(e):e,o="string"==typeof t?this.tableProps.propToCol(t):t,l=this.tableProps.countCols(),c=this.tableProps.countRows(),h=Object(tl.d)(r,l)&&Object(tl.d)(o,l);return h&&(this.setRangeStartOnly(this.tableProps.createCellCoords(n,r)),this.setRangeEnd(this.tableProps.createCellCoords(c-1,o)),this.finish()),h}},{key:"selectRows",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=this.tableProps.countRows(),o=this.tableProps.countCols(),l=Object(tl.d)(e,r)&&Object(tl.d)(t,r);return l&&(this.setRangeStartOnly(this.tableProps.createCellCoords(e,n)),this.setRangeEnd(this.tableProps.createCellCoords(t,o-1)),this.finish()),l}},{key:"refresh",value:function(){if(this.highlight.getCustomSelections().forEach((function(e){e.commit()})),this.isSelected()){var e=this.highlight.getCell(),t=this.getLayerLevel();e.commit().syncWith(this.selectedRange.current());for(var n=0;n<this.selectedRange.size();n+=1){this.highlight.useLayerLevel(n);var r=this.highlight.createOrGetArea(),o=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();r.commit(),o.commit(),l.commit()}this.highlight.useLayerLevel(t)}}}],n&&il(t.prototype,n),r&&il(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();Object(object.n)(al,Vo.a);var ll=al,sl=n(689);function cl(e,t){var n="string"==typeof e?Object(sl.a)(e):e;if(Object(object.l)(n)){var r=Object(object.l)(t),o={};return Object(object.o)(n,(function(e,n){"CELL_TYPE"===n||r&&(!r||Object(object.j)(t,n))||(o[n]=e)})),o}}function hl(e){return Number.isInteger(e)&&e>=0}function fl(e,t){if(!e())throw new Error("Assertion failed: ".concat(t))}function pl(e){return null==e}var bl=n(814);function yl(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function gl(e,t,n){return t&&yl(e.prototype,t),n&&yl(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function vl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var ml=function(){function e(t){vl(this,e),this.metaCtor=gl((function e(){vl(this,e)})),this.meta=this.metaCtor.prototype,Object(object.h)(this.meta,Object(bl.a)()),this.meta.instance=t}return gl(e,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(e){Object(object.h)(this.meta,e),Object(object.h)(this.meta,cl(e.type,e))}}]),e}();function wl(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ol=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=t.getMetaConstructor();this.meta=new n}var t,n,r;return t=e,(n=[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(e){Object(object.h)(this.meta,e),Object(object.h)(this.meta,cl(e.type,e))}}])&&wl(t.prototype,n),r&&wl(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Cl(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Sl=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.valueFactory=e,this.data=[],this.index=[],this.holes=new Set}var n,r,o;return n=t,r=[{key:"obtain",value:function(e){fl((function(){return hl(e)}),"Expecting an unsigned number.");var t,n=this._getStorageIndexByKey(e);if(n>=0)void 0===(t=this.data[n])&&(t=this.valueFactory(e),this.data[n]=t);else if(t=this.valueFactory(e),this.holes.size>0){var r=this.holes.values().next().value;this.holes.delete(r),this.data[r]=t,this.index[e]=r}else this.data.push(t),this.index[e]=this.data.length-1;return t}},{key:"insert",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;fl((function(){return hl(e)||pl(e)}),"Expecting an unsigned number or null/undefined argument.");for(var r=[],o=this.data.length,i=0;i<n;i++)r.push(o+i),this.data.push(void 0);(t=this.index).splice.apply(t,[pl(e)?this.index.length:e,0].concat(r))}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;fl((function(){return hl(e)||pl(e)}),"Expecting an unsigned number or null/undefined argument.");for(var n=this.index.splice(pl(e)?this.index.length-t:e,t),i=0;i<n.length;i++){var r=n[i];"number"==typeof r&&this.holes.add(r)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var e=this;return Object(f.b)(this.data,(function(t,n){return!e.holes.has(n)}))[Symbol.iterator]()}},{key:"entries",value:function(){for(var e=[],i=0;i<this.data.length;i++){var t=this._getKeyByStorageIndex(i);-1!==t&&e.push([t,this.data[i]])}var n=0;return{next:function(){if(n<e.length){var t=e[n];return n+=1,{value:t,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(e){return this.index.length>e?this.index[e]:-1}},{key:"_getKeyByStorageIndex",value:function(e){return this.index.indexOf(e)}},{key:e,value:function(){return this.entries()}}],r&&Cl(n.prototype,r),o&&Cl(n,o),Object.defineProperty(n,"prototype",{writable:!1}),t}(Symbol.iterator);function El(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Rl=["data","width"],Tl=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.globalMeta=t,this.metas=new Sl((function(){return n._createMeta()}))}var t,n,r;return t=e,n=[{key:"updateMeta",value:function(e,t){var meta=this.getMeta(e);Object(object.h)(meta,t),Object(object.h)(meta,cl(t.type,meta))}},{key:"createColumn",value:function(e,t){this.metas.insert(e,t)}},{key:"removeColumn",value:function(e,t){this.metas.remove(e,t)}},{key:"getMeta",value:function(e){return this.metas.obtain(e)}},{key:"getMetaConstructor",value:function(e){return this.metas.obtain(e).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function n(){}Object(object.k)(n,e);for(var i=0;i<t.length;i++)n.prototype[t[i]]=void 0;return n}(this.globalMeta.getMetaConstructor(),Rl).prototype}}],n&&El(t.prototype,n),r&&El(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function kl(e){return function(e){if(Array.isArray(e))return jl(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return jl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jl(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jl(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Al(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var xl=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.columnMeta=t,this.metas=new Sl((function(){return n._createRow()}))}var t,n,r;return t=e,(n=[{key:"updateMeta",value:function(e,t,n){var meta=this.getMeta(e,t);Object(object.h)(meta,n),Object(object.h)(meta,cl(n.type,meta))}},{key:"createRow",value:function(e,t){this.metas.insert(e,t)}},{key:"createColumn",value:function(e,t){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(e,t)}},{key:"removeRow",value:function(e,t){this.metas.remove(e,t)}},{key:"removeColumn",value:function(e,t){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(e,t)}},{key:"getMeta",value:function(e,t,n){var r=this.metas.obtain(e).obtain(t);return void 0===n?r:r[n]}},{key:"setMeta",value:function(e,t,n,r){this.metas.obtain(e).obtain(t)[n]=r}},{key:"removeMeta",value:function(e,t,n){delete this.metas.obtain(e).obtain(t)[n]}},{key:"getMetas",value:function(){for(var e=[],t=Array.from(this.metas.values()),n=0;n<t.length;n++)e.push.apply(e,kl(t[n].values()));return e}},{key:"getMetasAtRow",value:function(e){fl((function(){return hl(e)}),"Expecting an unsigned number.");var t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var e=this;return new Sl((function(t){return e._createMeta(t)}))}},{key:"_createMeta",value:function(e){return new(this.columnMeta.getMetaConstructor(e))}}])&&Al(t.prototype,n),r&&Al(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ml(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Il(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var _l=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];Ml(this,e),this.hot=t,this.globalMeta=new ml(t),this.tableMeta=new Ol(this.globalMeta),this.columnMeta=new Tl(this.globalMeta),this.cellMeta=new xl(this.columnMeta),o.forEach((function(e){return new e(n)})),this.globalMeta.updateMeta(r)}var t,n,r;return t=e,n=[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(e){this.globalMeta.updateMeta(e)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(e){this.tableMeta.updateMeta(e)}},{key:"getColumnMeta",value:function(e){return this.columnMeta.getMeta(e)}},{key:"updateColumnMeta",value:function(e,t){this.columnMeta.updateMeta(e,t)}},{key:"getCellMeta",value:function(e,t,n){var r=n.visualRow,o=n.visualColumn,l=this.cellMeta.getMeta(e,t);return l.visualRow=r,l.visualCol=o,l.row=e,l.col=t,this.runLocalHooks("afterGetCellMeta",l),l}},{key:"getCellMetaKeyValue",value:function(e,t,n){if("string"!=typeof n)throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,n)}},{key:"setCellMeta",value:function(e,t,n,r){this.cellMeta.setMeta(e,t,n,r)}},{key:"updateCellMeta",value:function(e,t,n){this.cellMeta.updateMeta(e,t,n)}},{key:"removeCellMeta",value:function(e,t,n){this.cellMeta.removeMeta(e,t,n)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(e){return this.cellMeta.getMetasAtRow(e)}},{key:"createRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(e,t)}},{key:"removeRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(e,t)}},{key:"createColumn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}},{key:"removeColumn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}],n&&Il(t.prototype,n),r&&Il(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Nl(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object(object.n)(_l,Vo.a);var Hl=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.metaManager=t,this.metaSyncMemo=new Map,t.addLocalHook("afterGetCellMeta",(function(e){return n.extendCellMeta(e)})),Si.a.getSingleton().add("beforeRender",(function(e){e&&n.metaSyncMemo.clear()}),this.metaManager.hot)}var t,n,r;return t=e,(n=[{key:"extendCellMeta",value:function(e){var t,n=e.row,r=e.col;if(null===(t=this.metaSyncMemo.get(n))||void 0===t||!t.has(r)){var l=e.visualRow,c=e.visualCol,h=this.metaManager.hot,d=h.colToProp(c);e.prop=d,h.runHooks("beforeGetCellMeta",l,c,e);var f,y=Object(object.j)(e,"type")?e.type:null,v=Object(o.d)(e.cells)?e.cells(n,r,d):null;y&&(v?v.type=null!==(f=v.type)&&void 0!==f?f:y:v={type:y}),v&&this.metaManager.updateCellMeta(n,r,v),h.runHooks("afterGetCellMeta",l,c,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(r)}}}])&&Nl(t.prototype,n),r&&Nl(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Pl(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Dl=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.metaManager=t,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(e){if(this.metaManager.hot.isRtl()&&"fixedColumnsLeft"===e)throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(e,t,n){if(!n)throw new Error("The `".concat(e,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}var t,n,r;return t=e,(n=[{key:"extendMetaProps",value:function(){var e=this;this.propDescriptors.forEach((function(t,n){var r=t.target,o=t.onChange,l=void 0===o?function(){}:o,c="string"==typeof r,h=c?r:n,d="_".concat(h);e.metaManager.globalMeta.meta[d]=e.metaManager.globalMeta.meta[h],e.installPropWatcher(n,d,l),c&&e.installPropWatcher(r,d,l)}))}},{key:"installPropWatcher",value:function(e,t,n){var r=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get:function(){return this[t]},set:function(o){var l=!r.usageTracker.has(e);r.usageTracker.add(e),n.call(r,e,o,l),this[t]=o},enumerable:!0,configurable:!0})}}])&&Pl(t.prototype,n),r&&Pl(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Ll=(n(61),n(889));function Bl(e){return Bl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bl(e)}function Vl(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Fl=Object(vo.a)("copyable",!1),Wl=function(){function e(t,data,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.instance=t,this.tableMeta=n,this.dataSource=data,this.duckSchema=this.dataSource&&this.dataSource[0]?Object(object.g)(this.dataSource[0]):{},this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}var t,n,r;return t=e,n=[{key:"createMap",value:function(){var e=this.getSchema();if(void 0===e)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var i,t=this.tableMeta.columns;if(this.colToPropCache=[],this.propToColCache=new Map,t){var n=0,r=0,o=!1;if("function"==typeof t){var l=Object(object.e)(e);n=l>0?l:this.countFirstRowKeys(),o=!0}else{var c=this.tableMeta.maxCols;n=Math.min(c,t.length)}for(i=0;i<n;i++){var h=o?t(i):t[i];if(Object(object.l)(h)){if(void 0!==h.data){var d=o?r:i;this.colToPropCache[d]=h.data,this.propToColCache.set(h.data,d)}r+=1}}}else this.recursiveDuckColumns(e)}},{key:"countFirstRowKeys",value:function(){return Object(vo.b)(this.dataSource)}},{key:"recursiveDuckColumns",value:function(e,t,n){var r,o=this,l=t,c=n;return void 0===l&&(l=0,c=""),"object"!==Bl(e)||Array.isArray(e)||Object(object.o)(e,(function(e,t){null===e?(r=c+t,o.colToPropCache.push(r),o.propToColCache.set(r,l),l+=1):l=o.recursiveDuckColumns(e,l,"".concat(t,"."))})),l}},{key:"colToProp",value:function(e){if(!1===Number.isInteger(e))return e;var t=this.instance.toPhysicalColumn(e);return null===t?e:this.colToPropCache&&Object(l.b)(this.colToPropCache[t])?this.colToPropCache[t]:t}},{key:"propToCol",value:function(e){var t=this.propToColCache.get(e);if(Object(l.b)(t))return this.instance.toVisualColumn(t);var n=this.instance.toVisualColumn(e);return null===n?e:n}},{key:"getSchema",value:function(){var e=this.tableMeta.dataSchema;return e?"function"==typeof e?e():e:this.duckSchema}},{key:"createRow",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,source=arguments.length>2?arguments[2]:void 0,r=this.instance.countSourceRows(),o=r,l=0,c=e;("number"!=typeof c||c>=r)&&(c=r),c<this.instance.countRows()&&(o=this.instance.toPhysicalRow(c));var h=this.instance.runHooks("beforeCreateRow",c,n,source);if(!1===h||null===o)return 0;for(var d=this.tableMeta.maxRows,f=this.instance.countCols(),y=[],v=function(){var e=null;"array"===t.instance.dataType?t.tableMeta.dataSchema?e=Object(object.c)(t.getSchema()):(e=[],Object(C.c)(f-1,(function(){return e.push(null)}))):"function"===t.instance.dataType?e=t.tableMeta.dataSchema(c+l):(e={},Object(object.d)(e,t.getSchema())),y.push(e),l+=1};l<n&&r+l<d;)v();return this.instance.rowIndexMapper.insertIndexes(c,l),this.spliceData.apply(this,[o,0].concat(y)),this.instance.runHooks("afterCreateRow",c,l,source),this.instance.forceFullRender=!0,l}},{key:"createCol",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,source=arguments.length>2?arguments[2]:void 0;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var n=this.dataSource,r=this.tableMeta.maxCols,o=e;("number"!=typeof o||o>=this.instance.countSourceCols())&&(o=this.instance.countSourceCols());var l=this.instance.runHooks("beforeCreateCol",o,t,source);if(!1===l)return 0;var c=this.instance.countSourceCols();o<this.instance.countCols()&&(c=this.instance.toPhysicalColumn(o));for(var h=this.instance.countSourceRows(),d=this.instance.countCols(),f=0,y=c;f<t&&d<r;){if("number"!=typeof o||o>=d)if(h>0)for(var v=0;v<h;v+=1)void 0===n[v]&&(n[v]=[]),n[v].push(null);else n.push([null]);else for(var m=0;m<h;m++)n[m].splice(y,0,null);f+=1,y+=1,d+=1}return this.instance.columnIndexMapper.insertIndexes(o,f),this.instance.runHooks("afterCreateCol",o,f,source),this.instance.forceFullRender=!0,f}},{key:"removeRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,source=arguments.length>2?arguments[2]:void 0,n=Number.isInteger(e)?e:-t,r=this.visualRowsToPhysical(n,t),o=this.instance.countSourceRows();n=(o+n)%o;var c=this.instance.runHooks("beforeRemoveRow",n,r.length,r,source);if(!1===c)return!1;var h=r.length;if(this.filterData(n,h,r),n<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(r);var d=Object(l.b)(this.tableMeta.columns)||Object(l.b)(this.tableMeta.dataSchema);0===this.instance.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===d&&this.instance.columnIndexMapper.setIndexesSequence([])}return this.instance.runHooks("afterRemoveRow",n,h,r,source),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,source=arguments.length>2?arguments[2]:void 0;if("object"===this.instance.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var n="number"!=typeof e?-t:e;n=(this.instance.countCols()+n)%this.instance.countCols();var r=this.visualColumnsToPhysical(n,t),o=r.slice(0).sort((function(a,b){return b-a})),l=this.instance.runHooks("beforeRemoveCol",n,t,r,source);if(!1===l)return!1;for(var c=!0,h=o.length,data=this.dataSource,d=0;d<h;d++)c&&r[0]!==r[d]-d&&(c=!1);if(c)for(var f=0,y=this.instance.countSourceRows();f<y;f++)data[f].splice(r[0],t);else for(var v=0,m=this.instance.countSourceRows();v<m;v++)for(var w=0;w<h;w++)data[v].splice(o[w],1);return n<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(r),0===this.instance.columnIndexMapper.getNotTrimmedIndexesLength()&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",n,t,r,source),this.instance.forceFullRender=!0,!0}},{key:"spliceCol",value:function(col,e,t){for(var n=this.instance.getDataAtCol(col),r=n.slice(e,e+t),o=n.slice(e+t),l=arguments.length,c=new Array(l>3?l-3:0),h=3;h<l;h++)c[h-3]=arguments[h];Object(f.f)(c,o);for(var i=0;i<t;)c.push(null),i+=1;return Object(f.j)(c),this.instance.populateFromArray(e,col,c,null,null,"spliceCol"),r}},{key:"spliceRow",value:function(e,t,n){for(var r=this.instance.getSourceDataAtRow(e),o=r.slice(t,t+n),l=r.slice(t+n),c=arguments.length,h=new Array(c>3?c-3:0),d=3;d<c;d++)h[d-3]=arguments[d];Object(f.f)(h,l);for(var i=0;i<n;)h.push(null),i+=1;return this.instance.populateFromArray(e,t,[h],null,null,"spliceRow"),o}},{key:"spliceData",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];var l,c=this.instance.runHooks("beforeDataSplice",e,t,r);!1!==c&&(l=this.dataSource).splice.apply(l,[e,t].concat(r))}},{key:"filterData",value:function(e,t,n){var data=this.instance.runHooks("filterData",e,t,n);!1===Array.isArray(data)&&(data=this.dataSource.filter((function(e,t){return-1===n.indexOf(t)}))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,data)}},{key:"get",value:function(e,t){var n=this.instance.toPhysicalRow(e),r=this.dataSource[n],o=this.instance.runHooks("modifyRowData",n),l=null;if((r=isNaN(o)?o:r)&&r.hasOwnProperty&&Object(object.j)(r,t))l=r[t];else if("string"==typeof t&&t.indexOf(".")>-1){var c=t.split("."),h=r;if(!h)return null;for(var i=0,d=c.length;i<d;i++)if(void 0===(h=h[c[i]]))return null;l=h}else"function"==typeof t&&(l=t(this.dataSource.slice(n,n+1)[0]));if(this.instance.hasHook("modifyData")){var f=Object(object.b)(l);this.instance.runHooks("modifyData",n,this.propToCol(t),f,"get"),f.isTouched()&&(l=f.value)}return l}},{key:"getCopyable",value:function(e,t){return Fl.call(this.instance,e,this.propToCol(t))?this.get(e,t):""}},{key:"set",value:function(e,t,n){var r=this.instance.toPhysicalRow(e),o=n,l=this.dataSource[r],c=this.instance.runHooks("modifyRowData",r);if(l=isNaN(c)?c:l,this.instance.hasHook("modifyData")){var h=Object(object.b)(o);this.instance.runHooks("modifyData",r,this.propToCol(t),h,"set"),h.isTouched()&&(o=h.value)}if(l&&l.hasOwnProperty&&Object(object.j)(l,t))l[t]=o;else if("string"==typeof t&&t.indexOf(".")>-1){var d,f=t.split("."),y=l,i=0;for(i=0,d=f.length-1;i<d;i++)void 0===y[f[i]]&&(y[f[i]]={}),y=y[f[i]];y[f[i]]=o}else"function"==typeof t?t(this.dataSource.slice(r,r+1)[0],o):l[t]=o}},{key:"visualRowsToPhysical",value:function(e,t){for(var n,r=this.instance.countSourceRows(),o=[],l=(r+e)%r,c=t;l<r&&c;)n=this.instance.toPhysicalRow(l),o.push(n),c-=1,l+=1;return o}},{key:"visualColumnsToPhysical",value:function(e,t){for(var n=this.instance.countCols(),r=[],o=(n+e)%n,l=t;o<n&&l;){var col=this.instance.toPhysicalColumn(o);r.push(col),l-=1,o+=1}return r}},{key:"clear",value:function(){for(var e=0;e<this.instance.countSourceRows();e++)for(var t=0;t<this.instance.countCols();t++)this.set(e,this.colToProp(t),"")}},{key:"getLength",value:function(){var e,t=this.tableMeta.maxRows;e=t<0||0===t?0:t||1/0;var n=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,e)}},{key:"getAll",value:function(){var t={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return t.row-n.row!=0||this.instance.countSourceRows()?this.getRange(t,n,e.DESTINATION_RENDERER):[]}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(t,n,r){var o,l,c,output=[],h=this.tableMeta.maxRows,d=this.tableMeta.maxCols;if(0===h||0===d)return[];var f=r===e.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,y=Math.min(Math.max(h-1,0),Math.max(t.row,n.row)),v=Math.min(Math.max(d-1,0),Math.max(t.col,n.col));for(o=Math.min(t.row,n.row);o<=y;o++){c=[];var m=o>=0?this.instance.toPhysicalRow(o):o;for(l=Math.min(t.col,n.col);l<=v&&null!==m;l++)c.push(f.call(this,o,this.colToProp(l)));null!==m&&output.push(c)}return output}},{key:"getText",value:function(t,n){return Object(Ll.b)(this.getRange(t,n,e.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(t,n){return Object(Ll.b)(this.getRange(t,n,e.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.tableMeta=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],r=[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}],n&&Vl(t.prototype,n),r&&Vl(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),zl=Wl;function Ul(e){return Ul="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ul(e)}function Gl(data,e,t,n){var r=n.hotInstance,l=n.dataMap,c=n.dataSource,h=n.internalSource,source=n.source,d=n.firstRun,f=Object(O.f)(h),y=r.getSettings();Array.isArray(y.dataSchema)?r.dataType="array":Object(o.d)(y.dataSchema)?r.dataType="function":r.dataType="object",l&&l.destroy(),data=r.runHooks("before".concat(f),data,d,source);var v=new zl(r,data,y);if(e(v),"object"===Ul(data)&&null!==data)data.push&&data.splice||(data=[data]);else{if(null!==data)throw new Error("".concat(h," only accepts array of objects or array of arrays (").concat(Ul(data)," given)"));var m,w=v.getSchema();data=[];var C,S=0;for(S=0,C=y.startRows;S<C;S++)if("object"!==r.dataType&&"function"!==r.dataType||!y.dataSchema)if("array"===r.dataType)m=Object(object.c)(w[0]),data.push(m);else{m=[];for(var E=0,R=y.startCols;E<R;E++)m.push(null);data.push(m)}else m=Object(object.c)(w),data.push(m)}Array.isArray(data[0])&&(r.dataType="array"),y.data=data,v.dataSource=data,c.data=data,c.dataType=r.dataType,c.colToProp=v.colToProp.bind(v),c.propToCol=v.propToCol.bind(v),c.countCachedColumns=v.countCachedColumns.bind(v),t(v),r.runHooks("after".concat(f),data,d,source),d||(r.runHooks("afterChange",null,h),r.render())}var Xl,Kl=n(691),Yl=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),ql=function(e){return e.map((function(e){var t=e.toLowerCase();return Yl.has(t)?Yl.get(t):t})).sort().join("+")},$l=function(e){return e.toLowerCase()};function Ql(e){return function(e){if(Array.isArray(e))return es(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Zl(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jl(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||Zl(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zl(e,t){if(e){if("string"==typeof e)return es(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?es(e,t):void 0}}function es(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function ts(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var ns,rs=["meta","alt","shift","control"],os=(ns=new Set,{press:function(e){ns.add(e)},release:function(e){ns.delete(e)},releaseAll:function(){ns.clear()},isPressed:function(e){return ns.has(e)}});var is=function(e){var t=e.ownerWindow,n=e.handleEvent,r=e.beforeKeyDown,h=e.afterKeyDown,d=Object(Kl.a)({errorIdExists:function(e){return'The "'.concat(e,'" context name is already registered.')}}),f="grid",y=function(){return f},v=function(e){return d.getItem(e)},m=!1,w=function(e,t,n,r,o){var l=function(e){return rs.includes(e)},h=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[];return e.altKey&&n.push("alt"),t&&(e.ctrlKey||e.metaKey)?n.push("control/meta"):(e.ctrlKey&&n.push("control"),e.metaKey&&n.push("meta")),e.shiftKey&&n.push("shift"),n},d=function(e){if(!1!==t(e)&&!1!==n(e)&&!Object(S.a)(e)){var d=$l(e.key),f=[];l(d)?os.press(d):f=h(e);var y=[d].concat(f);!o(e,y)&&(Object(c.j)()&&f.includes("meta")||!Object(c.j)()&&f.includes("control"))&&o(e,[d].concat(h(e,!0))),r(e)}},f=function(e){if(!1!==t(e)){var n=$l(e.key);!1!==l(n)&&os.release(n)}},y=function(){os.releaseAll()};return{mount:function(){for(var t=e;t;)t.addEventListener("keydown",d),t.addEventListener("keyup",f),t.addEventListener("blur",y),t=t.frameElement},unmount:function(){for(var t=e;t;)t.removeEventListener("keydown",d),t.removeEventListener("keyup",f),t.removeEventListener("blur",y),t=t.frameElement},isPressed:function(e){return os.isPressed(e)}}}(t,n,r,h,(function(e,t){var n=v(y()),r=!1;if(!n.hasShortcut(t))return r;for(var o=n.getShortcuts(t),l=0;l<o.length;l++){var c=o[l],h=c.callback,d=c.runOnlyIf,f=c.preventDefault,w=c.stopPropagation,O=c.captureCtrl;if(!1!==d(e)&&(m=O,r=!1===h(e,t),m=!1,f&&e.preventDefault(),w&&e.stopPropagation(),r))break}return r}));return w.mount(),{addContext:function(e){var t,n,r,c,h=(t=e,n=Object(Kl.a)({errorIdExists:function(e){return'The "'.concat(e,'" shortcut is already registered in the "').concat(t,'" context.')}}),r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.keys,r=e.callback,c=e.group,h=e.runOnlyIf,d=void 0===h?function(){return!0}:h,f=e.captureCtrl,y=void 0!==f&&f,v=e.preventDefault,m=void 0===v||v,w=e.stopPropagation,O=void 0!==w&&w,C=e.relativeToGroup,S=e.position;if(Object(l.e)(c))throw new Error("You need to define the shortcut's group.");if(!1===Object(o.d)(r))throw new Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(t))throw new Error(Object(Se.a)(Xl||(Xl=ts(["Pass the shortcut's keys as an array of arrays, \n      using the KeyboardEvent.key properties: \n      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values."],["Pass the shortcut\\'s keys as an array of arrays,\\x20\n      using the KeyboardEvent.key properties:\\x20\n      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values."]))));var E={callback:r,group:c,runOnlyIf:d,captureCtrl:y,preventDefault:m,stopPropagation:O};if(Object(l.b)(C)){var R=[C,S];E.relativeToGroup=R[0],E.position=R[1]}t.forEach((function(e){var t=ql(e);if(n.hasItem(t)){var r=n.getItem(t),o=r.findIndex((function(e){return e.group===C}));-1!==o?"before"===S?o-=1:o+=1:o=r.length,r.splice(o,0,E)}else n.addItem(t,[E])}))},{addShortcut:r,addShortcuts:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.forEach((function(e){Object(object.o)(t,(function(n,r){!1===Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=t[r])})),r(e)}))},getShortcuts:function(e){var t=ql(e),r=n.getItem(t);return Object(l.b)(r)?r.slice():[]},hasShortcut:function(e){var t=ql(e);return n.hasItem(t)},removeShortcutsByKeys:c=function(e){var t=ql(e);n.removeItem(t)},removeShortcutsByGroup:function(e){n.getItems().forEach((function(t){var n=Jl(t,2),r=n[0],o=n[1],l=o.filter((function(option){return option.group!==e}));0===l.length?c(function(e){return e.split("+")}(r)):(o.length=0,o.push.apply(o,Ql(l)))}))}});return d.addItem(e,h),h},getActiveContextName:y,getContext:v,setActiveContextName:function(e){f=e},isCtrlPressed:function(){return!m&&(w.isPressed("control")||w.isPressed("meta"))},destroy:function(){return w.unmount()}}};function as(e){return as="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},as(e)}function ls(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||cs(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ss(e){return function(e){if(Array.isArray(e))return us(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||cs(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cs(e,t){if(e){if("string"==typeof e)return us(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?us(e,t):void 0}}function us(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var hs="gridDefault",ds=null;function fs(e,t){var n,S,E,R,T,k=this,j=arguments.length>2&&void 0!==arguments[2]&&arguments[2],A=!1,x=this,M=new d.a(x),I=!0;Object(so.a)(j)&&Object(so.c)(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var _=null!==(n=null==t?void 0:t.layoutDirection)&&void 0!==n?n:"inherit",N=["rtl","ltr"].includes(_)?_:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",N),this.isRtl=function(){return"rtl"===N},this.isLtr=function(){return!x.isRtl()},this.getDirectionFactor=function(){return x.isLtr()?1:-1},t.language=Object(Ei.e)(t.language);var H=new _l(x,t,[Hl,Dl]),P=H.getTableMeta(),D=H.getGlobalMeta(),L=Object(Kl.a)();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),Object(so.b)(this)&&Object(l.a)(t.licenseKey,e),this.guid="ht_".concat(Object(O.b)()),this.columnIndexMapper=new Ci,this.rowIndexMapper=new Ci,E=new Co(x),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);var B=function(e){var t=e.row,n=e.col;return x._createCellCoords(t>=0?x.rowIndexMapper.getRenderableFromVisualIndex(t):t,n>=0?x.columnIndexMapper.getRenderableFromVisualIndex(n):n)},V=function(e){var t=e.row,n=e.col;return x._createCellCoords(t>=0?x.rowIndexMapper.getVisualFromRenderableIndex(t):t,n>=0?x.columnIndexMapper.getVisualFromRenderableIndex(n):n)},F=new ll(P,{rowIndexMapper:function(){return x.rowIndexMapper},columnIndexMapper:function(){return x.columnIndexMapper},countCols:function(){return x.countCols()},countRows:function(){return x.countRows()},propToCol:function(e){return S.propToCol(e)},isEditorOpened:function(){return!!x.getActiveEditor()&&x.getActiveEditor().isOpened()},countColsTranslated:function(){return k.view.countRenderableColumns()},countRowsTranslated:function(){return k.view.countRenderableRows()},getShortcutManager:function(){return x.getShortcutManager()},createCellCoords:function(e,t){return x._createCellCoords(e,t)},createCellRange:function(e,t,n){return x._createCellRange(e,t,n)},visualToRenderableCoords:B,renderableToVisualCoords:V,isDisabledCellSelection:function(e,t){return x.getCellMeta(e,t).disableVisualSelection}});this.selection=F;var W=function(e){e.hiddenIndexesChanged&&k.selection.refresh()};function z(e){var t=Object(Ri.b)(e);Object(Ei.f)(t)?(x.runHooks("beforeLanguageChange",t),D.language=t,x.runHooks("afterLanguageChange",t)):Object(Ri.c)(e)}function U(e,t){var element="className"===e?x.rootElement:x.table;if(I)Object(r.a)(element,t);else{var n=[],o=[];D[e]&&(n=Array.isArray(D[e])?D[e]:Object(f.i)(D[e])),t&&(o=Array.isArray(t)?t:Object(f.i)(t));var l=Object(f.g)(n,o),c=Object(f.g)(o,n);l.length&&Object(r.K)(element,l),c.length&&Object(r.a)(element,c)}D[e]=t}function G(){var e=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,e=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0===this.validatorsInQueue&&!1===e&&(e=!0,this.onQueueEmpty(this.valid))}}}function X(e){var t=e.replace(",",".");return!1===isNaN(parseFloat(t))?parseFloat(t):e}function K(e,source,t){if(e.length){var n=x.getActiveEditor(),o=x.runHooks("beforeChange",e,source||"edit"),l=!0;if(!1!==o){var c=new G;c.onQueueEmpty=function(e){n&&l&&n.cancelChanges(),t(e)};for(var i=e.length-1;i>=0;i--)if(null===e[i])e.splice(i,1);else{var h=ls(e[i],4),d=h[0],f=h[1],y=h[3],col=S.propToCol(f),v=x.getCellMeta(d,col);"numeric"===v.type&&"string"==typeof y&&Object(C.b)(y)&&(e[i][3]=X(y)),x.getCellValidator(v)&&(c.addValidatorToQueue(),x.validateCell(e[i][3],v,function(t,n){return function(o){if("boolean"!=typeof o)throw new Error("Validation error: result is not boolean");if(!1===o&&!1===n.allowInvalid){l=!1,e.splice(t,1),n.valid=!0;var h=x.getCell(n.visualRow,n.visualCol);null!==h&&Object(r.K)(h,P.invalidCellClassName)}c.removeValidatorFormQueue()}}(i,v),source))}c.checkIfQueueIsEmpty()}else n&&n.cancelChanges()}}function Y(e,source){var i=e.length-1;if(!(i<0)){for(;i>=0;i--){var t=!1;if(null!==e[i]){if(null!==e[i][2]&&void 0!==e[i][2]||null!==e[i][3]&&void 0!==e[i][3]){if(P.allowInsertRow)for(;e[i][0]>x.countRows()-1;){var n=S.createRow(void 0,void 0,source);if(!(n>=1)){t=!0;break}H.createRow(null,n)}if("array"===x.dataType&&(!P.columns||0===P.columns.length)&&P.allowInsertColumn)for(;S.propToCol(e[i][1])>x.countCols()-1;){var r=S.createCol(void 0,void 0,source);if(!(r>=1)){t=!0;break}H.createColumn(null,r)}t||S.set(e[i][0],e[i][1],e[i][3])}}else e.splice(i,1)}x.forceFullRender=!0,R.adjustRowsAndCols(),x.runHooks("beforeChangeRender",e,source),T.lockEditor(),x._refreshBorders(null),T.unlockEditor(),x.view.adjustElementsSize(),x.runHooks("afterChange",e,source||"edit");var o=x.getActiveEditor();o&&Object(l.b)(o.refreshValue)&&o.refreshValue()}}function $(e,t,n){return Array.isArray(e)?e:[[e,t,n]]}this.columnIndexMapper.addLocalHook("cacheUpdated",W),this.rowIndexMapper.addLocalHook("cacheUpdated",W),this.selection.addLocalHook("beforeSetRangeStart",(function(e){k.runHooks("beforeSetRangeStart",e)})),this.selection.addLocalHook("beforeSetRangeStartOnly",(function(e){k.runHooks("beforeSetRangeStartOnly",e)})),this.selection.addLocalHook("beforeSetRangeEnd",(function(e){k.runHooks("beforeSetRangeEnd",e),e.row<0&&(e.row=k.view._wt.wtTable.getFirstVisibleRow()),e.col<0&&(e.col=k.view._wt.wtTable.getFirstVisibleColumn())})),this.selection.addLocalHook("afterSetRangeEnd",(function(e){var t=Object(object.b)(!1),n=k.selection.getSelectedRange(),o=n.current(),l=o.from,c=o.to,h=n.size()-1;k.runHooks("afterSelection",l.row,l.col,c.row,c.col,t,h),k.runHooks("afterSelectionByProp",l.row,x.colToProp(l.col),c.row,x.colToProp(c.col),t,h);var d=k.selection.isSelectedByAnyHeader(),f=k.selection.selectedRange.current(),y=!0;A&&(y=!1),t.isTouched()&&(y=!t.value);var v=k.selection.isSelectedByRowHeader(),m=k.selection.isSelectedByColumnHeader();!1!==y&&(d?v?k.view.scrollViewportVertically(x.rowIndexMapper.getRenderableFromVisualIndex(e.row)):m&&k.view.scrollViewportHorizontally(x.columnIndexMapper.getRenderableFromVisualIndex(e.col)):f&&!k.selection.isMultiple()?k.view.scrollViewport(B(f.from)):k.view.scrollViewport(B(e))),v&&m?Object(r.a)(k.rootElement,["ht__selection--rows","ht__selection--columns"]):v?(Object(r.K)(k.rootElement,"ht__selection--columns"),Object(r.a)(k.rootElement,"ht__selection--rows")):m?(Object(r.K)(k.rootElement,"ht__selection--rows"),Object(r.a)(k.rootElement,"ht__selection--columns")):Object(r.K)(k.rootElement,["ht__selection--rows","ht__selection--columns"]),k._refreshBorders(null)})),this.selection.addLocalHook("afterSelectionFinished",(function(e){var t=e.length-1,n=e[t],r=n.from,o=n.to;k.runHooks("afterSelectionEnd",r.row,r.col,o.row,o.col,t),k.runHooks("afterSelectionEndByProp",r.row,x.colToProp(r.col),o.row,x.colToProp(o.col),t)})),this.selection.addLocalHook("afterIsMultipleSelection",(function(e){var t=k.runHooks("afterIsMultipleSelection",e.value);e.value&&(e.value=t)})),this.selection.addLocalHook("beforeModifyTransformStart",(function(e){k.runHooks("modifyTransformStart",e)})),this.selection.addLocalHook("afterModifyTransformStart",(function(e,t,n){k.runHooks("afterModifyTransformStart",e,t,n)})),this.selection.addLocalHook("beforeModifyTransformEnd",(function(e){k.runHooks("modifyTransformEnd",e)})),this.selection.addLocalHook("afterModifyTransformEnd",(function(e,t,n){k.runHooks("afterModifyTransformEnd",e,t,n)})),this.selection.addLocalHook("afterDeselect",(function(){T.destroyEditor(),k._refreshBorders(),Object(r.K)(k.rootElement,["ht__selection--rows","ht__selection--columns"]),k.runHooks("afterDeselect")})),this.selection.addLocalHook("insertRowRequire",(function(e){k.alter("insert_row",e,1,"auto")})),this.selection.addLocalHook("insertColRequire",(function(e){k.alter("insert_col",e,1,"auto")})),R={alter:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,source=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,c=function(e){if(0===e.length)return[];var t=ss(e);return t.sort((function(e,t){var n=ls(e,1)[0],r=ls(t,1)[0];return n===r?0:n>r?1:-1})),Object(f.d)(t,(function(e,t){var n=ls(t,2),r=n[0],o=n[1],l=e[e.length-1],c=ls(l,2),h=c[0]+c[1];if(r<=h){var d=Math.max(o-(h-r),0);l[1]+=d}else e.push([r,o]);return e}),[t[0]])};switch(e){case"insert_row":var h=x.countSourceRows();if(P.maxRows===h)return;if(t=Object(l.b)(t)?t:h,n=S.createRow(t,r,source)){H.createRow(x.toPhysicalRow(t),r);var d=F.selectedRange.current(),y=null==d?void 0:d.from,v=null==y?void 0:y.row;if(Object(l.b)(v)&&v>=t){var m=d.to,w=m.row,O=m.col,C=y.col;F.isSelectedByRowHeader()&&(C=-1),F.getSelectedRange().pop(),F.setRangeStartOnly(x._createCellCoords(v+n,C),!0),F.setRangeEnd(x._createCellCoords(w+n,O))}else x._refreshBorders()}break;case"insert_col":if(n=S.createCol(t,r,source)){if(H.createColumn(x.toPhysicalColumn(t),r),Array.isArray(P.colHeaders)){var E=[t,0];E.length+=n,Array.prototype.splice.apply(P.colHeaders,E)}var T=F.selectedRange.current(),k=null==T?void 0:T.from,j=null==k?void 0:k.col;if(Object(l.b)(j)&&j>=t){var A=T.to,M=A.row,I=A.col,_=k.row;F.isSelectedByColumnHeader()&&(_=-1),F.getSelectedRange().pop(),F.setRangeStartOnly(x._createCellCoords(_,j+n),!0),F.setRangeEnd(x._createCellCoords(M,I+n))}else x._refreshBorders()}break;case"remove_row":var N=function(e){var t=0;Object(f.a)(e,(function(e){var n=ls(e,2),r=n[0],o=n[1],c=Object(l.c)(r)?x.countRows()-1:Math.max(r-t,0);if(Number.isInteger(r)&&(r=Math.max(r-t,0)),S.removeRow(r,o,source)){H.removeRow(x.toPhysicalRow(c),o);var h=x.countRows(),d=P.fixedRowsTop;d>=c+1&&(P.fixedRowsTop-=Math.min(o,d-c));var f=P.fixedRowsBottom;f&&c>=h-f&&(P.fixedRowsBottom-=Math.min(o,f)),t+=o}}))};Array.isArray(t)?N(c(t)):N([[t,r]]),R.adjustRowsAndCols(),x._refreshBorders();break;case"remove_col":var D=function(e){var t=0;Object(f.a)(e,(function(e){var n=ls(e,2),r=n[0],o=n[1],c=Object(l.c)(r)?x.countCols()-1:Math.max(r-t,0),h=x.toPhysicalColumn(c);if(Number.isInteger(r)&&(r=Math.max(r-t,0)),S.removeCol(r,o,source)){H.removeColumn(h,o);var d=P.fixedColumnsStart;d>=c+1&&(P.fixedColumnsStart-=Math.min(o,d-c)),Array.isArray(P.colHeaders)&&(void 0===h&&(h=-1),P.colHeaders.splice(h,o)),t+=o}}))};Array.isArray(t)?D(c(t)):D([[t,r]]),R.adjustRowsAndCols(),x._refreshBorders();break;default:throw new Error('There is no such action "'.concat(e,'"'))}o||R.adjustRowsAndCols()},adjustRowsAndCols:function(){var e,t=P.minRows,n=P.minSpareRows,r=P.minCols,o=P.minSpareCols;if(t){var l=x.countRows();l<t&&S.createRow(l,t-l,"auto")}if(n){var c=x.countEmptyRows(!0);if(c<n){var h=n-c,d=Math.min(h,P.maxRows-x.countSourceRows());S.createRow(x.countRows(),d,"auto")}}(r||o)&&(e=x.countEmptyCols(!0));var y=x.countCols();if(r&&!P.columns&&y<r){var v=r-y;e+=v,S.createCol(y,v,"auto")}if(o&&!P.columns&&"array"===x.dataType&&e<o){y=x.countCols();var m=o-e,w=Math.min(m,P.maxCols-y);S.createCol(y,w,"auto")}var O=x.countRows(),C=x.countCols();0!==O&&0!==C||F.deselect(),F.isSelected()&&Object(f.a)(F.selectedRange,(function(e){var t=!1,n=e.from.row,r=e.from.col,o=e.to.row,l=e.to.col;n>O-1?(t=!0,o>(n=O-1)&&(o=n)):o>O-1&&(t=!0,n>(o=O-1)&&(n=o)),r>C-1?(t=!0,l>(r=C-1)&&(l=r)):l>C-1&&(t=!0,r>(l=C-1)&&(r=l)),t&&x.selectCell(n,r,o,l)})),x.view&&x.view.adjustElementsSize()},populateFromArray:function(e,input,t,source,n,r,o){var c,h,d,y,v=[],m={},w=[],O=e.row,C=e.col;if(0===(h=input.length))return!1;var S=0,E=0;switch(Object(object.l)(t)&&(S=t.col-C+1,E=t.row-O+1),n){case"shift_down":var R=Object(f.h)(input),T=R.length,k=Math.max(T,S),j=x.getData().slice(O),A=Object(f.h)(j).slice(C,C+k);for(d=0;d<k;d+=1)if(d<T){for(c=0,h=R[d].length;c<E-h;c+=1)R[d].push(R[d][c%h]);d<A.length?w.push(R[d].concat(A[d])):w.push(R[d].concat(new Array(j.length).fill(null)))}else w.push(R[d%T].concat(A[d]));x.populateFromArray(O,C,Object(f.h)(w));break;case"shift_right":var M=input.length,I=Math.max(M,E),_=x.getData().slice(O).map((function(e){return e.slice(C)}));for(c=0;c<I;c+=1)if(c<M){for(d=0,y=input[c].length;d<S-y;d+=1)input[c].push(input[c][d%y]);var N;if(c<_.length)for(var i=0;i<_[c].length;i+=1)input[c].push(_[c][i]);else(N=input[c]).push.apply(N,ss(new Array(_[0].length).fill(null)))}else input.push(input[c%h].slice(0,I).concat(_[c]));x.populateFromArray(O,C,input);break;default:m.row=e.row,m.col=e.col;var H,D={row:t&&e?t.row-e.row+1:1,col:t&&e?t.col-e.col+1:1},L=0,B=0,V=!0,F=function(e){var col=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=input[e%input.length];return null!==col?t[col%t.length]:t},W=input.length,z=t?t.row-e.row+1:0;for(h=t?z:Math.max(W,z),c=0;c<h&&!(t&&m.row>t.row&&z>W||!P.allowInsertRow&&m.row>x.countRows()-1||m.row>=P.maxRows);c++){var U=c-L,G=F(U).length,X=t?t.col-e.col+1:0;if(y=t?X:Math.max(G,X),m.col=e.col,H=x.getCellMeta(m.row,m.col),"CopyPaste.paste"!==source&&"Autofill.fill"!==source||!H.skipRowOnPaste){for(B=0,d=0;d<y&&!(t&&m.col>t.col&&X>G||!P.allowInsertColumn&&m.col>x.countCols()-1||m.col>=P.maxCols);d++)if(H=x.getCellMeta(m.row,m.col),"CopyPaste.paste"!==source&&"Autofill.fill"!==source||!H.skipColumnOnPaste)if(H.readOnly&&"UndoRedo.undo"!==source)m.col+=1;else{var K=d-B,Y=F(U,K),$=x.getDataAtCell(m.row,m.col),Q={row:U,col:K};if("Autofill.fill"===source){var J=x.runHooks("beforeAutofillInsidePopulate",Q,r,input,o,{},D);J&&(Y=Object(l.e)(J.value)?Y:J.value)}if(null!==Y&&"object"===as(Y))if(Array.isArray(Y)&&null===$&&($=[]),null===$||"object"!==as($))V=!1;else{var Z=Object(object.g)(Array.isArray($)?$:$[0]||$),ee=Object(object.g)(Array.isArray(Y)?Y:Y[0]||Y);Object(object.m)(Z,ee)?Y=Object(object.c)(Y):V=!1}else null!==$&&"object"===as($)&&(V=!1);V&&v.push([m.row,m.col,Y]),V=!0,m.col+=1}else B+=1,m.col+=1,y+=1;m.row+=1}else L+=1,m.row+=1,h+=1}x.setDataAtCell(v,null,null,source||"populateFromArray")}}},this.init=function(){E.setData(P.data),x.runHooks("beforeInit"),(Object(c.k)()||Object(c.i)())&&Object(r.a)(x.rootElement,"mobile"),this.updateSettings(P,!0),this.view=new go(this),T=h.c.getInstance(x,P,F),x.runHooks("init"),this.forceFullRender=!0,this.view.render(),"object"===as(I)&&(x.runHooks("afterChange",I[0],I[1]),I=!1),x.runHooks("afterInit")},this._createCellCoords=function(e,t){return x.view._wt.createCellCoords(e,t)},this._createCellRange=function(e,t,n){return x.view._wt.createCellRange(e,t,n)},this.validateCell=function(e,t,n,source){var r,c=x.getCellValidator(t);function h(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(r&&!0!==t.hidden){var col=t.visualCol,o=t.visualRow,td=x.getCell(o,col,!0);if(td&&"TH"!==td.nodeName){var l=x.rowIndexMapper.getRenderableFromVisualIndex(o),c=x.columnIndexMapper.getRenderableFromVisualIndex(col);x.view._wt.getSetting("cellRenderer",l,c,td)}n(e)}else n(e)}Object(l.d)(c)&&(r=c,c=function(e,t){t(r.test(e))}),Object(o.d)(c)?(e=x.runHooks("beforeValidate",e,t.visualRow,t.prop,source),x._registerImmediate((function(){c.call(t,e,(function(n){x&&(n=x.runHooks("afterValidate",n,e,t.visualRow,t.prop,source),t.valid=n,h(n),x.runHooks("postAfterValidate",n,e,t.visualRow,t.prop,source))}))}))):x._registerImmediate((function(){t.valid=!0,h(t.valid,!1)}))},this.setDataAtCell=function(e,t,n,source){var i,r,o,input=$(e,t,n),l=[],c=source;for(i=0,r=input.length;i<r;i++){if("object"!==as(input[i]))throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof input[i][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");o=input[i][1]>=this.countCols()?input[i][1]:S.colToProp(input[i][1]),l.push([input[i][0],o,E.getAtCell(this.toPhysicalRow(input[i][0]),input[i][1]),input[i][2]])}c||"object"!==as(e)||(c=t),x.runHooks("afterSetDataAtCell",l,c),K(l,c,(function(){Y(l,c)}))},this.setDataAtRowProp=function(e,t,n,source){var i,r,input=$(e,t,n),o=[],l=source;for(i=0,r=input.length;i<r;i++)o.push([input[i][0],input[i][1],E.getAtCell(this.toPhysicalRow(input[i][0]),input[i][1]),input[i][2]]);l||"object"!==as(e)||(l=t),x.runHooks("afterSetDataAtRowProp",o,l),K(o,l,(function(){Y(o,l)}))},this.listen=function(){x&&!x.isListening()&&(ds=x.guid,x.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(ds=null,x.runHooks("afterUnlisten"))},this.isListening=function(){return ds===x.guid},this.destroyEditor=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];x._refreshBorders(e,t)},this.populateFromArray=function(e,t,input,n,r,source,o,l,c){if("object"!==as(input)||"object"!==as(input[0]))throw new Error("populateFromArray parameter `input` must be an array of arrays");var h="number"==typeof n?x._createCellCoords(n,r):null;return R.populateFromArray(x._createCellCoords(e,t),input,h,source,o,l,c)},this.spliceCol=function(e,t,n){for(var r,o=arguments.length,l=new Array(o>3?o-3:0),c=3;c<o;c++)l[c-3]=arguments[c];return(r=S).spliceCol.apply(r,[e,t,n].concat(l))},this.spliceRow=function(e,t,n){for(var r,o=arguments.length,l=new Array(o>3?o-3:0),c=3;c<o;c++)l[c-3]=arguments[c];return(r=S).spliceRow.apply(r,[e,t,n].concat(l))},this.getSelected=function(){if(F.isSelected())return Object(f.c)(F.getSelectedRange(),(function(e){var t=e.from,n=e.to;return[t.row,t.col,n.row,n.col]}))},this.getSelectedLast=function(){var e,t=this.getSelected();return t&&t.length>0&&(e=t[t.length-1]),e},this.getSelectedRange=function(){if(F.isSelected())return Array.from(F.getSelectedRange())},this.getSelectedRangeLast=function(){var e,t=this.getSelectedRange();return t&&t.length>0&&(e=t[t.length-1]),e},this.emptySelectedCells=function(source){var e=this;if(F.isSelected()&&0!==this.countRows()&&0!==this.countCols()){var t=[];Object(f.a)(F.getSelectedRange(),(function(n){var r=n.getTopStartCorner(),o=n.getBottomEndCorner();Object(C.c)(r.row,o.row,(function(n){Object(C.c)(r.col,o.col,(function(r){e.getCellMeta(n,r).readOnly||t.push([n,r,null])}))}))})),t.length>0&&this.setDataAtCell(t,source)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var e=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(e,0),this.isRenderSuspended()||e!==this.renderSuspendedCounter||(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(T.lockEditor(),this._refreshBorders(null),T.unlockEditor()))},this.batchRender=function(e){this.suspendRender();var t=e();return this.resumeRender(),t},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(t,0),(!this.isExecutionSuspended()&&t===this.executionSuspendedCounter||e)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();var n=e();return this.resumeExecution(t),n},this.batch=function(e){this.suspendRender(),this.suspendExecution();var t=e();return this.resumeExecution(),this.resumeRender(),t},this.refreshDimensions=function(){if(x.view){var e=x.view.getLastSize(),t=e.width,n=e.height,r=x.rootElement.getBoundingClientRect(),o=r.width,l=r.height,c=o!==t||l!==n;!1===x.runHooks("beforeRefreshDimensions",{width:t,height:n},{width:o,height:l},c)||((c||x.view._wt.wtOverlays.scrollableElement===x.rootWindow)&&(x.view.setLastSize(o,l),x.render()),x.runHooks("afterRefreshDimensions",{width:t,height:n},{width:o,height:l},c))}},this.updateData=function(data,source){var e=this;Gl(data,(function(e){S=e}),(function(t){S=t,x.columnIndexMapper.fitToLength(e.getInitialColumnCount()),x.rowIndexMapper.fitToLength(e.countSourceRows()),R.adjustRowsAndCols()}),{hotInstance:x,dataMap:S,dataSource:E,internalSource:"updateData",source:source,firstRun:I})},this.loadData=function(data,source){Gl(data,(function(e){S=e}),(function(){H.clearCellsCache(),x.initIndexMappers(),R.adjustRowsAndCols(),I&&(I=[null,"loadData"])}),{hotInstance:x,dataMap:S,dataSource:E,internalSource:"loadData",source:source,firstRun:I})},this.getInitialColumnCount=function(){var e=P.columns,t=0;if(Array.isArray(e))t=e.length;else if(Object(o.d)(e))if("array"===x.dataType)for(var n=this.countSourceCols(),r=0;r<n;r+=1)e(r)&&(t+=1);else"object"!==x.dataType&&"function"!==x.dataType||(t=S.colToPropCache.length);else if(Object(l.b)(P.dataSchema)){var c=S.getSchema();t=Array.isArray(c)?c.length:Object(object.e)(c)}else t=this.countSourceCols();return t},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(e,t,n,r){return Object(l.e)(e)?S.getAll():S.getRange(x._createCellCoords(e,t),x._createCellCoords(n,r),S.DESTINATION_RENDERER)},this.getCopyableText=function(e,t,n,r){return S.getCopyableText(x._createCellCoords(e,t),x._createCellCoords(n,r))},this.getCopyableData=function(e,t){return S.getCopyable(e,S.colToProp(t))},this.getSchema=function(){return S.getSchema()},this.updateSettings=function(e){var i,t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=(I?x.loadData:x.updateData).bind(this),c=!1;if(Object(l.b)(e.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Object(l.b)(e.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Object(l.b)(e.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(i in e)"data"===i||("language"===i?z(e.language):"className"===i?U("className",e.className):"tableClassName"===i&&x.table?(U("tableClassName",e.tableClassName),x.view._wt.wtOverlays.syncOverlayTableClassNames()):Si.a.getSingleton().isRegistered(i)||Si.a.getSingleton().isDeprecated(i)?(Object(o.d)(e[i])||Array.isArray(e[i]))&&(e[i].initialHook=!0,x.addHook(i,e[i])):!n&&Object(object.j)(e,i)&&(D[i]=e[i]));void 0===e.data&&void 0===P.data?r(null,"updateSettings"):void 0!==e.data?r(e.data,"updateSettings"):void 0!==e.columns&&(S.createMap(),x.initIndexMappers());var h=x.countCols(),d=P.columns;if(d&&Object(o.d)(d)&&(c=!0),void 0===e.cell&&void 0===e.cells&&void 0===e.columns||H.clearCache(),h>0)for(i=0,t=0;i<h;i++){if(d){var f=c?d(i):d[t];f&&H.updateColumnMeta(t,f)}t+=1}Object(l.b)(e.cell)&&Object(object.o)(e.cell,(function(e){x.setCellMetaObject(e.row,e.col,e)})),x.runHooks("afterCellMetaReset");var y=x.rootElement.style.height;""!==y&&(y=parseInt(x.rootElement.style.height,10));var v=e.height;if(Object(o.d)(v)&&(v=v()),n){var m=x.rootElement.getAttribute("style");m&&x.rootElement.setAttribute("data-initialstyle",x.rootElement.getAttribute("style"))}if(null===v){var w=x.rootElement.getAttribute("data-initialstyle");w&&(w.indexOf("height")>-1||w.indexOf("overflow")>-1)?x.rootElement.setAttribute("style",w):(x.rootElement.style.height="",x.rootElement.style.overflow="")}else void 0!==v&&(x.rootElement.style.height=isNaN(v)?"".concat(v):"".concat(v,"px"),x.rootElement.style.overflow="hidden");if(void 0!==e.width){var O=e.width;Object(o.d)(O)&&(O=O()),x.rootElement.style.width=isNaN(O)?"".concat(O):"".concat(O,"px")}n||(x.view&&(x.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),x.view._wt.exportSettingsAsClassNames()),x.runHooks("afterUpdateSettings",e)),R.adjustRowsAndCols(),x.view&&!I&&(x.forceFullRender=!0,T.lockEditor(),x._refreshBorders(null),x.view._wt.wtOverlays.adjustElementsSize(),T.unlockEditor()),n||!x.view||""!==y&&""!==v&&void 0!==v||y===v||x.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var e=x.getSelectedLast();if(P.getValue){if(Object(o.d)(P.getValue))return P.getValue.call(x);if(e)return x.getData()[e[0][0]][P.getValue]}else if(e)return x.getDataAtCell(e[0],e[1])},this.getSettings=function(){return P},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(e,t,n,source,r){R.alter(e,t,n,source,r)},this.getCell=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t,o=e;if(t>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(t)))return null;r=this.columnIndexMapper.getRenderableFromVisualIndex(t)}if(e>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(e)))return null;o=this.rowIndexMapper.getRenderableFromVisualIndex(e)}return null===o||null===r?null:x.view.getCellAtCoords(x._createCellCoords(o,r),n)},this.getCoords=function(element){var e=this.view._wt.wtTable.getCoords(element);if(null===e)return null;var t=e.row,n=e.col,r=t,o=n;return t>=0&&(r=this.rowIndexMapper.getVisualFromRenderableIndex(t)),n>=0&&(o=this.columnIndexMapper.getVisualFromRenderableIndex(n)),x._createCellCoords(r,o)},this.colToProp=function(e){return S.colToProp(e)},this.propToCol=function(e){return S.propToCol(e)},this.toVisualRow=function(e){return k.rowIndexMapper.getVisualFromPhysicalIndex(e)},this.toVisualColumn=function(e){return k.columnIndexMapper.getVisualFromPhysicalIndex(e)},this.toPhysicalRow=function(e){return k.rowIndexMapper.getPhysicalFromVisualIndex(e)},this.toPhysicalColumn=function(e){return k.columnIndexMapper.getPhysicalFromVisualIndex(e)},this.getDataAtCell=function(e,t){return S.get(e,S.colToProp(t))},this.getDataAtRowProp=function(e,t){return S.get(e,t)},this.getDataAtCol=function(e){var t;return(t=[]).concat.apply(t,ss(S.getRange(x._createCellCoords(0,e),x._createCellCoords(P.data.length-1,e),S.DESTINATION_RENDERER)))},this.getDataAtProp=function(e){var t,n=S.getRange(x._createCellCoords(0,S.propToCol(e)),x._createCellCoords(P.data.length-1,S.propToCol(e)),S.DESTINATION_RENDERER);return(t=[]).concat.apply(t,ss(n))},this.getSourceData=function(e,t,n,r){return void 0===e?E.getData():E.getByRange(x._createCellCoords(e,t),x._createCellCoords(n,r))},this.getSourceDataArray=function(e,t,n,r){return void 0===e?E.getData(!0):E.getByRange(x._createCellCoords(e,t),x._createCellCoords(n,r),!0)},this.getSourceDataAtCol=function(e){return E.getAtColumn(e)},this.setSourceDataAtCell=function(e,t,n,source){var input=$(e,t,n),r=this.hasHook("afterSetSourceDataAtCell"),o=[];r&&Object(f.a)(input,(function(e){var t=ls(e,3),n=t[0],r=t[1],l=t[2];o.push([n,r,E.getAtCell(n,r),l])})),Object(f.a)(input,(function(e){var t=ls(e,3),n=t[0],r=t[1],o=t[2];E.setAtCell(n,r,o)})),r&&this.runHooks("afterSetSourceDataAtCell",o,source),this.render();var c=x.getActiveEditor();c&&Object(l.b)(c.refreshValue)&&c.refreshValue()},this.getSourceDataAtRow=function(e){return E.getAtRow(e)},this.getSourceDataAtCell=function(e,t){return E.getAtCell(e,t)},this.getDataAtRow=function(e){return S.getRange(x._createCellCoords(e,0),x._createCellCoords(e,this.countCols()-1),S.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(e,t,n,r){var o=this,l=void 0===e?[0,0,this.countRows(),this.countCols()]:[e,t,n,r],c=l[0],h=l[1],d=l[2],f=l[3],y=null,v=null;void 0===d&&(d=c),void 0===f&&(f=h);var m="mixed";return Object(C.c)(Math.max(Math.min(c,d),0),Math.max(c,d),(function(e){var t=!0;return Object(C.c)(Math.max(Math.min(h,f),0),Math.max(h,f),(function(n){var r=o.getCellMeta(e,n);return v=r.type,y?t=y===v:y=v,t})),m=t?v:"mixed",t})),m},this.removeCellMeta=function(e,t,n){var r=[this.toPhysicalRow(e),this.toPhysicalColumn(t)],o=r[0],l=r[1],c=H.getCellMetaKeyValue(o,l,n);!1!==x.runHooks("beforeRemoveCellMeta",e,t,n,c)&&(H.removeCellMeta(o,l,n),x.runHooks("afterRemoveCellMeta",e,t,n,c)),c=null},this.spliceCellsMeta=function(e){for(var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length,o=new Array(r>2?r-2:0),l=2;l<r;l++)o[l-2]=arguments[l];if(o.length>0&&!Array.isArray(o[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");n>0&&H.removeRow(this.toPhysicalRow(e),n),o.length>0&&Object(f.a)(o.reverse(),(function(n){H.createRow(t.toPhysicalRow(e)),Object(f.a)(n,(function(n,r){return t.setCellMetaObject(e,r,n)}))})),x.render()},this.setCellMetaObject=function(e,t,n){var r=this;"object"===as(n)&&Object(object.o)(n,(function(n,o){r.setCellMeta(e,t,o,n)}))},this.setCellMeta=function(e,t,n,r){if(!1!==x.runHooks("beforeSetCellMeta",e,t,n,r)){var o=e,l=t;e<this.countRows()&&(o=this.toPhysicalRow(e)),t<this.countCols()&&(l=this.toPhysicalColumn(t)),H.setCellMeta(o,l,n,r),x.runHooks("afterSetCellMeta",e,t,n,r)}},this.getCellsMeta=function(){return H.getCellsMeta()},this.getCellMeta=function(e,t){var n=this.toPhysicalRow(e),r=this.toPhysicalColumn(t);return null===n&&(n=e),null===r&&(r=t),H.getCellMeta(n,r,{visualRow:e,visualColumn:t})},this.getCellMetaAtRow=function(e){return H.getCellsMetaAtRow(e)},this.isColumnModificationAllowed=function(){return!("object"===x.dataType||P.columns)};var Q=Object(vo.a)("renderer");this.getCellRenderer=function(e,t){return Object(m.a)(Q.call(this,e,t))},this.getCellEditor=Object(vo.a)("editor");var J=Object(vo.a)("validator");this.getCellValidator=function(e,t){var n=J.call(this,e,t);return"string"==typeof n&&(n=Object(w.a)(n)),n},this.validateCells=function(e){this._validateCells(e)},this.validateRows=function(e,t){if(!Array.isArray(e))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(t,e)},this.validateColumns=function(e,t){if(!Array.isArray(e))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(t,void 0,e)},this._validateCells=function(e,t,n){var r=new G;e&&(r.onQueueEmpty=e);for(var i=x.countRows()-1;i>=0;)if(void 0===t||-1!==t.indexOf(i)){for(var o=x.countCols()-1;o>=0;)void 0===n||-1!==n.indexOf(o)?(r.addValidatorToQueue(),x.validateCell(x.getDataAtCell(i,o),x.getCellMeta(i,o),(function(e){if("boolean"!=typeof e)throw new Error("Validation error: result is not boolean");!1===e&&(r.valid=!1),r.removeValidatorFormQueue()}),"validateCells"),o-=1):o-=1;i-=1}else i-=1;r.checkIfQueueIsEmpty()},this.getRowHeader=function(e){var t=P.rowHeaders,n=e;return void 0!==n&&(n=x.runHooks("modifyRowHeader",n)),void 0===n?(t=[],Object(C.c)(x.countRows()-1,(function(i){t.push(x.getRowHeader(i))}))):Array.isArray(t)&&void 0!==t[n]?t=t[n]:Object(o.d)(t)?t=t(n):t&&"string"!=typeof t&&"number"!=typeof t&&(t=n+1),t},this.hasRowHeaders=function(){return!!P.rowHeaders},this.hasColHeaders=function(){if(void 0!==P.colHeaders&&null!==P.colHeaders)return!!P.colHeaders;for(var i=0,e=x.countCols();i<e;i++)if(x.getColHeader(i))return!0;return!1},this.getColHeader=function(e){var t=x.runHooks("modifyColHeader",e),n=P.colHeaders;if(void 0===t){for(var r=[],l=x.countCols(),i=0;i<l;i++)r.push(x.getColHeader(i));n=r}else{var c=x.toPhysicalColumn(t),h=function(e){for(var t=[],n=x.countCols(),r=0;r<n;r++)Object(o.d)(P.columns)&&P.columns(r)&&t.push(r);return t[e]}(c);!1===P.colHeaders?n=null:P.columns&&Object(o.d)(P.columns)&&P.columns(h)&&P.columns(h).title?n=P.columns(h).title:P.columns&&P.columns[c]&&P.columns[c].title?n=P.columns[c].title:Array.isArray(P.colHeaders)&&void 0!==P.colHeaders[c]?n=P.colHeaders[c]:Object(o.d)(P.colHeaders)?n=P.colHeaders(c):P.colHeaders&&"string"!=typeof P.colHeaders&&"number"!=typeof P.colHeaders&&(n=Object(vo.d)(t))}return n},this._getColWidthFromSettings=function(col){var e;col>=0&&(e=x.getCellMeta(0,col).width);if(void 0!==e&&e!==P.width||(e=P.colWidths),null!=e){switch(as(e)){case"object":e=e[col];break;case"function":e=e(col)}"string"==typeof e&&(e=parseInt(e,10))}return e},this.getColWidth=function(e){var t=x._getColWidthFromSettings(e);return void 0===(t=x.runHooks("modifyColWidth",t,e))&&(t=Gr.a.DEFAULT_WIDTH),t},this._getRowHeightFromSettings=function(e){var t=P.rowHeights;if(null!=t){switch(as(t)){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getRowHeight=function(e){var t=x._getRowHeightFromSettings(e);return t=x.runHooks("modifyRowHeight",t,e)},this.countSourceRows=function(){return E.countRows()},this.countSourceCols=function(){return E.countFirstRowKeys()},this.countRows=function(){return S.getLength()},this.countCols=function(){var e=P.maxCols,t=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(e,t)},this.countRenderedRows=function(){return x.view._wt.drawn?x.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return x.view._wt.drawn?x.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return x.view._wt.drawn?x.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return x.view._wt.drawn?x.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return Object(C.d)(x.countRows()-1,(function(n){if(x.isEmptyRow(n))t+=1;else if(!0===e)return!1})),t},this.countEmptyCols=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(x.countRows()<1)return 0;var t=0;return Object(C.d)(x.countCols()-1,(function(n){if(x.isEmptyCol(n))t+=1;else if(!0===e)return!1})),t},this.isEmptyRow=function(e){return P.isEmptyRow.call(x,e)},this.isEmptyCol=function(e){return P.isEmptyCol.call(x,e)},this.selectCell=function(e,t,n,r){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],c=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!Object(l.e)(e)&&!Object(l.e)(t)&&this.selectCells([[e,t,n,r]],o,c)},this.selectCells=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===t&&(A=!0);var r=F.selectCells(e);return r&&n&&x.listen(),A=!1,r},this.selectColumns=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return F.selectColumns(e,t)},this.selectRows=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return F.selectRows(e,t)},this.deselectCell=function(){F.deselect()},this.selectAll=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=e&&this.hasRowHeaders(),n=e&&this.hasColHeaders();A=!0,F.selectAll(t,n),A=!1};var Z=function(e,t){return e.getNearestNotHiddenIndex(t,1,!0)};function ee(e){return function(){throw new Error('The "'.concat(e,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.scrollViewportTo=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],l=!n,c=!r,h=e,d=t;if(o){var f=Number.isInteger(e),y=Number.isInteger(t),v=f?Z(this.rowIndexMapper,e):void 0,m=y?Z(this.columnIndexMapper,t):void 0;if(null===v||null===m)return!1;h=f?x.rowIndexMapper.getRenderableFromVisualIndex(v):void 0,d=y?x.columnIndexMapper.getRenderableFromVisualIndex(m):void 0}var w=Number.isInteger(h),O=Number.isInteger(d);return w&&O?x.view.scrollViewport(x._createCellCoords(h,d),l,r,n,c):w&&!1===O?x.view.scrollViewportVertically(h,l,n):!(!O||!1!==w)&&x.view.scrollViewportHorizontally(d,r,c)},this.destroy=function(){if(x._clearTimeouts(),x._clearImmediates(),x.view&&x.view.destroy(),E&&E.destroy(),E=null,this.getShortcutManager().destroy(),H.clearCache(),Object(so.b)(x)){var e=this.rootDocument.querySelector("#hot-display-license-info");e&&e.parentNode.removeChild(e)}Object(r.e)(x.rootElement),M.destroy(),T&&T.destroy(),x.batchExecution((function(){x.rowIndexMapper.unregisterAll(),x.columnIndexMapper.unregisterAll(),L.getItems().forEach((function(e){ls(e,2)[1].destroy()})),L.clear(),x.runHooks("afterDestroy")}),!0),Si.a.getSingleton().destroy(x),Object(object.o)(x,(function(e,t,n){Object(o.d)(e)?n[t]=ee(t):"guid"!==t&&(n[t]=null)})),x.isDestroyed=!0,S&&S.destroy(),x.rowIndexMapper=null,x.columnIndexMapper=null,S=null,R=null,F=null,T=null,x=null},this.getActiveEditor=function(){return T.getActiveEditor()},this.getPlugin=function(e){var t=Object(O.f)(e);return"UndoRedo"===t?this.undoRedo:L.getItem(t)},this.getPluginName=function(e){return e===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:L.getId(e)},this.getInstance=function(){return x},this.addHook=function(e,t){Si.a.getSingleton().add(e,t,x)},this.hasHook=function(e){return Si.a.getSingleton().has(e,x)||Si.a.getSingleton().has(e)},this.addHookOnce=function(e,t){Si.a.getSingleton().once(e,t,x)},this.removeHook=function(e,t){Si.a.getSingleton().remove(e,t,x)},this.runHooks=function(e,t,n,r,o,l,c){return Si.a.getSingleton().run(x,e,t,n,r,o,l,c)},this.getTranslatedPhrase=function(e,t){return Object(Ei.d)(P.language,e,t)},this.toHTML=function(){return Object(y.c)(k)},this.toTableElement=function(){var e=k.rootDocument.createElement("div");return e.insertAdjacentHTML("afterbegin",Object(y.c)(k)),e.firstElementChild},this.timeouts=[],this._registerTimeout=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e;"function"==typeof n&&(n=setTimeout(n,t)),this.timeouts.push(n)},this._clearTimeouts=function(){Object(f.a)(this.timeouts,(function(e){clearTimeout(e)}))},this.immediates=[],this._registerImmediate=function(e){this.immediates.push(setImmediate(e))},this._clearImmediates=function(){Object(f.a)(this.immediates,(function(e){clearImmediate(e)}))},this._refreshBorders=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];T.destroyEditor(e),x.view.render(),t&&F.isSelected()&&T.prepareEditor()},this.isRtl=function(){return"rtl"===x.rootWindow.getComputedStyle(x.rootElement).direction},this.isLtr=function(){return!x.isRtl()},this.getDirectionFactor=function(){return x.isLtr()?1:-1};var te=is({handleEvent:function(e){var t=x.isListening(),n=void 0!==(null==e?void 0:e.key);return t&&n},beforeKeyDown:function(e){return k.runHooks("beforeKeyDown",e)},afterKeyDown:function(e){k.isDestroyed||x.runHooks("afterDocumentKeyDown",e)},ownerWindow:this.rootWindow});this.getShortcutManager=function(){return te};var ne=te.addContext("grid"),re={runOnlyIf:function(){return Object(l.b)(x.getSelected())&&x.countRenderedRows()>0&&x.countRenderedCols()>0},group:hs};te.setActiveContextName("grid"),ne.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){x.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var e=x.getSelectedRange(),t=e[e.length-1].highlight,n=t.row,r=t.col,o=x.getDataAtCell(n,r),l=new Map,i=0;i<e.length;i++)e[i].forAll((function(e,t){e>=0&&t>=0&&(e!==n||t!==r)&&(x.getCellMeta(e,t).readOnly||l.set("".concat(e,"x").concat(t),[e,t,o]))}));x.setDataAtCell(Array.from(l.values()))},runOnlyIf:function(){return x.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){F.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){F.setRangeStart(x._createCellCoords(x.rowIndexMapper.getNearestNotHiddenIndex(0,1),x.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){F.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var e=x.getSelectedRangeLast(),t=e.from,n=e.to,r=x.rowIndexMapper.getNearestNotHiddenIndex(0,1);F.setRangeStart(t.clone()),F.setRangeEnd(x._createCellCoords(r,n.col))},runOnlyIf:function(){return!(x.selection.isSelectedByCorner()||x.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){F.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){F.setRangeStart(x._createCellCoords(x.rowIndexMapper.getNearestNotHiddenIndex(x.countRows()-1,-1),x.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){F.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var e=x.getSelectedRangeLast(),t=e.from,n=e.to,r=x.rowIndexMapper.getNearestNotHiddenIndex(x.countRows()-1,-1);F.setRangeStart(t.clone()),F.setRangeEnd(x._createCellCoords(r,n.col))},runOnlyIf:function(){return!(x.selection.isSelectedByCorner()||x.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){F.transformStart(0,-1*x.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var e,t=x.getSelectedRangeLast().highlight.row,n=(e=x.columnIndexMapper).getNearestNotHiddenIndex.apply(e,ss(x.isRtl()?[x.countCols()-1,-1]:[0,1]));F.setRangeStart(x._createCellCoords(t,n))}},{keys:[["ArrowLeft","Shift"]],callback:function(){F.transformEnd(0,-1*x.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var e,t=x.getSelectedRangeLast(),n=t.from,r=t.to,o=(e=x.columnIndexMapper).getNearestNotHiddenIndex.apply(e,ss(x.isRtl()?[x.countCols()-1,-1]:[0,1]));F.setRangeStart(n.clone()),F.setRangeEnd(x._createCellCoords(r.row,o))},runOnlyIf:function(){return!(x.selection.isSelectedByCorner()||x.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){F.transformStart(0,x.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var e,t=x.getSelectedRangeLast().highlight.row,n=(e=x.columnIndexMapper).getNearestNotHiddenIndex.apply(e,ss(x.isRtl()?[0,1]:[x.countCols()-1,-1]));F.setRangeStart(x._createCellCoords(t,n))}},{keys:[["ArrowRight","Shift"]],callback:function(){F.transformEnd(0,x.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var e,t=x.getSelectedRangeLast(),n=t.from,r=t.to,o=(e=x.columnIndexMapper).getNearestNotHiddenIndex.apply(e,ss(x.isRtl()?[0,1]:[x.countCols()-1,-1]));F.setRangeStart(n.clone()),F.setRangeEnd(x._createCellCoords(r.row,o))},runOnlyIf:function(){return!(x.selection.isSelectedByCorner()||x.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var e=parseInt(x.getSettings().fixedColumnsStart,10),t=x.getSelectedRangeLast().highlight.row,n=x.columnIndexMapper.getNearestNotHiddenIndex(e,1);F.setRangeStart(x._createCellCoords(t,n))},runOnlyIf:function(){return x.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){F.setRangeEnd(x._createCellCoords(F.selectedRange.current().from.row,x.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var e=parseInt(x.getSettings().fixedRowsTop,10),t=parseInt(x.getSettings().fixedColumnsStart,10),n=x.rowIndexMapper.getNearestNotHiddenIndex(e,1),r=x.columnIndexMapper.getNearestNotHiddenIndex(t,1);F.setRangeStart(x._createCellCoords(n,r))},runOnlyIf:function(){return x.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){F.setRangeStart(x._createCellCoords(x.getSelectedRangeLast().highlight.row,x.columnIndexMapper.getNearestNotHiddenIndex(x.countCols()-1,-1)))},runOnlyIf:function(){return x.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){F.setRangeEnd(x._createCellCoords(F.selectedRange.current().from.row,x.columnIndexMapper.getNearestNotHiddenIndex(x.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var e=parseInt(x.getSettings().fixedRowsBottom,10),t=x.rowIndexMapper.getNearestNotHiddenIndex(x.countRows()-e-1,-1),n=x.columnIndexMapper.getNearestNotHiddenIndex(x.countCols()-1,-1);F.setRangeStart(x._createCellCoords(t,n))},runOnlyIf:function(){return x.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){F.transformStart(-x.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var e=x.getSelectedRangeLast().to,t=Math.max(e.row-x.countVisibleRows(),0),n=x.rowIndexMapper.getNearestNotHiddenIndex(t,1);if(null!==n){var r=x._createCellCoords(n,e.col),o=e.row-x.view.getFirstFullyVisibleRow(),l=Math.max(r.row-o,0);F.setRangeEnd(r),x.scrollViewportTo(l)}}},{keys:[["PageDown"]],callback:function(){F.transformStart(x.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var e=x.getSelectedRangeLast().to,t=Math.min(e.row+x.countVisibleRows(),x.countRows()-1),n=x.rowIndexMapper.getNearestNotHiddenIndex(t,-1);if(null!==n){var r=x._createCellCoords(n,e.col),o=e.row-x.view.getFirstFullyVisibleRow(),l=Math.min(r.row-o,x.countRows()-1);F.setRangeEnd(r),x.scrollViewportTo(l)}}},{keys:[["Tab"]],callback:function(e){var t="function"==typeof P.tabMoves?P.tabMoves(e):P.tabMoves;F.transformStart(t.row,t.col,!0)}},{keys:[["Shift","Tab"]],callback:function(e){var t="function"==typeof P.tabMoves?P.tabMoves(e):P.tabMoves;F.transformStart(-t.row,-t.col)}}],re),Object(v.b)().forEach((function(e){var t=Object(v.a)(e);L.addItem(e,new t(k))})),Si.a.getSingleton().run(x,"construct")}},774:function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"g",(function(){return k})),n.d(t,"b",(function(){return j})),n.d(t,"f",(function(){return A})),n.d(t,"c",(function(){return x})),n.d(t,"d",(function(){return M})),n.d(t,"e",(function(){return I}));var object=n(601),r=n(607),o=n(617),l=n(742),c=n(669);n(377),n(22);var h=Object(c.a)("phraseFormatters"),d=h.register,f=h.getValues;d("pluralize",(function(e,t){return Array.isArray(e)&&Number.isInteger(t)?e[t]:e}));var y,v=n(609);function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w=(m(y={languageCode:"en-US"},v.CONTEXTMENU_ITEMS_NO_ITEMS,"No available options"),m(y,v.CONTEXTMENU_ITEMS_ROW_ABOVE,"Insert row above"),m(y,v.CONTEXTMENU_ITEMS_ROW_BELOW,"Insert row below"),m(y,v.CONTEXTMENU_ITEMS_INSERT_LEFT,"Insert column left"),m(y,v.CONTEXTMENU_ITEMS_INSERT_RIGHT,"Insert column right"),m(y,v.CONTEXTMENU_ITEMS_REMOVE_ROW,["Remove row","Remove rows"]),m(y,v.CONTEXTMENU_ITEMS_REMOVE_COLUMN,["Remove column","Remove columns"]),m(y,v.CONTEXTMENU_ITEMS_UNDO,"Undo"),m(y,v.CONTEXTMENU_ITEMS_REDO,"Redo"),m(y,v.CONTEXTMENU_ITEMS_READ_ONLY,"Read only"),m(y,v.CONTEXTMENU_ITEMS_CLEAR_COLUMN,"Clear column"),m(y,v.CONTEXTMENU_ITEMS_ALIGNMENT,"Alignment"),m(y,v.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT,"Left"),m(y,v.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER,"Center"),m(y,v.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT,"Right"),m(y,v.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY,"Justify"),m(y,v.CONTEXTMENU_ITEMS_ALIGNMENT_TOP,"Top"),m(y,v.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE,"Middle"),m(y,v.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM,"Bottom"),m(y,v.CONTEXTMENU_ITEMS_FREEZE_COLUMN,"Freeze column"),m(y,v.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN,"Unfreeze column"),m(y,v.CONTEXTMENU_ITEMS_BORDERS,"Borders"),m(y,v.CONTEXTMENU_ITEMS_BORDERS_TOP,"Top"),m(y,v.CONTEXTMENU_ITEMS_BORDERS_RIGHT,"Right"),m(y,v.CONTEXTMENU_ITEMS_BORDERS_BOTTOM,"Bottom"),m(y,v.CONTEXTMENU_ITEMS_BORDERS_LEFT,"Left"),m(y,v.CONTEXTMENU_ITEMS_REMOVE_BORDERS,"Remove border(s)"),m(y,v.CONTEXTMENU_ITEMS_ADD_COMMENT,"Add comment"),m(y,v.CONTEXTMENU_ITEMS_EDIT_COMMENT,"Edit comment"),m(y,v.CONTEXTMENU_ITEMS_REMOVE_COMMENT,"Delete comment"),m(y,v.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT,"Read-only comment"),m(y,v.CONTEXTMENU_ITEMS_MERGE_CELLS,"Merge cells"),m(y,v.CONTEXTMENU_ITEMS_UNMERGE_CELLS,"Unmerge cells"),m(y,v.CONTEXTMENU_ITEMS_COPY,"Copy"),m(y,v.CONTEXTMENU_ITEMS_CUT,"Cut"),m(y,v.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD,"Insert child row"),m(y,v.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD,"Detach from parent"),m(y,v.CONTEXTMENU_ITEMS_HIDE_COLUMN,["Hide column","Hide columns"]),m(y,v.CONTEXTMENU_ITEMS_SHOW_COLUMN,["Show column","Show columns"]),m(y,v.CONTEXTMENU_ITEMS_HIDE_ROW,["Hide row","Hide rows"]),m(y,v.CONTEXTMENU_ITEMS_SHOW_ROW,["Show row","Show rows"]),m(y,v.FILTERS_CONDITIONS_NONE,"None"),m(y,v.FILTERS_CONDITIONS_EMPTY,"Is empty"),m(y,v.FILTERS_CONDITIONS_NOT_EMPTY,"Is not empty"),m(y,v.FILTERS_CONDITIONS_EQUAL,"Is equal to"),m(y,v.FILTERS_CONDITIONS_NOT_EQUAL,"Is not equal to"),m(y,v.FILTERS_CONDITIONS_BEGINS_WITH,"Begins with"),m(y,v.FILTERS_CONDITIONS_ENDS_WITH,"Ends with"),m(y,v.FILTERS_CONDITIONS_CONTAINS,"Contains"),m(y,v.FILTERS_CONDITIONS_NOT_CONTAIN,"Does not contain"),m(y,v.FILTERS_CONDITIONS_GREATER_THAN,"Greater than"),m(y,v.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,"Greater than or equal to"),m(y,v.FILTERS_CONDITIONS_LESS_THAN,"Less than"),m(y,v.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,"Less than or equal to"),m(y,v.FILTERS_CONDITIONS_BETWEEN,"Is between"),m(y,v.FILTERS_CONDITIONS_NOT_BETWEEN,"Is not between"),m(y,v.FILTERS_CONDITIONS_AFTER,"After"),m(y,v.FILTERS_CONDITIONS_BEFORE,"Before"),m(y,v.FILTERS_CONDITIONS_TODAY,"Today"),m(y,v.FILTERS_CONDITIONS_TOMORROW,"Tomorrow"),m(y,v.FILTERS_CONDITIONS_YESTERDAY,"Yesterday"),m(y,v.FILTERS_VALUES_BLANK_CELLS,"Blank cells"),m(y,v.FILTERS_DIVS_FILTER_BY_CONDITION,"Filter by condition"),m(y,v.FILTERS_DIVS_FILTER_BY_VALUE,"Filter by value"),m(y,v.FILTERS_LABELS_CONJUNCTION,"And"),m(y,v.FILTERS_LABELS_DISJUNCTION,"Or"),m(y,v.FILTERS_BUTTONS_SELECT_ALL,"Select all"),m(y,v.FILTERS_BUTTONS_CLEAR,"Clear"),m(y,v.FILTERS_BUTTONS_OK,"OK"),m(y,v.FILTERS_BUTTONS_CANCEL,"Cancel"),m(y,v.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,"Search"),m(y,v.FILTERS_BUTTONS_PLACEHOLDER_VALUE,"Value"),m(y,v.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE,"Second value"),y),O=w.languageCode,C=Object(c.a)("languagesDictionaries"),S=C.register,E=C.getItem,R=C.hasItem,T=C.getValues;function k(e,t){var n=e,r=t;return Object(object.l)(e)&&(n=(r=e).languageCode),function(e,t){e!==O&&Object(l.a)(t,E(O))}(n,r),S(n,Object(object.c)(r)),Object(object.c)(r)}function j(e){return A(e)?Object(object.c)(E(e)):null}function A(e){return R(e)}function x(){return T()}function M(e,t,n){var l=j(e);if(null===l)return null;var c=l[t];if(Object(o.e)(c))return null;var h=function(e,t){var n=e;return Object(r.a)(function(){return f()}(),(function(r){n=r(e,t)})),n}(c,n);return Array.isArray(h)?h[0]:h}function I(e){var t=Object(l.b)(e);return A(t)||(t=O,Object(l.c)(e)),t}k(w)},775:function(e,t,n){"use strict";n.d(t,"b",(function(){return _})),n.d(t,"a",(function(){return N})),n.d(t,"c",(function(){return H})),n.d(t,"d",(function(){return P}));n(28),n(7),n(46),n(4),n(53),n(212),n(32),n(35),n(42),n(36),n(27),n(21);var r=n(643),o=(n(269),n(60),n(292),n(630)),l=n(636);function c(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||d(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||d(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var y="asc",v=new Map([[y,[-1,1]],["desc",[1,-1]]]),m=function(e){return"The priority '".concat(e,"' is already declared in a map.")},w=function(e){return"The priority '".concat(e,"' is not a number.")};var O=n(691);n(631);function C(e){return function(e){if(Array.isArray(e))return S(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var E=function(e){return"'".concat(e,"' value is already declared in a unique set.")};function R(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||k(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e){return function(e){if(Array.isArray(e))return j(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||k(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){if(e){if("string"==typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j(e,t):void 0}}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var A=function(e){return'There is already registered "'.concat(e,'" plugin.')},x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.errorPriorityExists,n=e.errorPriorityNaN,r=new Map;function d(e,l){if(!Object(o.a)(e))throw new Error(n(e));if(r.has(e))throw new Error(t(e));r.set(e,l)}function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=v.get(e)||v.get(y),n=h(t,2),o=n[0],l=n[1];return c(r).sort((function(a,b){return a[0]<b[0]?o:l})).map((function(e){return e[1]}))}return t=Object(l.d)(t)?t:m,n=Object(l.d)(n)?n:w,{addItem:d,getItems:f}}({errorPriorityExists:function(e){return'There is already registered plugin on priority "'.concat(e,'".')},errorPriorityNaN:function(e){return'The priority "'.concat(e,'" is not a number.')}}),M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.errorItemExists,n=new Set;function r(e){if(n.has(e))throw new Error(t(e));n.add(e)}function o(){return C(n)}function c(){n.clear()}return t=Object(l.d)(t)?t:E,{addItem:r,clear:c,getItems:o}}({errorItemExists:A}),I=Object(O.a)({errorIdExists:A});function _(){return[].concat(T(x.getItems()),T(M.getItems()))}function N(e){var t=Object(r.f)(e);return I.getItem(t)}function H(e){return!!N(e)}function P(e,t,n){var o=function(e,t,n){"function"==typeof e&&(e=(t=e).PLUGIN_KEY,n=t.PLUGIN_PRIORITY);return[e,t,n]}(e,t,n),l=R(o,3);e=l[0],t=l[1],n=l[2],void 0===N(e)&&function(e,t,n){var o=Object(r.f)(e);if(I.hasItem(o))throw new Error(A(o));void 0===n?M.addItem(o):x.addItem(n,o);I.addItem(o,t)}(e,t,n)}},807:function(e,t,n){"use strict";var r,o=n(26),l=n(19),c=n(298),h=n(221),d=n(379),f=n(741),y=n(37),v=n(392),m=n(91).enforce,w=n(385),O=!o.ActiveXObject&&"ActiveXObject"in o,C=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},S=d("WeakMap",C,f);if(w&&O){r=f.getConstructor(C,"WeakMap",!0),h.enable();var E=S.prototype,R=l(E.delete),T=l(E.has),k=l(E.get),j=l(E.set);c(E,{delete:function(e){if(y(e)&&!v(e)){var t=m(this);return t.frozen||(t.frozen=new r),R(this,e)||t.frozen.delete(e)}return R(this,e)},has:function(e){if(y(e)&&!v(e)){var t=m(this);return t.frozen||(t.frozen=new r),T(this,e)||t.frozen.has(e)}return T(this,e)},get:function(e){if(y(e)&&!v(e)){var t=m(this);return t.frozen||(t.frozen=new r),T(this,e)?k(this,e):t.frozen.get(e)}return k(this,e)},set:function(e,t){if(y(e)&&!v(e)){var n=m(this);n.frozen||(n.frozen=new r),T(this,e)?j(this,e,t):n.frozen.set(e,t)}else j(this,e,t);return this}})}},808:function(e,t,n){"use strict";var r=n(6),o=n(297).codeAt;r({target:"String",proto:!0},{codePointAt:function(e){return o(this,e)}})},809:function(e,t,n){e.exports=function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,p){return t=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},t(e,p)}function n(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function r(e,o,l){return r=n()?Reflect.construct:function(e,n,r){var a=[null];a.push.apply(a,n);var o=new(Function.bind.apply(e,a));return r&&t(o,r.prototype),o},r.apply(null,arguments)}function o(e){return l(e)||c(e)||h(e)||f()}function l(e){if(Array.isArray(e))return d(e)}function c(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function h(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function f(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var y=Object.hasOwnProperty,v=Object.setPrototypeOf,m=Object.isFrozen,w=Object.getPrototypeOf,O=Object.getOwnPropertyDescriptor,C=Object.freeze,S=Object.seal,E=Object.create,R="undefined"!=typeof Reflect&&Reflect,T=R.apply,k=R.construct;T||(T=function(e,t,n){return e.apply(t,n)}),C||(C=function(e){return e}),S||(S=function(e){return e}),k||(k=function(e,t){return r(e,o(t))});var j=L(Array.prototype.forEach),A=L(Array.prototype.pop),x=L(Array.prototype.push),M=L(String.prototype.toLowerCase),I=L(String.prototype.match),_=L(String.prototype.replace),N=L(String.prototype.indexOf),H=L(String.prototype.trim),P=L(RegExp.prototype.test),D=B(TypeError);function L(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return T(e,t,r)}}function B(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return k(e,n)}}function V(e,t,n){n=n||M,v&&v(e,null);for(var r=t.length;r--;){var element=t[r];if("string"==typeof element){var o=n(element);o!==element&&(m(t)||(t[r]=o),element=o)}e[element]=!0}return e}function F(object){var e,t=E(null);for(e in object)T(y,object,[e])&&(t[e]=object[e]);return t}function W(object,e){for(;null!==object;){var desc=O(object,e);if(desc){if(desc.get)return L(desc.get);if("function"==typeof desc.value)return L(desc.value)}object=w(object)}function t(element){return console.warn("fallback value for",element),null}return t}var z=C(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),U=C(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),G=C(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),X=C(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),K=C(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),Y=C(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),text=C(["#text"]),html=C(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),svg=C(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),$=C(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Q=C(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),J=S(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Z=S(/<%[\w\W]*|[\w\W]*%>/gm),ee=S(/^data-[\-\w.\u00B7-\uFFFF]/),te=S(/^aria-[\-\w]+$/),ne=S(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),re=S(/^(?:\w+script|data):/i),oe=S(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),ie=S(/^html$/i),ae=function(){return"undefined"==typeof window?null:window},le=function(t,n){if("object"!==e(t)||"function"!=typeof t.createPolicy)return null;var r=null,o="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(o)&&(r=n.currentScript.getAttribute(o));var l="dompurify"+(r?"#"+r:"");try{return t.createPolicy(l,{createHTML:function(html){return html},createScriptURL:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+l+" could not be created."),null}};function se(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae(),n=function(e){return se(e)};if(n.version="2.3.10",n.removed=[],!t||!t.document||9!==t.document.nodeType)return n.isSupported=!1,n;var r=t.document,l=t.document,c=t.DocumentFragment,h=t.HTMLTemplateElement,d=t.Node,f=t.Element,y=t.NodeFilter,v=t.NamedNodeMap,m=void 0===v?t.NamedNodeMap||t.MozNamedAttrMap:v,w=t.HTMLFormElement,O=t.DOMParser,S=t.trustedTypes,E=f.prototype,R=W(E,"cloneNode"),T=W(E,"nextSibling"),k=W(E,"childNodes"),L=W(E,"parentNode");if("function"==typeof h){var template=l.createElement("template");template.content&&template.content.ownerDocument&&(l=template.content.ownerDocument)}var B=le(S,r),ce=B?B.createHTML(""):"",ue=l,he=ue.implementation,de=ue.createNodeIterator,fe=ue.createDocumentFragment,pe=ue.getElementsByTagName,be=r.importNode,ye={};try{ye=F(l).documentMode?l.documentMode:{}}catch(e){}var ge={};n.isSupported="function"==typeof L&&he&&void 0!==he.createHTMLDocument&&9!==ye;var ve,me,we=J,Oe=Z,Ce=ee,Se=te,Ee=re,Re=oe,Te=ne,ke=null,je=V({},[].concat(o(z),o(U),o(G),o(K),o(text))),Ae=null,xe=V({},[].concat(o(html),o(svg),o($),o(Q))),Me=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ie=null,_e=null,Ne=!0,He=!0,Pe=!1,De=!1,Le=!1,Be=!1,Ve=!1,Fe=!1,We=!1,ze=!1,Ue=!0,Ge=!0,Xe=!1,Ke={},Ye=null,qe=V({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),$e=null,Qe=V({},["audio","video","img","source","image","track"]),Je=null,Ze=V({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),et="http://www.w3.org/1998/Math/MathML",tt="http://www.w3.org/2000/svg",nt="http://www.w3.org/1999/xhtml",ot=nt,it=!1,at=["application/xhtml+xml","text/html"],lt="text/html",st=null,ct=l.createElement("form"),ut=function(e){return e instanceof RegExp||e instanceof Function},ht=function(t){st&&st===t||(t&&"object"===e(t)||(t={}),t=F(t),ve=ve=-1===at.indexOf(t.PARSER_MEDIA_TYPE)?lt:t.PARSER_MEDIA_TYPE,me="application/xhtml+xml"===ve?function(e){return e}:M,ke="ALLOWED_TAGS"in t?V({},t.ALLOWED_TAGS,me):je,Ae="ALLOWED_ATTR"in t?V({},t.ALLOWED_ATTR,me):xe,Je="ADD_URI_SAFE_ATTR"in t?V(F(Ze),t.ADD_URI_SAFE_ATTR,me):Ze,$e="ADD_DATA_URI_TAGS"in t?V(F(Qe),t.ADD_DATA_URI_TAGS,me):Qe,Ye="FORBID_CONTENTS"in t?V({},t.FORBID_CONTENTS,me):qe,Ie="FORBID_TAGS"in t?V({},t.FORBID_TAGS,me):{},_e="FORBID_ATTR"in t?V({},t.FORBID_ATTR,me):{},Ke="USE_PROFILES"in t&&t.USE_PROFILES,Ne=!1!==t.ALLOW_ARIA_ATTR,He=!1!==t.ALLOW_DATA_ATTR,Pe=t.ALLOW_UNKNOWN_PROTOCOLS||!1,De=t.SAFE_FOR_TEMPLATES||!1,Le=t.WHOLE_DOCUMENT||!1,Fe=t.RETURN_DOM||!1,We=t.RETURN_DOM_FRAGMENT||!1,ze=t.RETURN_TRUSTED_TYPE||!1,Ve=t.FORCE_BODY||!1,Ue=!1!==t.SANITIZE_DOM,Ge=!1!==t.KEEP_CONTENT,Xe=t.IN_PLACE||!1,Te=t.ALLOWED_URI_REGEXP||Te,ot=t.NAMESPACE||nt,t.CUSTOM_ELEMENT_HANDLING&&ut(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Me.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&ut(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Me.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Me.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),De&&(He=!1),We&&(Fe=!0),Ke&&(ke=V({},o(text)),Ae=[],!0===Ke.html&&(V(ke,z),V(Ae,html)),!0===Ke.svg&&(V(ke,U),V(Ae,svg),V(Ae,Q)),!0===Ke.svgFilters&&(V(ke,G),V(Ae,svg),V(Ae,Q)),!0===Ke.mathMl&&(V(ke,K),V(Ae,$),V(Ae,Q))),t.ADD_TAGS&&(ke===je&&(ke=F(ke)),V(ke,t.ADD_TAGS,me)),t.ADD_ATTR&&(Ae===xe&&(Ae=F(Ae)),V(Ae,t.ADD_ATTR,me)),t.ADD_URI_SAFE_ATTR&&V(Je,t.ADD_URI_SAFE_ATTR,me),t.FORBID_CONTENTS&&(Ye===qe&&(Ye=F(Ye)),V(Ye,t.FORBID_CONTENTS,me)),Ge&&(ke["#text"]=!0),Le&&V(ke,["html","head","body"]),ke.table&&(V(ke,["tbody"]),delete Ie.tbody),C&&C(t),st=t)},ft=V({},["mi","mo","mn","ms","mtext"]),pt=V({},["foreignobject","desc","title","annotation-xml"]),bt=V({},["title","style","font","a","script"]),yt=V({},U);V(yt,G),V(yt,X);var gt=V({},K);V(gt,Y);var vt=function(element){var e=L(element);e&&e.tagName||(e={namespaceURI:nt,tagName:"template"});var t=M(element.tagName),n=M(e.tagName);return element.namespaceURI===tt?e.namespaceURI===nt?"svg"===t:e.namespaceURI===et?"svg"===t&&("annotation-xml"===n||ft[n]):Boolean(yt[t]):element.namespaceURI===et?e.namespaceURI===nt?"math"===t:e.namespaceURI===tt?"math"===t&&pt[n]:Boolean(gt[t]):element.namespaceURI===nt&&!(e.namespaceURI===tt&&!pt[n])&&!(e.namespaceURI===et&&!ft[n])&&!gt[t]&&(bt[t]||!yt[t])},mt=function(e){x(n.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=ce}catch(t){e.remove()}}},wt=function(e,t){try{x(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){x(n.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!Ae[e])if(Fe||We)try{mt(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},Ot=function(e){var t,n;if(Ve)e="<remove></remove>"+e;else{var r=I(e,/^[\r\n\t ]+/);n=r&&r[0]}"application/xhtml+xml"===ve&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var o=B?B.createHTML(e):e;if(ot===nt)try{t=(new O).parseFromString(o,ve)}catch(e){}if(!t||!t.documentElement){t=he.createDocument(ot,"template",null);try{t.documentElement.innerHTML=it?"":o}catch(e){}}var body=t.body||t.documentElement;return e&&n&&body.insertBefore(l.createTextNode(n),body.childNodes[0]||null),ot===nt?pe.call(t,Le?"html":"body")[0]:Le?t.documentElement:body},Ct=function(e){return de.call(e.ownerDocument||e,e,y.SHOW_ELEMENT|y.SHOW_COMMENT|y.SHOW_TEXT,null,!1)},St=function(e){return e instanceof w&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof m)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore)},Et=function(object){return"object"===e(d)?object instanceof d:object&&"object"===e(object)&&"number"==typeof object.nodeType&&"string"==typeof object.nodeName},Rt=function(e,t,data){ge[e]&&j(ge[e],(function(e){e.call(n,t,data,st)}))},Tt=function(e){var content;if(Rt("beforeSanitizeElements",e,null),St(e))return mt(e),!0;if(P(/[\u0080-\uFFFF]/,e.nodeName))return mt(e),!0;var t=me(e.nodeName);if(Rt("uponSanitizeElement",e,{tagName:t,allowedTags:ke}),e.hasChildNodes()&&!Et(e.firstElementChild)&&(!Et(e.content)||!Et(e.content.firstElementChild))&&P(/<[/\w]/g,e.innerHTML)&&P(/<[/\w]/g,e.textContent))return mt(e),!0;if("select"===t&&P(/<template/i,e.innerHTML))return mt(e),!0;if(!ke[t]||Ie[t]){if(!Ie[t]&&jt(t)){if(Me.tagNameCheck instanceof RegExp&&P(Me.tagNameCheck,t))return!1;if(Me.tagNameCheck instanceof Function&&Me.tagNameCheck(t))return!1}if(Ge&&!Ye[t]){var r=L(e)||e.parentNode,o=k(e)||e.childNodes;if(o&&r)for(var i=o.length-1;i>=0;--i)r.insertBefore(R(o[i],!0),T(e))}return mt(e),!0}return e instanceof f&&!vt(e)?(mt(e),!0):"noscript"!==t&&"noembed"!==t||!P(/<\/no(script|embed)/i,e.innerHTML)?(De&&3===e.nodeType&&(content=e.textContent,content=_(content,we," "),content=_(content,Oe," "),e.textContent!==content&&(x(n.removed,{element:e.cloneNode()}),e.textContent=content)),Rt("afterSanitizeElements",e,null),!1):(mt(e),!0)},kt=function(e,t,n){if(Ue&&("id"===t||"name"===t)&&(n in l||n in ct))return!1;if(He&&!_e[t]&&P(Ce,t));else if(Ne&&P(Se,t));else if(!Ae[t]||_e[t]){if(!(jt(e)&&(Me.tagNameCheck instanceof RegExp&&P(Me.tagNameCheck,e)||Me.tagNameCheck instanceof Function&&Me.tagNameCheck(e))&&(Me.attributeNameCheck instanceof RegExp&&P(Me.attributeNameCheck,t)||Me.attributeNameCheck instanceof Function&&Me.attributeNameCheck(t))||"is"===t&&Me.allowCustomizedBuiltInElements&&(Me.tagNameCheck instanceof RegExp&&P(Me.tagNameCheck,n)||Me.tagNameCheck instanceof Function&&Me.tagNameCheck(n))))return!1}else if(Je[t]);else if(P(Te,_(n,Re,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==N(n,"data:")||!$e[e])if(Pe&&!P(Ee,_(n,Re,"")));else if(n)return!1;return!0},jt=function(e){return e.indexOf("-")>0},At=function(t){var r,o,l,c;Rt("beforeSanitizeAttributes",t,null);var h=t.attributes;if(h){var d={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Ae};for(c=h.length;c--;){var f=r=h[c],y=f.name,v=f.namespaceURI;if(o="value"===y?r.value:H(r.value),l=me(y),d.attrName=l,d.attrValue=o,d.keepAttr=!0,d.forceKeepAttr=void 0,Rt("uponSanitizeAttribute",t,d),o=d.attrValue,!d.forceKeepAttr&&(wt(y,t),d.keepAttr))if(P(/\/>/i,o))wt(y,t);else{De&&(o=_(o,we," "),o=_(o,Oe," "));var m=me(t.nodeName);if(kt(m,l,o)){if(B&&"object"===e(S)&&"function"==typeof S.getAttributeType)if(v);else switch(S.getAttributeType(m,l)){case"TrustedHTML":o=B.createHTML(o);break;case"TrustedScriptURL":o=B.createScriptURL(o)}try{v?t.setAttributeNS(v,y,o):t.setAttribute(y,o),A(n.removed)}catch(e){}}}}Rt("afterSanitizeAttributes",t,null)}},xt=function e(t){var n,r=Ct(t);for(Rt("beforeSanitizeShadowDOM",t,null);n=r.nextNode();)Rt("uponSanitizeShadowNode",n,null),Tt(n)||(n.content instanceof c&&e(n.content),At(n));Rt("afterSanitizeShadowDOM",t,null)};return n.sanitize=function(o,l){var body,h,f,y,v;if((it=!o)&&(o="\x3c!--\x3e"),"string"!=typeof o&&!Et(o)){if("function"!=typeof o.toString)throw D("toString is not a function");if("string"!=typeof(o=o.toString()))throw D("dirty is not a string, aborting")}if(!n.isSupported){if("object"===e(t.toStaticHTML)||"function"==typeof t.toStaticHTML){if("string"==typeof o)return t.toStaticHTML(o);if(Et(o))return t.toStaticHTML(o.outerHTML)}return o}if(Be||ht(l),n.removed=[],"string"==typeof o&&(Xe=!1),Xe){if(o.nodeName){var m=me(o.nodeName);if(!ke[m]||Ie[m])throw D("root node is forbidden and cannot be sanitized in-place")}}else if(o instanceof d)1===(h=(body=Ot("\x3c!----\x3e")).ownerDocument.importNode(o,!0)).nodeType&&"BODY"===h.nodeName||"HTML"===h.nodeName?body=h:body.appendChild(h);else{if(!Fe&&!De&&!Le&&-1===o.indexOf("<"))return B&&ze?B.createHTML(o):o;if(!(body=Ot(o)))return Fe?null:ze?ce:""}body&&Ve&&mt(body.firstChild);for(var w=Ct(Xe?o:body);f=w.nextNode();)3===f.nodeType&&f===y||Tt(f)||(f.content instanceof c&&xt(f.content),At(f),y=f);if(y=null,Xe)return o;if(Fe){if(We)for(v=fe.call(body.ownerDocument);body.firstChild;)v.appendChild(body.firstChild);else v=body;return Ae.shadowroot&&(v=be.call(r,v,!0)),v}var O=Le?body.outerHTML:body.innerHTML;return Le&&ke["!doctype"]&&body.ownerDocument&&body.ownerDocument.doctype&&body.ownerDocument.doctype.name&&P(ie,body.ownerDocument.doctype.name)&&(O="<!DOCTYPE "+body.ownerDocument.doctype.name+">\n"+O),De&&(O=_(O,we," "),O=_(O,Oe," ")),B&&ze?B.createHTML(O):O},n.setConfig=function(e){ht(e),Be=!0},n.clearConfig=function(){st=null,Be=!1},n.isValidAttribute=function(e,t,n){st||ht({});var r=me(e),o=me(t);return kt(r,o,n)},n.addHook=function(e,t){"function"==typeof t&&(ge[e]=ge[e]||[],x(ge[e],t))},n.removeHook=function(e){if(ge[e])return A(ge[e])},n.removeHooks=function(e){ge[e]&&(ge[e]=[])},n.removeAllHooks=function(){ge={}},n}return se()}()},810:function(e,t,n){var r=n(38);e.exports=function(e){return void 0!==e&&(r(e,"value")||r(e,"writable"))}},811:function(e,t,n){n(812),n(813)},812:function(e,t,n){var r=n(6),o=n(26),l=n(296).clear;r({global:!0,bind:!0,enumerable:!0,forced:o.clearImmediate!==l},{clearImmediate:l})},813:function(e,t,n){var r=n(6),o=n(26),l=n(296).set;r({global:!0,bind:!0,enumerable:!0,forced:o.setImmediate!==l},{setImmediate:l})},814:function(e,t,n){"use strict";n(7),n(46),n(4),n(53),n(212),n(32),n(35);var r=n(617),o=n(601);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}t.a=function(){return{activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(col){var e,t,n;for(e=0,t=this.countRows();e<t;e++)if(n=this.getDataAtCell(e,col),!1===Object(r.c)(n))return!1;return!0},isEmptyRow:function(e){var col,t,n,meta;for(col=0,t=this.countCols();col<t;col++)if(n=this.getDataAtCell(e,col),!1===Object(r.c)(n))return"object"===l(n)&&(meta=this.getCellMeta(e,col),Object(o.m)(this.getSchema()[meta.prop],n));return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}}},815:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return l}));n(9),n(4);var r=n(607);function o(e,t){return Object(r.c)(e,(function(e){return e-t.filter((function(t){return t<e})).length}))}function l(e,t){var n=t[0],o=t.length;return Object(r.c)(e,(function(e){return e>=n?e+o:e}))}},816:function(e,t,n){"use strict";n(33),n(52),n(622),n(212),n(4),n(32),n(626),n(35);var r=n(747);function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,y(e,t,"get"))}function f(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,y(e,t,"set"),n),n}function y(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var v=new WeakMap,m=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,l=arguments.length>3&&void 0!==arguments[3]&&arguments[3];o(this,e),h(this,"highlight",null),h(this,"from",null),h(this,"to",null),c(this,v,{writable:!0,value:!1}),this.highlight=t.clone().normalize(),this.from=n.clone(),this.to=r.clone(),f(this,v,l)}var t,n,y;return t=e,(n=[{key:"setHighlight",value:function(e){return this.highlight=e.clone().normalize(),this}},{key:"setFrom",value:function(e){return this.from=e.clone(),this}},{key:"setTo",value:function(e){return this.to=e.clone(),this}},{key:"isValid",value:function(e){return this.from.isValid(e)&&this.to.isValid(e)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){var e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}},{key:"getWidth",value:function(){var e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(e){var t=e.row,col=e.col,n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return n.row<=t&&r.row>=t&&n.col<=col&&r.col>=col}},{key:"includesRange",value:function(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}},{key:"isEqual",value:function(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}},{key:"overlaps",value:function(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}},{key:"isNorthWestOf",value:function(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}},{key:"isOverlappingHorizontally",value:function(e){return this.getOuterTopRightCorner().col>=e.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=e.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=e.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=e.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(e){return this.getOuterBottomRightCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=e.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=e.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=e.getOuterTopRightCorner().row}},{key:"expand",value:function(e){var t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return(e.row<t.row||e.col<t.col||e.row>n.row||e.col>n.col)&&(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0)}},{key:"expandByRange",value:function(e){if(this.includesRange(e)||!this.overlaps(e))return!1;var t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=this.getDirection(),o=e.getOuterTopStartCorner(),l=e.getOuterBottomEndCorner(),c=Math.min(t.row,o.row),h=Math.min(t.col,o.col),d=Math.max(n.row,l.row),f=Math.max(n.col,l.col),y=this._createCellCoords(c,h),v=this._createCellCoords(d,f);return this.from=y,this.to=v,this.setDirection(r),this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}},{key:"setDirection",value:function(e){switch(e){case"NW-SE":var t=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=t[0],this.to=t[1];break;case"NE-SW":var n=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=n[0],this.to=n[1];break;case"SE-NW":var r=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=r[0],this.to=r[1];break;case"SW-NE":var o=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=o[0],this.to=o[1]}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}},{key:"flipDirectionHorizontally",value:function(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return d(this,v)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return d(this,v)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return d(this,v)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return d(this,v)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return d(this,v)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return d(this,v)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return d(this,v)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return d(this,v)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(e,t){return!!(t&&t.includes(e)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(t.from.row,t.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(t.from.row,t.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(t.to.row,t.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(t.to.row,t.to.col))))||e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(e,t){if(!(e instanceof r.a))return!1;if(t){var n=t.from,o=t.to;if(t.includes(e)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(n.row,n.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(n.row,o.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(o.row,n.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterTopStartCorner()}}return e.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():e.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():e.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():e.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0}},{key:"getBordersSharedWith",value:function(e){if(!this.includesRange(e))return[];var t=Math.min(this.from.row,this.to.row),n=Math.max(this.from.row,this.to.row),r=Math.min(this.from.col,this.to.col),o=Math.max(this.from.col,this.to.col),l=Math.min(e.from.row,e.to.row),c=Math.max(e.from.row,e.to.row),h=Math.min(e.from.col,e.to.col),d=Math.max(e.from.col,e.to.col),f=[];return t===l&&f.push("top"),o===d&&f.push("right"),n===c&&f.push("bottom"),r===h&&f.push("left"),f}},{key:"getInner",value:function(){for(var e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),n=[],r=e.row;r<=t.row;r++)for(var o=e.col;o<=t.col;o++)this.from.row===r&&this.from.col===o||this.to.row===r&&this.to.col===o||n.push(this._createCellCoords(r,o));return n}},{key:"getAll",value:function(){for(var e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),n=[],r=e.row;r<=t.row;r++)for(var o=e.col;o<=t.col;o++)e.row===r&&e.col===o?n.push(e):t.row===r&&t.col===o?n.push(t):n.push(this._createCellCoords(r,o));return n}},{key:"forAll",value:function(e){for(var t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=t.row;r<=n.row;r++)for(var o=t.col;o<=n.col;o++)if(!1===e(r,o))return}},{key:"clone",value:function(){return new e(this.highlight,this.from,this.to,d(this,v))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(e,t){return new r.a(e,t,d(this,v))}}])&&l(t.prototype,n),y&&l(t,y),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.a=m},817:function(e,t,n){var r=n(6),o=n(818);r({target:"Array",proto:!0,forced:o!==[].lastIndexOf},{lastIndexOf:o})},818:function(e,t,n){"use strict";var r=n(124),o=n(76),l=n(103),c=n(75),h=n(220),d=Math.min,f=[].lastIndexOf,y=!!f&&1/[1].lastIndexOf(1,-0)<0,v=h("lastIndexOf"),m=y||!v;e.exports=m?function(e){if(y)return r(f,this,arguments)||0;var t=o(this),n=c(t),h=n-1;for(arguments.length>1&&(h=d(h,l(arguments[1]))),h<0&&(h=n+h);h>=0;h--)if(h in t&&t[h]===e)return h||0;return-1}:f},819:function(e,t,n){"use strict";var r=n(6),o=n(820).left,l=n(220),c=n(147),h=n(225);r({target:"Array",proto:!0,forced:!l("reduce")||!h&&c>79&&c<83},{reduce:function(e){var t=arguments.length;return o(this,e,t,t>1?arguments[1]:void 0)}})},820:function(e,t,n){var r=n(54),o=n(71),l=n(182),c=n(75),h=TypeError,d=function(e){return function(t,n,d,f){r(n);var y=o(t),v=l(y),m=c(y),w=e?m-1:0,i=e?-1:1;if(d<2)for(;;){if(w in v){f=v[w],w+=i;break}if(w+=i,e?w<0:m<=w)throw h("Reduce of empty array with no initial value")}for(;e?w>=0:m>w;w+=i)w in v&&(f=n(f,v[w],w,y));return f}};e.exports={left:d(!1),right:d(!0)}},821:function(e,t,n){var r=n(14)(!1);r.push([e.i,'@charset "UTF-8";\n/*!\n * Copyright (c) HANDSONCODE sp. z o. o.\n * \n * HANDSONTABLE is a software distributed by HANDSONCODE sp. z o. o., a Polish corporation based in\n * Gdynia, Poland, at Aleja Zwyciestwa 96-98, registered by the District Court in Gdansk under number\n * 538651, EU tax ID number: PL5862294002, share capital: PLN 62,800.00.\n * \n * This software is protected by applicable copyright laws, including international treaties, and dual-\n * licensed  depending on whether your use for commercial purposes, meaning intended for or\n * resulting in commercial advantage or monetary compensation, or not.\n * \n * If your use is strictly personal or solely for evaluation purposes, meaning for the purposes of testing\n * the suitability, performance, and usefulness of this software outside the production environment,\n * you agree to be bound by the terms included in the "handsontable-non-commercial-license.pdf" file.\n * \n * Your use of this software for commercial purposes is subject to the terms included in an applicable\n * license agreement.\n * \n * In any case, you must not make any such use of this software as to develop software which may be\n * considered competitive with this software.\n * \n * UNLESS EXPRESSLY AGREED OTHERWISE, HANDSONCODE PROVIDES THIS SOFTWARE ON AN "AS IS"\n * BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, AND IN NO EVENT AND UNDER NO\n * LEGAL THEORY, SHALL HANDSONCODE BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY DIRECT,\n * INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES OF ANY CHARACTER ARISING FROM\n * USE OR INABILITY TO USE THIS SOFTWARE.\n * \n * Version: 12.1.2\n * Release date: 08/07/2022 (built at 08/07/2022 09:25:40)\n */.handsontable .table td,.handsontable .table th{border-top:none}.handsontable tr{background:#fff}.handsontable td{background-color:inherit}.handsontable .table caption+thead tr:first-child td,.handsontable .table caption+thead tr:first-child th,.handsontable .table colgroup+thead tr:first-child td,.handsontable .table colgroup+thead tr:first-child th,.handsontable .table thead:first-child tr:first-child td,.handsontable .table thead:first-child tr:first-child th{border-top:1px solid #ccc}.handsontable .table-bordered{border:0;border-collapse:separate}.handsontable .table-bordered td,.handsontable .table-bordered th{border-left:none}.handsontable .table-bordered td:first-child,.handsontable .table-bordered th:first-child{border-left:1px solid #ccc}.handsontable .table>tbody>tr>td,.handsontable .table>tbody>tr>th,.handsontable .table>tfoot>tr>td,.handsontable .table>tfoot>tr>th,.handsontable .table>thead>tr>td,.handsontable .table>thead>tr>th{line-height:21px;padding:0}.col-lg-1.handsontable,.col-lg-2.handsontable,.col-lg-3.handsontable,.col-lg-4.handsontable,.col-lg-5.handsontable,.col-lg-6.handsontable,.col-lg-7.handsontable,.col-lg-8.handsontable,.col-lg-9.handsontable,.col-lg-10.handsontable,.col-lg-11.handsontable,.col-lg-12.handsontable,.col-md-1.handsontable,.col-md-2.handsontable,.col-md-3.handsontable,.col-md-4.handsontable,.col-md-5.handsontable,.col-md-6.handsontable,.col-md-7.handsontable,.col-md-8.handsontable,.col-md-9.handsontable .col-sm-1.handsontable,.col-md-10.handsontable,.col-md-11.handsontable,.col-md-12.handsontable,.col-sm-2.handsontable,.col-sm-3.handsontable,.col-sm-4.handsontable,.col-sm-5.handsontable,.col-sm-6.handsontable,.col-sm-7.handsontable,.col-sm-8.handsontable,.col-sm-9.handsontable .col-xs-1.handsontable,.col-sm-10.handsontable,.col-sm-11.handsontable,.col-sm-12.handsontable,.col-xs-2.handsontable,.col-xs-3.handsontable,.col-xs-4.handsontable,.col-xs-5.handsontable,.col-xs-6.handsontable,.col-xs-7.handsontable,.col-xs-8.handsontable,.col-xs-9.handsontable,.col-xs-10.handsontable,.col-xs-11.handsontable,.col-xs-12.handsontable{padding-left:0;padding-right:0}.handsontable .table-striped>tbody>tr:nth-of-type(2n){background-color:#fff}.handsontable{position:relative}.handsontable .hide{display:none}.handsontable .relative{position:relative}.handsontable .wtHider{width:0}.handsontable .wtSpreader{position:relative;width:0;height:auto}.handsontable div,.handsontable input,.handsontable table,.handsontable tbody,.handsontable td,.handsontable textarea,.handsontable th,.handsontable thead{box-sizing:content-box;-webkit-box-sizing:content-box;-moz-box-sizing:content-box}.handsontable input,.handsontable textarea{min-height:0}.handsontable table.htCore{border-collapse:separate;border-spacing:0;margin:0;border-width:0;table-layout:fixed;width:0;outline-width:0;cursor:default;max-width:none;max-height:none}.handsontable col,.handsontable col.rowHeader{width:50px}.handsontable td,.handsontable th{border-top-width:0;border-left-width:0;border-right:1px solid #ccc;border-bottom:1px solid #ccc;height:22px;empty-cells:show;line-height:21px;padding:0 4px;background-color:#fff;vertical-align:top;overflow:hidden;outline-width:0;white-space:pre-wrap}[dir=rtl].handsontable td,[dir=rtl].handsontable th{border-right-width:0;border-left:1px solid #ccc}.handsontable th:last-child{border-left:none;border-right:1px solid #ccc;border-bottom:1px solid #ccc}[dir=rtl].handsontable th:last-child{border-right:none;border-left:1px solid #ccc}.handsontable td:first-of-type,.handsontable th:first-child,.handsontable th:nth-child(2){border-left:1px solid #ccc}[dir=rtl].handsontable td:first-of-type,[dir=rtl].handsontable th:first-child,[dir=rtl].handsontable th:nth-child(2){border-right:1px solid #ccc}.handsontable .ht_clone_top th:nth-child(2){border-left-width:0;border-right:1px solid #ccc}[dir=rtl].handsontable .ht_clone_top th:nth-child(2){border-right-width:0;border-left:1px solid #ccc}.handsontable.htRowHeaders thead tr th:nth-child(2){border-left:1px solid #ccc}[dir=rtl].handsontable.htRowHeaders thead tr th:nth-child(2){border-right:1px solid #ccc}.handsontable tr:first-child td,.handsontable tr:first-child th{border-top:1px solid #ccc}.ht_master:not(.innerBorderInlineStart):not(.emptyColumns)~.handsontable:not(.ht_clone_top) thead tr th:first-child,.ht_master:not(.innerBorderInlineStart):not(.emptyColumns)~.handsontable tbody tr th{border-right-width:0;border-left:1px solid #ccc}[dir=rtl].ht_master:not(.innerBorderInlineStart):not(.emptyColumns)~.handsontable:not(.ht_clone_top) thead tr th:first-child,[dir=rtl].ht_master:not(.innerBorderInlineStart):not(.emptyColumns)~.handsontable tbody tr th{border-left-width:0;border-right:1px solid #ccc}.ht_master:not(.innerBorderTop):not(.innerBorderBottom) thead tr.lastChild th,.ht_master:not(.innerBorderTop):not(.innerBorderBottom) thead tr:last-child th,.ht_master:not(.innerBorderTop):not(.innerBorderBottom)~.handsontable thead tr.lastChild th,.ht_master:not(.innerBorderTop):not(.innerBorderBottom)~.handsontable thead tr:last-child th{border-bottom-width:0}.handsontable th{background-color:#f0f0f0;color:#222;text-align:center;font-weight:400;white-space:nowrap}.handsontable thead th{padding:0}.handsontable th.active{background-color:#ccc}.handsontable thead th .relative{padding:2px 4px}.handsontable span.colHeader{display:inline-block;line-height:1.1}.handsontable .wtBorder{position:absolute;font-size:0}.handsontable .wtBorder.hidden{display:none!important}.handsontable .wtBorder.current{z-index:10}.handsontable .wtBorder.area{z-index:8}.handsontable .wtBorder.fill{z-index:6}.handsontable .wtBorder.corner{font-size:0;cursor:crosshair}.ht_clone_master{z-index:100}.ht_clone_inline_start{z-index:120}.ht_clone_bottom{z-index:130}.ht_clone_bottom_inline_start_corner{z-index:150}.ht_clone_top{z-index:160}.ht_clone_top_inline_start_corner{z-index:180}.handsontable col.hidden{width:0!important}.handsontable tr.hidden,.handsontable tr.hidden td,.handsontable tr.hidden th{display:none}.ht_clone_bottom,.ht_clone_inline_start,.ht_clone_top,.ht_master{overflow:hidden}.ht_master .wtHolder{overflow:auto}.handsontable .ht_clone_inline_start thead,.handsontable .ht_master thead,.handsontable .ht_master tr th{visibility:hidden}.ht_clone_bottom .wtHolder,.ht_clone_inline_start .wtHolder,.ht_clone_top .wtHolder{overflow:hidden}.handsontable{touch-action:manipulation;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Helvetica Neue",Arial,sans-serif;font-size:13px;font-weight:400;color:#373737}.handsontable a{color:#104acc}.handsontable.htAutoSize{visibility:hidden;left:-99000px;position:absolute;top:-99000px}.handsontable td.htInvalid{background-color:#ff4c42!important}.handsontable td.htNoWrap{white-space:nowrap}#hot-display-license-info{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Helvetica Neue",Arial,sans-serif;font-size:10px;font-weight:400;color:#373737;padding:5px 0 3px;text-align:left}#hot-display-license-info a{color:#104acc;font-size:10px}.handsontable .manualColumnResizer{position:absolute;top:0;cursor:col-resize;z-index:210;width:5px;height:25px}.handsontable .manualRowResizer{position:absolute;left:0;cursor:row-resize;z-index:210;height:5px;width:50px}.handsontable .manualColumnResizer.active,.handsontable .manualColumnResizer:hover,.handsontable .manualRowResizer.active,.handsontable .manualRowResizer:hover{background-color:#34a9db}.handsontable .manualColumnResizerGuide{position:absolute;right:unset;top:0;background-color:#34a9db;display:none;width:0;border-right:1px dashed #777;border-left:none;margin-left:5px;margin-right:unset}[dir=rtl].handsontable .manualColumnResizerGuide{left:unset;border-left:1px dashed #777;border-right:none;margin-right:5px;margin-left:unset}.handsontable .manualRowResizerGuide{position:absolute;left:0;bottom:0;background-color:#34a9db;display:none;height:0;border-bottom:1px dashed #777;margin-top:5px}.handsontable .manualColumnResizerGuide.active,.handsontable .manualRowResizerGuide.active{display:block;z-index:209}.handsontable .columnSorting{position:relative}.handsontable .columnSorting.sortAction:hover{text-decoration:underline;cursor:pointer}.handsontable span.colHeader.columnSorting:before{top:50%;margin-top:-6px;padding-left:8px;padding-right:0;position:absolute;right:-9px;left:unset;content:"";height:10px;width:5px;background-size:contain;background-repeat:no-repeat;background-position-x:right}[dir=rtl].handsontable span.colHeader.columnSorting:before{padding-right:8px;padding-left:0;left:-9px;right:unset;background-position-x:left}.handsontable span.colHeader.columnSorting.ascending:before{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAoCAMAAADJ7yrpAAAAKlBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKE86IAAAADXRSTlMABBEmRGprlJW72e77tTkTKwAAAFNJREFUeAHtzjkSgCAUBNHPgsoy97+ulGXRqJE5L+xkxoYt2UdsLb5bqFINz+aLuuLn5rIu2RkO3fZpWENimNgiw6iBYRTPMLJjGFxQZ1hxxb/xBI1qC8k39CdKAAAAAElFTkSuQmCC")}.handsontable span.colHeader.columnSorting.descending:before{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAoCAMAAADJ7yrpAAAAKlBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKE86IAAAADXRSTlMABBEmRGprlJW72e77tTkTKwAAAFJJREFUeAHtzjkSgCAQRNFmQYUZ7n9dKUvru0TmvPAn3br0QfgdZ5xx6x+rQn23GqTYnq1FDcnuzZIO2WmedVqIRVxgGKEyjNgYRjKGkZ1hFIZ3I70LyM0VtU8AAAAASUVORK5CYII=")}.htGhostTable .htCore span.colHeader.columnSorting:not(.indicatorDisabled):after{content:"*";display:inline-block;position:relative;padding-right:20px}.handsontable td.area,.handsontable td.area-1,.handsontable td.area-2,.handsontable td.area-3,.handsontable td.area-4,.handsontable td.area-5,.handsontable td.area-6,.handsontable td.area-7{position:relative}.handsontable td.area-1:before,.handsontable td.area-2:before,.handsontable td.area-3:before,.handsontable td.area-4:before,.handsontable td.area-5:before,.handsontable td.area-6:before,.handsontable td.area-7:before,.handsontable td.area:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;bottom:-100%\\9;background:#005eff}@media (-ms-high-contrast:none),screen and (-ms-high-contrast:active){.handsontable td.area-1:before,.handsontable td.area-2:before,.handsontable td.area-3:before,.handsontable td.area-4:before,.handsontable td.area-5:before,.handsontable td.area-6:before,.handsontable td.area-7:before,.handsontable td.area:before{bottom:-100%}}.handsontable td.area:before{opacity:.1}.handsontable td.area-1:before{opacity:.2}.handsontable td.area-2:before{opacity:.27}.handsontable td.area-3:before{opacity:.35}.handsontable td.area-4:before{opacity:.41}.handsontable td.area-5:before{opacity:.47}.handsontable td.area-6:before{opacity:.54}.handsontable td.area-7:before{opacity:.58}.handsontable tbody th.ht__highlight,.handsontable thead th.ht__highlight{background-color:#dcdcdc}.handsontable tbody th.ht__active_highlight,.handsontable thead th.ht__active_highlight{background-color:#8eb0e7;color:#000}.handsontableInput{border:none;outline-width:0;margin:0;padding:1px 5px 0;font-family:inherit;line-height:21px;font-size:inherit;box-shadow:inset 0 0 0 2px #5292f7;resize:none;display:block;color:#000;border-radius:0;background-color:#fff}.handsontableInput:focus{outline:none}.handsontableInputHolder{position:absolute;top:0;left:0}.htSelectEditor{-webkit-appearance:menulist-button!important;position:absolute;width:auto}.htSelectEditor:focus{outline:none}.handsontable .htDimmed{color:#777}.handsontable .htSubmenu{position:relative}.handsontable .htSubmenu :after{content:"";color:#777;position:absolute;right:5px;font-size:9px}[dir=rtl].handsontable .htSubmenu :after{content:""}[dir=rtl].handsontable .htSubmenu :before{content:"";color:#777;position:absolute;left:5px;font-size:9px}.handsontable .htLeft{text-align:left}.handsontable .htCenter{text-align:center}.handsontable .htRight{text-align:right}.handsontable .htJustify{text-align:justify}.handsontable .htTop{vertical-align:top}.handsontable .htMiddle{vertical-align:middle}.handsontable .htBottom{vertical-align:bottom}.handsontable .htPlaceholder{color:#999}.handsontable.listbox{margin:0}.handsontable.listbox .ht_master table{border:1px solid #ccc;border-collapse:separate;background:#fff}.handsontable.listbox td,.handsontable.listbox th,.handsontable.listbox tr:first-child td,.handsontable.listbox tr:first-child th,.handsontable.listbox tr:last-child th{border-color:transparent!important}.handsontable.listbox td,.handsontable.listbox th{white-space:nowrap;text-overflow:ellipsis}.handsontable.listbox td.htDimmed{cursor:default;color:inherit;font-style:inherit}.handsontable.listbox .wtBorder{visibility:hidden}.handsontable.listbox tr:hover td,.handsontable.listbox tr td.current{background:#eee}.ht_editor_hidden{z-index:-1}.ht_editor_visible{z-index:200}.handsontable td.htSearchResult{background:#fcedd9;color:#583707}.handsontable .collapsibleIndicator{position:absolute;top:50%;transform:translateY(-50%);left:unset;right:5px;border:1px solid #a6a6a6;line-height:8px;color:#222;border-radius:10px;font-size:10px;width:10px;height:10px;cursor:pointer;box-shadow:0 0 0 6px #eee;background:#eee;text-align:center}[dir=rtl].handsontable .collapsibleIndicator{right:unset;left:5px}.handsontable.mobile,.handsontable.mobile .wtHolder{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-overflow-scrolling:touch}.handsontable.mobile .handsontableInput:focus{box-shadow:inset 0 0 0 2px #5292f7;-webkit-appearance:none}.topSelectionHandle-HitArea:not(.ht_master .topSelectionHandle-HitArea),.topSelectionHandle:not(.ht_master .topSelectionHandle){z-index:9999}.handsontable .bottomSelectionHandle,.handsontable .bottomSelectionHandle-HitArea,.handsontable .topSelectionHandle,.handsontable .topSelectionHandle-HitArea{left:-10000px;right:unset;top:-10000px}[dir=rtl].handsontable .bottomSelectionHandle,[dir=rtl].handsontable .bottomSelectionHandle-HitArea,[dir=rtl].handsontable .topSelectionHandle,[dir=rtl].handsontable .topSelectionHandle-HitArea{right:-10000px;left:unset}.handsontable.hide-tween{-webkit-animation:opacity-hide .3s;animation:opacity-hide .3s;animation-fill-mode:forwards;-webkit-animation-fill-mode:forwards}.handsontable.show-tween{-webkit-animation:opacity-show .3s;animation:opacity-show .3s;animation-fill-mode:forwards;-webkit-animation-fill-mode:forwards}\n/*!\n * Pikaday\n * Copyright  2014 David Bushell | BSD & MIT license | https://dbushell.com/\n */.pika-single{z-index:9999;display:block;position:relative;color:#333;background:#fff;border:1px solid;border-color:#ccc #ccc #bbb;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif}.pika-single:after,.pika-single:before{content:" ";display:table}.pika-single:after{clear:both}.pika-single.is-hidden{display:none}.pika-single.is-bound{position:absolute;box-shadow:0 5px 15px -5px rgba(0,0,0,.5)}.pika-lendar{float:left;width:240px;margin:8px}.pika-title{position:relative;text-align:center}.pika-label{display:inline-block;position:relative;z-index:9999;overflow:hidden;margin:0;padding:5px 3px;font-size:14px;line-height:20px;font-weight:700;background-color:#fff}.pika-title select{cursor:pointer;position:absolute;z-index:9998;margin:0;left:0;top:5px;opacity:0}.pika-next,.pika-prev{display:block;cursor:pointer;position:relative;outline:none;border:0;padding:0;width:20px;height:30px;text-indent:20px;white-space:nowrap;overflow:hidden;background-color:transparent;background-position:50%;background-repeat:no-repeat;background-size:75% 75%;opacity:.5}.pika-next:hover,.pika-prev:hover{opacity:1}.is-rtl .pika-next,.pika-prev{float:left;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAAUklEQVR42u3VMQoAIBADQf8Pgj+OD9hG2CtONJB2ymQkKe0HbwAP0xucDiQWARITIDEBEnMgMQ8S8+AqBIl6kKgHiXqQqAeJepBo/z38J/U0uAHlaBkBl9I4GwAAAABJRU5ErkJggg==")}.is-rtl .pika-prev,.pika-next{float:right;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAAU0lEQVR42u3VOwoAMAgE0dwfAnNjU26bYkBCFGwfiL9VVWoO+BJ4Gf3gtsEKKoFBNTCoCAYVwaAiGNQGMUHMkjGbgjk2mIONuXo0nC8XnCf1JXgArVIZAQh5TKYAAAAASUVORK5CYII=")}.pika-next.is-disabled,.pika-prev.is-disabled{cursor:default;opacity:.2}.pika-select{display:inline-block}.pika-table{width:100%;border-collapse:collapse;border-spacing:0;border:0}.pika-table td,.pika-table th{width:14.2857142857%;padding:0}.pika-table th{color:#999;font-size:12px;line-height:25px;font-weight:700;text-align:center}.pika-button{cursor:pointer;display:block;box-sizing:border-box;-moz-box-sizing:border-box;outline:none;border:0;margin:0;width:100%;padding:5px;color:#666;font-size:12px;line-height:15px;text-align:right;background:#f5f5f5;height:auto}.pika-week{font-size:11px;color:#999}.is-today .pika-button{color:#3af;font-weight:700}.has-event .pika-button,.is-selected .pika-button{color:#fff;font-weight:700;background:#3af;box-shadow:inset 0 1px 3px #178fe5;border-radius:3px}.has-event .pika-button{background:#005da9;box-shadow:inset 0 1px 3px #0076c9}.is-disabled .pika-button,.is-inrange .pika-button{background:#d5e9f7}.is-startrange .pika-button{color:#fff;background:#6cb31d;box-shadow:none;border-radius:3px}.is-endrange .pika-button{color:#fff;background:#3af;box-shadow:none;border-radius:3px}.is-disabled .pika-button{pointer-events:none;cursor:default;color:#999;opacity:.3}.is-outside-current-month .pika-button{color:#999;opacity:.3}.is-selection-disabled{pointer-events:none;cursor:default}.pika-button:hover,.pika-row.pick-whole-week:hover .pika-button{color:#fff;background:#ff8000;box-shadow:none;border-radius:3px}.pika-table abbr{border-bottom:none;cursor:help}.handsontable .htAutocompleteArrow{float:right;font-size:10px;color:#eee;cursor:default;width:16px;text-align:center}[dir=rtl].handsontable .htAutocompleteArrow{float:left}.handsontable td .htAutocompleteArrow:hover{color:#777}.handsontable td.area .htAutocompleteArrow{color:#d3d3d3}.handsontable .htCheckboxRendererInput{display:inline-block}.handsontable .htCheckboxRendererInput.noValue{opacity:.5}.handsontable .htCheckboxRendererLabel{font-size:inherit;vertical-align:middle;cursor:pointer;display:inline-block}.handsontable .htCheckboxRendererLabel.fullWidth{width:100%}.handsontable .htCommentCell{position:relative}.handsontable .htCommentCell:after{content:"";position:absolute;top:0;right:0;left:unset;border-left:6px solid transparent;border-right:none;border-top:6px solid #000}[dir=rtl].handsontable .htCommentCell:after{left:0;right:unset;border-right:6px solid transparent;border-left:none}.htCommentsContainer .htComments{display:none;z-index:1059;position:absolute}.htCommentsContainer .htCommentTextArea{box-shadow:0 1px 3px rgba(0,0,0,.117647),0 1px 2px rgba(0,0,0,.239216);box-sizing:border-box;border:none;border-left:3px solid #ccc;background-color:#fff;width:215px;height:90px;font-size:12px;padding:5px;outline:0!important;-webkit-appearance:none}[dir=rtl].htCommentsContainer .htCommentTextArea{border-right:3px solid #ccc;border-left:none}.htCommentsContainer .htCommentTextArea:focus{box-shadow:0 1px 3px rgba(0,0,0,.117647),0 1px 2px rgba(0,0,0,.239216),inset 0 0 0 1px #5292f7;border-left:3px solid #5292f7;border-right:none}[dir=rtl].htCommentsContainer .htCommentTextArea:focus{border-right:3px solid #5292f7;border-left:none}\n/*!\n * Handsontable ContextMenu\n */.htContextMenu:not(.htGhostTable){display:none;position:absolute;z-index:1060}.htContextMenu .ht_clone_bottom,.htContextMenu .ht_clone_bottom_inline_start_corner,.htContextMenu .ht_clone_inline_start,.htContextMenu .ht_clone_top,.htContextMenu .ht_clone_top_inline_start_corner{display:none}.htContextMenu .ht_master table.htCore{border-color:#ccc;border-style:solid;border-width:1px 2px 2px 1px}[dir=rtl].htContextMenu .ht_master table.htCore{border-right-width:1px;border-left-width:2px}.htContextMenu .wtBorder{visibility:hidden}.htContextMenu table tbody tr td{background:#fff;border-width:0;padding:4px 6px 0;cursor:pointer;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.htContextMenu table tbody tr td:first-child{border-width:0}[dir=rtl].htContextMenu table tbody tr td:first-child{border-right-width:0;border-left-width:0}.htContextMenu table tbody tr td.htDimmed{font-style:normal;color:#323232}.htContextMenu table tbody tr td.current,.htContextMenu table tbody tr td.zeroclipboard-is-hover{background:#f3f3f3}.htContextMenu table tbody tr td.htSeparator{border-top:1px solid #e6e6e6;height:0;padding:0;cursor:default}.htContextMenu table tbody tr td.htDisabled{color:#999;cursor:default}.htContextMenu table tbody tr td.htDisabled:hover{background:#fff;color:#999;cursor:default}.htContextMenu table tbody tr.htHidden{display:none}.htContextMenu table tbody tr td .htItemWrapper{margin-left:10px;margin-right:6px}.htContextMenu table tbody tr td div span.selected{margin-top:-2px;position:absolute;left:4px}.htContextMenu .ht_master .wtHolder{overflow:hidden}textarea.HandsontableCopyPaste{position:fixed!important;top:0!important;right:100%!important;overflow:hidden;opacity:0;outline:0 none!important}\n/*!\n * Handsontable DropdownMenu\n */.handsontable .changeType{background:#eee;border-radius:2px;border:1px solid #bbb;color:#bbb;font-size:9px;line-height:9px;padding:2px;margin:3px 1px 0 5px;float:right}[dir=rtl].handsontable .changeType{float:left}.handsontable .changeType:before{content:" "}.handsontable .changeType:hover{border:1px solid #777;color:#777;cursor:pointer}.htDropdownMenu:not(.htGhostTable){display:none;position:absolute;z-index:1060}.htDropdownMenu .ht_clone_bottom,.htDropdownMenu .ht_clone_bottom_inline_start_corner,.htDropdownMenu .ht_clone_inline_start,.htDropdownMenu .ht_clone_top,.htDropdownMenu .ht_clone_top_inline_start_corner{display:none}.htDropdownMenu table.htCore{border-color:#ccc;border-style:solid;border-width:1px 2px 2px 1px}[dir=rtl].htDropdownMenu table.htCore{border-right-width:1px;border-left-width:2px}.htDropdownMenu .wtBorder{visibility:hidden}.htDropdownMenu table tbody tr td{background:#fff;border-width:0;padding:4px 6px 0;cursor:pointer;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.htDropdownMenu table tbody tr td:first-child{border-width:0}[dir=rtl].htDropdownMenu table tbody tr td:first-child{border-left-width:0;border-right-width:0}.htDropdownMenu table tbody tr td.htDimmed{font-style:normal;color:#323232}.htDropdownMenu table tbody tr td.current,.htDropdownMenu table tbody tr td.zeroclipboard-is-hover{background:#e9e9e9}.htDropdownMenu table tbody tr td.htSeparator{border-top:1px solid #e6e6e6;height:0;padding:0;cursor:default}.htDropdownMenu table tbody tr td.htDisabled{color:#999}.htDropdownMenu table tbody tr td.htDisabled:hover{background:#fff;color:#999;cursor:default}.htDropdownMenu:not(.htGhostTable) table tbody tr.htHidden{display:none}.htDropdownMenu table tbody tr td .htItemWrapper{margin-left:10px;margin-right:10px}.htDropdownMenu table tbody tr td div span.selected{margin-top:-2px;position:absolute;left:4px}.htDropdownMenu .ht_master .wtHolder{overflow:hidden}\n/*!\n * Handsontable Filters\n */.htFiltersConditionsMenu:not(.htGhostTable){display:none;position:absolute;z-index:1070}.htFiltersConditionsMenu .ht_clone_corner,.htFiltersConditionsMenu .ht_clone_inline_start,.htFiltersConditionsMenu .ht_clone_top{display:none}.htFiltersConditionsMenu table.htCore{border-color:#bbb;border-style:solid;border-width:1px 2px 2px 1px}.htFiltersConditionsMenu .wtBorder{visibility:hidden}.htFiltersConditionsMenu table tbody tr td{background:#fff;border-width:0;padding:4px 6px 0;cursor:pointer;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.htFiltersConditionsMenu table tbody tr td:first-child{border-width:0}[dir=rtl].htFiltersConditionsMenu table tbody tr td:first-child{border-left-width:0;border-right-width:0}.htFiltersConditionsMenu table tbody tr td.htDimmed{font-style:normal;color:#323232}.htFiltersConditionsMenu table tbody tr td.current,.htFiltersConditionsMenu table tbody tr td.zeroclipboard-is-hover{background:#e9e9e9}.htFiltersConditionsMenu table tbody tr td.htSeparator{border-top:1px solid #e6e6e6;height:0;padding:0}.htFiltersConditionsMenu table tbody tr td.htDisabled{color:#999}.htFiltersConditionsMenu table tbody tr td.htDisabled:hover{background:#fff;color:#999;cursor:default}.htFiltersConditionsMenu table tbody tr td .htItemWrapper{margin-left:10px;margin-right:10px}.htFiltersConditionsMenu table tbody tr td div span.selected{margin-top:-2px;position:absolute;left:4px}.htFiltersConditionsMenu .ht_master .wtHolder{overflow:hidden}.handsontable .htMenuFiltering{border-bottom:1px dotted #ccc;height:135px;overflow:hidden}.handsontable .ht_master table td.htCustomMenuRenderer{background-color:#fff;cursor:auto}.handsontable .htFiltersMenuLabel{font-size:.75em}.handsontable .htFiltersMenuActionBar{text-align:center;padding-top:10px;padding-bottom:3px}.handsontable .htFiltersMenuCondition.border{border-bottom:1px dotted #ccc!important}.handsontable .htFiltersMenuCondition .htUIInput{padding:0 0 5px}.handsontable .htFiltersMenuValue{border-bottom:1px dotted #ccc!important}.handsontable .htFiltersMenuValue .htUIMultipleSelectSearch{padding:0}.handsontable .htFiltersMenuCondition .htUIInput input,.handsontable .htFiltersMenuValue .htUIMultipleSelectSearch input{font-family:inherit;font-size:.75em;padding:4px;box-sizing:border-box;width:100%}.htUIMultipleSelect .ht_master .wtHolder{overflow-y:scroll}.handsontable .htFiltersActive .changeType{border:1px solid #509272;color:#18804e;background-color:#d2e0d9}.handsontable .htUISelectAll{margin-left:0;margin-right:10px}[dir=rtl].handsontable .htUISelectAll{margin-right:0;margin-left:10px}.handsontable .htUIClearAll,.handsontable .htUISelectAll{display:inline-block}.handsontable .htUIClearAll a,.handsontable .htUISelectAll a{font-size:.75em}.handsontable .htUISelectionControls{text-align:right}[dir=rtl].handsontable .htUISelectionControls{text-align:left}.handsontable .htCheckboxRendererInput{margin:0 5px 0 0;vertical-align:middle;height:1em}[dir=rtl].handsontable .htCheckboxRendererInput{margin-left:5px;margin-right:0}.handsontable .htUIInput{padding:3px 0 7px;position:relative;text-align:center}.handsontable .htUIInput input{border-radius:2px;border:1px solid #d2d1d1}.handsontable .htUIInput input:focus{outline:0}.handsontable .htUIInputIcon{position:absolute}.handsontable .htUIInput.htUIButton{cursor:pointer;display:inline-block}.handsontable .htUIInput.htUIButton input{background-color:#eee;color:#000;cursor:pointer;font-family:inherit;font-size:.75em;font-weight:700;height:19px;min-width:64px}.handsontable .htUIInput.htUIButton input:hover{border-color:#b9b9b9}.handsontable .htUIInput.htUIButtonOK{margin-left:0;margin-right:10px}[dir=rtl].handsontable .htUIInput.htUIButtonOK{margin-right:0;margin-left:10px}.handsontable .htUIInput.htUIButtonOK input{background-color:#0f9d58;border-color:#18804e;color:#fff}.handsontable .htUIInput.htUIButtonOK input:hover{border-color:#1a6f46}.handsontable .htUISelect{cursor:pointer;margin-bottom:7px;position:relative}.handsontable .htUISelectCaption{background-color:#e8e8e8;border-radius:2px;border:1px solid #d2d1d1;font-family:inherit;font-size:.75em;font-weight:700;padding:3px 20px 3px 10px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.handsontable .htUISelectCaption:hover{background-color:#e8e8e8;border:1px solid #b9b9b9}.handsontable .htUISelectDropdown:after{content:"";font-size:7px;position:absolute;right:10px;top:0}.handsontable .htUISelectDropdown:before{content:"";font-size:7px;position:absolute;right:10px;top:8px}.handsontable .htUIMultipleSelect .handsontable .htCore{border:none}.handsontable .htUIMultipleSelect .handsontable .htCore td:hover{background-color:#f5f5f5}.handsontable .htUIMultipleSelectSearch input{border-radius:2px;border:1px solid #d2d1d1;padding:3px}.handsontable .htUIRadio{display:inline-block;margin-left:0;margin-right:5px;height:100%}[dir=rtl].handsontable .htUIRadio{margin-right:0;margin-left:5px}.handsontable .htUIRadio:last-child{margin-right:0}.handsontable .htUIRadio>input[type=radio]{margin-left:0;margin-right:.5ex}[dir=rtl].handsontable .htUIRadio>input[type=radio]{margin-right:0;margin-left:.5ex}.handsontable .htUIRadio label{vertical-align:middle}.handsontable .htFiltersMenuOperators{padding-bottom:5px}.handsontable th.beforeHiddenColumn{position:relative}.handsontable th.afterHiddenColumn:before,.handsontable th.beforeHiddenColumn:after{color:#bbb;position:absolute;top:50%;font-size:5pt;transform:translateY(-50%)}.handsontable th.afterHiddenColumn{position:relative}.handsontable th.beforeHiddenColumn:after{right:1px;content:""}[dir=rtl].handsontable th.beforeHiddenColumn:after{right:auto;left:1px;content:""}.handsontable th.afterHiddenColumn:before{left:1px;content:""}[dir=rtl].handsontable th.afterHiddenColumn:before{right:1px;left:auto;content:""}\n/*!\n * Handsontable HiddenRows\n */.handsontable th.afterHiddenRow:after,.handsontable th.beforeHiddenRow:before{color:#bbb;font-size:6pt;line-height:6pt;position:absolute;left:2px}.handsontable th.afterHiddenRow,.handsontable th.beforeHiddenRow{position:relative}.handsontable th.beforeHiddenRow:before{content:"";bottom:2px}.handsontable th.afterHiddenRow:after{content:"";top:2px}.handsontable.ht__selection--rows tbody th.afterHiddenRow.ht__highlight:after,.handsontable.ht__selection--rows tbody th.beforeHiddenRow.ht__highlight:before{color:#eee}.handsontable td.afterHiddenRow.firstVisibleRow,.handsontable th.afterHiddenRow.firstVisibleRow{border-top:1px solid #ccc}.htRowHeaders .ht_master.innerBorderInlineStart~.ht_clone_inline_start td:first-of-type,.htRowHeaders .ht_master.innerBorderInlineStart~.ht_clone_top_inline_start_corner th:nth-child(2){border-left:0}.handsontable.ht__manualColumnMove.after-selection--columns thead th.ht__highlight{cursor:move;cursor:-webkit-grab;cursor:grab}.handsontable.ht__manualColumnMove.on-moving--columns,.handsontable.ht__manualColumnMove.on-moving--columns thead th.ht__highlight{cursor:move;cursor:-webkit-grabbing;cursor:grabbing}.handsontable.ht__manualColumnMove.on-moving--columns .manualColumnResizer{display:none}.handsontable .ht__manualColumnMove--backlight,.handsontable .ht__manualColumnMove--guideline{position:absolute;height:100%;display:none}[dir=ltr] .handsontable .ht__manualColumnMove--guideline{margin-left:-1px}[dir=rtl] .handsontable .ht__manualColumnMove--guideline{margin-right:-1px}[dir=ltr] .handsontable .ht__manualColumnMove--guideline{margin-right:0}[dir=rtl] .handsontable .ht__manualColumnMove--guideline{margin-left:0}.handsontable .ht__manualColumnMove--guideline{background:#757575;width:2px;top:0;z-index:205}.handsontable .ht__manualColumnMove--backlight{background:#343434;background:rgba(52,52,52,.25);display:none;z-index:205;pointer-events:none}.handsontable.on-moving--columns .ht__manualColumnMove--backlight,.handsontable.on-moving--columns.show-ui .ht__manualColumnMove--guideline{display:block}.handsontable .wtHider{position:relative}.handsontable.ht__manualRowMove.after-selection--rows tbody th.ht__highlight{cursor:move;cursor:-webkit-grab;cursor:grab}.handsontable.ht__manualRowMove.on-moving--rows,.handsontable.ht__manualRowMove.on-moving--rows tbody th.ht__highlight{cursor:move;cursor:-webkit-grabbing;cursor:grabbing}.handsontable.ht__manualRowMove.on-moving--rows .manualRowResizer{display:none}.handsontable .ht__manualRowMove--backlight,.handsontable .ht__manualRowMove--guideline{position:absolute;width:100%;display:none}.handsontable .ht__manualRowMove--guideline{background:#757575;height:2px;left:0;margin-top:-1px;z-index:205}.handsontable .ht__manualRowMove--backlight{background:#343434;background:rgba(52,52,52,.25);display:none;z-index:205;pointer-events:none}.handsontable.on-moving--rows .ht__manualRowMove--backlight,.handsontable.on-moving--rows.show-ui .ht__manualRowMove--guideline{display:block}.handsontable tbody td[rowspan][class*=area][class*=highlight]:not([class*=fullySelectedMergedCell]):before{opacity:0}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-0]:before,.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-multiple]:before{opacity:.1}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-1]:before{opacity:.2}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-2]:before{opacity:.27}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-3]:before{opacity:.35}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-4]:before{opacity:.41}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-5]:before{opacity:.47}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-6]:before{opacity:.54}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-7]:before{opacity:.58}.handsontable span.colHeader.columnSorting:after{top:50%;margin-top:-2px;position:absolute;right:-15px;left:unset;padding-left:5px;padding-right:unset;font-size:8px;height:8px;line-height:1.1;text-decoration:underline}[dir=rtl].handsontable span.colHeader.columnSorting:after{left:-15px;right:unset;padding-right:5px;padding-left:unset}.handsontable span.colHeader.columnSorting:after{text-decoration:none}.handsontable span.colHeader.columnSorting[class*=" sort-"]:after,.handsontable span.colHeader.columnSorting[class^=sort-]:after{content:"+"}.handsontable span.colHeader.columnSorting.sort-1:after{content:"1"}.handsontable span.colHeader.columnSorting.sort-2:after{content:"2"}.handsontable span.colHeader.columnSorting.sort-3:after{content:"3"}.handsontable span.colHeader.columnSorting.sort-4:after{content:"4"}.handsontable span.colHeader.columnSorting.sort-5:after{content:"5"}.handsontable span.colHeader.columnSorting.sort-6:after{content:"6"}.handsontable span.colHeader.columnSorting.sort-7:after{content:"7"}.htGhostTable th div button.changeType+span.colHeader.columnSorting:not(.indicatorDisabled){padding-right:5px}.handsontable thead th.hiddenHeader:not(:first-of-type){display:none}.handsontable th.ht_nestingLevels{text-align:left;padding-left:7px}[dir=rtl].handsontable th.ht_nestingLevels{text-align:right;padding-right:7px}.handsontable th div.ht_nestingLevels{display:inline-block;position:absolute;left:11px;right:unset}[dir=rtl].handsontable th div.ht_nestingLevels{right:11px;left:unset}.handsontable.innerBorderInlineStart th div.ht_nestingLevels,.handsontable.innerBorderInlineStart~.handsontable th div.ht_nestingLevels{right:10px;left:unset}[dir=rtl].handsontable.innerBorderInlineStart th div.ht_nestingLevels,[dir=rtl].handsontable.innerBorderInlineStart~.handsontable th div.ht_nestingLevels{left:10px;right:unset}.handsontable th span.ht_nestingLevel{display:inline-block}.handsontable th span.ht_nestingLevel_empty{display:inline-block;width:10px;height:1px;float:left}[dir=rtl].handsontable th span.ht_nestingLevel_empty{float:right}.handsontable th span.ht_nestingLevel:after{content:"";font-size:9px;display:inline-block;position:relative;bottom:3px}.handsontable th div.ht_nestingButton{display:inline-block;position:absolute;right:-2px;left:unset;cursor:pointer}[dir=rtl].handsontable th div.ht_nestingButton{left:-2px;right:unset}.handsontable th div.ht_nestingButton.ht_nestingExpand:after{content:"+"}.handsontable th div.ht_nestingButton.ht_nestingCollapse:after{content:"-"}.handsontable.innerBorderInlineStart th div.ht_nestingButton,.handsontable.innerBorderInlineStart~.handsontable th div.ht_nestingButton{right:0;left:unset}[dir=rtl].handsontable.innerBorderInlineStart th div.ht_nestingButton,[dir=rtl].handsontable.innerBorderInlineStart~.handsontable th div.ht_nestingButton{left:0;right:unset}',""]),e.exports=r},823:function(e,t,n){"use strict";n(379)("WeakSet",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),n(741))},869:function(e,t,n){"use strict";var r=n(756),o=n(713),l=n(814),c=n(638),h=n(774),d=n(689),f=n(1138),y=n(886),v={CELL_TYPE:"text",editor:f.a,renderer:y.a},m=n(870);function w(e,t){var n=new r.a(e,t||{},o.d);return n.init(),n}Object(d.c)(v),w.editors={BaseEditor:m.a},w.Core=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new r.a(e,t,o.d)},w.DefaultSettings=Object(l.a)(),w.hooks=c.a.getSingleton(),w.packageName="handsontable",w.buildDate="08/07/2022 15:24:08",w.version="12.1.2",w.languages={dictionaryKeys:h.a,getLanguageDictionary:h.b,getLanguagesDictionaries:h.c,registerLanguageDictionary:h.g,getTranslatedPhrase:h.d};t.a=w},870:function(e,t,n){"use strict";n.d(t,"b",(function(){return T})),n.d(t,"c",(function(){return k})),n.d(t,"a",(function(){return j}));n(290),n(80),n(27),n(33),n(606),n(604),n(4),n(110),n(7),n(46),n(53),n(212),n(32),n(35),n(36),n(42),n(21);var r=n(617),object=n(601),o=n(682),l=n(607),c={_hooksStorage:Object.create(null),addHook:function(e,t){return this._hooksStorage[e]||(this._hooksStorage[e]=[]),this.hot.addHook(e,t),this._hooksStorage[e].push(t),this},removeHooksByKey:function(e){var t=this;Object(l.a)(this._hooksStorage[e]||[],(function(n){t.hot.removeHook(e,n)}))},clearHooks:function(){var e=this;Object(object.o)(this._hooksStorage,(function(t,n){return e.removeHooksByKey(n)})),this._hooksStorage={}}};Object(object.f)(c,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});var h=c,d=n(605);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function y(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function m(e,p){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},m(e,p)}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C(e);if(t){var o=C(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return O(this,n)}}function O(e,t){if(t&&("object"===f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function C(e){return C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},C(e)}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function R(e,t,n){return t&&E(e.prototype,t),n&&E(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var T=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),k="baseEditor",j=function(){function e(t){S(this,e),this.hot=t,this.instance=t,this.state=T.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return R(e,[{key:"_fireCallbacks",value:function(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(e,col,t,td,n,r){this.TD=td,this.row=e,this.col=col,this.prop=t,this.originalValue=n,this.cellProperties=r,this.state=T.VIRGIN}},{key:"extend",value:function(){return function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(n,e);var t=w(n);function n(){return S(this,n),t.apply(this,arguments)}return R(n)}(this.constructor)}},{key:"saveValue",value:function(e,t){var n,o,l,c,h=this;if(t){var d=this.hot.getSelectedLast();n=Math.max(Math.min(d[0],d[2]),0),o=Math.max(Math.min(d[1],d[3]),0),l=Math.max(d[0],d[2]),c=Math.max(d[1],d[3])}else{var f=[this.row,this.col,null,null];n=f[0],o=f[1],l=f[2],c=f[3]}var v=this.hot.runHooks("modifyGetCellCoords",n,o);if(Array.isArray(v)){var m=y(v,2);n=m[0],o=m[1]}var w=this.hot.getShortcutManager().getContext("editor"),O={runOnlyIf:function(){return Object(r.b)(h.hot.getSelected())},group:k};this.isInFullEditMode()&&w.addShortcuts([{keys:[["ArrowUp"]],callback:function(){h.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){h.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){h.hot.selection.transformStart(0,-1*h.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){h.hot.selection.transformStart(0,h.hot.getDirectionFactor())}}],O),this.hot.populateFromArray(n,o,e,l,c,"edit")}},{key:"beginEditing",value:function(e,t){if(this.state===T.VIRGIN){var n=this.hot,o=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),l=n.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(n.view.scrollViewport(n._createCellCoords(o,l)),this.state=T.EDITING,this.isInFullEditMode()){var c="string"==typeof e?e:Object(r.f)(this.originalValue);this.setValue(c)}this.open(t),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(e,t,n){var r,l=this;if(n){var c=this._closeCallback;this._closeCallback=function(e){c&&c(e),n(e),l.hot.view.render()}}if(!this.isWaiting()){var h=this.hot.getShortcutManager().getContext("editor");if(h.removeShortcutsByGroup(k),h.removeShortcutsByGroup(o.b),this.state!==T.VIRGIN){if(this.state===T.EDITING){if(e)return this.cancelChanges(),void this.hot.view.render();var d=this.getValue();r=this.hot.getSettings().trimWhitespace?[["string"==typeof d?String.prototype.trim.call(d||""):d]]:[[d]],this.state=T.WAITING,this.saveValue(r,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",(function(e){l.state=T.FINISHED,l.discardEditor(e)})):(this.state=T.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout((function(){l._fireCallbacks(!0)}))}}},{key:"cancelChanges",value:function(){this.state=T.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(e){this.state===T.FINISHED&&(!1===e&&!0!==this.cellProperties.allowInvalid?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=T.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=T.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===T.WAITING}},{key:"getEditedCellRect",value:function(){var e,t=this.getEditedCell();if(t){var n=this.hot.view._wt,r=n.wtOverlays,o=n.wtViewport,l=this.hot.rootWindow,c=Object(d.G)(t),h=Object(d.I)(t),f=Object(d.G)(this.hot.rootElement),y=Object(d.I)(this.hot.rootElement),v=r.topOverlay.holder,m=r.inlineStartOverlay.holder,w=v!==l?v.scrollTop:0,O=m!==l?m.scrollLeft:0,C=l.innerWidth-f.left-y,S=(null!==(e=r.getParentOverlay(t))&&void 0!==e?e:this.hot.view._wt).wtTable,E=S.name,R=["master","inline_start"].includes(E)?w:0,T=["master","top","bottom"].includes(E)?O:0,k=c.top===f.top?0:1,j=c.top-f.top-k-R,A=0;A=this.hot.isRtl()?l.innerWidth-c.left-h-C-1+T:c.left-f.left-1-T,["top","top_inline_start_corner"].includes(E)&&(j+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(E)&&(A+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));var x=this.hot.hasColHeaders(),M=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),I=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),_=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(x&&M<=0||M===_)&&(j+=1),I<=0&&(A+=1);var N=o.rowsRenderCalculator.startPosition,H=o.columnsRenderCalculator.startPosition,P=Math.abs(r.inlineStartOverlay.getScrollPosition()),D=r.topOverlay.getScrollPosition(),L=Object(d.o)(this.hot.rootDocument),B=t.offsetTop+N-D,V=0;if(this.hot.isRtl()){var F=t.offsetLeft;V=F>=0?S.getWidth()-t.offsetLeft:Math.abs(F),V+=H-P-h}else V=t.offsetLeft+H-P;var W=Object(d.i)(this.TD,this.hot.rootWindow),z=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",U=parseInt(W[z],10)>0?0:1,G=parseInt(W.borderTopWidth,10)>0?0:1,X=Object(d.I)(t)+U,K=Object(d.H)(t)+G,Y=Object(d.x)(v)?L:0,$=Object(d.w)(m)?L:0,Q=this.hot.view.maximumVisibleElementWidth(V)-Y+U;return{top:j,start:A,height:K,maxHeight:Math.max(this.hot.view.maximumVisibleElementHeight(B)-$+G,23),width:X,maxWidth:Q}}}},{key:"getEditedCellsLayerClass",value:function(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var e=this.hot.countRows(),section="";return this.row<this.hot.getSettings().fixedRowsTop?section=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?section=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(section="inline-start"),section}}],[{key:"EDITOR_TYPE",get:function(){return"base"}}]),e}();Object(object.n)(j,h)},886:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));n(80);var r=n(887),o=n(605),l=n(617);function c(e,t,n,col,c,h,d){r.a.apply(this,[e,t,n,col,c,h,d]);var f=h;if(!f&&d.placeholder&&(f=d.placeholder),f=Object(l.f)(f),e.getSettings().trimWhitespace&&(f=f.trim()),d.rendererTemplate){Object(o.e)(t);var y=e.rootDocument.createElement("TEMPLATE");y.setAttribute("bind","{{}}"),y.innerHTML=d.rendererTemplate,HTMLTemplateElement.decorate(y),y.model=e.getSourceDataAtRow(n),t.appendChild(y)}else Object(o.g)(t,f)}c.RENDERER_TYPE="text"},887:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(605);function o(e,t,n,col,o,l,c){var h=[],d=[];c.className&&Object(r.a)(t,c.className),c.readOnly&&h.push(c.readOnlyCellClassName),!1===c.valid&&c.invalidCellClassName?h.push(c.invalidCellClassName):d.push(c.invalidCellClassName),!1===c.wordWrap&&c.noWordWrapClassName&&h.push(c.noWordWrapClassName),!l&&c.placeholder&&h.push(c.placeholderCellClassName),Object(r.K)(t,d),Object(r.a)(t,h)}o.RENDERER_TYPE="base"},888:function(e,t,n){"use strict";n(212),n(4),n(32),n(626),n(35);var r=n(748);function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c=new WeakMap,h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.viewportSize,r=t.scrollOffset,l=t.totalItems,h=t.itemSizeFn,d=t.overrideFn,f=t.calculationType,y=t.stretchMode,v=t.stretchingItemWidthFn,m=void 0===v?function(e){return e}:v;o(this,e),c.set(this,{viewportWidth:n,scrollOffset:r,totalColumns:l,columnWidthFn:h,overrideFn:d,calculationType:f,stretchingColumnWidthFn:m}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=y,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}var t,n,h;return t=e,h=[{key:"DEFAULT_WIDTH",get:function(){return 50}}],(n=[{key:"calculate",value:function(){for(var e,t=0,n=!0,o=[],l=c.get(this),h=l.calculationType,d=l.overrideFn,f=l.scrollOffset,y=l.totalColumns,v=l.viewportWidth,i=0;i<y;i++){e=this._getColumnWidth(i),t<=f&&h!==r.a&&(this.startColumn=i);var m=f>0?v+1:v;if(t>=f&&t+(h===r.a?e:0)<=f+m&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=i),this.endColumn=i),o.push(t),t+=e,h!==r.a&&(this.endColumn=i),t>=f+v){n=!1;break}}if(this.endColumn===y-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var w=o[this.endColumn]+e-o[this.startColumn-1];if((w<=v||h!==r.a)&&(this.startColumn-=1),w>v)break}h===r.b&&null!==this.startColumn&&d&&d(this),this.startPosition=o[this.startColumn],void 0===this.startPosition&&(this.startPosition=null),y<this.endColumn&&(this.endColumn=y-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(e){if("none"!==this.stretch){var t=e;this.totalTargetWidth=t;for(var n=c.get(this),r=n.totalColumns,o=0,i=0;i<r;i++){var l=this._getColumnWidth(i),h=n.stretchingColumnWidthFn(void 0,i);"number"==typeof h?t-=h:o+=l}var d=t-o;if("all"===this.stretch&&d>0)this.stretchAllRatio=t/o,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===this.stretch&&t!==1/0){var f=this._getColumnWidth(r-1),y=d+f;this.stretchLastWidth=y>=0?y:f}}}},{key:"getStretchedColumnWidth",value:function(e,t){var n=null;return"all"===this.stretch&&0!==this.stretchAllRatio?n=this._getStretchedAllColumnWidth(e,t):"last"===this.stretch&&0!==this.stretchLastWidth&&(n=this._getStretchedLastColumnWidth(e)),n}},{key:"_getStretchedAllColumnWidth",value:function(e,t){var n=0,r=c.get(this),o=r.totalColumns;if(!this.stretchAllColumnsWidth[e]){var l=Math.round(t*this.stretchAllRatio),h=r.stretchingColumnWidthFn(l,e);this.stretchAllColumnsWidth[e]=void 0===h?l:isNaN(h)?this._getColumnWidth(e):h}if(this.stretchAllColumnsWidth.length===o&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var i=0;i<this.stretchAllColumnsWidth.length;i++)n+=this.stretchAllColumnsWidth[i];n!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-n)}return this.stretchAllColumnsWidth[e]}},{key:"_getStretchedLastColumnWidth",value:function(e){return e===c.get(this).totalColumns-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(t){var n=c.get(this).columnWidthFn(t);return isNaN(n)&&(n=e.DEFAULT_WIDTH),n}}])&&l(t.prototype,n),h&&l(t,h),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.a=h},889:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return h}));n(21),n(111),n(65),n(81),n(36),n(101),n(378),n(622);var r=/^(\r\n|\n\r|\r|\n)/,o=/^[^\t\r\n]+/,l=/^\t/;function c(e){var t=[[""]];if(0===e.length)return t;for(var n,c=0,h=0;e.length>0&&n!==e.length;)if(n=e.length,e.match(l))e=e.replace(l,""),c+=1,t[h][c]="";else if(e.match(r))e=e.replace(r,""),c=0,t[h+=1]=[""];else{var d="";if(e.startsWith('"')){for(var f=0,y=!0;y;){var v=e.slice(0,1);'"'===v&&(f+=1),d+=v,(0===(e=e.slice(1)).length||e.match(/^[\t\r\n]/)&&f%2==0)&&(y=!1)}d=d.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,(function(e){return new Array(Math.floor(e.length/2)).fill('"').join("")}))}else{var m=e.match(o);d=m?m[0]:"",e=e.slice(d.length)}t[h][c]=d}return t}function h(e){var t,n,r,o,l,c="";for(t=0,n=e.length;t<n;t+=1){for(o=e[t].length,r=0;r<o;r+=1)r>0&&(c+="\t"),"string"==typeof(l=e[t][r])?l.indexOf("\n")>-1?c+='"'.concat(l.replace(/"/g,'""'),'"'):c+=l:c+=null==l?"":l;t!==n-1&&(c+="\n")}return c}},890:function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));n(212),n(4),n(32),n(626),n(35),n(622),n(292),n(79),n(21),n(65),n(9),n(606),n(604),n(110),n(623),n(12),n(7),n(46),n(53);var r=n(891),o=n(607),l=n(605),c=n(617),h=n(643),d=n(670),f=n(886);function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function v(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function m(){return m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var base=w(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},m.apply(this,arguments)}function w(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=R(object)););return object}function O(e,p){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},O(e,p)}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R(e);if(t){var o=R(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return S(this,n)}}function S(e,t){if(t&&("object"===y(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return E(e)}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function R(e){return R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},R(e)}var T=new WeakMap,k=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O(e,t)}(w,e);var t,n,r,y=C(w);function w(e){var t,n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,w),t=y.call(this,e),n=E(t),o=function(e,t,n){var r,o,i,l,d=[],f=[],y=e.length,v=t.length;if(0===y){for(i=0;i<v;i++)f.push(i);return f}for(i=0;i<v;i++){if(o=Object(h.d)(Object(c.f)(t[i])),n)l=o.indexOf(e);else{var m=this.cellProperties.locale;l=o.toLocaleLowerCase(m).indexOf(e.toLocaleLowerCase(m))}-1!==l&&(r=o.length-l-y,d.push({baseIndex:i,index:l,charsLeft:r,value:o}))}for(d.sort((function(a,b){if(-1===b.index)return-1;if(-1===a.index)return 1;if(a.index<b.index)return-1;if(b.index<a.index)return 1;if(a.index===b.index){if(a.charsLeft<b.charsLeft)return-1;if(a.charsLeft>b.charsLeft)return 1}return 0})),i=0,v=d.length;i<v;i++)f.push(d[i].baseIndex);return f},(r="sortByRelevance")in n?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,t.query=null,t.strippedChoices=[],t.rawChoices=[],T.set(E(t),{skipOne:!1,isMacOS:t.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),t}return t=w,r=[{key:"EDITOR_TYPE",get:function(){return"autocomplete"}}],(n=[{key:"getValue",value:function(){var e=this,t=this.rawChoices.find((function(t){return e.stripValueIfNeeded(t)===e.TEXTAREA.value}));return Object(c.b)(t)?t:this.TEXTAREA.value}},{key:"createElements",value:function(){m(R(w.prototype),"createElements",this).call(this),Object(l.a)(this.htContainer,"autocompleteEditor"),Object(l.a)(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll")}},{key:"open",value:function(){var e=this,t=T.get(this);m(R(w.prototype),"open",this).call(this);var n=this.htEditor.getInstance(),r=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var o=Object(l.o)();0===o&&t.isMacOS&&(o+=15),this.addHook("beforeKeyDown",(function(t){return e.onBeforeKeyDown(t)})),n.updateSettings({colWidths:r?[Object(l.I)(this.TEXTAREA)-2]:void 0,width:r?Object(l.I)(this.TEXTAREA)+o:void 0,renderer:function(t,n,r,col,o,l,h){Object(f.a)(t,n,r,col,o,l,h);var d,y,v=e.cellProperties,m=v.filteringCaseSensitive,w=v.allowHtml,O=v.locale,C=e.query,S=Object(c.f)(l);S&&!w&&-1!==(d=!0===m?S.indexOf(C):S.toLocaleLowerCase(O).indexOf(C.toLocaleLowerCase(O)))&&(y=S.substr(d,C.length),S=S.replace(y,"<strong>".concat(y,"</strong>"))),n.innerHTML=S},autoColumnSize:!0}),t.skipOne&&(t.skipOne=!1),this.hot._registerTimeout((function(){e.queryChoices(e.TEXTAREA.value)}))}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),m(R(w.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(e){m(R(w.prototype),"discardEditor",this).call(this,e),this.hot.view.render()}},{key:"queryChoices",value:function(e){var t=this,source=this.cellProperties.source;this.query=e,"function"==typeof source?source.call(this.cellProperties,e,(function(e){t.rawChoices=e,t.updateChoicesList(t.stripValuesIfNeeded(e))})):Array.isArray(source)?(this.rawChoices=source,this.updateChoicesList(this.stripValuesIfNeeded(source))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(e){var t=Object(l.h)(this.TEXTAREA),n=Object(l.p)(this.TEXTAREA),r=this.cellProperties.sortByRelevance,c=this.cellProperties.filter,h=null,d=null,f=e;r&&(h=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),f,this.cellProperties.filteringCaseSensitive));var y=Array.isArray(h)?h.length:0;if(!1===c)y&&(d=h[0]);else{for(var v=[],i=0,m=f.length;i<m&&!(r&&y<=i);i++)y?v.push(f[h[i]]):v.push(f[i]);d=0,f=v}this.strippedChoices=f,this.htEditor.loadData(Object(o.h)([f])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(d),this.hot.listen(),Object(l.O)(this.TEXTAREA,t,t===n?void 0:n)}},{key:"flipDropdownIfNeeded",value:function(){var e=Object(l.s)(this.hot.view._wt.wtTable.TABLE),t=e===this.hot.rootWindow,n=this.cellProperties.preventOverflow;if(t||!t&&(n||"horizontal"===n))return!1;var r=Object(l.G)(this.TEXTAREA),o=Object(l.H)(this.TEXTAREA),c=this.getDropdownHeight(),h=e.scrollTop,d=Object(l.H)(this.hot.view._wt.wtTable.THEAD),f=Object(l.G)(e),y=r.top-f.top-d+h,v=e.scrollHeight-y-d-o,m=c>v&&y>v;return m?this.flipDropdown(c):this.unflipDropdown(),this.limitDropdownIfNeeded(m?y:v,c),m}},{key:"limitDropdownIfNeeded",value:function(e,t){if(t>e){var n,r=0,i=0,o=0;do{r+=o=this.htEditor.getRowHeight(i)||this.htEditor.view._wt.getSetting("defaultRowHeight"),i+=1}while(r<e);n=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+t-n,"px")),this.setDropdownHeight(r-o)}}},{key:"flipDropdown",value:function(e){var t=this.htEditor.rootElement.style;t.position="absolute",t.top="".concat(-e,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var e=this.htEditor.getColWidth(0)+Object(l.o)(this.hot.rootDocument)+2,t=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(e){this.htEditor.updateSettings({height:e})}},{key:"highlightBestMatchingChoice",value:function(e){"number"==typeof e?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var e=this.htEditor.getInstance().getRowHeight(0)||23,t=this.cellProperties.visibleRows;return this.strippedChoices.length>=t?t*e:this.strippedChoices.length*e+8}},{key:"stripValueIfNeeded",value:function(e){return this.stripValuesIfNeeded([e])[0]}},{key:"stripValuesIfNeeded",value:function(e){var t=this.cellProperties.allowHtml,n=Object(o.c)(e,(function(e){return Object(c.f)(e)}));return Object(o.c)(n,(function(e){return t?e:Object(h.d)(e)}))}},{key:"allowKeyEventPropagation",value:function(e){var t=this.htEditor.getSelectedRangeLast(),n=t?t.from.row:-1,r=!1;return e===d.a.ARROW_DOWN&&n>0&&n<this.htEditor.countRows()-1&&(r=!0),e===d.a.ARROW_UP&&n>-1&&(r=!0),r}},{key:"onBeforeKeyDown",value:function(e){var t=this,n=T.get(this);if(n.skipOne=!1,Object(d.e)(e.keyCode)||e.keyCode===d.a.BACKSPACE||e.keyCode===d.a.DELETE||e.keyCode===d.a.INSERT){var r=10;if(e.keyCode===d.a.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(r+=10),this.htEditor&&this.hot._registerTimeout((function(){t.queryChoices(t.TEXTAREA.value),n.skipOne=!0}),r)}}}])&&v(t.prototype,n),r&&v(t,r),Object.defineProperty(t,"prototype",{writable:!1}),w}(r.a)},891:function(e,t,n){"use strict";n.d(t,"a",(function(){return R}));n(606),n(604),n(4),n(110),n(623),n(12),n(7),n(46),n(53),n(212),n(32),n(35);var r=n(1138),o=n(605),l=n(645),c=n(601),h=n(682);function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function v(){return v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var base=m(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},v.apply(this,arguments)}function m(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=S(object)););return object}function w(e,p){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},w(e,p)}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S(e);if(t){var o=S(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return C(this,n)}}function C(e,t){if(t&&("object"===d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},S(e)}var E="handsontableEditor",R=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}(m,e);var t,n,r,d=O(m);function m(){return f(this,m),d.apply(this,arguments)}return t=m,r=[{key:"EDITOR_TYPE",get:function(){return"handsontable"}}],(n=[{key:"open",value:function(){v(S(m.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),"none"===this.htContainer.style.display&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Object(o.O)(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),v(S(m.prototype),"close",this).call(this)}},{key:"prepare",value:function(e,col,t,td,n,r){v(S(m.prototype),"prepare",this).call(this,e,col,t,td,n,r);var o=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(e,t){var n=this.getSourceData(t.row,t.col);void 0!==n&&o.setValue(n),o.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Object(c.h)(l,r.handsontable),this.htOptions=l}},{key:"beginEditing",value:function(e,t){var n=this.hot.getSettings().onBeginEditing;n&&!1===n()||v(S(m.prototype),"beginEditing",this).call(this,e,t)}},{key:"createElements",value:function(){v(S(m.prototype),"createElements",this).call(this);var e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}},{key:"finishEditing",value:function(e,t,n){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var r=this.htEditor.getInstance().getValue();void 0!==r&&this.setValue(r)}v(S(m.prototype),"finishEditing",this).call(this,e,t,n)}},{key:"assignHooks",value:function(){var e=this;this.hot.addHook("afterDestroy",(function(){e.htEditor&&e.htEditor.destroy()}))}},{key:"registerShortcuts",value:function(){var e=this,t=this.hot.getShortcutManager().getContext("editor");v(S(m.prototype),"registerShortcuts",this).call(this);var n={group:E,relativeToGroup:h.b,position:"before"},r=function(t,n){var r=e.htEditor.getInstance();if(void 0!==t&&(t<0||r.flipped&&t>r.countRows()-1?r.deselectCell():r.selectCell(t,0),r.getData().length))return n.preventDefault(),Object(l.d)(n),e.hot.listen(),e.TEXTAREA.focus(),!1};t.addShortcuts([{keys:[["ArrowUp"]],callback:function(t){var n,o,l=e.htEditor.getInstance();return!l.getSelectedLast()&&l.flipped?n=l.countRows()-1:l.getSelectedLast()&&(l.flipped?(o=l.getSelectedLast()[0],n=Math.max(0,o-1)):n=(o=l.getSelectedLast()[0])-1),r(n,t)},preventDefault:!1},{keys:[["ArrowDown"]],callback:function(t){var n,o,l=e.htEditor.getInstance();if(l.getSelectedLast()||l.flipped){if(l.getSelectedLast())if(l.flipped)n=l.getSelectedLast()[0]+1;else if(!l.flipped){var c=l.countRows()-1;o=l.getSelectedLast()[0],n=Math.min(c,o+1)}}else n=0;return r(n,t)},preventDefault:!1}],n)}},{key:"unregisterShortcuts",value:function(){v(S(m.prototype),"unregisterShortcuts",this).call(this),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(E)}}])&&y(t.prototype,n),r&&y(t,r),Object.defineProperty(t,"prototype",{writable:!1}),m}(r.a)},892:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));function r(e,t){var n=e;null==n&&(n=""),this.allowEmpty&&""===n?t(!0):this.strict&&this.source?"function"==typeof this.source?this.source(n,o(n,t)):o(n,t)(this.source):t(!0)}function o(e,t){var n=e;return function(source){for(var e=!1,s=0,r=source.length;s<r;s++)if(n===source[s]){e=!0;break}t(e)}}r.VALIDATOR_TYPE="autocomplete"},895:function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));n(212),n(269),n(4),n(32),n(35),n(626),n(10),n(21),n(61),n(28),n(101),n(622),n(214),n(750),n(7),n(46),n(53),n(36),n(27),n(42);var r=n(601),o=n(607),l=n(775),c=n(689),h=n(709),d=n(711),f=n(712);function y(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function m(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function w(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}var O=new Map([["plugin",l.c],["cell-type",c.b],["editor",h.b],["renderer",d.b],["validator",f.b]]),C=new WeakMap,S=[],E=null,R=new WeakSet,T=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),w(this,R),Object(r.f)(this,"hot",t,{writable:!1}),C.set(this,{hooks:{}}),E=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",(function(){return n.onAfterPluginsInitialized()})),this.hot.addHook("afterUpdateSettings",(function(e){return n.onUpdateSettings(e)})),this.hot.addHook("beforeInit",(function(){return n.init()}))}var t,n,c;return t=e,c=[{key:"PLUGIN_KEY",get:function(){return"base"}},{key:"SETTING_KEYS",get:function(){return[this.PLUGIN_KEY]}}],(n=[{key:"init",value:function(){var e=this;this.pluginName=this.hot.getPluginName(this);var t=this.constructor.PLUGIN_DEPS,n=Array.isArray(t)?t:[];if(n.length>0){var r=[];if(n.forEach((function(e){var t=y(e.split(":"),2),n=t[0],o=t[1];if(!O.has(n))throw new Error('Unknown plugin dependency type "'.concat(n,'" was found.'));O.get(n)(o)||r.push(" - ".concat(o," (").concat(n,")"))})),r.length>0){var o=["The ".concat(this.pluginName," plugin requires the following modules:\n"),"".concat(r.join("\n"),"\n")].join("");S.push(o)}}if(E||(E=Object(l.b)()),E.indexOf("UndoRedo")>=0&&E.splice(E.indexOf("UndoRedo"),1),E.indexOf(this.pluginName)>=0&&E.splice(E.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",(function(){e.isEnabled&&e.isEnabled()&&e.enablePlugin()})),0===E.length){if(S.length>0){var c=["".concat(S.join("\n"),"\n"),"You have to import and register them manually."].join("");throw new Error(c)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(e,t){C.get(this).hooks[e]=C.get(this).hooks[e]||[];var n=C.get(this).hooks[e];this.hot.addHook(e,t),n.push(t),C.get(this).hooks[e]=n}},{key:"removeHooks",value:function(e){var t=this;Object(o.a)(C.get(this).hooks[e]||[],(function(n){t.hot.removeHook(e,n)}))}},{key:"clearHooks",value:function(){var e=this,t=C.get(this).hooks;Object(r.o)(t,(function(t,n){return e.removeHooks(n)})),t.length=0}},{key:"callOnPluginsReady",value:function(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}},{key:"onAfterPluginsInitialized",value:function(){Object(o.a)(this.pluginsInitializedCallbacks,(function(e){return e()})),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(e){var t=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}(this,R,k).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&t&&this.updatePlugin(e))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var e=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),Object(r.o)(this,(function(t,n){"hot"!==n&&(e[n]=null)})),delete this.t,delete this.hot}}])&&m(t.prototype,n),c&&m(t,c),Object.defineProperty(t,"prototype",{writable:!1}),e}();function k(e){if(!e)return!1;var t=this.constructor.SETTING_KEYS;if("boolean"==typeof t)return t;for(var i=0;i<t.length;i++)if(void 0!==e[t[i]])return!0;return!1}},911:function(e,t,n){"use strict";n.d(t,"a",(function(){return Y}));n(212),n(4),n(32),n(626),n(35),n(101),n(622),n(21),n(28),n(606),n(604),n(110),n(623),n(12),n(7),n(46),n(53),n(36),n(27),n(42);var base=n(895),r=n(638),o=n(889),l=n(607),c=n(630),h=n(643),d=n(605),f=n(609);function y(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var v=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data={}}var t,n,r;return t=e,(n=[{key:"setData",value:function(e,t){this.data[e]=t}},{key:"getData",value:function(e){return this.data[e]||void 0}}])&&y(t.prototype,n),r&&y(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function m(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function w(e,t,n){return t&&m(e.prototype,t),n&&m(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var O=w((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clipboardData=new v})),C=(n(750),n(639)),S=n(642),object=n(601),E=n(650);function R(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var T=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootDocument=t.defaultView?t:t.ownerDocument,this.mainElement=null,this.eventManager=new C.a(this),this.listenersCount=new WeakSet,this.container=t}var t,n,r;return t=e,(n=[{key:"useSecondaryElement",value:function(){var e=function(e){var t=x.get(e);if(t)return t.parentElement||e.appendChild(t),t;var element=(e.defaultView?e:e.ownerDocument).createElement("textarea");return x.set(e,element),element.setAttribute("data-hot-input",""),element.className="HandsontableCopyPaste",element.tabIndex=-1,element.autocomplete="off",element.wrap="hard",element.value=" ",e.appendChild(element),element}(this.container);this.listenersCount.has(e)||(this.listenersCount.add(e),A(this.eventManager,e,this)),this.mainElement=e}},{key:"setFocusableElement",value:function(element){this.listenersCount.has(element)||(this.listenersCount.add(element),A(this.eventManager,element,this)),this.mainElement=element}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",Object(E.k)()||Object(d.N)(this.mainElement)}}])&&R(t.prototype,n),r&&R(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();Object(object.n)(T,S.a);var k=new WeakMap;var j=function(e,t){return function(n){return t.runLocalHooks(e,n)}};function A(e,element,t){e.addEventListener(element,"copy",j("copy",t)),e.addEventListener(element,"cut",j("cut",t)),e.addEventListener(element,"paste",j("paste",t))}var x=new WeakMap;function M(e){if(e instanceof T){var t=k.get(e.container);if((t=isNaN(t)?0:t)>0&&(t-=1),function(e){e.eventManager.clear()}(e),t<=0){t=0;var n=x.get(e.container);n&&n.parentNode&&(n.parentNode.removeChild(n),x.delete(e.container)),e.mainElement=null}k.set(e.container,t)}}var I=n(749);function _(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function H(e){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},H(e)}function P(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function D(){return D="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var base=L(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},D.apply(this,arguments)}function L(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=z(object)););return object}function B(e,p){return B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,p){return e.__proto__=p,e},B(e,p)}function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=z(e);if(t){var o=z(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return F(this,n)}}function F(e,t){if(t&&("object"===H(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return W(e)}function W(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function z(e){return z=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},z(e)}r.a.getSingleton().register("afterCopyLimit"),r.a.getSingleton().register("modifyCopyableRange"),r.a.getSingleton().register("beforeCut"),r.a.getSingleton().register("afterCut"),r.a.getSingleton().register("beforePaste"),r.a.getSingleton().register("afterPaste"),r.a.getSingleton().register("beforeCopy"),r.a.getSingleton().register("afterCopy");var U="copyPaste",G=["fragmentSelection"],X=new WeakMap,K=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),Y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&B(e,t)}(v,e);var t,n,r,y=V(v);function v(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,v),(t=y.call(this,e)).columnsLimit=Infinity,t.copyableRanges=[],t.focusableElement=void 0,t.pasteMode="overwrite",t.rowsLimit=Infinity,t.uiContainer=t.hot.rootDocument.body,X.set(W(t),{isTriggeredByCopy:!1,isTriggeredByCut:!1,isBeginEditing:!1,isFragmentSelectionEnabled:!1}),t}return t=v,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[U]}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t,n,r,o=this.hot.getSettings(),l=o[U],c=o.fragmentSelection;X.get(this).isFragmentSelectionEnabled=!!c,"object"===H(l)&&(this.pasteMode=l.pasteMode||this.pasteMode,this.rowsLimit=isNaN(l.rowsLimit)?this.rowsLimit:l.rowsLimit,this.columnsLimit=isNaN(l.columnsLimit)?this.columnsLimit:l.columnsLimit,this.uiContainer=l.uiContainer||this.uiContainer),this.addHook("afterContextMenuDefaultOptions",(function(t){return e.onAfterContextMenuDefaultOptions(t)})),this.addHook("afterOnCellMouseUp",(function(){return e.onAfterOnCellMouseUp()})),this.addHook("afterSelectionEnd",(function(){return e.onAfterSelectionEnd()})),this.addHook("beforeKeyDown",(function(){return e.onBeforeKeyDown()})),this.focusableElement=(t=this.uiContainer,n=new T(t),r=k.get(t),r=isNaN(r)?0:r,k.set(t,r+1),n),this.focusableElement.addLocalHook("copy",(function(t){return e.onCopy(t)})).addLocalHook("cut",(function(t){return e.onCut(t)})).addLocalHook("paste",(function(t){return e.onPaste(t)})),D(z(v.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),D(z(v.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&M(this.focusableElement),D(z(v.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){X.get(this).isTriggeredByCopy=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"cut",value:function(){X.get(this).isTriggeredByCut=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(e){var t=this,n=[],r=[],h=[];return Object(l.a)(e,(function(e){Object(c.c)(e.startRow,e.endRow,(function(e){-1===r.indexOf(e)&&r.push(e)})),Object(c.c)(e.startCol,e.endCol,(function(e){-1===h.indexOf(e)&&h.push(e)}))})),Object(l.a)(r,(function(e){var r=[];Object(l.a)(h,(function(n){r.push(t.hot.getCopyableData(e,n))})),n.push(r)})),Object(o.b)(n)}},{key:"getRangedData",value:function(e){var t=this,n=[],r=[],o=[];return Object(l.a)(e,(function(e){Object(c.c)(e.startRow,e.endRow,(function(e){-1===r.indexOf(e)&&r.push(e)})),Object(c.c)(e.startCol,e.endCol,(function(e){-1===o.indexOf(e)&&o.push(e)}))})),Object(l.a)(r,(function(e){var r=[];Object(l.a)(o,(function(n){r.push(t.hot.getCopyableData(e,n))})),n.push(r)})),n}},{key:"paste",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(e||t){var n=new O;e&&n.clipboardData.setData("text/plain",e),t&&n.clipboardData.setData("text/html",t),this.getOrCreateFocusableElement(),this.onPaste(n)}}},{key:"setCopyableText",value:function(){var e=this.hot.getSelectedRangeLast();if(e){var t=e.getTopStartCorner(),n=e.getBottomEndCorner(),r=t.row,o=t.col,l=n.row,c=n.col,h=Math.min(l,r+this.rowsLimit-1),d=Math.min(c,o+this.columnsLimit-1);this.copyableRanges.length=0,this.copyableRanges.push({startRow:r,startCol:o,endRow:h,endCol:d}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges),l===h&&c===d||this.hot.runHooks("afterCopyLimit",l-r+1,c-o+1,this.rowsLimit,this.columnsLimit)}}},{key:"getOrCreateFocusableElement",value:function(){var e=this.hot.getActiveEditor(),t=e?e.TEXTAREA:void 0;t?this.focusableElement.setFocusableElement(t):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var e=this.hot.getActiveEditor();return e&&e.isOpened()}},{key:"populateValues",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(e.length){for(var n=e.length,r=e[0].length,o=[],l=t.getTopStartCorner(),c=l.row,h=l.col,d=t.getBottomEndCorner(),f=d.row,y=d.col,v=c,m=h,w=c,O=h;o.length<n||v<=f;){var C=this.hot.getCellMeta(v,h),S=C.skipRowOnPaste,E=C.visualRow;if(v=E+1,!0!==S){w=E,m=h;for(var R=[],T=o.length%n;R.length<r||m<=y;){var k=this.hot.getCellMeta(c,m),j=k.skipColumnOnPaste,A=k.visualCol;if(m=A+1,!0!==j){O=A;var x=R.length%r;R.push(e[T][x])}}o.push(R)}}return this.hot.populateFromArray(c,h,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[c,h,w,O]}}},{key:"onCopy",value:function(e){var t=X.get(this);if((this.hot.isListening()||t.isTriggeredByCopy)&&!this.isEditorOpened()){this.setCopyableText(),t.isTriggeredByCopy=!1;var n=this.getRangedData(this.copyableRanges);if(this.hot.runHooks("beforeCopy",n,this.copyableRanges)){var r=Object(o.b)(n);if(e&&e.clipboardData){var l=Object(I.a)(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",r),e.clipboardData.setData("text/html",[K,l].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",r);this.hot.runHooks("afterCopy",n,this.copyableRanges)}e.preventDefault()}}},{key:"onCut",value:function(e){var t=X.get(this);if((this.hot.isListening()||t.isTriggeredByCut)&&!this.isEditorOpened()){this.setCopyableText(),t.isTriggeredByCut=!1;var n=this.getRangedData(this.copyableRanges);if(this.hot.runHooks("beforeCut",n,this.copyableRanges)){var r=Object(o.b)(n);if(e&&e.clipboardData){var l=Object(I.a)(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",r),e.clipboardData.setData("text/html",[K,l].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",r);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",n,this.copyableRanges)}e.preventDefault()}}},{key:"onPaste",value:function(e){if(this.hot.isListening()&&!this.isEditorOpened()){var t;if(e&&e.preventDefault&&e.preventDefault(),e&&void 0!==e.clipboardData){var n=Object(h.c)(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});t=n&&/(<table)|(<TABLE)/g.test(n)?Object(I.b)(n,this.hot.rootDocument).data:e.clipboardData.getData("text/plain")}else"undefined"==typeof ClipboardEvent&&void 0!==this.hot.rootWindow.clipboardData&&(t=this.hot.rootWindow.clipboardData.getData("Text"));if("string"==typeof t&&(t=Object(o.a)(t)),(!t||0!==t.length)&&!1!==this.hot.runHooks("beforePaste",t,this.copyableRanges)){var r=_(this.populateValues(t),4),l=r[0],c=r[1],d=r[2],f=r[3];this.hot.selectCell(l,c,Math.min(this.hot.countRows()-1,d),Math.min(this.hot.countCols()-1,f)),this.hot.runHooks("afterPaste",t,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(e){var t;e.items.push({name:"---------"},(t=this,{key:"copy",name:function(){return this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_COPY)},callback:function(){t.copy()},disabled:function(){if(0===this.countRows()||0===this.countCols())return!0;var e=this.getSelected();return!e||e.length>1},hidden:!1}),function(e){return{key:"cut",name:function(){return this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_CUT)},callback:function(){e.cut()},disabled:function(){if(0===this.countRows()||0===this.countCols())return!0;var e=this.getSelected();return!e||e.length>1},hidden:!1}}(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){var e=X.get(this).isFragmentSelectionEnabled;this.isEditorOpened()||(this.getOrCreateFocusableElement(),e&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&Object(d.q)()||(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(this.hot.isListening()&&!this.isEditorOpened()){var e=this.hot.rootDocument.activeElement,t=this.hot.getActiveEditor();!t||e!==this.focusableElement.getFocusableElement()&&e!==t.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(M(this.focusableElement),this.focusableElement=null),D(z(v.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return U}},{key:"SETTING_KEYS",get:function(){return[U].concat(G)}},{key:"PLUGIN_PRIORITY",get:function(){return 80}}],n&&P(t.prototype,n),r&&P(t,r),Object.defineProperty(t,"prototype",{writable:!1}),v}(base.a)}}]);