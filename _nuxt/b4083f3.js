(window.webpackJsonp=window.webpackJsonp||[]).push([[35,31],{1091:function(Y,D,t){"use strict";t.r(D);var P=function(){var a=this,e=a._self._c;return e("LazyFormDialogFull",{ref:"dialogForm",on:{arrowLink:a.arrowLink,closeDialog:a.closeDialog},scopedSlots:a._u([{key:"content",fn:function(){return[e("LazyDocumentFormDocument",{ref:"formDocument",attrs:{"form-type":a.formType}}),a._v(" "),e("AccountingDialogLedger",{ref:"ledger"})]},proxy:!0},{key:"actions",fn:function(){return[a.actionName==="Update Document"?e("span",[e("v-btn",{attrs:{text:"",small:"",dark:""},on:{click:function(c){return a.printAction("preview")}}},[a._v("Print or Preview")]),a._v(" "),e("v-divider",{attrs:{dark:"",vertical:""}}),a._v(" "),e("v-btn",{attrs:{text:"",small:"",dark:""}},[a._v(`
          More
          `),e("v-menu",{attrs:{transition:"slide-y-transition",bottom:""},scopedSlots:a._u([{key:"activator",fn:function(c){var g=c.on,p=c.attrs;return[e("v-btn",a._g(a._b({attrs:{dark:"",icon:""}},"v-btn",p,!1),g),[e("v-icon",[a._v("mdi-menu-down")])],1)]}}],null,!1,1025138851)},[a._v(" "),e("v-list",{attrs:{link:""}},a._l(a.itemAction,function(d,c){return e("v-list-item",{key:c,on:{click:function(p){return a.actionItem(d.action)}}},[e("v-list-item-content",[e("v-list-item-title",[a._v(a._s(d.text))])],1)],1)}),1)],1)],1)],1):a._e(),a._v(" "),e("v-spacer"),a._v(" "),e("v-btn",{staticClass:"mr-3",attrs:{small:"",loading:a.loading,disabled:a.checkDisable()},on:{click:function(c){return a.actionSave("saveDraft")}}},[a._v(`
        Save draft
      `)]),a._v(" "),e("v-btn",{staticClass:"mr-3",attrs:{small:"",color:"green darken-1",dark:"",loading:a.loading,disabled:a.checkDisable()},on:{click:function(c){return a.actionSave("save")}}},[a._v(`
        `+a._s(a.actionName)+`

        `)])]},proxy:!0}])},[e("v-overlay",{attrs:{value:a.showLoading}},[e("v-progress-circular",{attrs:{indeterminate:"",size:"64"}})],1)],1)},A=[],U=t(8),K=t(7),T=t(9),W=t(12),I=t(13),C=t(2),h=t(24),E=t(64),V=t(74),x=t(59),M=t(28),S=t(4),j=t(10),n=t(27),s=t(32),r=t(34),v=t(651),y=t(291),O=t(33);function N(l,a){var e=Object.keys(l);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(l);a&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(l,d).enumerable})),e.push.apply(e,o)}return e}function G(l){for(var a=1;a<arguments.length;a++){var e=arguments[a]!=null?arguments[a]:{};a%2?N(Object(e),!0).forEach(function(o){Object(C.a)(l,o,e[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(e)):N(Object(e)).forEach(function(o){Object.defineProperty(l,o,Object.getOwnPropertyDescriptor(e,o))})}return l}var H={name:"DialogForm",props:{url:{type:String,default:"/api/documents"},formType:{type:String,default:""},formUrl:{type:String,default:""},dialogTitle:{type:String,default:""},tableUrl:{type:String,default:""}},data:function(){return{title:this.dialogTitle,items:[{text:"Save and close",action:"saveClose"},{text:"Save and new",action:"saveNew"},{text:"Save and send",action:"saveSend"}],itemAction:[],action:[],breadcrumb:[],form:{},audits:{},defaultItem:{},dialogLoading:!1,dialog:!1,loading:!1,showLoading:!1,actionName:"Save Document",actionOnSave:"save",countRouter:-1,showDraft:!1}},activated:function(){var a=this;this.$nextTick(function(){a.$nuxt.$loading.start()}),setTimeout(function(){a.action=[],a.itemAction=[{text:"Copy",action:"copy"},{text:"Cancel",action:"canceled"},{text:"Audit History",action:"history"},{text:"Journal Entry",action:"journal"}],a.itemAction=a.appendItemAction(a.formType),a.$auth.$storage.setState("formType",a.formType),a.$refs.dialogForm.openDialog(),a.getDataFromApi()},500)},methods:{close:function(){this.$emit("getDataFromApi")},checkDisable:function(){return this.form.status==="closed"||this.form.status==="canceled"},appendItemAction:function(a){return this.action=[],a==="CS"||a==="CP"?this.action=[]:this.action=this.$formatter.appendAction(a),[].concat(Object(E.a)(this.action),Object(E.a)(this.itemAction))},closeDialog:function(){this.$router.push({path:this.tableUrl})},arrowLink:function(a){var e=this;this.$axios.get(this.url+"/arrow",{params:{type:this.formType,status:a.status,document:this.$route.query.document}}).then(function(o){e.$router.push({path:e.formUrl,query:{document:o.data.id}}),setTimeout(function(){e.getDataFromApi()},300)}).catch(function(o){e.$swal({type:"error",title:"Error",text:o.response.data.message})})},getDataFromApi:function(a){var e=this;return Object(h.a)(regeneratorRuntime.mark(function o(){var d,c,g,p,B,L;return regeneratorRuntime.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(e.showLoading=!0,_.prev=1,d=e.formType,c=e.$route.query.copyFrom,g="",!c){_.next=11;break}return _.next=8,e.$axios.get("/api/document/copy",{params:{type:d,copyFromId:a,copyFrom:c}});case 8:g=_.sent,_.next=14;break;case 11:return _.next=13,e.$axios.get(e.url+"/"+e.$route.query.document,{params:{type:d,copyFromId:a}});case 13:g=_.sent;case 14:p="",e.audits=g.data.audits,g.data.count===0?(p=g.data.form,e.actionName="Save Document"):(p=g.data.data,e.actionName="Update Document"),e.form=Object.assign({},p),e.defaultItem=Object.assign({},p),c&&(e.form.status="open",e.form.base_id=e.form.id,e.form.base_type=e.form.transaction_type,e.form.base_num=e.form.transaction_no,e.form.transaction_type=e.formType),e.form.tags&&(B=[],e.form.tags.forEach(function(mt,vt){B.push(mt.name.en)}),e.form.tags=B),e.title=e.dialogTitle+" #"+e.form.transaction_no,e.$refs.dialogForm.setTitle(e.title),e.$refs.formDocument.setData(e.form),e.showLoading=!1,_.next=32;break;case 27:_.prev=27,_.t0=_.catch(1),e.showLoading=!1,L=_.t0.response!==void 0?_.t0.response.data.message:_.t0,e.$swal({type:"error",title:"Error",text:L});case 32:case"end":return _.stop()}},o,null,[[1,27]])}))()},actionItem:function(a){var e=this;switch(a){case"copy":this.$router.push({path:e.formUrl,query:{document:0}}),this.form.status="open",this.$refs.formDocument.setData(this.form);break;case"journal":this.$refs.ledger.openDialog("/api/transaction/ledger/"+this.form.id);break;case"closed":case"canceled":this.closeItem(this.form,a);break;default:this.$router.push({path:e.$formatter.mappingAction(a),query:{document:0,copyFrom:this.form.id}}),this.form.status="open",this.form.base_id=this.form.id,this.form.base_type=this.form.transaction_type,this.form.base_num=this.form.document_number,this.$refs.formDocument.setData(this.form);break}},closeItem:function(a,e){var o=this;this.$swal({title:this.$t("Are you sure you want to run this action?"),text:"Data cannot be change after posted!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Save"}).then(function(d){d.value&&(o.$nuxt.$loading.start(),o.$axios.put(o.url+"/"+a.id,G({updateStatus:e},a)).then(function(c){o.getDataFromApi()}).catch(function(c){o.$swal({type:"error",title:"Error",text:c.response.data.message})}).finally(function(){o.$nuxt.$loading.finish()}))})},actionDocument:function(a){var e=this,o=this.$route.query.document;switch(a){case"SQ":case"SO":case"PQ":case"PO":this.$router.push({path:"/dashboard/documents/form",query:{document:0,type:a}}),setTimeout(function(){e.actionName="Save",e.$refs.formDocument.changeValue("type",a),e.$refs.formDocument.changeValue("parent_id",o)},300);break;case"C":this.$refs.formDocument.changeValue("status","cancel"),this.store();break;case"sendEmail":this.openDialogEmail();break}},printAction:function(a){switch(a){case"preview":this.previewDocument();break;case"sendEmail":this.openDialogEmail();break}},openDialogEmail:function(){this.$refs.dialogSendEmail.openEmailDialog(this.form)},previewDocument:function(){var a=this,e=this;this.$refs.dialogForm.showLoading(),this.$axios.get("/api/document/print",{params:{id:e.form.id,type:e.form.transaction_type},responseType:"arraybuffer"}).then(function(o){a.$refs.dialogForm.finishLoading();var d=window.URL.createObjectURL(new Blob([o.data])),c=document.createElement("a");c.href=d,c.setAttribute("download",e.form.transaction_no+".pdf"),document.body.appendChild(c),c.click()}).catch(function(o){a.$refs.dialogForm.finishLoading(),a.$swal({type:"error",title:"Error",text:o.response.data.message})})},actionSave:function(a){var e=this,o=["IN","RC","CN","SR","BL","PY","DN","GN","CS","CP"];a==="save"&&o.includes(this.form.transaction_type)?this.$swal({title:this.$t("Are you sure you want to run this action?"),text:"Data cannot be change after posted!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Save"}).then(function(d){d.value&&e.save(a)}):this.save(a)},save:function(a){var e=this;this.actionOnSave=a;var o=this.$route.query.document,d=["CS","IN","CN","IN","RC","CP","BL","PY","DN","JN","CE"],c=d.includes(this.form.transaction_type)?"/api/transactions":this.url,g=o==="0"?c:c+"/"+o,p=o==="0"?"post":"patch",B=G(G({},this.$refs.formDocument.returnData(o)),{},{action:a}),L=this;this.loading=!0,this.showLoading=!0,this.$axios({method:p,url:g,data:B}).then(function($){switch(e.$nuxt.$emit("snackbar",e.title+" saved!"),e.actionOnSave){case"save":case"saveDraft":e.$router.push({path:L.formUrl,query:{document:$.data.id}}),setTimeout(function(){e.getDataFromApi()},50);break;case"saveNew":e.$router.push({path:L.formUrl,query:{document:0}}),setTimeout(function(){e.getDataFromApi()},50);break;case"saveClose":e.$refs.dialogForm.closeDialog();break}}).catch(function($){e.$swal({type:"error",title:"Error",text:$.response.data.message})}).finally(function($){e.showLoading=!1,e.loading=!1})}}},st=H,X=t(50),rt=t(51),z=t.n(rt),it=t(164),Z=t(576),lt=t(247),w=t(249),ct=t(165),J=t(35),dt=t(577),k=t(246),ut=t(243),q=t(593),Q=Object(X.a)(st,P,A,!1,null,null,null),_t=D.default=Q.exports;z()(Q,{AccountingDialogLedger:t(652).default}),z()(Q,{VBtn:it.a,VDivider:Z.a,VIcon:lt.a,VList:w.a,VListItem:ct.a,VListItemContent:J.a,VListItemTitle:J.c,VMenu:dt.a,VOverlay:k.a,VProgressCircular:ut.a,VSpacer:q.a})},599:function(Y,D,t){"use strict";var P=t(7),A=t.n(P),U=t(9),K=t.n(U),T=t(12),W=t.n(T),I=t(13),C=t.n(I),h=t(2),E=t(4),V=t.n(E),x=t(33),M=t.n(x),S=t(52),j=t.n(S),n=t(28),s=t.n(n),r=t(8),v=t.n(r),y=t(21),O=t.n(y),N=t(65),G=t.n(N),H=t(269),st=t.n(H),X=t(32),rt=t.n(X),z=t(270),it=t.n(z),Z=t(271),lt=t.n(Z),w=t(272),ct=t.n(w),J=t(273),dt=t.n(J),k=t(274),ut=t.n(k),q=t(275),Q=t.n(q),_t=t(276),l=t.n(_t),a=t(277),e=t.n(a),o=t(278),d=t.n(o),c=t(279),g=t.n(c),p=t(280),B=t.n(p),L=t(281),$=t.n(L),_=t(282),mt=t.n(_),vt=t(34),Wt=t.n(vt),Mt=t(10),Vt=t.n(Mt),Lt=t(283),St=t.n(Lt),At=t(3),Tt=t(78),It=t(1);function ft(f,u){var m=Object.keys(f);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(f);u&&(i=i.filter(function(F){return Object.getOwnPropertyDescriptor(f,F).enumerable})),m.push.apply(m,i)}return m}function tt(f){for(var u=1;u<arguments.length;u++){var m=arguments[u]!=null?arguments[u]:{};u%2?ft(Object(m),!0).forEach(function(i){Object(h.a)(f,i,m[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(m)):ft(Object(m)).forEach(function(i){Object.defineProperty(f,i,Object.getOwnPropertyDescriptor(m,i))})}return f}var xt=["sm","md","lg","xl"],et=["start","end","center"];function at(f,u){return xt.reduce(function(m,i){return m[f+Object(It.I)(i)]=u(),m},{})}var gt=function(u){return[].concat(et,["baseline","stretch"]).includes(u)},pt=at("align",function(){return{type:String,default:null,validator:gt}}),Dt=function(u){return[].concat(et,["space-between","space-around"]).includes(u)},ht=at("justify",function(){return{type:String,default:null,validator:Dt}}),Et=function(u){return[].concat(et,["space-between","space-around","stretch"]).includes(u)},yt=at("alignContent",function(){return{type:String,default:null,validator:Et}}),Ot={align:Object.keys(pt),justify:Object.keys(ht),alignContent:Object.keys(yt)},Bt={align:"align",justify:"justify",alignContent:"align-content"};function $t(f,u,m){var i=Bt[f];if(m!=null){if(u){var F=u.replace(f,"");i+="-".concat(F)}return i+="-".concat(m),i.toLowerCase()}}var jt=new Map;D.a=At.default.extend({name:"v-row",functional:!0,props:tt(tt(tt({tag:{type:String,default:"div"},dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:gt}},pt),{},{justify:{type:String,default:null,validator:Dt}},ht),{},{alignContent:{type:String,default:null,validator:Et}},yt),render:function(u,m){var i=m.props,F=m.data,Rt=m.children,nt="";for(var Ut in i)nt+=String(i[Ut]);var R=jt.get(nt);return R||function(){var b;R=[];var ot;for(ot in Ot)Ot[ot].forEach(function(Pt){var Kt=i[Pt],Ct=$t(ot,Pt,Kt);Ct&&R.push(Ct)});R.push((b={"no-gutters":i.noGutters,"row--dense":i.dense},Object(h.a)(b,"align-".concat(i.align),i.align),Object(h.a)(b,"justify-".concat(i.justify),i.justify),Object(h.a)(b,"align-content-".concat(i.alignContent),i.alignContent),b)),jt.set(nt,R)}(),u(i.tag,Object(Tt.a)(F,{staticClass:"row",class:R}),Rt)}})},601:function(Y,D,t){"use strict";t.r(D);var P=function(){var r=this,v=r._self._c;return v("v-dialog",{attrs:{"no-click-animation":"",persistent:"",scrollable:"",origin:r.original,"max-width":r.maxWidth,transition:"dialog-top-transition"},model:{value:r.dialog,callback:function(O){r.dialog=O},expression:"dialog"}},[v("v-card",[v("v-card-title",[v("span",{staticClass:"subtitle-2"},[r._v(r._s(r.dialogTitle))]),r._v(" "),v("v-spacer"),r._v(" "),v("v-btn",{attrs:{icon:"",color:"red",dark:""},on:{click:function(O){return r.closeDialog()}}},[v("v-icon",[r._v("mdi-close-circle")])],1)],1),r._v(" "),v("v-divider"),r._v(" "),v("v-card-text",{staticClass:"pr-0 pl-0"},[r._t("content")],2),r._v(" "),v("v-divider"),r._v(" "),v("v-card-actions",[r._t("addLine"),r._v(" "),v("v-spacer"),r._v(" "),r._t("saveData")],2)],1)],1)},A=[],U={name:"DialogForm",props:{maxWidth:{type:String,default:"800px"},dialogTitle:{type:String,default:""},original:{type:String,default:null}},data:function(){return{dialog:!1}},methods:{addLine:function(){this.$emit("addLine")},openDialog:function(){this.dialog=!0},closeDialog:function(){this.dialog=!1,this.$emit("eventCloseDialog")},saveData:function(){this.$emit("saveData")}}},K=U,T=t(50),W=t(51),I=t.n(W),C=t(164),h=t(248),E=t(88),V=t(595),x=t(576),M=t(247),S=t(593),j=Object(T.a)(K,P,A,!1,null,null,null),n=D.default=j.exports;I()(j,{VBtn:C.a,VCard:h.a,VCardActions:E.a,VCardText:E.b,VCardTitle:E.c,VDialog:V.a,VDivider:x.a,VIcon:M.a,VSpacer:S.a})},652:function(Y,D,t){"use strict";t.r(D);var P=function(){var n=this,s=n._self._c;return s("div",[s("DialogForm",{ref:"dialogForm",attrs:{"max-width":"1200px","dialog-title":n.$t("Journal Entry"),"button-title":"Save",original:"top"},scopedSlots:n._u([{key:"content",fn:function(){return[s("v-container",[s("v-row",[s("v-col",{staticClass:"mt-0",attrs:{cols:"12"}},[s("v-data-table",{staticClass:"elevation-0",attrs:{"mobile-breakpoint":0,headers:n.headers,items:n.allData,"items-per-page":150,options:n.options,"server-items-length":n.totalData,loading:n.loading,"show-select":"","fixed-header":"",height:"60vh","hide-default-footer":"",dense:"","footer-props":{"items-per-page-options":[150,250,500,-1]}},on:{"update:options":function(y){n.options=y}},scopedSlots:n._u([{key:"item.amount_credit",fn:function(y){var O=y.item;return[O.amount_credit?s("span",[n._v(`
                    `+n._s(n.$auth.user.entity.currency.currency_symbol+" "+n.$formatter.formatPrice(O.amount_credit))+`
                  `)]):n._e()]}},{key:"item.amount_debit",fn:function(y){var O=y.item;return[O.amount_debit?s("span",[n._v(`
                    `+n._s(n.$auth.user.entity.currency.currency_symbol+" "+n.$formatter.formatPrice(O.amount_debit))+`
                  `)]):n._e()]}},{key:"body.append",fn:function(){return[s("tr",{staticClass:"black--text"},[s("th",{staticClass:"title"}),n._v(" "),s("th",{staticClass:"title"}),n._v(" "),s("th",{staticClass:"title"}),n._v(" "),s("th",{staticClass:"title"}),n._v(" "),s("th",{staticClass:"title"}),n._v(" "),s("th",{staticClass:"title"}),n._v(" "),s("th",{staticClass:"title text-right"},[n._v(`
                      `+n._s(n.$auth.user.entity.currency.currency_symbol+" "+n.$formatter.formatPrice(n.sumField("amount_debit")))+`
                    `)]),n._v(" "),s("th",{staticClass:"title text-right"},[n._v(`
                      `+n._s(n.$auth.user.entity.currency.currency_symbol+" "+n.$formatter.formatPrice(n.sumField("amount_credit")))+`
                    `)])]),n._v(" "),s("tr",[s("td",[n._v("Notes: ")]),n._v(" "),s("td",{attrs:{colspan:"3"}},[s("strong",[n._v(n._s(n.transaction.narration))])])])]},proxy:!0}],null,!0)})],1)],1)],1)]},proxy:!0}])})],1)},A=[],U=t(4),K={name:"DialogItem",props:{viewData:{type:Boolean,default:!0},showAddBtn:{type:Boolean,default:!0}},data:function(){return{row:null,url:"",allData:[],transaction:[],totalData:0,loading:!1,options:{},headers:[{text:"Reference",value:"reference"},{text:"Posting Date",value:"posting_date"},{text:"Account Code",value:"post_account.code"},{text:"Account Category",value:"post_account.account_type"},{text:"Account Name",value:"post_account.name"},{text:"Debit",value:"amount_debit",class:"text-center",cellClass:"disable-wrap text-right"},{text:"Credit",value:"amount_credit",class:"text-center",cellClass:"disable-wrap text-right"}]}},methods:{sumField:function(n){return this.allData.reduce(function(s,r){return parseFloat(s)+parseFloat(r[n]||0)},0)},openDialog:function(n){this.$refs.dialogForm.openDialog(),this.url=n,this.getDataFromApi()},getDataFromApi:function(){var n=this;this.loading=!0,this.$axios.get(this.url).then(function(s){n.loading=!1;var r=s.data;n.allData=r.data,n.transaction=r.transaction,n.totalData=r.total}).catch(function(s){n.loading=!1,n.$swal({type:"error",title:"Error",text:s.response.data.message})})}}},T=K,W=t(50),I=t(51),C=t.n(I),h=t(585),E=t(586),V=t(909),x=t(599),M=Object(W.a)(T,P,A,!1,null,null,null),S=D.default=M.exports;C()(M,{DialogForm:t(601).default}),C()(M,{VCol:h.a,VContainer:E.a,VDataTable:V.a,VRow:x.a})}}]);
