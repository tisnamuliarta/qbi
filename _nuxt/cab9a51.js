(window.webpackJsonp=window.webpackJsonp||[]).push([[175,18,52],{1049:function(O,c,s){"use strict";s.r(c);var D=function(){var t=this,o=t.$createElement,a=t._self._c||o;return a("v-layout",[a("v-flex",{attrs:{sm12:""}},[a("div",{staticClass:"mt-0"},[a("v-data-table",{staticClass:"elevation-1",attrs:{"mobile-breakpoint":0,headers:t.headers,items:t.allData,"items-per-page":20,options:t.options,"server-items-length":t.totalData,loading:t.loading,"footer-props":{"items-per-page-options":[20,50,100,-1]},"show-select":"",dense:"","fixed-header":"",height:"70vh"},on:{"update:options":function(r){t.options=r}},scopedSlots:t._u([{key:"top",fn:function(){return[a("div",{staticClass:"pl-4 pt-2"},[a("span",{staticClass:"font-weight-medium text-h6"},[t._v("Users")])]),t._v(" "),a("LazyMainToolbar",{staticClass:"has-border-bottom",attrs:{"document-status":t.documentStatus,"search-status":t.searchStatus,"item-search":t.itemSearch,"search-item":t.searchItem,search:t.search,filter:!1,title:"Users","title-button":"User","show-back-link":"","show-new-data":"","show-batch-action":"","new-data-text":"New User"},on:{emitData:t.emitData,newData:t.newData,getDataFromApi:t.getDataFromApi}})]},proxy:!0},{key:"item.Action",fn:function(r){var h=r.item;return[a("v-btn",{staticClass:"font-weight-bold text-right",attrs:{color:"secondary",text:"",small:""},on:{click:function(m){return t.actions(t.itemAction,h)}}},[t._v(`
            `+t._s(t.itemText)+`
          `)]),t._v(" "),a("v-menu",{attrs:{transition:"slide-y-transition",bottom:""},scopedSlots:t._u([{key:"activator",fn:function(m){var A=m.on,p=m.attrs;return[a("v-btn",t._g(t._b({attrs:{color:"black",dark:"",icon:""}},"v-btn",p,!1),A),[a("v-icon",[t._v("mdi-menu-down")])],1)]}}],null,!0)},[t._v(" "),a("v-list",t._l(t.items,function(m,A){return a("v-list-item",{key:A,on:{click:function(p){return t.actions(m.action,h)}}},[a("v-list-item-content",[a("v-list-item-title",[t._v(t._s(m.text))])],1)],1)}),1)],1)]}}],null,!0)})],1)]),t._v(" "),a("DialogForm",{ref:"dialogForm",attrs:{"max-width":"600px","dialog-title":t.formTitle,"button-title":"Save"},scopedSlots:t._u([{key:"content",fn:function(){return[a("v-form",[a("v-layout",{attrs:{wrap:""}},[a("v-flex",{staticClass:"d-flex",attrs:{md12:""}},[a("v-layout",{attrs:{wrap:""}},[a("v-flex",{staticClass:"pa-2",attrs:{xs12:""}},[a("v-text-field",{attrs:{label:"Name",placeholder:"Name",outlined:"",dense:"",clearable:"","hide-details":"auto"},model:{value:t.form.name,callback:function(r){t.$set(t.form,"name",r)},expression:"form.name"}})],1),t._v(" "),a("v-flex",{staticClass:"pa-2",attrs:{xs12:""}},[a("v-text-field",{attrs:{label:"Username",placeholder:"Username",outlined:"",dense:"",clearable:"","hide-details":"auto"},model:{value:t.form.username,callback:function(r){t.$set(t.form,"username",r)},expression:"form.username"}})],1),t._v(" "),a("v-flex",{staticClass:"pa-2",attrs:{xs12:""}},[a("v-text-field",{attrs:{label:"E-mail",placeholder:"E-mail",outlined:"",dense:"",clearable:"","hide-details":"auto"},model:{value:t.form.email,callback:function(r){t.$set(t.form,"email",r)},expression:"form.email"}})],1),t._v(" "),a("v-flex",{staticClass:"pa-2",attrs:{xs12:""}},[a("v-autocomplete",{attrs:{items:t.itemRole,chips:"","deletable-chips":"","hide-no-data":"","small-chips":"",label:"Role",multiple:"",outlined:"",dense:"","hide-details":"auto"},model:{value:t.form.role,callback:function(r){t.$set(t.form,"role",r)},expression:"form.role"}})],1),t._v(" "),a("v-flex",{staticClass:"pa-2",attrs:{xs12:""}},[a("v-select",{attrs:{items:t.itemEntity,"hide-no-data":"",label:"Company",outlined:"",dense:"","item-text":"name","item-value":"id","hide-details":"auto",clearable:""},model:{value:t.form.entity_id,callback:function(r){t.$set(t.form,"entity_id",r)},expression:"form.entity_id"}})],1),t._v(" "),a("v-flex",{staticClass:"pa-2",attrs:{xs12:""}},[a("v-switch",{attrs:{inset:"",label:"Enabled"},model:{value:t.form.enabled,callback:function(r){t.$set(t.form,"enabled",r)},expression:"form.enabled"}})],1)],1)],1)],1)],1)]},proxy:!0},{key:"saveData",fn:function(){return[a("v-btn",{attrs:{color:"green darken-1",small:"",dark:"",loading:t.submitLoad},on:{click:function(r){return t.save()}}},[t._v(`
        Save
      `)])]},proxy:!0}])}),t._v(" "),a("MasterDialogPermission",{ref:"dialogPermission"})],1)},x=[],R=s(59),S=s(21),b=s(283),F=s(9),T=s(4),y={name:"MasterUser",data:function(){return{totalData:0,editedIndex:-1,loadNewBtn:!1,submitLoad:!1,statusProcessing:"insert",show:!1,dialog:!1,message:!1,loading:!0,loadingSync:!1,searchItem:"",searchRole:"",search:"",searchStatus:"",items:[{text:"Edit",action:"edit"},{text:"Copy",action:"copy"},{text:"Direct Permissions",action:"permissions"}],itemText:"",itemAction:"",allData:[],itemRole:[],itemEntity:{},itemSearch:[],documentStatus:[],options:{},sub_id:{},url:"",form:{},defaultForm:{},headers:[{text:"Username",value:"username"},{text:"Name",value:"name"},{text:"Email",value:"email"},{text:"Enabled",value:"enabled"},{text:"Role",value:"role"},{text:"Action",value:"Action",align:"end"}]}},head:function(){return{title:"Master Users"}},computed:{formTitle:function(){return this.editedIndex===-1?"New User":"Edit User"}},watch:{options:{handler:function(){this.getDataFromApi()},deep:!0}},activated:function(){var o=this;setTimeout(function(){o.refreshData()},500),this.itemText=this.items[0].text,this.itemAction=this.items[0].action},methods:{changeEntity:function(){},actions:function(o,a){o==="edit"?this.editItem(a):o==="copy"?this.copyItem(a):this.$refs.dialogPermission.openDialogPermission(a,"Direct Permissions")},emitData:function(o){this.documentStatus=o.documentStatus,this.itemSearch=o.itemSearch,this.searchStatus=o.searchStatus,this.searchItem=o.searchItem,this.search=o.search,this.filters=o.filters,this.getDataFromApi()},refreshData:function(){this.getDataFromApi(),this.getRole(),this.getEntity()},getRole:function(){var o=this;this.$axios.get("/api/master/roles").then(function(a){o.itemRole=a.data.data.simple}).catch(function(a){o.$swal({type:"error",title:"Error",text:a.response.data.message})})},getEntity:function(){var o=this;this.$axios.get("/api/entities").then(function(a){o.itemEntity=a.data.data.simple}).catch(function(a){o.$swal({type:"error",title:"Error",text:a.response.data.message})})},getDataFromApi:function(){var o=this;this.loading=!0;var a=this;this.$axios.get("/api/master/users",{params:{options:a.options,searchItem:a.searchItem,documentStatus:a.documentStatus,searchStatus:a.searchStatus,search:a.search}}).then(function(r){o.loading=!1,o.allData=r.data.data.rows,o.totalData=r.data.data.total,o.itemSearch=r.data.data.filter,o.form=Object.assign({},r.data.data.form),o.defaultForm=Object.assign({},r.data.data.form)}).catch(function(r){o.loading=!1,o.$swal({type:"error",title:"Error",text:r.response.data.message})})},newData:function(){var o=this;this.$refs.dialogForm.openDialog(),setTimeout(function(){o.form=Object.assign({},o.defaultForm),o.editedIndex=-1},300),this.statusProcessing="insert"},editItem:function(o){var a=o;a.role=JSON.parse(a.role),this.statusProcessing="update",this.editedIndex=this.allData.indexOf(o),this.form=Object.assign({},a),this.$refs.dialogForm.openDialog(),this.insert=!1},copyItem:function(o){var a=o;a.role=JSON.parse(a.role),this.statusProcessing="copy",this.editedIndex=this.allData.indexOf(o),this.form=Object.assign({},a),this.$refs.dialogForm.openDialog(),this.insert=!1},close:function(){var o=this;this.statusProcessing="insert",this.dialog=!1,setTimeout(function(){o.form=Object.assign({},o.defaultForm),o.editedIndex=-1},300)},save:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"all",a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=this,h=this.form,m=this.statusProcessing;r.submitLoad=!0,m==="insert"?this.store("post","/api/master/users",h,"insert",o):m==="copy"?this.store("post","/api/master/users",h,"insert",o):m==="update"&&this.store("put","/api/master/users/"+this.form.id,h,"update",o)},store:function(o,a,r,h){var m=this,A=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"all",p=this;p.submitLoad=!0,this.$axios({method:o,url:a,data:r}).then(function(U){m.dialog=!1,m.$swal({type:"success",title:"Success!",text:U.data.message}),m.$refs.dialogForm.closeDialog(),m.getDataFromApi(),p.submitLoad=!1}).catch(function(U){m.$swal({type:"error",title:"Error",text:U.response.data.message}),p.submitLoad=!1})}}},P=y,u=s(50),v=s(51),g=s.n(v),V=s(643),$=s(164),f=s(1018),E=s(617),e=s(612),n=s(246),i=s(615),l=s(248),d=s(165),I=s(34),C=s(573),L=s(637),N=s(1e3),M=s(570),j=Object(u.a)(P,D,x,!1,null,null,null),B=c.default=j.exports;g()(j,{DialogForm:s(613).default,MasterDialogPermission:s(639).default}),g()(j,{VAutocomplete:V.a,VBtn:$.a,VDataTable:f.a,VFlex:E.a,VForm:e.a,VIcon:n.a,VLayout:i.a,VList:l.a,VListItem:d.a,VListItemContent:I.b,VListItemTitle:I.d,VMenu:C.a,VSelect:L.a,VSwitch:N.a,VTextField:M.a})},613:function(O,c,s){"use strict";s.r(c);var D=function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("v-dialog",{attrs:{"no-click-animation":"",persistent:"",scrollable:"",origin:e.original,"max-width":e.maxWidth,transition:"dialog-top-transition"},model:{value:e.dialog,callback:function(l){e.dialog=l},expression:"dialog"}},[i("v-card",[i("v-card-title",[i("span",{staticClass:"subtitle-2"},[e._v(e._s(e.dialogTitle))]),e._v(" "),i("v-spacer"),e._v(" "),i("v-btn",{attrs:{icon:"",color:"red",dark:""},on:{click:function(l){return e.closeDialog()}}},[i("v-icon",[e._v("mdi-close-circle")])],1)],1),e._v(" "),i("v-divider"),e._v(" "),i("v-card-text",{staticClass:"pr-0 pl-0"},[e._t("content")],2),e._v(" "),i("v-divider"),e._v(" "),i("v-card-actions",[e._t("addLine"),e._v(" "),i("v-spacer"),e._v(" "),e._t("saveData")],2)],1)],1)},x=[],R={name:"DialogForm",props:{maxWidth:{type:String,default:"800px"},dialogTitle:{type:String,default:""},original:{type:String,default:null}},data:function(){return{dialog:!1}},methods:{addLine:function(){this.$emit("addLine")},openDialog:function(){this.dialog=!0},closeDialog:function(){this.dialog=!1,this.$emit("eventCloseDialog")},saveData:function(){this.$emit("saveData")}}},S=R,b=s(50),F=s(51),T=s.n(F),y=s(164),P=s(247),u=s(88),v=s(591),g=s(572),V=s(246),$=s(589),f=Object(b.a)(S,D,x,!1,null,null,null),E=c.default=f.exports;T()(f,{VBtn:y.a,VCard:P.a,VCardActions:u.a,VCardText:u.b,VCardTitle:u.c,VDialog:v.a,VDivider:g.a,VIcon:V.a,VSpacer:$.a})},639:function(O,c,s){"use strict";s.r(c);var D=function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("v-dialog",{attrs:{persistent:"","max-width":"1000px",transition:"dialog-bottom-transition"},model:{value:e.dialogPermission,callback:function(l){e.dialogPermission=l},expression:"dialogPermission"}},[i("v-card",{attrs:{loading:e.loadingPermission}},[i("v-card-title",[i("span",{staticClass:"subtitle-2"},[e._v(`
        `+e._s(e.dialogTitle)+`
      `)]),e._v(" "),i("v-spacer"),e._v(" "),i("v-btn",{attrs:{color:"red darken-1",dark:"",icon:"",small:""},on:{click:e.closeDialogPermission}},[i("v-icon",[e._v("mdi-close-circle")])],1)],1),e._v(" "),i("v-card-text",[i("div",{staticClass:"scroll-container"},[i("LazyMasterPermissionList",{ref:"childDetails"})],1)]),e._v(" "),i("v-card-actions",[e.canAddData?i("v-btn",{staticClass:"white--text",attrs:{small:"",color:"orange darken-1"},on:{click:function(l){return e.$refs.childDetails.addLine()}}},[e._v(`
        Add Line
      `)]):e._e(),e._v(" "),i("v-spacer"),e._v(" "),e.canAddData?i("v-btn",{attrs:{color:"green darken-1",dark:"",small:"",loading:e.loadingPermission},on:{click:function(l){return e.saveRolePermission()}}},[e._v(`
        Save
      `)]):e._e()],1)],1)],1)},x=[],R=s(4),S={name:"DialogPermission",data:function(){return{loadingPermission:!1,dialogPermission:!1,dialogTitle:"",role:"",userRole:[],form:{},canAddData:!1,type:""}},mounted:function(){this.getPermissionList()},methods:{getPermissionList:function(){var n=this;this.$axios.get("/api/master/permissions").then(function(i){n.$auth.$storage.setLocalStorage("permission_list",i.data.data.simple)})},openDialogPermission:function(n,i){this.dialogTitle=i,this.dialogPermission=!0,this.loadingPermission=!0,this.form=Object.assign({},n),this.canAddData=!0,this.getPermissionUser(n),this.type="user"},getPermissionUser:function(n){var i=this;this.userRole=null,this.$axios.get("/api/master/user/permission",{params:{form:n}}).then(function(l){i.$refs.childDetails.setDataToDetails(l.data.data.rows)}).finally(function(l){i.loadingPermission=!1})},closeDialogPermission:function(){this.dialogPermission=!1,this.userRole=[],this.canAddData=!1},openRolePermissions:function(n,i,l){var d=this,I=this;this.type=l,this.dialogTitle=i,this.dialogPermission=!0,this.loadingPermission=!0,this.form=Object.assign({},n);var C="";l==="user"?C="/api/master/user/roles":(this.canAddData=!0,C="/api/master/permission-role"),this.$axios.get(C,{params:{form:this.form}}).then(function(L){I.$refs.childDetails.setDataToDetails(L.data.data.rows),d.loadingPermission=!1}).finally(function(L){d.loadingPermission=!1})},changeTab:function(n){var i=this;this.loadingPermission=!0,this.$axios.post("/api/master/permission-role",{form:n}).then(function(l){i.$refs.childDetails.setDataToDetails(l.data.data.rows)}).finally(function(l){i.loadingPermission=!1})},getRolePermissionUser:function(n){var i=this;this.$axios.post("/api/master/user/role-permission",{item:n}).then(function(l){i.$refs.childDetails.setDataToDetails(l.data.data.rows)}).finally(function(l){i.loadingPermission=!1})},getPermissionRole:function(n){var i=this;this.$axios.post("/api/master/permission-role",{form:this.form}).then(function(l){i.$refs.childDetails.setDataToDetails(l.data.data.rows)}).finally(function(l){i.loadingPermission=!1})},saveRolePermission:function(){var n=this;this.loadingPermission=!0;var i=this.$refs.childDetails.getAddData(),l="";this.type==="user"?l="/api/master/user/permission":l="/api/master/permission-role",this.$axios.post(l,{details:i,form:this.form}).then(function(d){n.$swal({icon:"success",title:"Success",text:d.data.message}),n.type==="user"?n.getPermissionUser(n.form):n.getPermissionRole(n.form)}).catch(function(d){n.$swal({icon:"error",title:"Error",text:d.response.data.message})}).finally(function(d){n.loadingPermission=!1})}}},b=S,F=s(50),T=s(51),y=s.n(T),P=s(164),u=s(247),v=s(88),g=s(591),V=s(246),$=s(589),f=Object(F.a)(b,D,x,!1,null,null,null),E=c.default=f.exports;y()(f,{VBtn:P.a,VCard:u.a,VCardActions:v.a,VCardText:v.b,VCardTitle:v.c,VDialog:g.a,VIcon:V.a,VSpacer:$.a})}}]);
