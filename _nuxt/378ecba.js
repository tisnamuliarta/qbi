(window.webpackJsonp=window.webpackJsonp||[]).push([[245],{757:function(T,d,o){"use strict";o.r(d);var p=function(){var i=this,s=i._self._c;return s("v-timeline",{attrs:{dense:""}},i._l(i.action,function(c){return s("v-timeline-item",{key:c.title,attrs:{small:"",color:c.color}},[s("v-card",{staticClass:"elevation-2"},[s("v-card-text",{staticClass:"pa-2"},[s("span",{staticClass:"font-weight-bold"},[i._v(i._s(c.title))]),i._v(" "),s("v-divider"),i._v(" "),c.title!=="Clone"&&c.title!=="Cancel"?s("div",[s("span",[i._v("No : no")]),i._v(" "),s("br"),i._v(" "),s("span",[i._v("Date : no")]),i._v(" "),s("br"),i._v(" "),s("span",[i._v("Status : no")]),i._v(" "),s("br")]):i._e()],1),i._v(" "),c.button?s("v-card-actions",[s("v-btn",{staticClass:"white--text",attrs:{disabled:c.button,"x-small":"",color:c.color},on:{click:function(I){return i.processAction(c.action)}}},[c.title==="Clone"||c.title==="Cancel"?s("span",{domProps:{textContent:i._s(c.title)}}):s("span",[i._v("Create")])])],1):i._e()],1)],1)}),1)},g=[],x={name:"CardAction",props:{title:{type:String,default:""}},data:function(){return{loading:!0,checkDisable:!1,action:[]}},methods:{setAction:function(i,s){this.checkDisable=s,this.action=i},processAction:function(i){}}},C=x,V=o(50),L=o(51),w=o.n(L),k=o(164),y=o(248),v=o(88),D=o(576),b=o(806),f=o(807),h=Object(V.a)(C,p,g,!1,null,null,null),S=d.default=h.exports;w()(h,{VBtn:k.a,VCard:y.a,VCardActions:v.a,VCardText:v.b,VDivider:D.a,VTimeline:b.a,VTimelineItem:f.a})},915:function(T,d,o){"use strict";o.r(d);var p=function(){var t=this,e=t._self._c;return e("v-row",[e("v-col",{attrs:{cols:"12",md:t.itemAction.length>0?"10":"12"}},[e("DocumentFormWindow",{ref:"formWindow",attrs:{breadcrumb:t.breadcrumb},on:{getDataFromApi:t.getDataFromApi},scopedSlots:t._u([{key:"action-toolbar",fn:function(){return[e("v-btn",{attrs:{text:"",small:""},on:{click:function(a){return t.arrowLink("prev",t.form.type)}}},[e("v-icon",[t._v("mdi-arrow-left")]),t._v(" "),e("span",[t._v("Prev")])],1),t._v(" "),e("v-btn",{attrs:{text:"",small:""},on:{click:function(a){return t.arrowLink("next",t.form.type)}}},[e("v-icon",[t._v("mdi-arrow-right")]),t._v(" "),e("span",[t._v("Next")])],1),t._v(" "),e("v-btn",{attrs:{icon:"",small:""},on:{click:function(a){return t.$refs.dialogAudit.openDialogAudit(t.audits)}}},[e("v-icon",[t._v("mdi-history")])],1),t._v(" "),e("v-btn",{attrs:{color:"green",dark:"",icon:"",small:""},on:{click:t.getDataFromApi}},[e("v-icon",[t._v("mdi-refresh")])],1)]},proxy:!0},{key:"content",fn:function(){return[e("v-row",{directives:[{name:"show",rawName:"v-show",value:t.showLoading,expression:"showLoading"}],attrs:{"no-gutters":""}},[e("v-col",{attrs:{cols:"12"}},[e("v-skeleton-loader",{attrs:{type:"list-item-three-line, table-thead, table-tbody, list-item-three-line"}})],1)],1),t._v(" "),e("LazyDocumentFormInput",{directives:[{name:"show",rawName:"v-show",value:!t.showLoading,expression:"!showLoading"}],ref:"formDocument"})]},proxy:!0},{key:"action",fn:function(){return[e("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(a){var m=a.attrs,A=a.on;return[e("v-btn",t._g(t._b({staticClass:"white--text",attrs:{color:"green",disabled:t.checkDisable(),small:""}},"v-btn",m,!1),A),[t._v(`
                Print & Preview
                `),e("v-icon",{attrs:{right:"",dark:""}},[t._v(`
                  mdi-printer
                `)])],1)]}}])},[t._v(" "),e("v-list",{attrs:{dense:""}},t._l(t.items,function(n){return e("v-list-item",{key:n.title,attrs:{dense:"",link:""},on:{click:function(m){return t.printAction(n.action)}}},[e("v-list-item-icon",[e("v-icon",{domProps:{textContent:t._s(n.icon)}})],1),t._v(" "),e("v-list-item-content",[e("v-list-item-title",{domProps:{textContent:t._s(n.title)}})],1)],1)}),1)],1),t._v(" "),e("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(a){var m=a.attrs,A=a.on;return[e("v-btn",t._g(t._b({staticClass:"white--text ml-5",attrs:{color:"green",disabled:t.checkDisable(),small:""}},"v-btn",m,!1),A),[t._v(`
                Action
                `),e("v-icon",{attrs:{right:"",dark:""}},[t._v(`
                  mdi-folder-cog
                `)])],1)]}}])},[t._v(" "),e("v-list",t._l(t.itemAction,function(n){return e("v-list-item",{key:n.title,attrs:{dense:"",link:""},on:{click:function(m){return t.actionDocument(n.action)}}},[e("v-list-item-icon",[e("v-icon",{domProps:{textContent:t._s(n.icon)}})],1),t._v(" "),e("v-list-item-content",[e("v-list-item-title",{domProps:{textContent:t._s(n.title)}})],1)],1)}),1)],1)]},proxy:!0},{key:"saveData",fn:function(){return[e("v-btn",{staticClass:"white--text",attrs:{color:"green darken-1",disabled:t.checkDisable(),small:""},on:{click:t.store}},[t._v(`
            `+t._s(t.actionName)+`
            `),e("v-icon",[t._v(`
              mdi-check
            `)])],1)]},proxy:!0}])})],1),t._v(" "),t.itemAction.length>0?e("v-col",{attrs:{cols:"12",md:"2"}},[e("v-subheader",{staticStyle:{"margin-top":"-20px"}},[t._v("Action")]),t._v(" "),e("DocumentCardAction",{ref:"documentAction"})],1):t._e(),t._v(" "),e("LazyDocumentDialogSendEmail",{ref:"dialogSendEmail"}),t._v(" "),e("LazyDocumentDialogAudit",{ref:"dialogAudit"}),t._v(" "),t.dialogLoading?e("LazySpinnerLoading",{ref:"spinnerLoadingImport"}):t._e()],1)},g=[],x=o(59),C=o(4),V=o(32),L=o(34),w=o(668),k=o(293),y={name:"FormDocument",layout:"dashboard",data:function(){return{breadcrumb:[],form:{},audits:{},defaultItem:{},url:"/api/documents/form",dialogLoading:!1,showLoading:!1,itemAction:[],actionName:"Save",items:[{title:"Preview",action:"preview",icon:"mdi-printer"},{title:"Send Email",action:"sendEmail",icon:"mdi-email"}]}},head:function(){return{title:"Form Document"}},created:function(){this.getDataFromApi()},methods:{checkDisable:function(){return this.form.status==="closed"||this.form.status==="cancel"},arrowLink:function(t,e){var r=this;this.$axios.get(this.url+"/arrow",{params:{type:e,status:t,document:this.$route.query.document}}).then(function(n){r.$router.push({path:"/dashboard/documents/form",query:{document:n.data.data.id,type:e}}),setTimeout(function(){r.getDataFromApi()},300)}).catch(function(n){r.$swal({type:"error",title:"Error",text:n.response.data.message})})},getDataFromApi:function(t){var e=this;this.showLoading=!0;var r=this.$route.query.type;this.$axios.get(this.url+"/"+this.$route.query.document,{params:{type:r,copyFromId:t}}).then(function(n){var a="";e.audits=n.data.data.audits,n.data.data.count>0?(a=n.data.data.rows,e.actionName="Update"):(a=n.data.data.form,e.actionName="Save"),e.form=Object.assign({},a),e.defaultItem=Object.assign({},a),n.data.data.count>0&&(e.itemAction=n.data.data.action,setTimeout(function(){e.$refs.documentAction.setAction(e.itemAction,e.checkDisable())},50)),e.getBreadcrumb(r,a,a.status),setTimeout(function(){e.$refs.formDocument.setData(e.form)},30)}).catch(function(n){var a=n.response!==void 0?n.response.data.message:n;e.$swal({type:"error",title:"Error",text:a})}).finally(function(n){e.showLoading=!1})},actionDocument:function(t){var e=this;switch(t){case"SQ":case"SO":case"PQ":case"PO":var r=this.$route.query.document;this.$router.push({path:"/dashboard/documents/form",query:{document:0,type:t}}),setTimeout(function(){e.actionName="Save",e.getBreadcrumb(t,e.form,e.form.status),e.$refs.formDocument.changeValue("type",t),e.$refs.formDocument.changeValue("parent_id",r)},300);break;case"C":this.$refs.formDocument.changeValue("status","cancel"),this.store();break;case"sendEmail":this.openDialogEmail();break}},deleteDocument:function(t){var e=this,r=this;this.$swal({title:"Are you sure?",text:"The data will be deleted",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(function(n){n.value&&e.$axios.delete(e.url+"/"+t).then(function(a){e.$swal({type:"success",title:"Success...",text:"Data Deleted!"}),e.$router.push({path:r.$helper.mappingAction(r.$route.query.type)})}).catch(function(a){e.$swal({type:"error",title:"Oops...",text:a.response.data.message})})})},printAction:function(t){switch(t){case"preview":this.previewDocument();break;case"sendEmail":this.openDialogEmail();break}},openDialogEmail:function(){this.$refs.dialogSendEmail.openEmailDialog(this.form)},previewDocument:function(){var t=this,e=this;this.dialogLoading=!0,this.$axios.get("/api/documents/print",{params:{id:e.form.id},responseType:"arraybuffer"}).then(function(r){t.dialogLoading=!1;var n=window.URL.createObjectURL(new Blob([r.data])),a=document.createElement("a");a.href=n,a.setAttribute("download",e.form.document_number+".pdf"),document.body.appendChild(a),a.click()}).catch(function(r){t.dialogLoading=!1,t.$swal({type:"error",title:"Error",text:r.response.data.message})})},getBreadcrumb:function(t,e,r){var n=this.$route.query.document!=="0"?e.document_number:"Create Document";this.breadcrumb=[{text:"Dashboard",disabled:!1,to:{path:"/dashboard"}},{text:this.$helper.mapping(t),disabled:!1,to:{path:this.$helper.mappingAction(t)}},{text:n,disabled:!0,to:{path:"/dashboard/documents/form"}}]},mappingType:function(t){switch(t){case"SQ":return"/dashboard/sales/quote"}},store:function(){var t=this,e=this.$route.query.document==="0"?"post":"patch",r=this.$route.query.document==="0"?this.url:this.url+"/"+this.$route.query.document,n=this.$refs.formDocument.returnData(this.$route.query.document);this.dialogLoading=!0,this.$axios({method:e,url:r,data:n}).then(function(a){t.$router.push({path:"/dashboard/documents/form",query:{document:a.data.data.id,type:a.data.data.type}}),t.$nuxt.$emit("snackbar",a.data.message),setTimeout(function(){t.getDataFromApi()},50)}).catch(function(a){t.$swal({type:"error",title:"Error",text:a.response.data.message})}).finally(function(a){t.dialogLoading=!1})}}},v=y,D=o(50),b=o(51),f=o.n(b),h=o(164),S=o(585),u=o(247),i=o(249),s=o(165),c=o(35),E=o(142),I=o(577),F=o(599),B=o(591),N=o(704),$=Object(D.a)(v,p,g,!1,null,null,null),P=d.default=$.exports;f()($,{DocumentCardAction:o(757).default}),f()($,{VBtn:h.a,VCol:S.a,VIcon:u.a,VList:i.a,VListItem:s.a,VListItemContent:c.a,VListItemIcon:E.a,VListItemTitle:c.c,VMenu:I.a,VRow:F.a,VSkeletonLoader:B.a,VSubheader:N.a})}}]);
