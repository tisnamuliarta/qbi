(window.webpackJsonp=window.webpackJsonp||[]).push([[32,28],{1078:function(t,e,n){"use strict";n.r(e);n(8),n(7),n(9),n(12),n(10),n(13);var o=n(2),r=n(25),c=n(64);n(74),n(59),n(28),n(4),n(32),n(35),n(668),n(293),n(33);function l(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function d(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var m={name:"DialogForm",props:{url:{type:String,default:"/api/documents"},formType:{type:String,default:""},formUrl:{type:String,default:""},dialogTitle:{type:String,default:""}},data:function(){return{title:this.dialogTitle,items:[{text:"Save and close",action:"saveClose"},{text:"Save and new",action:"saveNew"},{text:"Save and send",action:"saveSend"}],itemAction:[],action:[],breadcrumb:[],form:{},audits:{},defaultItem:{},dialogLoading:!1,showLoading:!0,dialog:!1,loading:!1,actionName:"Save",actionOnSave:"save",countRouter:-1,showDraft:!1}},activated:function(){var t=this;this.$nextTick((function(){t.$nuxt.$loading.start()})),setTimeout((function(){t.action=[],t.itemAction=[{text:"Copy",action:"copy"},{text:"Cancel",action:"canceled"},{text:"Audit History",action:"history"},{text:"Journal Entry",action:"journal"}],t.itemAction=t.appendItemAction(t.formType),t.$refs.dialogForm.openDialog(),t.getDataFromApi()}),300)},methods:{close:function(){this.$emit("getDataFromApi")},checkDisable:function(){return"closed"===this.form.status||"canceled"===this.form.status},appendItemAction:function(t){switch(this.action=[],t){case"PQ":this.action=[{text:"Copy to "+this.$t("Purchase Order"),action:"PO",type:"document"},{text:"Copy to "+this.$t("Goods Receipt PO"),action:"GR",type:"document"},{text:"Copy to "+this.$t("A/P Invoice"),action:"BL",type:"transaction"}];break;case"PO":this.action=[{text:"Copy to "+this.$t("Goods Receipt PO"),action:"GR",type:"document"},{text:"Copy to "+this.$t("A/P Invoice"),action:"BL",type:"transaction"}];break;case"GR":this.action=[{text:"Copy to "+this.$t("A/P Invoice"),action:"BL",type:"transaction"},{text:"Copy to "+this.$t("Goods Return"),action:"BL",type:"document"}];break;case"BL":this.action=[{text:"Copy to "+this.$t("Outgoing Payment"),action:"PY",type:"transaction"}];break;case"PY":this.action=[{text:"Copy to "+this.$t("A/P Credit Memo"),action:"DN",type:"transaction"}];break;case"DN":this.action=[{text:"Copy to "+this.$t("Goods Return"),action:"GN",type:"document"}];break;case"SQ":this.action=[{text:"Copy to "+this.$t("Sales Order"),action:"SO",type:"document"},{text:"Copy to "+this.$t("Sales Delivery"),action:"SD",type:"document"},{text:"Copy to "+this.$t("A/R Invoice"),action:"IN",type:"transaction"}];break;case"SO":this.action=[{text:"Copy to "+this.$t("Sales Delivery"),action:"SD",type:"document"},{text:"Copy to "+this.$t("A/R Invoice"),action:"IN",type:"transaction"}];break;case"SD":this.action=[{text:"Copy to "+this.$t("A/R Invoice"),action:"IN",type:"transaction"},{text:"Copy to "+this.$t("Sales Return"),action:"SR",type:"document"}];break;case"IN":this.action=[{text:"Copy to "+this.$t("Incoming Payment"),action:"RC",type:"transaction"}];break;case"RC":this.action=[{text:"Copy to "+this.$t("A/R Credit Memo"),action:"CN",type:"transaction"}];break;case"CN":this.action=[{text:"Copy to "+this.$t("Sales Return"),action:"SR",type:"document"}]}return[].concat(Object(c.a)(this.action),Object(c.a)(this.itemAction))},arrowLink:function(t,e){var n=this;this.$axios.get(this.url+"/arrow",{params:{type:e,status:t,document:this.$route.query.document}}).then((function(t){n.$router.push({path:"/dashboard/documents",query:{document:t.data.id,type:e}}),setTimeout((function(){n.getDataFromApi()}),300)})).catch((function(t){n.$swal({type:"error",title:"Error",text:t.response.data.message})}))},getDataFromApi:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,r,c,form,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.showLoading=!0,n.prev=1,o=e.formType,r=e.$route.query.copyFrom,c="",!r){n.next=11;break}return n.next=8,e.$axios.get("/api/document/copy/"+r);case 8:c=n.sent,n.next=14;break;case 11:return n.next=13,e.$axios.get(e.url+"/"+e.$route.query.document,{params:{type:o,copyFromId:t}});case 13:c=n.sent;case 14:form="",e.audits=c.data.audits,0===c.data.count?(form=c.data.form,e.actionName="Save"):(form=c.data.data,e.actionName="Update"),e.form=Object.assign({},form),e.defaultItem=Object.assign({},form),r&&(e.form.status="open",e.form.base_id=e.form.id,e.form.base_type=e.form.transaction_type,e.form.base_num=e.form.transaction_no,e.form.transaction_type=e.formType),e.title=e.dialogTitle+" #"+e.form.transaction_no,e.$refs.dialogForm.setTitle(e.title),e.$refs.formDocument.setData(e.form),e.showLoading=!1,n.next=30;break;case 26:n.prev=26,n.t0=n.catch(1),l=void 0!==n.t0.response?n.t0.response.data.message:n.t0,e.$swal({type:"error",title:"Error",text:l});case 30:case"end":return n.stop()}}),n,null,[[1,26]])})))()},actionItem:function(t){switch(t){case"copy":this.$router.push({path:this.formUrl,query:{document:0}}),this.form.status="open",this.$refs.formDocument.setData(this.form);break;case"journal":this.$refs.ledger.openDialog("/api/transaction/ledger/"+this.form.id);break;case"closed":case"canceled":this.closeItem(this.form,t);break;default:this.$router.push({path:this.$formatter.mappingAction(t),query:{document:0,copyFrom:this.form.id}}),this.form.status="open",this.form.base_id=this.form.id,this.form.base_type=this.form.transaction_type,this.form.base_num=this.form.document_number,this.$refs.formDocument.setData(this.form)}},closeItem:function(t,e){var n=this;this.$swal({title:this.$t("Are you sure you want to run this action?"),text:"Data cannot be change after posted!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Save"}).then((function(o){o.value&&(n.$nuxt.$loading.start(),n.$axios.put(n.url+"/"+t.id,d({updateStatus:e},t)).then((function(t){n.getDataFromApi()})).catch((function(t){n.$swal({type:"error",title:"Error",text:t.response.data.message})})).finally((function(){n.$nuxt.$loading.finish()})))}))},actionDocument:function(t){var e=this,n=this.$route.query.document;switch(t){case"SQ":case"SO":case"PQ":case"PO":this.$router.push({path:"/dashboard/documents/form",query:{document:0,type:t}}),setTimeout((function(){e.actionName="Save",e.$refs.formDocument.changeValue("type",t),e.$refs.formDocument.changeValue("parent_id",n)}),300);break;case"C":this.$refs.formDocument.changeValue("status","cancel"),this.store();break;case"sendEmail":this.openDialogEmail()}},printAction:function(t){switch(t){case"preview":this.previewDocument();break;case"sendEmail":this.openDialogEmail()}},openDialogEmail:function(){this.$refs.dialogSendEmail.openEmailDialog(this.form)},previewDocument:function(){var t=this,e=this;this.$refs.dialogForm.showLoading(),this.$axios.get("/api/document/print",{params:{id:e.form.id,type:e.form.transaction_type},responseType:"arraybuffer"}).then((function(n){t.$refs.dialogForm.finishLoading();var o=window.URL.createObjectURL(new Blob([n.data])),link=document.createElement("a");link.href=o,link.setAttribute("download",e.form.transaction_no+".pdf"),document.body.appendChild(link),link.click()})).catch((function(e){t.$refs.dialogForm.finishLoading(),t.$swal({type:"error",title:"Error",text:e.response.data.message})}))},actionSave:function(t){var e=this;"save"===t&&["IN","RC","CN","SR","BL","PY","DN","GN"].includes(this.form.transaction_type)?this.$swal({title:this.$t("Are you sure you want to run this action?"),text:"Data cannot be change after posted!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Save"}).then((function(n){n.value&&e.save(t)})):this.save(t)},save:function(t){var e=this;this.actionOnSave=t;var n=this.$route.query.document,o="0"===n?this.url:this.url+"/"+n,r="0"===n?"post":"patch",data=d(d({},this.$refs.formDocument.returnData(n)),{},{action:t}),c=this;this.loading=!0,this.showLoading=!0,this.$axios({method:r,url:o,data:data}).then((function(t){switch(e.$nuxt.$emit("snackbar",e.title+" saved!"),e.actionOnSave){case"save":case"saveDraft":e.$router.push({path:c.formUrl,query:{document:t.data.id}}),setTimeout((function(){e.getDataFromApi()}),50);break;case"saveNew":e.$router.push({path:c.formUrl,query:{document:0}}),setTimeout((function(){e.getDataFromApi()}),50);break;case"saveClose":e.$refs.dialogForm.closeDialog()}})).catch((function(t){e.$swal({type:"error",title:"Error",text:t.response.data.message})})).finally((function(t){e.showLoading=!1,e.loading=!1}))}}},f=n(50),h=n(51),v=n.n(h),y=n(164),_=n(576),x=n(247),D=n(249),$=n(165),w=n(34),C=n(577),k=n(246),O=n(243),S=n(593),component=Object(f.a)(m,(function(){var t=this,e=t._self._c;return e("LazyFormDialogFull",{ref:"dialogForm",scopedSlots:t._u([{key:"content",fn:function(){return[e("LazyDocumentFormDocument",{ref:"formDocument",attrs:{"form-type":t.formType}}),t._v(" "),e("AccountingDialogLedger",{ref:"ledger"})]},proxy:!0},{key:"actions",fn:function(){return["Update"===t.actionName?e("span",[e("v-btn",{attrs:{text:"",small:"",dark:""},on:{click:function(e){return t.printAction("preview")}}},[t._v("Print or Preview")]),t._v(" "),e("v-divider",{attrs:{dark:"",vertical:""}}),t._v(" "),e("v-btn",{attrs:{text:"",small:"",dark:""}},[t._v("Make recurring")]),t._v(" "),e("v-divider",{attrs:{dark:"",vertical:""}}),t._v(" "),e("v-btn",{attrs:{text:"",small:"",dark:""}},[t._v("\n          More\n          "),e("v-menu",{attrs:{transition:"slide-y-transition",bottom:""},scopedSlots:t._u([{key:"activator",fn:function(n){var o=n.on,r=n.attrs;return[e("v-btn",t._g(t._b({attrs:{dark:"",icon:""}},"v-btn",r,!1),o),[e("v-icon",[t._v("mdi-menu-down")])],1)]}}],null,!1,1025138851)},[t._v(" "),e("v-list",{attrs:{link:""}},t._l(t.itemAction,(function(n,i){return e("v-list-item",{key:i,on:{click:function(e){return t.actionItem(n.action)}}},[e("v-list-item-content",[e("v-list-item-title",[t._v(t._s(n.text))])],1)],1)})),1)],1)],1)],1):t._e(),t._v(" "),e("v-spacer"),t._v(" "),e("v-btn",{staticClass:"mr-3",attrs:{small:"",loading:t.loading,disabled:t.checkDisable()},on:{click:function(e){return t.actionSave("saveDraft")}}},[t._v("\n        Save draft\n      ")]),t._v(" "),e("v-btn",{staticClass:"mr-3",attrs:{small:"",color:"green darken-1",dark:"",loading:t.loading,disabled:t.checkDisable()},on:{click:function(e){return t.actionSave("save")}}},[t._v("\n        "+t._s(t.actionName)+"\n\n        "),e("v-menu",{attrs:{transition:"slide-y-transition",bottom:""},scopedSlots:t._u([{key:"activator",fn:function(n){var o=n.on,r=n.attrs;return[e("v-btn",t._g(t._b({attrs:{dark:"",icon:"",disabled:t.checkDisable()}},"v-btn",r,!1),o),[e("v-icon",[t._v("mdi-menu-down")])],1)]}}])},[t._v(" "),e("v-list",{attrs:{link:""}},t._l(t.items,(function(n,i){return e("v-list-item",{key:i,on:{click:function(e){return t.actionSave(n.action)}}},[e("v-list-item-content",[e("v-list-item-title",[t._v(t._s(n.text))])],1)],1)})),1)],1)],1)]},proxy:!0}])},[e("v-overlay",{attrs:{value:t.showLoading}},[e("v-progress-circular",{attrs:{indeterminate:"",size:"64"}})],1)],1)}),[],!1,null,null,null);e.default=component.exports;v()(component,{AccountingDialogLedger:n(664).default}),v()(component,{VBtn:y.a,VDivider:_.a,VIcon:x.a,VList:D.a,VListItem:$.a,VListItemContent:w.a,VListItemTitle:w.c,VMenu:C.a,VOverlay:k.a,VProgressCircular:O.a,VSpacer:S.a})},598:function(t,e,n){"use strict";n(7),n(9),n(12),n(13);var o=n(2),r=(n(4),n(33),n(52),n(28),n(8),n(21),n(65),n(269),n(32),n(270),n(271),n(272),n(273),n(274),n(275),n(276),n(277),n(278),n(279),n(280),n(281),n(282),n(35),n(10),n(283),n(3)),c=n(78),l=n(1);function d(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function m(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var f=["sm","md","lg","xl"],h=["start","end","center"];function v(t,e){return f.reduce((function(n,o){return n[t+Object(l.I)(o)]=e(),n}),{})}var y=function(t){return[].concat(h,["baseline","stretch"]).includes(t)},_=v("align",(function(){return{type:String,default:null,validator:y}})),x=function(t){return[].concat(h,["space-between","space-around"]).includes(t)},D=v("justify",(function(){return{type:String,default:null,validator:x}})),$=function(t){return[].concat(h,["space-between","space-around","stretch"]).includes(t)},w=v("alignContent",(function(){return{type:String,default:null,validator:$}})),C={align:Object.keys(_),justify:Object.keys(D),alignContent:Object.keys(w)},k={align:"align",justify:"justify",alignContent:"align-content"};function O(t,e,n){var o=k[t];if(null!=n){if(e){var r=e.replace(t,"");o+="-".concat(r)}return(o+="-".concat(n)).toLowerCase()}}var S=new Map;e.a=r.default.extend({name:"v-row",functional:!0,props:m(m(m({tag:{type:String,default:"div"},dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:y}},_),{},{justify:{type:String,default:null,validator:x}},D),{},{alignContent:{type:String,default:null,validator:$}},w),render:function(t,e){var n=e.props,data=e.data,r=e.children,l="";for(var d in n)l+=String(n[d]);var m=S.get(l);return m||function(){var t,e;for(e in m=[],C)C[e].forEach((function(t){var o=n[t],r=O(e,t,o);r&&m.push(r)}));m.push((t={"no-gutters":n.noGutters,"row--dense":n.dense},Object(o.a)(t,"align-".concat(n.align),n.align),Object(o.a)(t,"justify-".concat(n.justify),n.justify),Object(o.a)(t,"align-content-".concat(n.alignContent),n.alignContent),t)),S.set(l,m)}(),t(n.tag,Object(c.a)(data,{staticClass:"row",class:m}),r)}})},603:function(t,e,n){"use strict";n.r(e);var o={name:"DialogForm",props:{maxWidth:{type:String,default:"800px"},dialogTitle:{type:String,default:""},original:{type:String,default:null}},data:function(){return{dialog:!1}},methods:{addLine:function(){this.$emit("addLine")},openDialog:function(){this.dialog=!0},closeDialog:function(){this.dialog=!1,this.$emit("eventCloseDialog")},saveData:function(){this.$emit("saveData")}}},r=n(50),c=n(51),l=n.n(c),d=n(164),m=n(248),f=n(88),h=n(595),v=n(576),y=n(247),_=n(593),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return e("v-dialog",{attrs:{"no-click-animation":"",persistent:"",scrollable:"",origin:t.original,"max-width":t.maxWidth,transition:"dialog-top-transition"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[e("v-card",[e("v-card-title",[e("span",{staticClass:"subtitle-2"},[t._v(t._s(t.dialogTitle))]),t._v(" "),e("v-spacer"),t._v(" "),e("v-btn",{attrs:{icon:"",color:"red",dark:""},on:{click:function(e){return t.closeDialog()}}},[e("v-icon",[t._v("mdi-close-circle")])],1)],1),t._v(" "),e("v-divider"),t._v(" "),e("v-card-text",{staticClass:"pr-0 pl-0"},[t._t("content")],2),t._v(" "),e("v-divider"),t._v(" "),e("v-card-actions",[t._t("addLine"),t._v(" "),e("v-spacer"),t._v(" "),t._t("saveData")],2)],1)],1)}),[],!1,null,null,null);e.default=component.exports;l()(component,{VBtn:d.a,VCard:m.a,VCardActions:f.a,VCardText:f.b,VCardTitle:f.c,VDialog:h.a,VDivider:v.a,VIcon:y.a,VSpacer:_.a})},664:function(t,e,n){"use strict";n.r(e);n(4);var o={name:"DialogItem",props:{viewData:{type:Boolean,default:!0},showAddBtn:{type:Boolean,default:!0}},data:function(){return{row:null,url:"",allData:[],transaction:[],totalData:0,loading:!1,options:{},headers:[{text:"Posting Date",value:"posting_date"},{text:"Account Code",value:"post_account.code"},{text:"Account Category",value:"post_account.account_type"},{text:"Account Name",value:"post_account.name"},{text:"Debit",value:"amount_debit",class:"text-center",cellClass:"disable-wrap text-right"},{text:"Credit",value:"amount_credit",class:"text-center",cellClass:"disable-wrap text-right"}]}},methods:{sumField:function(t){return this.allData.reduce((function(a,b){return parseFloat(a)+parseFloat(b[t]||0)}),0)},openDialog:function(t){this.$refs.dialogForm.openDialog(),this.url=t,this.getDataFromApi()},getDataFromApi:function(){var t=this;this.loading=!0,this.$axios.get(this.url).then((function(e){t.loading=!1;var data=e.data;t.allData=data.data,t.transaction=data.transaction,t.totalData=data.total})).catch((function(e){t.loading=!1,t.$swal({type:"error",title:"Error",text:e.response.data.message})}))}}},r=n(50),c=n(51),l=n.n(c),d=n(585),m=n(586),f=n(907),h=n(598),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return e("div",[e("DialogForm",{ref:"dialogForm",attrs:{"max-width":"1200px","dialog-title":t.$t("Journal Entry"),"button-title":"Save",original:"top"},scopedSlots:t._u([{key:"content",fn:function(){return[e("v-container",[e("v-row",[e("v-col",{staticClass:"mt-0",attrs:{cols:"12"}},[e("v-data-table",{staticClass:"elevation-0",attrs:{"mobile-breakpoint":0,headers:t.headers,items:t.allData,"items-per-page":150,options:t.options,"server-items-length":t.totalData,loading:t.loading,"show-select":"","fixed-header":"",height:"60vh","hide-default-footer":"",dense:"","footer-props":{"items-per-page-options":[150,250,500,-1]}},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.amount_credit",fn:function(n){var o=n.item;return[o.amount_credit?e("span",[t._v("\n                    "+t._s(t.$auth.user.entity.currency.currency_symbol+" "+t.$formatter.formatPrice(o.amount_credit))+"\n                  ")]):t._e()]}},{key:"item.amount_debit",fn:function(n){var o=n.item;return[o.amount_debit?e("span",[t._v("\n                    "+t._s(t.$auth.user.entity.currency.currency_symbol+" "+t.$formatter.formatPrice(o.amount_debit))+"\n                  ")]):t._e()]}},{key:"body.append",fn:function(){return[e("tr",{staticClass:"black--text"},[e("th",{staticClass:"title"}),t._v(" "),e("th",{staticClass:"title"}),t._v(" "),e("th",{staticClass:"title"}),t._v(" "),e("th",{staticClass:"title"}),t._v(" "),e("th",{staticClass:"title"}),t._v(" "),e("th",{staticClass:"title text-right"},[t._v("\n                      "+t._s(t.$auth.user.entity.currency.currency_symbol+" "+t.$formatter.formatPrice(t.sumField("amount_debit")))+"\n                    ")]),t._v(" "),e("th",{staticClass:"title text-right"},[t._v("\n                      "+t._s(t.$auth.user.entity.currency.currency_symbol+" "+t.$formatter.formatPrice(t.sumField("amount_credit")))+"\n                    ")])]),t._v(" "),e("tr",[e("td",[t._v("Notes: ")]),t._v(" "),e("td",{attrs:{colspan:"3"}},[e("strong",[t._v(t._s(t.transaction.narration))])])])]},proxy:!0}],null,!0)})],1)],1)],1)]},proxy:!0}])})],1)}),[],!1,null,null,null);e.default=component.exports;l()(component,{DialogForm:n(603).default}),l()(component,{VCol:d.a,VContainer:m.a,VDataTable:f.a,VRow:h.a})}}]);