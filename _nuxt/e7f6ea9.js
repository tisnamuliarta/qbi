(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{1087:function(Q,E,a){"use strict";a.r(E);var K=function(){var t=this,e=t._self._c;return e("div",{staticClass:"scroll-container-min",attrs:{id:"parentContainer"}},[e("hot-table",{ref:"details",attrs:{root:t.detailsRoot,settings:t.settings}}),t._v(" "),e("LazyInventoryDialogItem",{ref:"dialogItem",attrs:{"view-data":!0,"show-add-btn":!1},on:{selectItems:t.selectItems}})],1)},N=[],F=a(24),V=a(17),Y=a(74),X=a(4),Z=a(10),k=a(27),q=a(33),tt=a(7),et=a(46),at=a(291),b=a(655),y=a(689),j=a(1151),_=a(894),T=a(1145),I=a(1148),C=a(710),R=a(674),g=a(776),S=a(895),O=a(912),x=a(1153),$=a(1149),A=a(1150),M=a(897),w=a(697),P=a(658);Object(y.c)(j.a),Object(y.c)(_.a),Object(y.c)(T.a),Object(y.c)(I.a),Object(C.c)(R.a),Object(g.d)(S.a),Object(g.d)(O.a),Object(g.d)(x.a),Object(g.d)($.a),Object(g.d)(A.a),Object(g.d)(M.a),Object(g.d)(w.a);var D=function(t,e){e.row===-1&&t.target.nodeName==="TD"&&(t.stopImmediatePropagation(),t.stopPropagation(),this.deselectCell())},W={name:"TableDetail",components:{HotTable:b.a},data:function(){return{settings:{licenseKey:"non-commercial-and-evaluation",currentRowClassName:"currentRow",currentColClassName:"currentCol",startRows:1,rowHeaders:!0,manualColumnResize:!0,rowHeights:28,viewportRowRenderingOffset:1e3,viewportColumnRenderingOffset:100,colWidths:80,persistentState:!0,width:"100%",height:"auto",stretchH:"all",hiddenColumns:{copyPasteEnabled:!1,indicator:!1,columns:[1,2,3]},beforeOnCellMouseDown:D,dataSchema:{id:null,item_id:null,sku:null,name:null,description:null,quantity:0,unit:null,default_currency_symbol:null,vat_inclusive:0,price:0,discount_rate:0,tax_name:"",total:0},colHeaders:["#","Id","Item ID","Item Code","Item Code","Description","Qty","Units","Currency","Vat Inclusive","Unit Price","Discount","Tax","Warehouse","Amount",""],columns:[{width:30,wordWrap:!1,renderer:function(e,n,c,f,i,l,h){var u=null,v=window.details;if(v.form.status!=="closed"&&v.form.status!=="cancel")return u=document.createElement("button"),u.type="button",u.innerHTML='<span class="mdi mdi-arrow-right-bold"></span>',u.className="btnNPB",u.value="Details",u.addEventListener("mousedown",function(m){m.preventDefault();var p=v.$refs.details.hotInstance.getDataAtRowProp(c,"whs_name");v.$refs.dialogItem.openDialog(c,p)}),n.innerText="",n.appendChild(u),n}},{data:"id",wordWrap:!1},{data:"item_id",wordWrap:!1},{data:"base_line_id",width:150,readOnly:!0,wordWrap:!1},{data:"code",width:120,readOnly:!0,wordWrap:!1},{data:"narration",width:250,wordWrap:!1},{data:"quantity",width:80,wordWrap:!1,type:"numeric",numericFormat:{pattern:"0,0"}},{data:"unit",className:"htCenter",width:60,readOnly:!0,wordWrap:!1},{data:"default_currency_symbol",width:60,readOnly:!0,wordWrap:!1,className:"htCenter"},{data:"vat_inclusive",type:"checkbox",className:"htCenter",checkedTemplate:1,uncheckedTemplate:0},{data:"amount",width:100,wordWrap:!1,type:"numeric",numericFormat:{pattern:"0,0.00"}},{data:"discount_rate",width:100,wordWrap:!1,type:"numeric",numericFormat:{pattern:"0,0.00"}},{data:"tax_name",width:100,height:26,wordWrap:!1,editor:"select",className:"htCenter",selectOptions:function(){var e=window.details;return e.$auth.$storage.getState("tax")},visibleRows:5,strict:!0,filter:!1,allowInvalid:!1},{data:"whs_name",width:100,height:26,wordWrap:!1,editor:"select",className:"htCenter",selectOptions:function(){var e=window.details;return e.$auth.$storage.getState("warehouse")},visibleRows:5,strict:!0,filter:!1,allowInvalid:!1},{data:"sub_total",width:100,wordWrap:!1,type:"numeric",readOnly:!0,numericFormat:{pattern:"0,0.00"}},{width:40,wordWrap:!1,renderer:function(e,n,c,f,i,l,h){var u=null,v=window.details;return v.form.status!=="closed"&&v.form.status!=="cancel"&&(u=document.createElement("button"),u.type="button",u.innerHTML='<span class="mdi mdi-delete"></span>',u.className="btnDelete",u.value="Details2",u.addEventListener("mousedown",function(m){m.preventDefault(),v.removeRow(c)}),n.innerText="",n.appendChild(u)),n}}]},detailsRoot:"detailsRoot",colHeaders:[],form:{}}},created:function(){this.setInstance()},methods:{setInstance:function(){window.details=this},removeRow:function(t){this.$refs.details.hotInstance.alter("remove_row",t)},addLine:function(){var t=this,e=this;this.$refs.details.hotInstance.batch(function(){var n=t.$refs.details.hotInstance.countRows();t.$refs.details.hotInstance.alter("insert_row",n+1,1),t.$refs.details.hotInstance.setDataAtRowProp([[n,"whs_name",e.form.warehouse_name]])})},updateTableSettings:function(t){this.$refs.details.hotInstance.updateSettings({licenseKey:"non-commercial-and-evaluation",height:"auto",beforeRefreshDimensions:function(){return!1},beforeOnCellMouseDown:D,afterRemoveRow:function(n,c,f,i){var l=window.details;l.calculateTotal()},beforeRemoveRow:function(n,c,f,i){var l=window.details,h=[];f.forEach(function(v,m){var p=l.$refs.details.hotInstance.getDataAtCell(v,0);p&&h.push(p)});var u=l.$refs.details.hotInstance.countRows();return u===1&&l.$emit("calcTotal",{subTotal:0,amount:0,discountAmount:0,taxDetail:[]}),h.length>0&&l.$emit("removeData",{id:h}),!0},afterChange:function(n,c){var f=window.details;if(n){var i=0;n.forEach(function(l){var h=Object(V.a)(l,4),u=h[0],v=h[1],m=h[2],p=h[3];i=v,(i==="quantity"||i==="amount"||i==="discount_rate"||i==="tax_name")&&m!==p&&f.calculateTotal()})}},beforeRender:function(n){var c=window.details;c.$nuxt.$loading.start()},afterRender:function(n){var c=window.details;c.$nuxt.$loading.finish()},afterLoadData:function(n,c,f){}})},selectItems:function(t){var e=t.row,n=t.selected,c=this.form.transaction_type,f=this,i=["SQ","SO","SD","IN","RC","CN","SR"];this.$refs.details.hotInstance.batch(function(){n.forEach(function(l,h){var u=l.sales_tax!=null?l.sales_tax.name:null,v=i.includes(c)?l.sale_price:l.purchase_price,m=l.description?l.description:l.name;f.$refs.details.hotInstance.setDataAtRowProp([[e,"code",l.code],[e,"base_line_id",0],[e,"unit",l.unit],[e,"narration",m],[e,"default_currency_symbol",f.form.default_currency_code],[e,"item_id",l.id],[e,"amount",v],[e,"tax_name",u],[e,"whs_name",l.whs_name],[e,"quantity",1]]),e++})})},setDataToDetails:function(t,e){var n=this,c=this;this.form=e,this.$refs.details.hotInstance.batch(function(){n.updateTableSettings();var f=e.line_items.length>0?e.line_items:t;if(c.$refs.details.hotInstance.loadData(f),e.line_items.length===0)for(var i=n.$refs.details.hotInstance.countRows(),l=0;l<i;l++)n.$refs.details.hotInstance.setDataAtRowProp(l,"whs_name",c.form.warehouse_name);n.$nuxt.$loading.finish()})},calculateTotal:function(){var t=this,e=this.$refs.details.hotInstance.countRows(),n=0,c=0,f=[],i=0,l=0;if(e>0)for(var h=function(m){t.$refs.details.hotInstance.batch(function(){var p=t.$refs.details.hotInstance.getDataAtRowProp(m,"quantity"),z=t.$refs.details.hotInstance.getDataAtRowProp(m,"amount"),nt=t.$refs.details.hotInstance.getDataAtRowProp(m,"discount_rate"),B=t.$refs.details.hotInstance.getDataAtRowProp(m,"tax_name"),U=p*z;n=n+p*z;var H=parseFloat(nt/100*U).toFixed(2);if(c=parseFloat(c)+parseFloat(H),l=U-H,B){var G=0;t.$auth.$storage.getState("tax_row").forEach(function(J,ot){J.name===B&&(G=parseFloat(J.rate))});var rt=parseFloat(G)/100*l;f.push({name:B,amount:rt})}i=i+(U-H),t.$refs.details.hotInstance.setDataAtRowProp(m,"sub_total",l)})},u=0;u<e;u++)h(u);this.$emit("calcTotal",{subTotal:n,amount:i,discountAmount:c,taxDetail:f})},getTaxRate:function(t){var e=this;return Object(F.a)(regeneratorRuntime.mark(function n(){var c;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,e.$axios.get("/api/financial/taxes/0",{params:{name:t}});case 2:return c=i.sent,i.abrupt("return",c.data.data.rows);case 4:case"end":return i.stop()}},n)}))()},getDataAtRowPro:function(t,e){return this.$refs.details.hotInstance.getDataAtRowProp(t,e)},countRows:function(){return this.$refs.details.hotInstance.countRows()},checkIfEmptyRow:function(t){return this.$refs.details.hotInstance.isEmptyRow(t)},getAddData:function(t){if(t==="0")for(var e=this.$refs.details.hotInstance.countRows(),n=0;n<e;n++)this.$refs.details.hotInstance.setDataAtRowProp(n,"id",null);return this.$refs.details.hotInstance.getSourceData()}}},L=W,s=a(50),o=Object(s.a)(L,K,N,!1,null,null,null),d=E.default=o.exports},674:function(Q,E,a){"use strict";a.d(E,"a",function(){return L});var K=a(607),N=a(605),F=a(4),V=a(110),Y=a(626),X=a(12),Z=a(7),k=a(46),q=a(53),tt=a(212),et=a(32),at=a(34),b=a(871),y=a(606),j=a(601);function _(s){return _=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_(s)}function T(s,o){if(!(s instanceof o))throw new TypeError("Cannot call a class as a function")}function I(s,o){for(var d=0;d<o.length;d++){var r=o[d];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(s,r.key,r)}}function C(s,o,d){return o&&I(s.prototype,o),d&&I(s,d),Object.defineProperty(s,"prototype",{writable:!1}),s}function R(){return typeof Reflect!="undefined"&&Reflect.get?R=Reflect.get.bind():R=function(o,d,r){var t=g(o,d);if(!!t){var e=Object.getOwnPropertyDescriptor(t,d);return e.get?e.get.call(arguments.length<3?o:r):e.value}},R.apply(this,arguments)}function g(s,o){for(;!Object.prototype.hasOwnProperty.call(s,o)&&(s=w(s),s!==null););return s}function S(s,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(o&&o.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),o&&O(s,o)}function O(s,o){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,t){return r.__proto__=t,r},O(s,o)}function x(s){var o=M();return function(){var r=w(s),t;if(o){var e=w(this).constructor;t=Reflect.construct(r,arguments,e)}else t=r.apply(this,arguments);return $(this,t)}}function $(s,o){if(o&&(_(o)==="object"||typeof o=="function"))return o;if(o!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return A(s)}function A(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function M(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(s){return!1}}function w(s){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(d){return d.__proto__||Object.getPrototypeOf(d)},w(s)}var P="ht_editor_visible",D="selectEditor",W="select",L=function(s){S(d,s);var o=x(d);function d(){return T(this,d),o.apply(this,arguments)}return C(d,[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),Object(y.a)(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(t){this.select.value=t}},{key:"open",value:function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";var t=this.hot.getShortcutManager();t.setActiveContextName("editor"),this.registerShortcuts()}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",Object(y.v)(this.select,P)&&Object(y.K)(this.select,P),this.unregisterShortcuts(),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var t=this;this.addHook("afterScrollHorizontally",function(){return t.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return t.refreshDimensions()}),this.addHook("afterColumnResize",function(){return t.refreshDimensions()}),this.addHook("afterRowResize",function(){return t.refreshDimensions()})}},{key:"prepare",value:function(t,e,n,c,f,i){var l=this;R(w(d.prototype),"prepare",this).call(this,t,e,n,c,f,i);var h=this.cellProperties.selectOptions,u;typeof h=="function"?u=this.prepareOptions(h(this.row,this.col,this.prop)):u=this.prepareOptions(h),Object(y.e)(this.select),Object(j.o)(u,function(v,m){var p=l.hot.rootDocument.createElement("OPTION");p.value=m,Object(y.f)(p,v),l.select.appendChild(p)})}},{key:"prepareOptions",value:function(t){var e={};if(Array.isArray(t))for(var n=0,c=t.length;n<c;n++)e[t[n]]=t[n];else _(t)==="object"&&(e=t);return e}},{key:"refreshValue",value:function(){var t=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=t,this.setValue(t),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===b.b.EDITING){if(this.TD=this.getEditedCell(),!this.TD){this.close();return}var t=this.getEditedCellRect(),e=t.top,n=t.start,c=t.width,f=t.height,i=this.select.style;i.height="".concat(f,"px"),i.width="".concat(c,"px"),i.top="".concat(e,"px"),i[this.hot.isRtl()?"right":"left"]="".concat(n,"px"),i.margin="0px",Object(y.a)(this.select,P)}}},{key:"registerShortcuts",value:function(){var t=this,e=this.hot.getShortcutManager(),n=e.getContext("editor"),c={group:D};this.isInFullEditMode()!==!1&&n.addShortcuts([{keys:[["ArrowUp"]],callback:function(){var i=t.select.selectedIndex-1;i>=0&&(t.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:function(){var i=t.select.selectedIndex+1;i<=t.select.length-1&&(t.select[i].selected=!0)}}],c)}},{key:"unregisterShortcuts",value:function(){var t=this.hot.getShortcutManager(),e=t.getContext("editor");e.removeShortcutsByGroup(D)}}],[{key:"EDITOR_TYPE",get:function(){return W}}]),d}(b.a)}}]);
