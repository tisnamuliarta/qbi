(window.webpackJsonp=window.webpackJsonp||[]).push([[147],{1025:function(S,d,a){"use strict";a.r(d);var h=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("v-row",[e("v-col",{attrs:{cols:"12",md:t.itemAction.length>0?"10":"12"}},[e("DocumentFormWindow",{ref:"formWindow",attrs:{breadcrumb:t.breadcrumb},on:{getDataFromApi:t.getDataFromApi},scopedSlots:t._u([{key:"action-toolbar",fn:function(){return[e("v-btn",{attrs:{text:"",small:""},on:{click:function(o){return t.arrowLink("prev",t.form.type)}}},[e("v-icon",[t._v("mdi-arrow-left")]),t._v(" "),e("span",[t._v("Prev")])],1),t._v(" "),e("v-btn",{attrs:{text:"",small:""},on:{click:function(o){return t.arrowLink("next",t.form.type)}}},[e("v-icon",[t._v("mdi-arrow-right")]),t._v(" "),e("span",[t._v("Next")])],1),t._v(" "),e("v-btn",{attrs:{icon:"",small:""},on:{click:function(o){return t.$refs.dialogAudit.openDialogAudit(t.audits)}}},[e("v-icon",[t._v("mdi-history")])],1),t._v(" "),e("v-btn",{attrs:{color:"green",dark:"",icon:"",small:""},on:{click:t.getDataFromApi}},[e("v-icon",[t._v("mdi-refresh")])],1)]},proxy:!0},{key:"content",fn:function(){return[e("v-row",{directives:[{name:"show",rawName:"v-show",value:t.showLoading,expression:"showLoading"}],attrs:{"no-gutters":""}},[e("v-col",{attrs:{cols:"12"}},[e("v-skeleton-loader",{attrs:{type:"list-item-three-line, table-thead, table-tbody, list-item-three-line"}})],1)],1),t._v(" "),e("LazyDocumentFormInput",{directives:[{name:"show",rawName:"v-show",value:!t.showLoading,expression:"!showLoading"}],ref:"formDocument"})]},proxy:!0},{key:"action",fn:function(){return[e("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(o){var s=o.attrs,c=o.on;return[e("v-btn",t._g(t._b({staticClass:"white--text",attrs:{color:"green",disabled:t.checkDisable(),small:""}},"v-btn",s,!1),c),[t._v(`
              Print & Preview
              `),e("v-icon",{attrs:{right:"",dark:""}},[t._v(`
                mdi-printer
              `)])],1)]}}])},[t._v(" "),e("v-list",{attrs:{dense:""}},t._l(t.items,function(o){return e("v-list-item",{key:o.title,attrs:{dense:"",link:""},on:{click:function(s){return t.printAction(o.action)}}},[e("v-list-item-icon",[e("v-icon",{domProps:{textContent:t._s(o.icon)}})],1),t._v(" "),e("v-list-item-content",[e("v-list-item-title",{domProps:{textContent:t._s(o.title)}})],1)],1)}),1)],1),t._v(" "),e("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(o){var s=o.attrs,c=o.on;return[e("v-btn",t._g(t._b({staticClass:"white--text ml-5",attrs:{color:"green",disabled:t.checkDisable(),small:""}},"v-btn",s,!1),c),[t._v(`
              Action
              `),e("v-icon",{attrs:{right:"",dark:""}},[t._v(`
                mdi-folder-cog
              `)])],1)]}}])},[t._v(" "),e("v-list",t._l(t.itemAction,function(o){return e("v-list-item",{key:o.title,attrs:{dense:"",link:""},on:{click:function(s){return t.actionDocument(o.action)}}},[e("v-list-item-icon",[e("v-icon",{domProps:{textContent:t._s(o.icon)}})],1),t._v(" "),e("v-list-item-content",[e("v-list-item-title",{domProps:{textContent:t._s(o.title)}})],1)],1)}),1)],1)]},proxy:!0},{key:"saveData",fn:function(){return[e("v-btn",{staticClass:"white--text",attrs:{color:"green darken-1",disabled:t.checkDisable(),small:""},on:{click:t.store}},[t._v(`
          `+t._s(t.actionName)+`
          `),e("v-icon",[t._v(`
            mdi-check
          `)])],1)]},proxy:!0}])})],1),t._v(" "),t.itemAction.length>0?e("v-col",{attrs:{cols:"12",md:"2"}},[e("v-subheader",{staticStyle:{"margin-top":"-20px"}},[t._v("Action")]),t._v(" "),e("DocumentCardAction",{ref:"documentAction"})],1):t._e(),t._v(" "),e("LazyDocumentDialogSendEmail",{ref:"dialogSendEmail"}),t._v(" "),e("LazyDocumentDialogAudit",{ref:"dialogAudit"}),t._v(" "),t.dialogLoading?e("LazySpinnerLoading",{ref:"spinnerLoadingImport"}):t._e()],1)},p=[],b=a(59),V=a(4),C=a(32),$=a(35),A=a(806),x=a(291),g={name:"FormDocument",layout:"dashboard",data:function(){return{breadcrumb:[],form:{},audits:{},defaultItem:{},url:"/api/documents/form",dialogLoading:!1,showLoading:!1,itemAction:[],actionName:"Save",items:[{title:"Preview",action:"preview",icon:"mdi-printer"},{title:"Send Email",action:"sendEmail",icon:"mdi-email"}]}},head:function(){return{title:"Form Document"}},created:function(){this.getDataFromApi()},methods:{checkDisable:function(){return this.form.status==="closed"||this.form.status==="cancel"},arrowLink:function(i,e){var o=this;this.$axios.get(this.url+"/arrow",{params:{type:e,status:i,document:this.$route.query.document}}).then(function(s){o.$router.push({path:"/dashboard/documents/form",query:{document:s.data.data.id,type:e}}),setTimeout(function(){o.getDataFromApi()},300)}).catch(function(s){o.$swal({type:"error",title:"Error",text:s.response.data.message})})},getDataFromApi:function(i){var e=this;this.showLoading=!0;var o=this.$route.query.type;this.$axios.get(this.url+"/"+this.$route.query.document,{params:{type:o,copyFromId:i}}).then(function(s){var c="";e.audits=s.data.data.audits,s.data.data.count>0?(c=s.data.data.rows,e.actionName="Update"):(c=s.data.data.form,e.actionName="Save"),e.form=Object.assign({},c),e.defaultItem=Object.assign({},c),s.data.data.count>0&&(e.itemAction=s.data.data.action,setTimeout(function(){e.$refs.documentAction.setAction(e.itemAction,e.checkDisable())},50)),e.getBreadcrumb(o,c,c.status),setTimeout(function(){e.$refs.formDocument.setData(e.form)},30)}).catch(function(s){var c=s.response!==void 0?s.response.data.message:s;e.$swal({type:"error",title:"Error",text:c})}).finally(function(s){e.showLoading=!1})},actionDocument:function(i){var e=this;switch(i){case"SQ":case"SO":case"PQ":case"PO":var o=this.$route.query.document;this.$router.push({path:"/dashboard/documents/form",query:{document:0,type:i}}),setTimeout(function(){e.actionName="Save",e.getBreadcrumb(i,e.form,e.form.status),e.$refs.formDocument.changeValue("type",i),e.$refs.formDocument.changeValue("parent_id",o)},300);break;case"C":this.$refs.formDocument.changeValue("status","cancel"),this.store();break;case"sendEmail":this.openDialogEmail();break}},deleteDocument:function(i){var e=this,o=this;this.$swal({title:"Are you sure?",text:"The data will be deleted",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(function(s){s.value&&e.$axios.delete(e.url+"/"+i).then(function(c){e.$swal({type:"success",title:"Success...",text:"Data Deleted!"}),e.$router.push({path:o.$helper.mappingAction(o.$route.query.type)})}).catch(function(c){e.$swal({type:"error",title:"Oops...",text:c.response.data.message})})})},printAction:function(i){switch(i){case"preview":this.previewDocument();break;case"sendEmail":this.openDialogEmail();break}},openDialogEmail:function(){this.$refs.dialogSendEmail.openEmailDialog(this.form)},previewDocument:function(){var i=this,e=this;this.dialogLoading=!0,this.$axios.get("/api/documents/print",{params:{id:e.form.id},responseType:"arraybuffer"}).then(function(o){i.dialogLoading=!1;var s=window.URL.createObjectURL(new Blob([o.data])),c=document.createElement("a");c.href=s,c.setAttribute("download",e.form.document_number+".pdf"),document.body.appendChild(c),c.click()}).catch(function(o){i.dialogLoading=!1,i.$swal({type:"error",title:"Error",text:o.response.data.message})})},getBreadcrumb:function(i,e,o){var s=this.$route.query.document!=="0"?e.document_number:"Create Document";this.breadcrumb=[{text:"Dashboard",disabled:!1,to:{path:"/dashboard"}},{text:this.$helper.mapping(i),disabled:!1,to:{path:this.$helper.mappingAction(i)}},{text:s,disabled:!0,to:{path:"/dashboard/documents/form"}}]},mappingType:function(i){switch(i){case"SQ":return"/dashboard/sales/quote"}},store:function(){var i=this,e=this.$route.query.document==="0"?"post":"patch",o=this.$route.query.document==="0"?this.url:this.url+"/"+this.$route.query.document,s=this.$refs.formDocument.returnData(this.$route.query.document);this.dialogLoading=!0,this.$axios({method:e,url:o,data:s}).then(function(c){i.$router.push({path:"/dashboard/documents/form",query:{document:c.data.data.id,type:c.data.data.type}}),i.$nuxt.$emit("snackbar",c.data.message),setTimeout(function(){i.getDataFromApi()},50)}).catch(function(c){i.$swal({type:"error",title:"Error",text:c.response.data.message})}).finally(function(c){i.dialogLoading=!1})}}},v=g,y=a(50),D=a(51),f=a.n(D),u=a(164),L=a(581),n=a(246),m=a(248),r=a(165),l=a(34),F=a(142),E=a(573),T=a(595),I=a(587),B=a(820),w=Object(y.a)(v,h,p,!1,null,null,null),j=d.default=w.exports;f()(w,{DocumentFormWindow:a(881).default,DocumentCardAction:a(882).default}),f()(w,{VBtn:u.a,VCol:L.a,VIcon:n.a,VList:m.a,VListItem:r.a,VListItemContent:l.b,VListItemIcon:F.a,VListItemTitle:l.d,VMenu:E.a,VRow:T.a,VSkeletonLoader:I.a,VSubheader:B.a})},881:function(S,d,a){"use strict";a.r(d);var h=function(){var n=this,m=n.$createElement,r=n._self._c||m;return r("v-card",[r("v-toolbar",{staticClass:"toolbar-content",staticStyle:{height:"32px"},attrs:{flat:"",color:"grey lighten-2",dense:""}},[r("v-breadcrumbs",{staticClass:"hidden-sm-and-down",attrs:{items:n.breadcrumb,divider:"/"}}),n._v(" "),r("v-spacer",{staticClass:"hidden-xs-only"}),n._v(" "),n._t("action-toolbar")],2),n._v(" "),n._t("content"),n._v(" "),r("v-divider"),n._v(" "),r("v-card-actions",[n._t("action"),n._v(" "),r("v-spacer"),n._v(" "),n._t("saveData")],2)],2)},p=[],b={name:"FormWindow",props:{breadcrumb:{type:Array,default:function(){return[]}}},methods:{getDataFromApi:function(){this.$emit("getDataFromApi")}}},V=b,C=a(50),$=a(51),A=a.n($),x=a(977),g=a(247),v=a(88),y=a(572),D=a(589),f=a(73),u=Object(C.a)(V,h,p,!1,null,null,null),L=d.default=u.exports;A()(u,{VBreadcrumbs:x.a,VCard:g.a,VCardActions:v.a,VDivider:y.a,VSpacer:D.a,VToolbar:f.a})},882:function(S,d,a){"use strict";a.r(d);var h=function(){var n=this,m=n.$createElement,r=n._self._c||m;return r("v-timeline",{attrs:{dense:""}},n._l(n.action,function(l){return r("v-timeline-item",{key:l.title,attrs:{small:"",color:l.color}},[r("v-card",{staticClass:"elevation-2"},[r("v-card-text",{staticClass:"pa-2"},[r("span",{staticClass:"font-weight-bold"},[n._v(n._s(l.title))]),n._v(" "),r("v-divider"),n._v(" "),l.title!=="Clone"&&l.title!=="Cancel"?r("div",[r("span",[n._v("No : no")]),n._v(" "),r("br"),n._v(" "),r("span",[n._v("Date : no")]),n._v(" "),r("br"),n._v(" "),r("span",[n._v("Status : no")]),n._v(" "),r("br")]):n._e()],1),n._v(" "),l.button?r("v-card-actions",[r("v-btn",{staticClass:"white--text",attrs:{disabled:l.button,"x-small":"",color:l.color},on:{click:function(F){return n.processAction(l.action)}}},[l.title==="Clone"||l.title==="Cancel"?r("span",{domProps:{textContent:n._s(l.title)}}):r("span",[n._v("Create")])])],1):n._e()],1)],1)}),1)},p=[],b={name:"CardAction",props:{title:{type:String,default:""}},data:function(){return{loading:!0,checkDisable:!1,action:[]}},methods:{setAction:function(m,r){this.checkDisable=r,this.action=m},processAction:function(m){}}},V=b,C=a(50),$=a(51),A=a.n($),x=a(164),g=a(247),v=a(88),y=a(572),D=a(929),f=a(930),u=Object(C.a)(V,h,p,!1,null,null,null),L=d.default=u.exports;A()(u,{VBtn:x.a,VCard:g.a,VCardActions:v.a,VCardText:v.b,VDivider:y.a,VTimeline:D.a,VTimelineItem:f.a})}}]);
