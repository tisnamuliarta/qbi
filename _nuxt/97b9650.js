(window.webpackJsonp=window.webpackJsonp||[]).push([[23,18,25,26],{1114:function(_,y,o){"use strict";o.r(y);var C=function(){var a=this,g=a.$createElement,i=a._self._c||g;return i("div",[i("DialogForm",{ref:"dialogForm",attrs:{"max-width":"1200px","dialog-title":a.formTitle,"button-title":"Save"},scopedSlots:a._u([{key:"content",fn:function(){return[i("DocumentFormDocument",{ref:"formDocument"})]},proxy:!0},{key:"addLine",fn:function(){return[i("v-menu",{attrs:{"offset-y":""},scopedSlots:a._u([{key:"activator",fn:function(l){var D=l.attrs,T=l.on;return[i("v-btn",a._g(a._b({staticClass:"white--text",attrs:{color:"primary",dark:"",small:""}},"v-btn",D,!1),T),[a._v(`
            Print & Preview
            `),i("v-icon",{attrs:{right:"",dark:""}},[a._v(`
              mdi-printer
            `)])],1)]}}])},[a._v(" "),i("v-list",a._l(a.items,function(l){return i("v-list-item",{key:l,attrs:{link:""}},[i("v-list-item-title",{domProps:{textContent:a._s(l)}})],1)}),1)],1),a._v(" "),i("v-menu",{attrs:{"offset-y":""},scopedSlots:a._u([{key:"activator",fn:function(l){var D=l.attrs,T=l.on;return[i("v-btn",a._g(a._b({staticClass:"white--text ml-5",attrs:{color:"primary",dark:"",small:""}},"v-btn",D,!1),T),[a._v(`
            Action
            `),i("v-icon",{attrs:{right:"",dark:""}},[a._v(`
              mdi-content-copy
            `)])],1)]}}])},[a._v(" "),i("v-list",a._l(a.items,function(l){return i("v-list-item",{key:l,attrs:{link:""}},[i("v-list-item-title",{domProps:{textContent:a._s(l)}})],1)}),1)],1)]},proxy:!0},{key:"saveData",fn:function(){return[i("v-btn",{attrs:{color:"green darken-1",dark:"",small:"",loading:a.submitLoad},on:{click:function(l){return a.save()}}},[a._v(`
        `+a._s(a.buttonTitle)+`
      `)])]},proxy:!0}])})],1)},b=[],P=o(59),F={name:"DialogFormDocument",props:{formTitle:{type:String,default:""},type:{type:String,default:""},buttonTitle:{type:String,default:""},formData:{type:Object,default:function(){return{}}}},data:function(){return{dialog:!1,submitLoad:!1,form:this.formData,items:["Item 1","Item 2"],url:"/api/sales/quote"}},methods:{newData:function(g,i){var l=this;this.$refs.dialogForm.openDialog(),this.form=Object.assign({},i),setTimeout(function(){l.$refs.formDocument.setData(l.form)},300),this.statusProcessing="insert"},editItem:function(g,i){var l=this;this.form=Object.assign({},g),this.statusProcessing="update",this.$refs.dialogForm.openDialog(),setTimeout(function(){l.$refs.formDocument.setData(l.form)},300)},close:function(){var g=this;this.$refs.dialogForm.closeDialog(),this.statusProcessing="insert",setTimeout(function(){g.form=Object.assign({},g.defaultItem)},300)},save:function(){var g=this,i=this.statusProcessing,l=this.$refs.formDocument.returnData();i==="insert"?(this.store("post",this.url,l),g.submitLoad=!1):i==="update"&&(this.store("put",this.url+"/"+this.form.id,l),g.submitLoad=!1)},store:function(g,i,l){var D=this,T=this;T.submitLoad=!0,this.$axios({method:g,url:i,data:l}).then(function(I){D.$refs.dialogForm.closeDialog(),D.$emit("getDataFromApi")}).catch(function(I){D.$swal({type:"error",title:"Error",text:I.response.data.message}),T.submitLoad=!1})}}},V=F,S=o(50),w=o(51),$=o.n(w),A=o(164),x=o(246),L=o(248),h=o(165),p=o(34),u=o(573),m=Object(S.a)(V,C,b,!1,null,null,null),v=y.default=m.exports;$()(m,{DocumentFormDocument:o(889).default,DialogForm:o(613).default}),$()(m,{VBtn:A.a,VIcon:x.a,VList:L.a,VListItem:h.a,VListItemTitle:p.d,VMenu:u.a})},613:function(_,y,o){"use strict";o.r(y);var C=function(){var a=this,g=a.$createElement,i=a._self._c||g;return i("v-dialog",{attrs:{"no-click-animation":"",persistent:"",scrollable:"",origin:a.original,"max-width":a.maxWidth,transition:"dialog-top-transition"},model:{value:a.dialog,callback:function(l){a.dialog=l},expression:"dialog"}},[i("v-card",[i("v-card-title",[i("span",{staticClass:"subtitle-2"},[a._v(a._s(a.dialogTitle))]),a._v(" "),i("v-spacer"),a._v(" "),i("v-btn",{attrs:{icon:"",color:"red",dark:""},on:{click:function(l){return a.closeDialog()}}},[i("v-icon",[a._v("mdi-close-circle")])],1)],1),a._v(" "),i("v-divider"),a._v(" "),i("v-card-text",{staticClass:"pr-0 pl-0"},[a._t("content")],2),a._v(" "),i("v-divider"),a._v(" "),i("v-card-actions",[a._t("addLine"),a._v(" "),i("v-spacer"),a._v(" "),a._t("saveData")],2)],1)],1)},b=[],P={name:"DialogForm",props:{maxWidth:{type:String,default:"800px"},dialogTitle:{type:String,default:""},original:{type:String,default:null}},data:function(){return{dialog:!1}},methods:{addLine:function(){this.$emit("addLine")},openDialog:function(){this.dialog=!0},closeDialog:function(){this.dialog=!1,this.$emit("eventCloseDialog")},saveData:function(){this.$emit("saveData")}}},F=P,V=o(50),S=o(51),w=o.n(S),$=o(164),A=o(247),x=o(88),L=o(591),h=o(572),p=o(246),u=o(589),m=Object(V.a)(F,C,b,!1,null,null,null),v=y.default=m.exports;w()(m,{VBtn:$.a,VCard:A.a,VCardActions:x.a,VCardText:x.b,VCardTitle:x.c,VDialog:L.a,VDivider:h.a,VIcon:p.a,VSpacer:u.a})},636:function(_,y,o){"use strict";o.r(y);var C=function(){var h=this,p=h.$createElement,u=h._self._c||p;return u("div",[u("dropzone",{ref:"attachment",attrs:{id:"attachment",options:h.options,"destroy-dropzone":!0},on:{"vdropzone-sending":function(m,v,a){return h.sendingParams(m,v,a)},"vdropzone-success":function(m,v){return h.reloadAttachment(m,v)},"vdropzone-error":function(m,v,a){return h.handleError(m,v,a)}}})],1)},b=[],P=o(59),F=o(648),V=o.n(F),S=o(649),w={name:"FieldUpload",components:{Dropzone:V.a},props:{formType:{type:String,default:""},formData:{type:Object,default:function(){return{}}}},data:function(){return{showLoadingAttachment:!1,form:this.formData,options:{url:window.location.protocol+"//"+window.location.hostname+"/qb-core/api/document-files",timeout:9e9,addRemoveLinks:!0,withCredentials:!0,thumbnailWidth:50,thumbnailHeight:50,acceptedFiles:"image/*",dictDefaultMessage:"<span class='mdi mdi-cloud-upload'></span> UPLOAD HERE",headers:{Authorization:this.$auth.$storage.getLocalStorage("_token.local")}}}},methods:{sendingParams:function(p,u,m){var v=this.form.id!==0?this.form.id:this.form.temp_id;m.append("temp_id",v),m.append("type",this.formType)},handleError:function(p,u,m){this.$swal({type:"error",title:"Error...",text:u.message})},reloadAttachment:function(p,u){var m=this;u.errors?this.$swal({type:"error",title:"Oops...",text:u.message}):(setTimeout(function(){m.getFiles()},300),this.$swal({type:"success",title:"Success...",text:"Attachment uploaded!"}))},getFiles:function(){var p=this;this.showLoadingAttachment=!0;var u=this,m=this.form.id?this.form.id:this.form.temp_id;this.$axios.get(u.options.url,{params:{type:this.formType,temp_id:m}}).then(function(v){p.$emit("eventGetFiles",{total:v.data.data.total,row:v.data.data.rows}),u.showLoadingAttachment=!1}).catch(function(v){p.showLoadingAttachment=!1,p.$swal({type:"error",title:"Error...",text:v.response.message})})},deleteFile:function(p){var u=this,m=this;this.$swal({title:"Are you sure?",text:"The file will be permanently deleted",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(function(v){v.value&&u.$axios.delete(m.options.url,{params:{id:p.id}}).then(function(a){u.$swal({type:"success",title:"Success...",text:"Attachment Deleted!"}),m.getFiles()}).catch(function(a){u.$swal({type:"error",title:"Oops...",text:a.response.data.message})})})}}},$=w,A=o(50),x=Object(A.a)($,C,b,!1,null,null,null),L=y.default=x.exports},889:function(_,y,o){"use strict";o.r(y);var C=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("v-row",{attrs:{dense:""}},[e("v-col",{attrs:{cols:"12",md:"9",sm:"8"}},[e("v-row",{attrs:{dense:""}},[e("v-col",{attrs:{cols:"12",md:"4",sm:"12"}},[e("v-autocomplete",{attrs:{items:t.itemContact,label:"Customer/Vendor","return-object":"","item-value":"id","item-text":"name",outlined:"",dense:"","hide-details":"auto"},on:{change:t.changeContact},model:{value:t.form.contact_id,callback:function(s){t.$set(t.form,"contact_id",s)},expression:"form.contact_id"}})],1),t._v(" "),e("v-col",{attrs:{cols:"12",md:"2",sm:"6"}},[e("v-select",{attrs:{items:t.itemPaymentTerm,"item-value":"id","item-text":"name",label:"Payment Term",outlined:"",dense:"","hide-details":"auto"},on:{change:t.changePaymentTerm},model:{value:t.form.payment_term_id,callback:function(s){t.$set(t.form,"payment_term_id",s)},expression:"form.payment_term_id"}})],1),t._v(" "),e("v-col",{attrs:{cols:"12",md:"2",sm:"4"}},[e("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:t._u([{key:"activator",fn:function(s){var c=s.on,r=s.attrs;return[e("v-text-field",t._g(t._b({attrs:{label:"Transaction Date","prepend-icon":"mdi-calendar",readonly:"","persistent-hint":"",outlined:"",dense:"","hide-details":"auto"},model:{value:t.form.issued_at,callback:function(f){t.$set(t.form,"issued_at",f)},expression:"form.issued_at"}},"v-text-field",r,!1),c))]}}]),model:{value:t.menu,callback:function(s){t.menu=s},expression:"menu"}},[t._v(" "),e("v-date-picker",{attrs:{"no-title":""},on:{input:function(s){t.menu=!1}},model:{value:t.form.issued_at,callback:function(s){t.$set(t.form,"issued_at",s)},expression:"form.issued_at"}})],1)],1),t._v(" "),e("v-col",{attrs:{cols:"12",md:"2",sm:"4"}},[e("v-menu",{ref:"menu3",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:t._u([{key:"activator",fn:function(s){var c=s.on,r=s.attrs;return[e("v-text-field",t._g(t._b({attrs:{label:"Due Date","prepend-icon":"mdi-calendar",readonly:"","persistent-hint":"",outlined:"",dense:"","hide-details":"auto"},model:{value:t.form.due_at,callback:function(f){t.$set(t.form,"due_at",f)},expression:"form.due_at"}},"v-text-field",r,!1),c))]}}]),model:{value:t.menu3,callback:function(s){t.menu3=s},expression:"menu3"}},[t._v(" "),e("v-date-picker",{attrs:{"no-title":""},on:{input:function(s){t.menu3=!1}},model:{value:t.form.due_at,callback:function(s){t.$set(t.form,"due_at",s)},expression:"form.due_at"}})],1)],1),t._v(" "),e("v-col",{attrs:{cols:"12",md:"4"}},[e("v-textarea",{attrs:{rows:"2",label:"Billing Address",outlined:"",dense:"","hide-details":"auto"},model:{value:t.form.contact_address,callback:function(s){t.$set(t.form,"contact_address",s)},expression:"form.contact_address"}})],1),t._v(" "),e("v-col",{attrs:{cols:"12",md:"4"}},[e("v-text-field",{attrs:{label:"No Contract",outlined:"",dense:"","hide-details":"auto"},model:{value:t.form.reference_no,callback:function(s){t.$set(t.form,"reference_no",s)},expression:"form.reference_no"}})],1),t._v(" "),e("v-col",{attrs:{cols:"12",md:"8"}},[e("v-combobox",{attrs:{items:t.itemTag,"search-input":t.search,"hide-selected":"",label:"Tags","hide-details":"",dense:"",multiple:"","persistent-hint":"","small-chips":"",outlined:""},on:{"update:searchInput":function(s){t.search=s},"update:search-input":function(s){t.search=s}},scopedSlots:t._u([{key:"no-data",fn:function(){return[e("v-list-item",[e("v-list-item-content",[e("v-list-item-title",[t._v(`
                  No results matching "`),e("strong",[t._v(t._s(t.search))]),t._v('". Press '),e("kbd",[t._v("enter")]),t._v(` to create a new one
                `)])],1)],1)]},proxy:!0}]),model:{value:t.form.tags,callback:function(s){t.$set(t.form,"tags",s)},expression:"form.tags"}})],1)],1)],1),t._v(" "),e("v-spacer"),t._v(" "),e("v-col",{staticClass:"text-right",attrs:{cols:"12",md:"3",xl:"2",sm:"4"}},[e("v-row",{attrs:{dense:""}},[e("v-col",{staticClass:"pt-0",attrs:{cols:"12"}},[e("p",{staticClass:"mb-0"},[t._v("Amount Due")]),t._v(" "),e("span",{staticClass:"text-right font-weight-bold text-h4"},[t._v(`
          `+t._s(isNaN(t.form.balance_due)?0:t.$formatter.formatPrice(t.form.balance_due))+`
        `)])]),t._v(" "),e("v-col",{attrs:{cols:"12"}},[e("v-autocomplete",{attrs:{items:t.itemSalesPersons,"item-value":"user_id","item-text":"first_name",label:"Sales Person",outlined:"",dense:"",multiple:"","persistent-hint":"","small-chips":"","hide-details":"auto"},model:{value:t.form.sales_person,callback:function(s){t.$set(t.form,"sales_person",s)},expression:"form.sales_person"}})],1)],1)],1),t._v(" "),e("v-col",{attrs:{cols:"12"}},[e("v-card",{attrs:{flat:""}},[e("LazyDocumentTableDetail",{ref:"childDetails",on:{calcTotal:t.calcTotal}}),t._v(" "),e("v-card-actions",[e("v-btn",{attrs:{small:"",depressed:"",outlined:""},on:{click:function(s){return t.$refs.childDetails.addLine(5)}}},[t._v(`
          Add Line
          `),e("v-icon",[t._v("mdi-plus")])],1)],1)],1)],1),t._v(" "),e("v-col",{attrs:{cols:"12",md:"4",lg:"4"}},[e("v-col",{attrs:{cols:"12",md:"12"}},[e("v-textarea",{attrs:{rows:"2",label:"Message",outlined:"",dense:"","hide-details":"auto"},model:{value:t.form.footer,callback:function(s){t.$set(t.form,"footer",s)},expression:"form.footer"}})],1),t._v(" "),e("v-col",{attrs:{cols:"12",md:"12"}},[e("v-textarea",{attrs:{rows:"2",label:"Memo",outlined:"",dense:"","hide-details":"auto"},model:{value:t.form.notes,callback:function(s){t.$set(t.form,"notes",s)},expression:"form.notes"}})],1),t._v(" "),e("v-col",{attrs:{cols:"12",md:"12"}},[e("DocumentFieldUpload",{ref:"uploadField",attrs:{"form-data":t.form,"form-type":"document"},on:{eventGetFiles:t.eventGetFiles}})],1)],1),t._v(" "),e("v-spacer"),t._v(" "),e("v-col",{attrs:{cols:"12",md:"6",lg:"5"}},[e("v-row",{attrs:{dense:""}},[e("v-col",{attrs:{cols:"12"}},[e("v-row",{attrs:{dense:""}},[e("v-spacer"),t._v(" "),e("v-col",{staticClass:"text-right pa-1",attrs:{cols:"12",md:"4"}},[e("span",{staticClass:"font-weight-bold subtitle-1"},[t._v("Subtotal")])]),t._v(" "),e("v-col",{staticClass:"text-right pa-1",attrs:{cols:"12",md:"4"}},[e("span",{staticClass:"font-weight-bold subtitle-1"},[t._v(`
              `+t._s(isNaN(t.form.sub_total)?0:t.$formatter.formatPrice(t.form.sub_total))+`
            `)])])],1)],1),t._v(" "),e("v-col",{attrs:{cols:"12"}},[e("v-row",{staticClass:"align-right",attrs:{dense:""}},[e("v-spacer"),t._v(" "),e("v-col",{staticClass:"pa-1",attrs:{cols:"12",md:"4"}},[e("v-select",{attrs:{items:["Value","Percent"],label:"Discount Type",outlined:"",dense:"","hide-details":"auto"},model:{value:t.form.discount_type,callback:function(s){t.$set(t.form,"discount_type",s)},expression:"form.discount_type"}})],1),t._v(" "),e("v-col",{staticClass:"pa-1",attrs:{cols:"12",md:"3"}},[e("vuetify-money",{staticClass:"text-money",attrs:{"value-when-is-empty":t.valueWhenIsEmpty,options:t.moneyOptionTotalDiscount,label:"Discount Rate",outlined:"",dense:"","hide-details":"auto"},model:{value:t.form.discount_rate,callback:function(s){t.$set(t.form,"discount_rate",s)},expression:"form.discount_rate"}})],1),t._v(" "),e("v-col",{staticClass:"text-right pa-1",attrs:{cols:"12",md:"4"}},[e("span",{staticClass:"font-weight-bold subtitle-1"},[t._v(`
              `+t._s(isNaN(t.form.discount_amount)?0:t.$formatter.formatPrice(t.form.discount_amount))+`
            `)])])],1)],1),t._v(" "),e("v-col",{attrs:{cols:"12"}},t._l(t.form.tax_details,function(s,c){return e("v-row",{key:c,attrs:{dense:""}},[e("v-spacer"),t._v(" "),e("v-col",{staticClass:"text-right pa-1",attrs:{cols:"12",md:"4"}},[e("span",{staticClass:"font-weight-bold subtitle-1"},[t._v(t._s(s.name))])]),t._v(" "),e("v-col",{staticClass:"text-right pa-1",attrs:{cols:"12",md:"4"}},[e("span",{staticClass:"font-weight-bold subtitle-1"},[t._v(`
              `+t._s(isNaN(s.amount)?0:t.$formatter.formatPrice(s.amount))+`
            `)])])],1)}),1),t._v(" "),e("v-col",{attrs:{cols:"12"}},[e("v-row",{attrs:{dense:""}},[e("v-spacer"),t._v(" "),e("v-col",{staticClass:"text-right pa-1",attrs:{cols:"12",md:"4"}},[e("span",{staticClass:"font-weight-bold subtitle-1"},[t._v("Shipping")])]),t._v(" "),e("v-col",{staticClass:"pa-1",attrs:{cols:"12",md:"4"}},[e("vuetify-money",{staticClass:"text-money",attrs:{"value-when-is-empty":t.valueWhenIsEmpty,options:t.moneyOptionTotal,label:"Shipping Fee",outlined:"",dense:"","hide-details":"auto"},model:{value:t.form.shipping_fee,callback:function(s){t.$set(t.form,"shipping_fee",s)},expression:"form.shipping_fee"}})],1)],1)],1),t._v(" "),e("v-col",{attrs:{cols:"12"}},[e("v-row",{attrs:{dense:""}},[e("v-spacer"),t._v(" "),e("v-col",{staticClass:"text-right pa-1",attrs:{cols:"12",md:"4"}},[e("span",{staticClass:"font-weight-bold subtitle-1"},[t._v("Total")])]),t._v(" "),e("v-col",{staticClass:"text-right pa-1",attrs:{cols:"12",md:"4"}},[e("span",{staticClass:"font-weight-bold subtitle-1"},[t._v(`
              `+t._s(isNaN(t.form.amount)?0:t.$formatter.formatPrice(t.form.amount))+`
            `)])])],1)],1),t._v(" "),e("v-col",{attrs:{cols:"12"}},[e("v-row",{attrs:{dense:""}},[e("v-spacer"),t._v(" "),e("v-col",{staticClass:"text-right pa-1",attrs:{cols:"12",md:"4"}},[e("span",{staticClass:"font-weight-bold subtitle-1"},[t._v("Deposit")])]),t._v(" "),e("v-col",{staticClass:"pa-1",attrs:{cols:"12",md:"4"}},[e("vuetify-money",{staticClass:"text-money",attrs:{"value-when-is-empty":t.valueWhenIsEmpty,options:t.moneyOptionTotal,label:"Amount",outlined:"",dense:"","hide-details":"auto"},model:{value:t.form.deposit_amount,callback:function(s){t.$set(t.form,"deposit_amount",s)},expression:"form.deposit_amount"}})],1)],1)],1),t._v(" "),e("v-col",{attrs:{cols:"12"}},[e("v-row",{attrs:{dense:""}},[e("v-spacer"),t._v(" "),e("v-col",{staticClass:"text-right pa-1",attrs:{cols:"12",md:"4"}},[e("span",{staticClass:"font-weight-bold subtitle-1"},[t._v("Balance Due")])]),t._v(" "),e("v-col",{staticClass:"text-right pa-1",attrs:{cols:"12",md:"4"}},[e("span",{staticClass:"font-weight-bold subtitle-1"},[t._v(`
              `+t._s(isNaN(t.form.balance_due)?0:t.$formatter.formatPrice(t.form.balance_due))+`
            `)])])],1)],1)],1)],1)],1)},b=[],P=o(25),F=o(74),V=o(4),S=o(29),w=o(10),$=o(59),A=o(101),x={name:"FormDocument",props:{formType:{type:String,default:""}},data:function(){return{menu:"",menu2:"",menu3:"",menu4:"",logo:"",search:null,selectedItem:1,dialog:!1,checkbox:!1,deposit:!1,tax:!0,withholding:!1,submitLoad:!1,showLoading:!1,form:{},itemCategory:[],itemUnit:[],itemContact:[],itemAccounts:[],itemTag:[],itemPaymentTerm:[],itemWarehouse:[],itemFiles:[],taxDetails:[],itemSalesPersons:[],statusProcessing:"insert",valueWhenIsEmpty:"0",tempTotalTax:0,subTotalMinDiscount:0,taxAmount:0,taxDiscount:0,amountBeforeTax:0,withholdingAmount:0,discountAmount:0,moneyOptions:{locale:"en",prefix:"",length:11,precision:0},moneyOptionTotal:{locale:"en",prefix:"",length:14,precision:2},moneyOptionTotalDiscount:{locale:"en",prefix:"",length:14,precision:0}}},computed:{depositAmount:function(){return this.form.deposit_amount},discountRate:function(){return this.form.discount_rate},discountType:function(){return this.form.discount_type},withholdingType:function(){return this.form.withholding_type},withholdingRate:function(){return this.form.withholding_rate},shippingFee:function(){return this.form.shipping_fee}},watch:{shippingFee:{handler:function(){this.changeCalculation()},deep:!0},depositAmount:{handler:function(){this.changeCalculation()},deep:!0},withholdingType:{handler:function(){this.changeCalculation()},deep:!0},discountType:{handler:function(){this.changeCalculation()},deep:!0},discountRate:{handler:function(){this.changeCalculation()},deep:!0},withholdingRate:{handler:function(){this.changeCalculation()},deep:!0}},mounted:function(){this.getMasterData()},methods:{checkDisable:function(){return this.form.status==="closed"||this.form.status==="cancel"},calcTotal:function(n){this.form.discount_per_line=n.discountAmount,this.form.sub_total=n.subTotal,this.form.tax_details=this.reduceArrayTax(n.taxDetail),this.taxDetails=n.taxDetail,this.form.amount=n.amount+this.tempTotalTax,this.form.balance_due=this.form.amount,this.subTotalMinDiscount=parseFloat(this.form.sub_total)-parseFloat(this.form.discount_per_line),this.form.sub_total===0&&(this.form.discount_rate=0,this.form.discount_amount=0),this.changeCalculation(n)},changeCalculation:function(n){this.taxDetails.length>0&&(this.form.tax_details=this.reduceArrayTax(this.taxDetails)),this.form.discount_amount=0,this.form.discount_type==="Percent"?this.form.discount_rate>0&&(this.subTotalMinDiscount=parseFloat(this.form.sub_total)-parseFloat(this.form.discount_per_line),this.form.discount_amount=this.form.discount_rate/100*this.subTotalMinDiscount,this.taxDiscount=this.form.discount_rate/100*this.tempTotalTax):(this.form.discount_amount=parseFloat(this.form.discount_rate),this.tempTotalTax>0&&(this.taxDiscount=this.tempTotalTax-this.form.discount_amount)),this.taxAmount=parseFloat(this.tempTotalTax)-parseFloat(this.taxDiscount),this.taxAmount=this.taxAmount===void 0?0:this.taxAmount,this.taxDetails.length>0&&parseFloat(this.form.discount_rate)>0&&(this.form.tax_details=this.reduceArrayTaxAfterDiscount(this.taxDetails)),this.form.amount=parseFloat(this.form.sub_total)-parseFloat(this.form.discount_per_line)-parseFloat(this.form.discount_amount)+parseFloat(this.taxAmount),this.amountBeforeTax=this.form.amount-this.taxAmount,this.form.withholding_type==="Percent"?this.form.withholding_rate>0&&(this.form.withholding_amount=this.form.withholding_rate/100*this.amountBeforeTax):this.form.withholding_amount=parseFloat(this.form.withholding_rate),this.form.balance_due=this.form.amount-this.form.deposit_amount-this.form.withholding_amount-parseFloat(this.form.shipping_fee)},reduceArrayTaxAfterDiscount:function(n){var e=[],s=this;return n.reduce(function(c,r){if(c[r.name]||(c[r.name]={name:r.name,amount:0},e.push(c[r.name])),parseFloat(s.form.discount_rate)>0){var f=0;s.form.discount_type==="Percent"?f=parseFloat(s.form.discount_rate)/100*parseFloat(r.amount):f=parseFloat(s.form.discount_rate),c[r.name].amount=parseFloat(r.amount)-parseFloat(f)}return c},{}),e},reduceArrayTax:function(n){var e=[],s=this,c=0;return n.forEach(function(r,f){c+=parseFloat(r.amount)}),s.tempTotalTax=c,n.reduce(function(r,f){return r[f.name]||(r[f.name]={name:f.name,amount:0},e.push(r[f.name])),r[f.name].amount+=f.amount,r},{}),e},showLoad:function(n){this.showLoading=n},setData:function(n){var e=this;this.showLoading=!0,setTimeout(function(){e.$refs.childDetails.setDataToDetails([{item_number:null,description:null,qty:null,unit:null},{item_number:null,description:null,qty:null,unit:null}],n)},500),this.form=Object.assign({},n),this.moneyOptionTotal.prefix=this.form.default_currency_symbol,this.moneyOptionTotalDiscount.prefix=this.form.default_currency_symbol,this.moneyOptions.prefix=this.form.default_currency_symbol,this.statusProcessing="insert"},eventGetFiles:function(n){this.itemFiles=n.row},getMasterData:function(){var n=this;return Object(P.a)(regeneratorRuntime.mark(function e(){var s,c,r,f,R,j,E;return regeneratorRuntime.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return n.$nuxt.$loading.start(),d.prev=1,d.next=4,n.$axios.get("/api/master/categories",{params:{type:"Item Category"}});case 4:return s=d.sent,d.next=7,n.$axios.get("/api/inventory/item-units",{params:{type:"Item Category"}});case 7:return c=d.sent,d.next=10,n.$axios.get("/api/financial/accounts",{params:{type:"All"}});case 10:return r=d.sent,d.next=13,n.$axios.get("/api/bp/contacts",{params:{type:n.$route.query.type}});case 13:return f=d.sent,d.next=16,n.$axios.get("/api/financial/payment-terms",{params:{type:"All"}});case 16:return R=d.sent,d.next=19,n.$axios.get("/api/financial/taxes",{params:{type:"All"}});case 19:return j=d.sent,d.next=22,n.$axios.get("/api/payroll/employees",{params:{type:"All"}});case 22:E=d.sent,n.itemCategory=s.data.data.simple,n.itemUnit=c.data.data.simple,n.itemAccounts=r.data.data.rows,n.itemContact=f.data.data.rows,n.itemPaymentTerm=R.data.data.auto_complete,n.$auth.$storage.setLocalStorage("tax",j.data.data.simple),n.$auth.$storage.setLocalStorage("tax_row",j.data.data.rows),n.$auth.$storage.setLocalStorage("salesPerson",E.data.data.rows),n.itemSalesPersons=E.data.data.rows,d.next=37;break;case 34:d.prev=34,d.t0=d.catch(1),n.$swal({type:"error",title:"Error",text:d.t0.response.data.error});case 37:case"end":return d.stop()}},e,null,[[1,34]])}))()},changePaymentTerm:function(){var n=this;this.$axios.get("/api/financial/payment-terms/"+this.form.payment_term_id).then(function(e){Date.prototype.addDays=function(c){var r=new Date(this.valueOf());return r.setDate(r.getDate()+c),r};var s=new Date(n.form.issued_at);n.form.due_at=n.formatDate(s.addDays(e.data.data.rows.value))})},formatDate:function(n){var e=new Date(n),s=""+(e.getMonth()+1),c=""+e.getDate(),r=e.getFullYear();return s.length<2&&(s="0"+s),c.length<2&&(c="0"+c),[r,s,c].join("-")},changeContact:function(){var n=this.form.contact_id;this.form.contact_id=n.id,this.form.contact_address=n.address?n.address:this.form.contact_address,this.form.shipping_address=n.shipping_address?n.shipping_address:this.form.shipping_address},checkDocument:function(){var n=this.$route.query.type;switch(n){case"SQ":case"PQ":return!1;default:return!0}},returnData:function(n){var e=this,s={},c=e.$refs.childDetails.getAddData(n);return c.forEach(function(r,f){e.$refs.childDetails.checkIfEmptyRow(f)||(s[f]=r)}),this.form.items=s,this.form},changeValue:function(n,e){this.form[n]=e}}},L=x,h=o(50),p=o(51),u=o.n(p),m=o(643),v=o(164),a=o(247),g=o(88),i=o(581),l=o(1008),D=o(1017),T=o(246),I=o(165),N=o(34),z=o(573),B=o(595),M=o(637),U=o(589),W=o(570),G=o(797),O=Object(h.a)(L,C,b,!1,null,null,null),k=y.default=O.exports;u()(O,{DocumentFieldUpload:o(636).default}),u()(O,{VAutocomplete:m.a,VBtn:v.a,VCard:a.a,VCardActions:g.a,VCol:i.a,VCombobox:l.a,VDatePicker:D.a,VIcon:T.a,VListItem:I.a,VListItemContent:N.b,VListItemTitle:N.d,VMenu:z.a,VRow:B.a,VSelect:M.a,VSpacer:U.a,VTextField:W.a,VTextarea:G.a})}}]);
