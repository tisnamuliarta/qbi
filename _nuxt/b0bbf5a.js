(window.webpackJsonp=window.webpackJsonp||[]).push([[172,52],{1046:function(R,v,s){"use strict";s.r(v);var h=function(){var t=this,m=t.$createElement,e=t._self._c||m;return e("v-layout",[e("v-flex",{attrs:{sm12:"",md12:""}},[e("div",{staticClass:"mt-0"},[e("v-data-table",{staticClass:"elevation-1",attrs:{"mobile-breakpoint":0,headers:t.headers,items:t.allData,"items-per-page":20,options:t.options,"server-items-length":t.totalData,loading:t.loading,"show-select":"",dense:"","fixed-header":"",height:"70vh","footer-props":{"items-per-page-options":[20,50,100,-1]}},on:{"update:options":function(c){t.options=c}},scopedSlots:t._u([{key:"top",fn:function(){return[e("div",{staticClass:"pl-4 pt-2"},[e("span",{staticClass:"font-weight-medium text-h6"},[t._v("Users")])]),t._v(" "),e("LazyMainToolbar",{staticClass:"has-border-bottom",attrs:{"document-status":t.documentStatus,"search-status":t.searchStatus,"item-search":t.itemSearch,"search-item":t.searchItem,search:t.search,filter:!1,title:"Roles","title-button":"Roles","show-back-link":"","show-new-data":"","show-batch-action":"","new-data-text":"New Role"},on:{emitData:t.emitData,newData:t.newData,getDataFromApi:t.getDataFromApi}})]},proxy:!0},{key:"item.ACTIONS",fn:function(c){var p=c.item;return[e("v-btn",{staticClass:"font-weight-bold text-right",attrs:{color:"secondary",text:"",small:""},on:{click:function(n){return t.actions(t.itemAction,p)}}},[t._v(`
            `+t._s(t.itemText)+`
          `)]),t._v(" "),e("v-menu",{attrs:{transition:"slide-y-transition",bottom:""},scopedSlots:t._u([{key:"activator",fn:function(n){var i=n.on,r=n.attrs;return[e("v-btn",t._g(t._b({attrs:{color:"black",dark:"",icon:""}},"v-btn",r,!1),i),[e("v-icon",[t._v("mdi-menu-down")])],1)]}}],null,!0)},[t._v(" "),e("v-list",t._l(t.items,function(n,i){return e("v-list-item",{key:i,on:{click:function(r){return t.actions(n.action,p)}}},[e("v-list-item-content",[e("v-list-item-title",[t._v(t._s(n.text))])],1)],1)}),1)],1)]}}],null,!0)})],1)]),t._v(" "),e("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:t.dialog,callback:function(c){t.dialog=c},expression:"dialog"}},[e("v-card",[e("v-card-title",[e("span",{staticClass:"headline"},[t._v(t._s(t.formTitle))])]),t._v(" "),e("v-card-text",[e("v-form",[e("v-layout",{attrs:{wrap:""}},[t.message?e("v-flex",{attrs:{xs12:""}},[e("div",{staticClass:"red darken-2 text-xs-center"},[e("span",{staticClass:"white--text"},[t._v(t._s(t.message))])])]):t._e(),t._v(" "),e("v-flex",{staticClass:"d-flex",attrs:{md12:""}},[e("v-layout",{attrs:{wrap:""}},[e("v-flex",{staticClass:"pa-2",attrs:{md12:""}},[e("v-text-field",{attrs:{label:"Role Name",placeholder:"Role Name",outlined:"",dense:"","hide-details":"auto"},model:{value:t.form.name,callback:function(c){t.$set(t.form,"name",c)},expression:"form.name"}})],1),t._v(" "),e("v-flex",{staticClass:"pa-2",attrs:{md12:""}},[e("v-text-field",{attrs:{label:"Description",placeholder:"Description",outlined:"",dense:"","hide-details":"auto"},model:{value:t.form.description,callback:function(c){t.$set(t.form,"description",c)},expression:"form.description"}})],1)],1)],1)],1)],1)],1),t._v(" "),e("v-card-actions",[e("v-spacer"),t._v(" "),e("v-btn",{attrs:{color:"red darken-1",text:"",small:""},on:{click:function(c){t.dialog=!1}}},[t._v(`
          Close
        `)]),t._v(" "),e("v-btn",{attrs:{color:"green darken-1",dark:"",small:"",loading:t.submitLoad},on:{click:function(c){return t.save()}}},[t._v(`
          Save
        `)])],1)],1)],1),t._v(" "),e("MasterDialogPermission",{ref:"dialogPermission"})],1)},P=[],E=s(59),M={name:"MasterRole",data:function(){return{totalData:0,editedIndex:-1,loadNewBtn:!1,submitLoad:!1,dialogWindow:!1,statusProcessing:"insert",dialog:!1,message:!1,loading:!0,insertDivision:!0,insert:!0,items:[{text:"Edit",action:"edit"},{text:"Direct Permissions",action:"permissions"}],itemText:"",itemAction:"",loadingPermission:!0,allData:[],department:{},form:{id:null,name:null,description:null},defaultItem:{id:null,name:null,description:null},options:{},optionDivision:{},headers:[{text:"Role Name",value:"name"},{text:"Description",value:"description"},{text:"Guard",value:"guard_name"},{text:"Action",value:"ACTIONS",align:"center"}]}},head:function(){return{title:"Master Roles"}},computed:{formTitle:function(){return this.editedIndex===-1?"New":"Edit"}},watch:{options:{handler:function(){this.getDataFromApi()},deep:!0}},activated:function(){this.getDataFromApi(),this.itemText=this.items[0].text,this.itemAction=this.items[0].action},methods:{actions:function(m,e){m==="edit"?this.editItem(e):this.$refs.dialogPermission.openRolePermissions(e,"Role Permissions","role")},getDataFromApi:function(){var m=this;this.loading=!0;var e=this;this.$axios.get("/api/master/roles",{params:{options:e.options}}).then(function(c){m.loading=!1,m.allData=c.data.data.rows,m.totalData=c.data.data.total}).catch(function(c){m.loading=!1,m.$swal({type:"error",title:"Error",text:c.response.data.message})})},newData:function(){this.dialog=!0,this.statusProcessing="insert",this.form=Object.assign({},this.defaultItem),this.message=!1},editItem:function(m){this.editedIndex=this.allData.indexOf(m),this.form=Object.assign({},m),this.statusProcessing="update",this.dialog=!0,this.insert=!1},close:function(){var m=this;this.dialog=!1,this.statusProcessing="insert",setTimeout(function(){m.form=Object.assign({},m.defaultItem),m.editedIndex=-1},300)},save:function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"all",e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,c=this,p=this.form,n=this.statusProcessing,i={form:p,status:n};n==="insert"?(this.store("post","/api/master/roles",i,"insert",m),c.submitLoad=!1):n==="update"&&(this.store("put","/api/master/roles/"+this.form.id,i,"update",m),c.submitLoad=!1)},store:function(m,e,c,p){var n=this,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"all",r=this;r.submitLoad=!0,this.$axios({method:m,url:e,data:c}).then(function(u){u.data.status==="Error"?(n.$swal({type:"error",title:"Error",text:u.data.message}),r.submitLoad=!1):(n.dialog=!1,n.message=u.data.message,setTimeout(function(){return n.message=!1},8e3),n.getDataFromApi())}).catch(function(u){n.$swal({type:"error",title:"Error",text:u.response.data.message}),r.submitLoad=!1})}}},A=M,x=s(50),I=s(51),O=s.n(I),B=s(164),C=s(247),g=s(88),T=s(1018),$=s(591),y=s(617),V=s(612),U=s(246),a=s(615),l=s(248),o=s(165),d=s(34),_=s(573),L=s(589),j=s(570),D=Object(x.a)(A,h,P,!1,null,null,null),b=v.default=D.exports;O()(D,{MasterDialogPermission:s(639).default}),O()(D,{VBtn:B.a,VCard:C.a,VCardActions:g.a,VCardText:g.b,VCardTitle:g.c,VDataTable:T.a,VDialog:$.a,VFlex:y.a,VForm:V.a,VIcon:U.a,VLayout:a.a,VList:l.a,VListItem:o.a,VListItemContent:d.b,VListItemTitle:d.d,VMenu:_.a,VSpacer:L.a,VTextField:j.a})},612:function(R,v,s){"use strict";var h=s(1),P=s(33),E=s.n(P),M=s(52),A=s.n(M),x=s(286),I=s.n(x),O=s(9),B=s.n(O),C=s(4),g=s.n(C),T=s(10),$=s.n(T),y=s(59),V=s.n(y),U=s(79),a=s.n(U),l=s(8),o=s.n(l),d=s(7),_=s.n(d),L=s(12),j=s.n(L),D=s(13),b=s.n(D),t=s(5),m=s(99),e=s(118);function c(n,i){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);i&&(u=u.filter(function(f){return Object.getOwnPropertyDescriptor(n,f).enumerable})),r.push.apply(r,u)}return r}function p(n){for(var i=1;i<arguments.length;i++){var r=arguments[i]!=null?arguments[i]:{};i%2?c(Object(r),!0).forEach(function(u){Object(h.a)(n,u,r[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(r,u))})}return n}v.a=Object(t.a)(m.a,Object(e.b)("form")).extend({name:"v-form",provide:function(){return{form:this}},inheritAttrs:!1,props:{disabled:Boolean,lazyValidation:Boolean,readonly:Boolean,value:Boolean},data:function(){return{inputs:[],watchers:[],errorBag:{}}},watch:{errorBag:{handler:function(i){var r=Object.values(i).includes(!0);this.$emit("input",!r)},deep:!0,immediate:!0}},methods:{watchInput:function(i){var r=this,u=function(W){return W.$watch("hasError",function(S){r.$set(r.errorBag,W._uid,S)},{immediate:!0})},f={_uid:i._uid,valid:function(){},shouldValidate:function(){}};return this.lazyValidation?f.shouldValidate=i.$watch("shouldValidate",function(K){!K||r.errorBag.hasOwnProperty(i._uid)||(f.valid=u(i))}):f.valid=u(i),f},validate:function(){return this.inputs.filter(function(i){return!i.validate(!0)}).length===0},reset:function(){this.inputs.forEach(function(i){return i.reset()}),this.resetErrorBag()},resetErrorBag:function(){var i=this;this.lazyValidation&&setTimeout(function(){i.errorBag={}},0)},resetValidation:function(){this.inputs.forEach(function(i){return i.resetValidation()}),this.resetErrorBag()},register:function(i){this.inputs.push(i),this.watchers.push(this.watchInput(i))},unregister:function(i){var r=this.inputs.find(function(f){return f._uid===i._uid});if(!!r){var u=this.watchers.find(function(f){return f._uid===r._uid});u&&(u.valid(),u.shouldValidate()),this.watchers=this.watchers.filter(function(f){return f._uid!==r._uid}),this.inputs=this.inputs.filter(function(f){return f._uid!==r._uid}),this.$delete(this.errorBag,r._uid)}}},render:function(i){var r=this;return i("form",{staticClass:"v-form",attrs:p({novalidate:!0},this.attrs$),on:{submit:function(f){return r.$emit("submit",f)}}},this.$slots.default)}})},615:function(R,v,s){"use strict";var h=s(281),P=s.n(h),E=s(282);v.a=Object(E.a)("layout")},617:function(R,v,s){"use strict";var h=s(281),P=s.n(h),E=s(282);v.a=Object(E.a)("flex")},639:function(R,v,s){"use strict";s.r(v);var h=function(){var a=this,l=a.$createElement,o=a._self._c||l;return o("v-dialog",{attrs:{persistent:"","max-width":"1000px",transition:"dialog-bottom-transition"},model:{value:a.dialogPermission,callback:function(d){a.dialogPermission=d},expression:"dialogPermission"}},[o("v-card",{attrs:{loading:a.loadingPermission}},[o("v-card-title",[o("span",{staticClass:"subtitle-2"},[a._v(`
        `+a._s(a.dialogTitle)+`
      `)]),a._v(" "),o("v-spacer"),a._v(" "),o("v-btn",{attrs:{color:"red darken-1",dark:"",icon:"",small:""},on:{click:a.closeDialogPermission}},[o("v-icon",[a._v("mdi-close-circle")])],1)],1),a._v(" "),o("v-card-text",[o("div",{staticClass:"scroll-container"},[o("LazyMasterPermissionList",{ref:"childDetails"})],1)]),a._v(" "),o("v-card-actions",[a.canAddData?o("v-btn",{staticClass:"white--text",attrs:{small:"",color:"orange darken-1"},on:{click:function(d){return a.$refs.childDetails.addLine()}}},[a._v(`
        Add Line
      `)]):a._e(),a._v(" "),o("v-spacer"),a._v(" "),a.canAddData?o("v-btn",{attrs:{color:"green darken-1",dark:"",small:"",loading:a.loadingPermission},on:{click:function(d){return a.saveRolePermission()}}},[a._v(`
        Save
      `)]):a._e()],1)],1)],1)},P=[],E=s(4),M={name:"DialogPermission",data:function(){return{loadingPermission:!1,dialogPermission:!1,dialogTitle:"",role:"",userRole:[],form:{},canAddData:!1,type:""}},mounted:function(){this.getPermissionList()},methods:{getPermissionList:function(){var l=this;this.$axios.get("/api/master/permissions").then(function(o){l.$auth.$storage.setLocalStorage("permission_list",o.data.data.simple)})},openDialogPermission:function(l,o){this.dialogTitle=o,this.dialogPermission=!0,this.loadingPermission=!0,this.form=Object.assign({},l),this.canAddData=!0,this.getPermissionUser(l),this.type="user"},getPermissionUser:function(l){var o=this;this.userRole=null,this.$axios.get("/api/master/user/permission",{params:{form:l}}).then(function(d){o.$refs.childDetails.setDataToDetails(d.data.data.rows)}).finally(function(d){o.loadingPermission=!1})},closeDialogPermission:function(){this.dialogPermission=!1,this.userRole=[],this.canAddData=!1},openRolePermissions:function(l,o,d){var _=this,L=this;this.type=d,this.dialogTitle=o,this.dialogPermission=!0,this.loadingPermission=!0,this.form=Object.assign({},l);var j="";d==="user"?j="/api/master/user/roles":(this.canAddData=!0,j="/api/master/permission-role"),this.$axios.get(j,{params:{form:this.form}}).then(function(D){L.$refs.childDetails.setDataToDetails(D.data.data.rows),_.loadingPermission=!1}).finally(function(D){_.loadingPermission=!1})},changeTab:function(l){var o=this;this.loadingPermission=!0,this.$axios.post("/api/master/permission-role",{form:l}).then(function(d){o.$refs.childDetails.setDataToDetails(d.data.data.rows)}).finally(function(d){o.loadingPermission=!1})},getRolePermissionUser:function(l){var o=this;this.$axios.post("/api/master/user/role-permission",{item:l}).then(function(d){o.$refs.childDetails.setDataToDetails(d.data.data.rows)}).finally(function(d){o.loadingPermission=!1})},getPermissionRole:function(l){var o=this;this.$axios.post("/api/master/permission-role",{form:this.form}).then(function(d){o.$refs.childDetails.setDataToDetails(d.data.data.rows)}).finally(function(d){o.loadingPermission=!1})},saveRolePermission:function(){var l=this;this.loadingPermission=!0;var o=this.$refs.childDetails.getAddData(),d="";this.type==="user"?d="/api/master/user/permission":d="/api/master/permission-role",this.$axios.post(d,{details:o,form:this.form}).then(function(_){l.$swal({icon:"success",title:"Success",text:_.data.message}),l.type==="user"?l.getPermissionUser(l.form):l.getPermissionRole(l.form)}).catch(function(_){l.$swal({icon:"error",title:"Error",text:_.response.data.message})}).finally(function(_){l.loadingPermission=!1})}}},A=M,x=s(50),I=s(51),O=s.n(I),B=s(164),C=s(247),g=s(88),T=s(591),$=s(246),y=s(589),V=Object(x.a)(A,h,P,!1,null,null,null),U=v.default=V.exports;O()(V,{VBtn:B.a,VCard:C.a,VCardActions:g.a,VCardText:g.b,VCardTitle:g.c,VDialog:T.a,VIcon:$.a,VSpacer:y.a})}}]);
