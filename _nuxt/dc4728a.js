(window.webpackJsonp=window.webpackJsonp||[]).push([[39,37],{1086:function(P,h,a){"use strict";a.r(h);var g=function(){var t=this,e=t._self._c;return e("v-row",{attrs:{dense:""}},[e("v-col",{attrs:{cols:"12",md:"9",sm:"8"}},[e("v-row",{attrs:{dense:""}},[e("v-col",{attrs:{cols:"12",md:"4",sm:"12"}},[e("v-autocomplete",{attrs:{items:t.itemContact,label:"Customer/Vendor","return-object":"","item-value":"id","item-text":"name",outlined:"",dense:"","hide-details":"auto"},on:{change:t.getInvoice},model:{value:t.form.contact_id,callback:function(o){t.$set(t.form,"contact_id",o)},expression:"form.contact_id"}})],1),t._v(" "),e("v-col",{attrs:{cols:"12",lg:"2",md:"2",sm:"6"}},[e("v-select",{attrs:{items:t.itemPaymentMethod,"item-value":"id","item-text":"name",label:"Payment Method",outlined:"",dense:"","hide-details":"auto"},model:{value:t.form.payment_term_id,callback:function(o){t.$set(t.form,"payment_term_id",o)},expression:"form.payment_term_id"}})],1),t._v(" "),e("v-col",{attrs:{cols:"12",lg:"2",md:"2",sm:"6"}},[e("v-text-field",{attrs:{label:"Transaction Date","persistent-hint":"",outlined:"",dense:"","hide-details":"auto",type:"date"},model:{value:t.form.transaction_date,callback:function(o){t.$set(t.form,"transaction_date",o)},expression:"form.transaction_date"}})],1),t._v(" "),e("v-col",{attrs:{cols:"12",md:"4",sm:"12"}},[e("v-autocomplete",{attrs:{items:t.itemAccounts,label:"Deposit Account","return-object":"","item-value":"id","item-text":"name",outlined:"",dense:"","hide-details":"auto"},model:{value:t.form.deposit_account_id,callback:function(o){t.$set(t.form,"deposit_account_id",o)},expression:"form.deposit_account_id"}})],1),t._v(" "),e("v-col",{attrs:{cols:"12",md:"4",sm:"6"}},[e("v-text-field",{attrs:{label:"No Contract",outlined:"",dense:"","hide-details":"auto"},model:{value:t.form.reference_no,callback:function(o){t.$set(t.form,"reference_no",o)},expression:"form.reference_no"}})],1)],1)],1),t._v(" "),e("v-spacer"),t._v(" "),e("v-col",{staticClass:"text-right",attrs:{cols:"12",md:"3",xl:"2",sm:"4"}},[e("v-row",{attrs:{dense:""}},[e("v-col",{staticClass:"pt-0",attrs:{cols:"12"}},[e("p",{staticClass:"mb-0"},[t._v("Amount Due")]),t._v(" "),e("span",{staticClass:"text-right font-weight-bold text-h4"},[t._v(`
            `+t._s(isNaN(t.form.main_account_amount)?0:t.$formatter.formatPrice(t.form.main_account_amount))+`
          `)])]),t._v(" "),e("v-col",{attrs:{cols:"12"}},[e("v-chip",{attrs:{label:"",color:t.statusColor(t.form.status),dark:""}},[t._v(`
            `+t._s(t.form.status))])],1)],1)],1),t._v(" "),e("v-col",{staticClass:"mt-2",attrs:{cols:"12"}},[e("v-card",{attrs:{flat:""}},[e("LazyPaymentTablePayment",{ref:"childDetails",on:{calcTotal:t.calcTotal}})],1)],1),t._v(" "),e("v-col",{attrs:{cols:"12",md:"4",lg:"4"}},[e("v-col",{attrs:{cols:"12",md:"12"}},[e("v-textarea",{attrs:{rows:"2",label:"Memo",outlined:"",dense:"","hide-details":"auto"},model:{value:t.form.narration,callback:function(o){t.$set(t.form,"narration",o)},expression:"form.narration"}})],1),t._v(" "),e("v-col",{attrs:{cols:"12",md:"12"}},[e("DocumentFieldUpload",{ref:"uploadField",attrs:{"form-data":t.form,"form-type":"document"},on:{eventGetFiles:t.eventGetFiles}})],1)],1),t._v(" "),e("v-spacer"),t._v(" "),e("v-col",{attrs:{cols:"12",md:"6",lg:"5"}},[e("v-row",{attrs:{dense:""}},[e("v-col",{attrs:{cols:"12"}},[e("v-row",{attrs:{dense:""}},[e("v-spacer"),t._v(" "),e("v-col",{staticClass:"text-right pa-1",attrs:{cols:"12",md:"4"}},[e("span",{staticClass:"font-weight-bold subtitle-1"},[t._v("Subtotal")])]),t._v(" "),e("v-col",{staticClass:"text-right pa-1",attrs:{cols:"12",md:"4"}},[e("span",{staticClass:"font-weight-bold subtitle-1"},[t._v(`
                `+t._s(isNaN(t.form.sub_total)?0:t.$formatter.formatPrice(t.form.sub_total))+`
              `)])])],1)],1),t._v(" "),e("v-col",{attrs:{cols:"12"}},[e("v-row",{attrs:{dense:""}},[e("v-spacer"),t._v(" "),e("v-col",{staticClass:"text-right pa-1",attrs:{cols:"12",md:"4"}},[e("span",{staticClass:"font-weight-bold subtitle-1"},[t._v("Total")])]),t._v(" "),e("v-col",{staticClass:"text-right pa-1",attrs:{cols:"12",md:"4"}},[e("span",{staticClass:"font-weight-bold subtitle-1"},[t._v(`
                `+t._s(isNaN(t.form.main_account_amount)?0:t.$formatter.formatPrice(t.form.main_account_amount))+`
              `)])])],1)],1)],1)],1)],1)},y=[],$=a(24),T=a(74),b=a(59),V=a(101),w=a(4),F=a(10),x={name:"FormDocument",props:{formType:{type:String,default:""}},data:function(){return{tab:null,menu:"",menu2:"",menu3:"",menu4:"",logo:"",search:null,selectedItem:1,dialog:!1,checkbox:!1,deposit:!1,tax:!0,withholding:!1,submitLoad:!1,showLoading:!1,form:{},itemCategory:[],itemUnit:[],itemContact:[],itemAccounts:[],itemTag:[],itemPaymentMethod:[],itemWarehouse:[],itemFiles:[],taxDetails:[],itemSalesPersons:[],statusProcessing:"insert",valueWhenIsEmpty:"0",tempTotalTax:0,subTotalMinDiscount:0,taxAmount:0,taxDiscount:0,amountBeforeTax:0,withholdingAmount:0,discountAmount:0,moneyOptions:{locale:"en",prefix:"",length:11,precision:0},moneyOptionTotal:{locale:"en",prefix:"",length:14,precision:2},moneyOptionTotalDiscount:{locale:"en",prefix:"",length:14,precision:0}}},activated:function(){var t=this;this.getMasterData(),this.$nextTick(function(){t.$nuxt.$loading.start()})},mounted:function(){},methods:{checkDisable:function(){return this.form.status==="closed"||this.form.status==="cancel"},statusColor:function(t){switch(t){case"open":return"blue darken-3";case"partial":return"orange";case"paid":return"green";case"closed":return"green";case"overdue":return"red";case"cancel":return"red"}},calcTotal:function(t){try{this.form.main_account_amount=t.amount,this.form.sub_total=t.amount}catch(e){console.log(e)}},showLoad:function(t){this.showLoading=t},setData:function(t){var e=this;this.showLoading=!0,setTimeout(function(){e.$refs.childDetails.setDataToDetails([{item_number:null,narration:null,qty:null,unit:null}],t)},500),this.form=Object.assign({},t),this.moneyOptionTotal.prefix=this.form.default_currency_symbol,this.moneyOptionTotalDiscount.prefix=this.form.default_currency_symbol,this.moneyOptions.prefix=this.form.default_currency_symbol,this.statusProcessing="insert"},eventGetFiles:function(t){this.itemFiles=t.row},getMasterData:function(){var t=this;return Object($.a)(regeneratorRuntime.mark(function e(){var s,o,u,p;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return t.$nuxt.$loading.start(),l.prev=1,l.next=4,t.$axios.get("/api/master/categories",{params:{type:"Item Category"}});case 4:return s=l.sent,l.next=7,t.$axios.get("/api/financial/accounts",{params:{type:"BANK"}});case 7:return o=l.sent,l.next=10,t.$axios.get("/api/bp/contacts",{params:{type:t.formType}});case 10:return u=l.sent,l.next=13,t.$axios.get("/api/financial/payment-methods");case 13:p=l.sent,t.itemCategory=s.data.simple,t.itemAccounts=o.data.data,t.itemContact=u.data.data,t.itemPaymentMethod=p.data.data,l.next=23;break;case 20:l.prev=20,l.t0=l.catch(1),t.$swal({type:"error",title:"Error",text:l.t0.response.data.error});case 23:case"end":return l.stop()}},e,null,[[1,20]])}))()},changePaymentTerm:function(){var t=this;this.$axios.get("/api/financial/payment-terms/"+this.form.payment_term_id).then(function(e){Date.prototype.addDays=function(o){var u=new Date(this.valueOf());return u.setDate(u.getDate()+o),u};var s=t.$moment(t.form.transaction_date);t.form.due_date=s.add(e.data.data.value,"days").format("YYYY-MM-DD")})},formatDate:function(t){var e=new Date(t),s=""+(e.getMonth()+1),o=""+e.getDate(),u=e.getFullYear();return s.length<2&&(s="0"+s),o.length<2&&(o="0"+o),[u,s,o].join("-")},changeContact:function(){var t=this.form.contact_id;this.form.contact_id=t.id,this.form.contact_address=t.address?t.address:this.form.contact_address,this.form.shipping_address=t.shipping_address?t.shipping_address:this.form.shipping_address},checkDocument:function(){var t=this.$route.query.type;switch(t){case"SQ":case"PQ":return!1;default:return!0}},getInvoice:function(){var t=this;this.form.contact_id=this.form.contact_id.id;var e=this.form.contact_id;this.$axios("/api/transaction/invoice",{params:{type:this.formType,contact:e}}).then(function(s){setTimeout(function(){t.$refs.childDetails.setDataToDetails([{amount:null}],s.data.data)},500)})},returnData:function(t){var e=this,s={},o=e.$refs.childDetails.getAddData(t);return o.forEach(function(u,p){e.$refs.childDetails.checkIfEmptyRow(p)||(s[p]=u)}),this.form.line_items=s,this.form},changeValue:function(t,e){this.form[t]=e}}},D=x,A=a(50),f=a(51),n=a.n(f),r=a(637),c=a(248),m=a(578),d=a(585),v=a(599),z=a(631),O=a(593),j=a(574),L=a(662),C=Object(A.a)(D,g,y,!1,null,null,null),M=h.default=C.exports;n()(C,{DocumentFieldUpload:a(642).default}),n()(C,{VAutocomplete:r.a,VCard:c.a,VChip:m.a,VCol:d.a,VRow:v.a,VSelect:z.a,VSpacer:O.a,VTextField:j.a,VTextarea:L.a})},642:function(P,h,a){"use strict";a.r(h);var g=function(){var n=this,r=n._self._c;return r("div",[r("dropzone",{ref:"attachment",attrs:{id:"attachment",options:n.options,"destroy-dropzone":!0},on:{"vdropzone-sending":function(m,d,v){return n.sendingParams(m,d,v)},"vdropzone-success":function(m,d){return n.reloadAttachment(m,d)},"vdropzone-error":function(m,d,v){return n.handleError(m,d,v)}}})],1)},y=[],$=a(59),T=a(660),b=a.n(T),V=a(661),w={name:"FieldUpload",components:{Dropzone:b.a},props:{formType:{type:String,default:""},formData:{type:Object,default:function(){return{}}}},data:function(){return{showLoadingAttachment:!1,form:this.formData,options:{url:window.location.protocol+"//"+window.location.hostname+"/qb-core/api/document-files",timeout:9e9,addRemoveLinks:!0,withCredentials:!0,thumbnailWidth:50,thumbnailHeight:50,acceptedFiles:"image/*, application/pdf",dictDefaultMessage:"<span class='mdi mdi-cloud-upload'></span> UPLOAD HERE",headers:{Authorization:this.$auth.$storage.getCookie("_token.local")}}}},methods:{sendingParams:function(n,r,c){var m=this.form.id!==0?this.form.id:this.form.temp_id;c.append("temp_id",m),c.append("type",this.formType)},handleError:function(n,r,c){this.$swal({type:"error",title:"Error...",text:r.message})},reloadAttachment:function(n,r){var c=this;r.errors?this.$swal({type:"error",title:"Oops...",text:r.message}):(setTimeout(function(){c.getFiles()},300),this.$swal({type:"success",title:"Success...",text:"Attachment uploaded!"}))},getFiles:function(){var n=this;this.showLoadingAttachment=!0;var r=this,c=this.form.id?this.form.id:this.form.temp_id;this.$axios.get(r.options.url,{params:{type:this.formType,temp_id:c}}).then(function(m){n.$emit("eventGetFiles",{row:m.data.rows}),r.showLoadingAttachment=!1}).catch(function(m){n.showLoadingAttachment=!1,n.$swal({type:"error",title:"Error...",text:m.response.message})})},deleteFile:function(n){var r=this,c=this;this.$swal({title:"Are you sure?",text:"The file will be permanently deleted",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(function(m){m.value&&r.$axios.delete(c.options.url,{params:{id:n.id}}).then(function(d){r.$swal({type:"success",title:"Success...",text:"Attachment Deleted!"}),c.getFiles()}).catch(function(d){r.$swal({type:"error",title:"Oops...",text:d.response.data.message})})})}}},F=w,x=a(50),D=Object(x.a)(F,g,y,!1,null,null,null),A=h.default=D.exports}}]);
